/**
 * @license Rangy Inputs, a jQuery plug-in for selection and caret manipulation within textareas and text inputs.
 *
 * https://github.com/timdown/rangyinputs
 *
 * For range and selection features for contenteditable, see Rangy.

 * http://code.google.com/p/rangy/
 *
 * Depends on jQuery 1.0 or later.
 *
 * Copyright 2013, Tim Down
 * Licensed under the MIT license.
 * Version: 1.1.2
 * Build date: 6 September 2013
 */
/**
 * Diff Match and Patch
 *
 * Copyright 2006 Google Inc.
 * http://code.google.com/p/google-diff-match-patch/
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function diff_match_patch(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32}/**
 * BibtexParser - https://github.com/mayanklahiri/bib2json
 * Copyright 2012-13 Mayank Lahiri
 * mlahiri@gmail.com
 * Released under the BSD License.
 *
 * A forgiving Bibtex parser that can:
 *
 * (1) operate in streaming or block mode, extracting entries as dictionaries.
 * (2) convert Latex special characters to UTF-8.
 * (3) best-effort parse malformed entries.
 * (4) run in a CommonJS environment or a browser, without any dependencies.
 * (5) be advanced-compiled by Google Closure Compiler.
 *
 * Handwritten as a labor of love, not auto-generated from a grammar.
 *
 * Modes of usage:
 *
 * (1) Synchronous, string
 *
 *   var entries = BibtexParser(text);
 *   console.log(entries);
 *
 * (2) Asynchronous, stream
 *
 *   var entryCallback = function(entry) { console.log(entry); }
 *   var parser = new BibtexParser(entryCallback);
 *   parser.parse(chunk1);
 *   parser.parse(chunk2);
 *   ...
 *
 * @param {text|function(Object)} arg0 Either a Bibtex string or callback
 *                                    function for processing parsed entries.
 * @constructor
 */
function BibtexParser(e){function t(e){i.push(e)}if(_.isString(e)){var n={},i=[],r=BibtexParser.call(n,t);return r.parse(e),{entries:i,errors:r.getErrors()}}return _.isFunction(e)?(this.STATES_={ENTRY_OR_JUNK:0,OBJECT_TYPE:1,ENTRY_KEY:2,KV_KEY:3,EQUALS:4,KV_VALUE:5},this.DATA_={},this.CALLBACK_=e,this.CHAR_=0,this.LINE_=1,this.CHAR_IN_LINE_=0,this.SKIPWS_=!0,this.SKIPCOMMENT_=!0,this.PARSETMP_={},this.SKIPTILLEOL_=!1,this.VALBRACES_=null,this.BRACETYPE_=null,this.BRACECOUNT_=0,this.STATE_=this.STATES_.ENTRY_OR_JUNK,this.ERRORS_=[],this.ENTRY_TYPES_={inproceedings:1,proceedings:2,article:3,techreport:4,misc:5,mastersthesis:6,book:7,phdthesis:8,incollection:9,unpublished:10,inbook:11,manual:12,periodical:13,booklet:14,masterthesis:15,conference:16,online:17},this.MACROS_={jan:"January",feb:"February",mar:"March",apr:"April",may:"May",jun:"June",jul:"July",aug:"August",sep:"September",oct:"October",nov:"November",dec:"December",Jan:"January",Feb:"February",Mar:"March",Apr:"April",May:"May",Jun:"June",Jul:"July",Aug:"August",Sep:"September",Oct:"October",Nov:"November",Dec:"December"},this.getErrors=function(){return this.ERRORS_},this.parse=function(e){for(var t=0;t<e.length;t++)this.processCharacter_(e[t])},this.error_=function(e){this.ERRORS_.push([this.LINE_,this.CHAR_IN_LINE_,this.CHAR_,e])},this.processEntry_=function(){var e=this.DATA_;if(e.Fields)for(var t in e.Fields){for(var n=e.Fields[t],i=0;i<this.CHARCONV_.length;i++){var r=this.CHARCONV_[i][0],o=this.CHARCONV_[i][1];n=n.replace(r,o)}n=n.replace(/[\n\r\t]/g," ").replace(/\s\s+/g," ").replace(/^\s+|\s+$/g,"");for(var a=n.length,s="",i=0;a>i;i++){var l=n[i],c=!1;"\\"==l&&a-1>i?l=n[++i]:"{"!=l&&"}"!=l||(c=!0),c||(s+=l)}e.Fields[t]=s}if("string"==e.ObjectType)for(var t in e.Fields)this.MACROS_[t]=e.Fields[t];else this.CALLBACK_(e)},this.processCharacter_=function(e){if(this.CHAR_++,this.CHAR_IN_LINE_++,"\n"==e&&(this.LINE_++,this.CHAR_IN_LINE_=1),this.SKIPTILLEOL_)return void("\n"==e&&(this.SKIPTILLEOL_=!1));if(this.SKIPCOMMENT_&&"%"==e)return void(this.SKIPTILLEOL_=!0);if(!this.SKIPWS_||!/\s/.test(e)){this.SKIPWS_=!1,this.SKIPCOMMENT_=!1,this.SKIPTILLEOL_=!1;for(var t=!0;t;)switch(t=!1,this.STATE_){case this.STATES_.ENTRY_OR_JUNK:"@"==e&&(this.STATE_=this.STATES_.OBJECT_TYPE,this.DATA_={ObjectType:""}),this.BRACETYPE_=null,this.SKIPWS_=!0,this.SKIPCOMMENT_=!0;break;case this.STATES_.OBJECT_TYPE:if(/[A-Za-z]/.test(e))this.DATA_.ObjectType+=e.toLowerCase(),this.SKIPWS_=!0,this.SKIPCOMMENT_=!0;else{var n=this.DATA_.ObjectType;"comment"==n?this.STATE_=this.STATES_.ENTRY_OR_JUNK:"string"==n?(this.DATA_.ObjectType=n,this.DATA_.Fields={},this.BRACETYPE_=e,this.BRACECOUNT_=1,this.STATE_=this.STATES_.KV_KEY,this.SKIPWS_=!0,this.SKIPCOMMENT_=!0,this.PARSETMP_={Key:""}):"preamble"==n?this.STATE_=this.STATES_.ENTRY_OR_JUNK:n in this.ENTRY_TYPES_?(this.DATA_.ObjectType="entry",this.DATA_.EntryType=n,this.DATA_.EntryKey="",this.STATE_=this.STATES_.ENTRY_KEY,t=!0):(this.error_('Unrecognized object type: "'+this.DATA_.ObjectType+'"'),this.STATE_=this.STATES_.ENTRY_OR_JUNK)}break;case this.STATES_.ENTRY_KEY:if(("{"===e||"("===e)&&null==this.BRACETYPE_){this.BRACETYPE_=e,this.BRACECOUNT_=1,this.SKIPWS_=!0,this.SKIPCOMMENT_=!0;break}/[,%\s]/.test(e)?this.DATA_.EntryKey.length<1?(this.SKIPWS_=!0,this.SKIPCOMMENT_=!0):null==this.BRACETYPE_?(this.error_("No opening brace for object."),this.STATE_=this.STATES_.ENTRY_OR_JUNK):(this.SKIPWS_=!0,this.SKIPCOMMENT_=!0,t=!0,this.STATE_=this.STATES_.KV_KEY,this.PARSETMP_.Key="",this.DATA_.Fields={}):(this.DATA_.EntryKey+=e,this.SKIPWS_=!1,this.SKIPCOMMENT_=!1);break;case this.STATES_.KV_KEY:if("}"==e&&"{"==this.BRACETYPE_||")"==e&&"("==this.BRACETYPE_){this.processEntry_(),this.SKIPWS_=!0,this.SKIPCOMMENT_=!0,this.STATE_=this.STATES_.ENTRY_OR_JUNK;break}/[\-A-Za-z:]/.test(e)?(this.PARSETMP_.Key+=e,this.SKIPWS_=!1,this.SKIPCOMMENT_=!1):this.PARSETMP_.Key.length<1?(this.SKIPWS_=!0,this.SKIPCOMMENT_=!0):(this.SKIPWS_=!0,this.SKIPCOMMENT_=!0,this.STATE_=this.STATES_.EQUALS,t=!0);break;case this.STATES_.EQUALS:if("}"==e&&"{"==this.BRACETYPE_||")"==e&&"("==this.BRACETYPE_){this.error_('Key-value pair has key "'+this.PARSETMP_.Key+'", but no value.'),this.processEntry_(),this.SKIPWS_=!0,this.SKIPCOMMENT_=!0,this.STATE_=this.STATES_.ENTRY_OR_JUNK;break}"="==e&&(this.SKIPWS_=!0,this.SKIPCOMMENT_=!0,this.STATE_=this.STATES_.KV_VALUE,this.PARSETMP_.Value="",this.VALBRACES_={'"':[],"{":[]});break;case this.STATES_.KV_VALUE:var i=this.VALBRACES_,r=this.PARSETMP_.Value,o=!1;if('"'==e||"{"==e||"}"==e||","==e){if(","==e&&0===i['"'].length+i["{"].length){var a=this.PARSETMP_.Value.trim();a in this.MACROS_?this.PARSETMP_.Value=this.MACROS_[a]:this.error_("Reference to an undefined macro: "+a),o=!0}if('"'==e){if(0===i['"'].length+i["{"].length){i['"'].push(this.CHAR_),this.SKIPWS_=!1,this.SKIPCOMMENT_=!1;break}1!=i['"'].length||0!=i["{"].length||0!=r.length&&"\\"==r[r.length-1]||(o=!0)}if("{"==e&&(0!=r.length&&"\\"==r[r.length-1]||(i["{"].push(this.CHAR_),this.SKIPWS_=!1,this.SKIPCOMMENT_=!1)),"}"==e)if(0===i['"'].length+i["{"].length){var a=this.PARSETMP_.Value.trim();a in this.MACROS_?this.PARSETMP_.Value=this.MACROS_[a]:this.error_("Reference to an undefined macro: "+a),t=!0,o=!0}else 0!=r.length&&"\\"==r[r.length-1]||i["{"].length>0&&(i["{"].splice(i["{"].length-1,1),0==i["{"].length+i['"'].length&&(o=!0))}o?(this.SKIPWS_=!0,this.SKIPCOMMENT_=!0,this.STATE_=this.STATES_.KV_KEY,this.DATA_.Fields[this.PARSETMP_.Key]=this.PARSETMP_.Value,this.PARSETMP_={Key:""},this.VALBRACES_=null):this.PARSETMP_.Value+=e}}},this.CHARCONV_=[[/\\space /g," "],[/\\textdollar /g,"$"],[/\\textquotesingle /g,"'"],[/\\ast /g,"*"],[/\\textbackslash /g,"\\"],[/\\\^\{\}/g,"^"],[/\\textasciigrave /g,"`"],[/\\lbrace /g,"{"],[/\\vert /g,"|"],[/\\rbrace /g,"}"],[/\\textasciitilde /g,"~"],[/\\textexclamdown /g,"\xa1"],[/\\textcent /g,"\xa2"],[/\\textsterling /g,"\xa3"],[/\\textcurrency /g,"\xa4"],[/\\textyen /g,"\xa5"],[/\\textbrokenbar /g,"\xa6"],[/\\textsection /g,"\xa7"],[/\\textasciidieresis /g,"\xa8"],[/\\textcopyright /g,"\xa9"],[/\\textordfeminine /g,"\xaa"],[/\\guillemotleft /g,"\xab"],[/\\lnot /g,"\xac"],[/\\textregistered /g,"\xae"],[/\\textasciimacron /g,"\xaf"],[/\\textdegree /g,"\xb0"],[/\\pm /g,"\xb1"],[/\\textasciiacute /g,"\xb4"],[/\\mathrm\{\\mu\}/g,"\xb5"],[/\\textparagraph /g,"\xb6"],[/\\cdot /g,"\xb7"],[/\\c\{\}/g,"\xb8"],[/\\textordmasculine /g,"\xba"],[/\\guillemotright /g,"\xbb"],[/\\textonequarter /g,"\xbc"],[/\\textonehalf /g,"\xbd"],[/\\textthreequarters /g,"\xbe"],[/\\textquestiondown /g,"\xbf"],[/\\`\{A\}/g,"\xc0"],[/\\'\{A\}/g,"\xc1"],[/\\\^\{A\}/g,"\xc2"],[/\\~\{A\}/g,"\xc3"],[/\\"\{A\}/g,"\xc4"],[/\\AA /g,"\xc5"],[/\\AE /g,"\xc6"],[/\\c\{C\}/g,"\xc7"],[/\\`\{E\}/g,"\xc8"],[/\\'\{E\}/g,"\xc9"],[/\\\^\{E\}/g,"\xca"],[/\\"\{E\}/g,"\xcb"],[/\\`\{I\}/g,"\xcc"],[/\\'\{I\}/g,"\xcd"],[/\\\^\{I\}/g,"\xce"],[/\\"\{I\}/g,"\xcf"],[/\\DH /g,"\xd0"],[/\\~\{N\}/g,"\xd1"],[/\\`\{O\}/g,"\xd2"],[/\\'\{O\}/g,"\xd3"],[/\\\^\{O\}/g,"\xd4"],[/\\~\{O\}/g,"\xd5"],[/\\"\{O\}/g,"\xd6"],[/\\texttimes /g,"\xd7"],[/\\O /g,"\xd8"],[/\\`\{U\}/g,"\xd9"],[/\\'\{U\}/g,"\xda"],[/\\\^\{U\}/g,"\xdb"],[/\\"\{U\}/g,"\xdc"],[/\\'\{Y\}/g,"\xdd"],[/\\TH /g,"\xde"],[/\\ss /g,"\xdf"],[/\\`\{a\}/g,"\xe0"],[/\\'\{a\}/g,"\xe1"],[/\\\^\{a\}/g,"\xe2"],[/\\~\{a\}/g,"\xe3"],[/\\"\{a\}/g,"\xe4"],[/\\aa /g,"\xe5"],[/\\ae /g,"\xe6"],[/\\c\{c\}/g,"\xe7"],[/\\`\{e\}/g,"\xe8"],[/\\'\{e\}/g,"\xe9"],[/\\\^\{e\}/g,"\xea"],[/\\"\{e\}/g,"\xeb"],[/\\`\{\\i\}/g,"\xec"],[/\\'\{\\i\}/g,"\xed"],[/\\\^\{\\i\}/g,"\xee"],[/\\"\{\\i\}/g,"\xef"],[/\\dh /g,"\xf0"],[/\\~\{n\}/g,"\xf1"],[/\\`\{o\}/g,"\xf2"],[/\\'\{o\}/g,"\xf3"],[/\\\^\{o\}/g,"\xf4"],[/\\~\{o\}/g,"\xf5"],[/\\"\{o\}/g,"\xf6"],[/\\div /g,"\xf7"],[/\\o /g,"\xf8"],[/\\`\{u\}/g,"\xf9"],[/\\'\{u\}/g,"\xfa"],[/\\\^\{u\}/g,"\xfb"],[/\\"\{u\}/g,"\xfc"],[/\\'\{y\}/g,"\xfd"],[/\\th /g,"\xfe"],[/\\"\{y\}/g,"\xff"],[/\\=\{A\}/g,"\u0100"],[/\\=\{a\}/g,"\u0101"],[/\\u\{A\}/g,"\u0102"],[/\\u\{a\}/g,"\u0103"],[/\\k\{A\}/g,"\u0104"],[/\\k\{a\}/g,"\u0105"],[/\\'\{C\}/g,"\u0106"],[/\\'\{c\}/g,"\u0107"],[/\\\^\{C\}/g,"\u0108"],[/\\\^\{c\}/g,"\u0109"],[/\\.\{C\}/g,"\u010a"],[/\\.\{c\}/g,"\u010b"],[/\\v\{C\}/g,"\u010c"],[/\\v\{c\}/g,"\u010d"],[/\\v\{D\}/g,"\u010e"],[/\\v\{d\}/g,"\u010f"],[/\\DJ /g,"\u0110"],[/\\dj /g,"\u0111"],[/\\=\{E\}/g,"\u0112"],[/\\=\{e\}/g,"\u0113"],[/\\u\{E\}/g,"\u0114"],[/\\u\{e\}/g,"\u0115"],[/\\.\{E\}/g,"\u0116"],[/\\.\{e\}/g,"\u0117"],[/\\k\{E\}/g,"\u0118"],[/\\k\{e\}/g,"\u0119"],[/\\v\{E\}/g,"\u011a"],[/\\v\{e\}/g,"\u011b"],[/\\\^\{G\}/g,"\u011c"],[/\\\^\{g\}/g,"\u011d"],[/\\u\{G\}/g,"\u011e"],[/\\u\{g\}/g,"\u011f"],[/\\.\{G\}/g,"\u0120"],[/\\.\{g\}/g,"\u0121"],[/\\c\{G\}/g,"\u0122"],[/\\c\{g\}/g,"\u0123"],[/\\\^\{H\}/g,"\u0124"],[/\\\^\{h\}/g,"\u0125"],[/\\Elzxh /g,"\u0127"],[/\\~\{I\}/g,"\u0128"],[/\\~\{\\i\}/g,"\u0129"],[/\\=\{I\}/g,"\u012a"],[/\\=\{\\i\}/g,"\u012b"],[/\\u\{I\}/g,"\u012c"],[/\\u\{\\i\}/g,"\u012d"],[/\\k\{I\}/g,"\u012e"],[/\\k\{i\}/g,"\u012f"],[/\\.\{I\}/g,"\u0130"],[/\\i /g,"\u0131"],[/\\\^\{J\}/g,"\u0134"],[/\\\^\{\\j\}/g,"\u0135"],[/\\c\{K\}/g,"\u0136"],[/\\c\{k\}/g,"\u0137"],[/\\'\{L\}/g,"\u0139"],[/\\'\{l\}/g,"\u013a"],[/\\c\{L\}/g,"\u013b"],[/\\c\{l\}/g,"\u013c"],[/\\v\{L\}/g,"\u013d"],[/\\v\{l\}/g,"\u013e"],[/\\L /g,"\u0141"],[/\\l /g,"\u0142"],[/\\'\{N\}/g,"\u0143"],[/\\'\{n\}/g,"\u0144"],[/\\c\{N\}/g,"\u0145"],[/\\c\{n\}/g,"\u0146"],[/\\v\{N\}/g,"\u0147"],[/\\v\{n\}/g,"\u0148"],[/\\NG /g,"\u014a"],[/\\ng /g,"\u014b"],[/\\=\{O\}/g,"\u014c"],[/\\=\{o\}/g,"\u014d"],[/\\u\{O\}/g,"\u014e"],[/\\u\{o\}/g,"\u014f"],[/\\H\{O\}/g,"\u0150"],[/\\H\{o\}/g,"\u0151"],[/\\OE /g,"\u0152"],[/\\oe /g,"\u0153"],[/\\'\{R\}/g,"\u0154"],[/\\'\{r\}/g,"\u0155"],[/\\c\{R\}/g,"\u0156"],[/\\c\{r\}/g,"\u0157"],[/\\v\{R\}/g,"\u0158"],[/\\v\{r\}/g,"\u0159"],[/\\'\{S\}/g,"\u015a"],[/\\'\{s\}/g,"\u015b"],[/\\\^\{S\}/g,"\u015c"],[/\\\^\{s\}/g,"\u015d"],[/\\c\{S\}/g,"\u015e"],[/\\c\{s\}/g,"\u015f"],[/\\v\{S\}/g,"\u0160"],[/\\v\{s\}/g,"\u0161"],[/\\c\{T\}/g,"\u0162"],[/\\c\{t\}/g,"\u0163"],[/\\v\{T\}/g,"\u0164"],[/\\v\{t\}/g,"\u0165"],[/\\~\{U\}/g,"\u0168"],[/\\~\{u\}/g,"\u0169"],[/\\=\{U\}/g,"\u016a"],[/\\=\{u\}/g,"\u016b"],[/\\u\{U\}/g,"\u016c"],[/\\u\{u\}/g,"\u016d"],[/\\r\{U\}/g,"\u016e"],[/\\r\{u\}/g,"\u016f"],[/\\H\{U\}/g,"\u0170"],[/\\H\{u\}/g,"\u0171"],[/\\k\{U\}/g,"\u0172"],[/\\k\{u\}/g,"\u0173"],[/\\\^\{W\}/g,"\u0174"],[/\\\^\{w\}/g,"\u0175"],[/\\\^\{Y\}/g,"\u0176"],[/\\\^\{y\}/g,"\u0177"],[/\\"\{Y\}/g,"\u0178"],[/\\'\{Z\}/g,"\u0179"],[/\\'\{z\}/g,"\u017a"],[/\\.\{Z\}/g,"\u017b"],[/\\.\{z\}/g,"\u017c"],[/\\v\{Z\}/g,"\u017d"],[/\\v\{z\}/g,"\u017e"],[/\\texthvlig /g,"\u0195"],[/\\textnrleg /g,"\u019e"],[/\\eth /g,"\u01aa"],[/\\textdoublepipe /g,"\u01c2"],[/\\'\{g\}/g,"\u01f5"],[/\\Elztrna /g,"\u0250"],[/\\Elztrnsa /g,"\u0252"],[/\\Elzopeno /g,"\u0254"],[/\\Elzrtld /g,"\u0256"],[/\\Elzschwa /g,"\u0259"],[/\\varepsilon /g,"\u025b"],[/\\Elzpgamma /g,"\u0263"],[/\\Elzpbgam /g,"\u0264"],[/\\Elztrnh /g,"\u0265"],[/\\Elzbtdl /g,"\u026c"],[/\\Elzrtll /g,"\u026d"],[/\\Elztrnm /g,"\u026f"],[/\\Elztrnmlr /g,"\u0270"],[/\\Elzltlmr /g,"\u0271"],[/\\Elzltln /g,"\u0272"],[/\\Elzrtln /g,"\u0273"],[/\\Elzclomeg /g,"\u0277"],[/\\textphi /g,"\u0278"],[/\\Elztrnr /g,"\u0279"],[/\\Elztrnrl /g,"\u027a"],[/\\Elzrttrnr /g,"\u027b"],[/\\Elzrl /g,"\u027c"],[/\\Elzrtlr /g,"\u027d"],[/\\Elzfhr /g,"\u027e"],[/\\Elzrtls /g,"\u0282"],[/\\Elzesh /g,"\u0283"],[/\\Elztrnt /g,"\u0287"],[/\\Elzrtlt /g,"\u0288"],[/\\Elzpupsil /g,"\u028a"],[/\\Elzpscrv /g,"\u028b"],[/\\Elzinvv /g,"\u028c"],[/\\Elzinvw /g,"\u028d"],[/\\Elztrny /g,"\u028e"],[/\\Elzrtlz /g,"\u0290"],[/\\Elzyogh /g,"\u0292"],[/\\Elzglst /g,"\u0294"],[/\\Elzreglst /g,"\u0295"],[/\\Elzinglst /g,"\u0296"],[/\\textturnk /g,"\u029e"],[/\\Elzdyogh /g,"\u02a4"],[/\\Elztesh /g,"\u02a7"],[/\\textasciicaron /g,"\u02c7"],[/\\Elzverts /g,"\u02c8"],[/\\Elzverti /g,"\u02cc"],[/\\Elzlmrk /g,"\u02d0"],[/\\Elzhlmrk /g,"\u02d1"],[/\\Elzsbrhr /g,"\u02d2"],[/\\Elzsblhr /g,"\u02d3"],[/\\Elzrais /g,"\u02d4"],[/\\Elzlow /g,"\u02d5"],[/\\textasciibreve /g,"\u02d8"],[/\\textperiodcentered /g,"\u02d9"],[/\\r\{\}/g,"\u02da"],[/\\k\{\}/g,"\u02db"],[/\\texttildelow /g,"\u02dc"],[/\\H\{\}/g,"\u02dd"],[/\\tone\{55\}/g,"\u02e5"],[/\\tone\{44\}/g,"\u02e6"],[/\\tone\{33\}/g,"\u02e7"],[/\\tone\{22\}/g,"\u02e8"],[/\\tone\{11\}/g,"\u02e9"],[/\\cyrchar\\C/g,"\u030f"],[/\\Elzpalh /g,"\u0321"],[/\\Elzrh /g,"\u0322"],[/\\Elzsbbrg /g,"\u032a"],[/\\Elzxl /g,"\u0335"],[/\\Elzbar /g,"\u0336"],[/\\'\{A\}/g,"\u0386"],[/\\'\{E\}/g,"\u0388"],[/\\'\{H\}/g,"\u0389"],[/\\'\{\}\{I\}/g,"\u038a"],[/\\'\{\}O/g,"\u038c"],[/\\mathrm\{'Y\}/g,"\u038e"],[/\\mathrm\{'\\Omega\}/g,"\u038f"],[/\\acute\{\\ddot\{\\iota\}\}/g,"\u0390"],[/\\Alpha /g,"\u0391"],[/\\Beta /g,"\u0392"],[/\\Gamma /g,"\u0393"],[/\\Delta /g,"\u0394"],[/\\Epsilon /g,"\u0395"],[/\\Zeta /g,"\u0396"],[/\\Eta /g,"\u0397"],[/\\Theta /g,"\u0398"],[/\\Iota /g,"\u0399"],[/\\Kappa /g,"\u039a"],[/\\Lambda /g,"\u039b"],[/\\Xi /g,"\u039e"],[/\\Pi /g,"\u03a0"],[/\\Rho /g,"\u03a1"],[/\\Sigma /g,"\u03a3"],[/\\Tau /g,"\u03a4"],[/\\Upsilon /g,"\u03a5"],[/\\Phi /g,"\u03a6"],[/\\Chi /g,"\u03a7"],[/\\Psi /g,"\u03a8"],[/\\Omega /g,"\u03a9"],[/\\mathrm\{\\ddot\{I\}\}/g,"\u03aa"],[/\\mathrm\{\\ddot\{Y\}\}/g,"\u03ab"],[/\\'\{\$\\alpha\$\}/g,"\u03ac"],[/\\acute\{\\epsilon\}/g,"\u03ad"],[/\\acute\{\\eta\}/g,"\u03ae"],[/\\acute\{\\iota\}/g,"\u03af"],[/\\acute\{\\ddot\{\\upsilon\}\}/g,"\u03b0"],[/\\alpha /g,"\u03b1"],[/\\beta /g,"\u03b2"],[/\\gamma /g,"\u03b3"],[/\\delta /g,"\u03b4"],[/\\epsilon /g,"\u03b5"],[/\\zeta /g,"\u03b6"],[/\\eta /g,"\u03b7"],[/\\texttheta /g,"\u03b8"],[/\\iota /g,"\u03b9"],[/\\kappa /g,"\u03ba"],[/\\lambda /g,"\u03bb"],[/\\mu /g,"\u03bc"],[/\\nu /g,"\u03bd"],[/\\xi /g,"\u03be"],[/\\pi /g,"\u03c0"],[/\\rho /g,"\u03c1"],[/\\varsigma /g,"\u03c2"],[/\\sigma /g,"\u03c3"],[/\\tau /g,"\u03c4"],[/\\upsilon /g,"\u03c5"],[/\\varphi /g,"\u03c6"],[/\\chi /g,"\u03c7"],[/\\psi /g,"\u03c8"],[/\\omega /g,"\u03c9"],[/\\ddot\{\\iota\}/g,"\u03ca"],[/\\ddot\{\\upsilon\}/g,"\u03cb"],[/\\'\{o\}/g,"\u03cc"],[/\\acute\{\\upsilon\}/g,"\u03cd"],[/\\acute\{\\omega\}/g,"\u03ce"],[/\\Pisymbol\{ppi022\}\{87\}/g,"\u03d0"],[/\\textvartheta /g,"\u03d1"],[/\\Upsilon /g,"\u03d2"],[/\\phi /g,"\u03d5"],[/\\varpi /g,"\u03d6"],[/\\Stigma /g,"\u03da"],[/\\Digamma /g,"\u03dc"],[/\\digamma /g,"\u03dd"],[/\\Koppa /g,"\u03de"],[/\\Sampi /g,"\u03e0"],[/\\varkappa /g,"\u03f0"],[/\\varrho /g,"\u03f1"],[/\\textTheta /g,"\u03f4"],[/\\backepsilon /g,"\u03f6"],[/\\cyrchar\\CYRYO /g,"\u0401"],[/\\cyrchar\\CYRDJE /g,"\u0402"],[/\\cyrchar\{\\'\\CYRG\}/g,"\u0403"],[/\\cyrchar\\CYRIE /g,"\u0404"],[/\\cyrchar\\CYRDZE /g,"\u0405"],[/\\cyrchar\\CYRII /g,"\u0406"],[/\\cyrchar\\CYRYI /g,"\u0407"],[/\\cyrchar\\CYRJE /g,"\u0408"],[/\\cyrchar\\CYRLJE /g,"\u0409"],[/\\cyrchar\\CYRNJE /g,"\u040a"],[/\\cyrchar\\CYRTSHE /g,"\u040b"],[/\\cyrchar\{\\'\\CYRK\}/g,"\u040c"],[/\\cyrchar\\CYRUSHRT /g,"\u040e"],[/\\cyrchar\\CYRDZHE /g,"\u040f"],[/\\cyrchar\\CYRA /g,"\u0410"],[/\\cyrchar\\CYRB /g,"\u0411"],[/\\cyrchar\\CYRV /g,"\u0412"],[/\\cyrchar\\CYRG /g,"\u0413"],[/\\cyrchar\\CYRD /g,"\u0414"],[/\\cyrchar\\CYRE /g,"\u0415"],[/\\cyrchar\\CYRZH /g,"\u0416"],[/\\cyrchar\\CYRZ /g,"\u0417"],[/\\cyrchar\\CYRI /g,"\u0418"],[/\\cyrchar\\CYRISHRT /g,"\u0419"],[/\\cyrchar\\CYRK /g,"\u041a"],[/\\cyrchar\\CYRL /g,"\u041b"],[/\\cyrchar\\CYRM /g,"\u041c"],[/\\cyrchar\\CYRN /g,"\u041d"],[/\\cyrchar\\CYRO /g,"\u041e"],[/\\cyrchar\\CYRP /g,"\u041f"],[/\\cyrchar\\CYRR /g,"\u0420"],[/\\cyrchar\\CYRS /g,"\u0421"],[/\\cyrchar\\CYRT /g,"\u0422"],[/\\cyrchar\\CYRU /g,"\u0423"],[/\\cyrchar\\CYRF /g,"\u0424"],[/\\cyrchar\\CYRH /g,"\u0425"],[/\\cyrchar\\CYRC /g,"\u0426"],[/\\cyrchar\\CYRCH /g,"\u0427"],[/\\cyrchar\\CYRSH /g,"\u0428"],[/\\cyrchar\\CYRSHCH /g,"\u0429"],[/\\cyrchar\\CYRHRDSN /g,"\u042a"],[/\\cyrchar\\CYRERY /g,"\u042b"],[/\\cyrchar\\CYRSFTSN /g,"\u042c"],[/\\cyrchar\\CYREREV /g,"\u042d"],[/\\cyrchar\\CYRYU /g,"\u042e"],[/\\cyrchar\\CYRYA /g,"\u042f"],[/\\cyrchar\\cyra /g,"\u0430"],[/\\cyrchar\\cyrb /g,"\u0431"],[/\\cyrchar\\cyrv /g,"\u0432"],[/\\cyrchar\\cyrg /g,"\u0433"],[/\\cyrchar\\cyrd /g,"\u0434"],[/\\cyrchar\\cyre /g,"\u0435"],[/\\cyrchar\\cyrzh /g,"\u0436"],[/\\cyrchar\\cyrz /g,"\u0437"],[/\\cyrchar\\cyri /g,"\u0438"],[/\\cyrchar\\cyrishrt /g,"\u0439"],[/\\cyrchar\\cyrk /g,"\u043a"],[/\\cyrchar\\cyrl /g,"\u043b"],[/\\cyrchar\\cyrm /g,"\u043c"],[/\\cyrchar\\cyrn /g,"\u043d"],[/\\cyrchar\\cyro /g,"\u043e"],[/\\cyrchar\\cyrp /g,"\u043f"],[/\\cyrchar\\cyrr /g,"\u0440"],[/\\cyrchar\\cyrs /g,"\u0441"],[/\\cyrchar\\cyrt /g,"\u0442"],[/\\cyrchar\\cyru /g,"\u0443"],[/\\cyrchar\\cyrf /g,"\u0444"],[/\\cyrchar\\cyrh /g,"\u0445"],[/\\cyrchar\\cyrc /g,"\u0446"],[/\\cyrchar\\cyrch /g,"\u0447"],[/\\cyrchar\\cyrsh /g,"\u0448"],[/\\cyrchar\\cyrshch /g,"\u0449"],[/\\cyrchar\\cyrhrdsn /g,"\u044a"],[/\\cyrchar\\cyrery /g,"\u044b"],[/\\cyrchar\\cyrsftsn /g,"\u044c"],[/\\cyrchar\\cyrerev /g,"\u044d"],[/\\cyrchar\\cyryu /g,"\u044e"],[/\\cyrchar\\cyrya /g,"\u044f"],[/\\cyrchar\\cyryo /g,"\u0451"],[/\\cyrchar\\cyrdje /g,"\u0452"],[/\\cyrchar\{\\'\\cyrg\}/g,"\u0453"],[/\\cyrchar\\cyrie /g,"\u0454"],[/\\cyrchar\\cyrdze /g,"\u0455"],[/\\cyrchar\\cyrii /g,"\u0456"],[/\\cyrchar\\cyryi /g,"\u0457"],[/\\cyrchar\\cyrje /g,"\u0458"],[/\\cyrchar\\cyrlje /g,"\u0459"],[/\\cyrchar\\cyrnje /g,"\u045a"],[/\\cyrchar\\cyrtshe /g,"\u045b"],[/\\cyrchar\{\\'\\cyrk\}/g,"\u045c"],[/\\cyrchar\\cyrushrt /g,"\u045e"],[/\\cyrchar\\cyrdzhe /g,"\u045f"],[/\\cyrchar\\CYROMEGA /g,"\u0460"],[/\\cyrchar\\cyromega /g,"\u0461"],[/\\cyrchar\\CYRYAT /g,"\u0462"],[/\\cyrchar\\CYRIOTE /g,"\u0464"],[/\\cyrchar\\cyriote /g,"\u0465"],[/\\cyrchar\\CYRLYUS /g,"\u0466"],[/\\cyrchar\\cyrlyus /g,"\u0467"],[/\\cyrchar\\CYRIOTLYUS /g,"\u0468"],[/\\cyrchar\\cyriotlyus /g,"\u0469"],[/\\cyrchar\\CYRBYUS /g,"\u046a"],[/\\cyrchar\\CYRIOTBYUS /g,"\u046c"],[/\\cyrchar\\cyriotbyus /g,"\u046d"],[/\\cyrchar\\CYRKSI /g,"\u046e"],[/\\cyrchar\\cyrksi /g,"\u046f"],[/\\cyrchar\\CYRPSI /g,"\u0470"],[/\\cyrchar\\cyrpsi /g,"\u0471"],[/\\cyrchar\\CYRFITA /g,"\u0472"],[/\\cyrchar\\CYRIZH /g,"\u0474"],[/\\cyrchar\\CYRUK /g,"\u0478"],[/\\cyrchar\\cyruk /g,"\u0479"],[/\\cyrchar\\CYROMEGARND /g,"\u047a"],[/\\cyrchar\\cyromegarnd /g,"\u047b"],[/\\cyrchar\\CYROMEGATITLO /g,"\u047c"],[/\\cyrchar\\cyromegatitlo /g,"\u047d"],[/\\cyrchar\\CYROT /g,"\u047e"],[/\\cyrchar\\cyrot /g,"\u047f"],[/\\cyrchar\\CYRKOPPA /g,"\u0480"],[/\\cyrchar\\cyrkoppa /g,"\u0481"],[/\\cyrchar\\cyrthousands /g,"\u0482"],[/\\cyrchar\\cyrhundredthousands /g,"\u0488"],[/\\cyrchar\\cyrmillions /g,"\u0489"],[/\\cyrchar\\CYRSEMISFTSN /g,"\u048c"],[/\\cyrchar\\cyrsemisftsn /g,"\u048d"],[/\\cyrchar\\CYRRTICK /g,"\u048e"],[/\\cyrchar\\cyrrtick /g,"\u048f"],[/\\cyrchar\\CYRGUP /g,"\u0490"],[/\\cyrchar\\cyrgup /g,"\u0491"],[/\\cyrchar\\CYRGHCRS /g,"\u0492"],[/\\cyrchar\\cyrghcrs /g,"\u0493"],[/\\cyrchar\\CYRGHK /g,"\u0494"],[/\\cyrchar\\cyrghk /g,"\u0495"],[/\\cyrchar\\CYRZHDSC /g,"\u0496"],[/\\cyrchar\\cyrzhdsc /g,"\u0497"],[/\\cyrchar\\CYRZDSC /g,"\u0498"],[/\\cyrchar\\cyrzdsc /g,"\u0499"],[/\\cyrchar\\CYRKDSC /g,"\u049a"],[/\\cyrchar\\cyrkdsc /g,"\u049b"],[/\\cyrchar\\CYRKVCRS /g,"\u049c"],[/\\cyrchar\\cyrkvcrs /g,"\u049d"],[/\\cyrchar\\CYRKHCRS /g,"\u049e"],[/\\cyrchar\\cyrkhcrs /g,"\u049f"],[/\\cyrchar\\CYRKBEAK /g,"\u04a0"],[/\\cyrchar\\cyrkbeak /g,"\u04a1"],[/\\cyrchar\\CYRNDSC /g,"\u04a2"],[/\\cyrchar\\cyrndsc /g,"\u04a3"],[/\\cyrchar\\CYRNG /g,"\u04a4"],[/\\cyrchar\\cyrng /g,"\u04a5"],[/\\cyrchar\\CYRPHK /g,"\u04a6"],[/\\cyrchar\\cyrphk /g,"\u04a7"],[/\\cyrchar\\CYRABHHA /g,"\u04a8"],[/\\cyrchar\\cyrabhha /g,"\u04a9"],[/\\cyrchar\\CYRSDSC /g,"\u04aa"],[/\\cyrchar\\cyrsdsc /g,"\u04ab"],[/\\cyrchar\\CYRTDSC /g,"\u04ac"],[/\\cyrchar\\cyrtdsc /g,"\u04ad"],[/\\cyrchar\\CYRY /g,"\u04ae"],[/\\cyrchar\\cyry /g,"\u04af"],[/\\cyrchar\\CYRYHCRS /g,"\u04b0"],[/\\cyrchar\\cyryhcrs /g,"\u04b1"],[/\\cyrchar\\CYRHDSC /g,"\u04b2"],[/\\cyrchar\\cyrhdsc /g,"\u04b3"],[/\\cyrchar\\CYRTETSE /g,"\u04b4"],[/\\cyrchar\\cyrtetse /g,"\u04b5"],[/\\cyrchar\\CYRCHRDSC /g,"\u04b6"],[/\\cyrchar\\cyrchrdsc /g,"\u04b7"],[/\\cyrchar\\CYRCHVCRS /g,"\u04b8"],[/\\cyrchar\\cyrchvcrs /g,"\u04b9"],[/\\cyrchar\\CYRSHHA /g,"\u04ba"],[/\\cyrchar\\cyrshha /g,"\u04bb"],[/\\cyrchar\\CYRABHCH /g,"\u04bc"],[/\\cyrchar\\cyrabhch /g,"\u04bd"],[/\\cyrchar\\CYRABHCHDSC /g,"\u04be"],[/\\cyrchar\\cyrabhchdsc /g,"\u04bf"],[/\\cyrchar\\CYRpalochka /g,"\u04c0"],[/\\cyrchar\\CYRKHK /g,"\u04c3"],[/\\cyrchar\\cyrkhk /g,"\u04c4"],[/\\cyrchar\\CYRNHK /g,"\u04c7"],[/\\cyrchar\\cyrnhk /g,"\u04c8"],[/\\cyrchar\\CYRCHLDSC /g,"\u04cb"],[/\\cyrchar\\cyrchldsc /g,"\u04cc"],[/\\cyrchar\\CYRAE /g,"\u04d4"],[/\\cyrchar\\cyrae /g,"\u04d5"],[/\\cyrchar\\CYRSCHWA /g,"\u04d8"],[/\\cyrchar\\cyrschwa /g,"\u04d9"],[/\\cyrchar\\CYRABHDZE /g,"\u04e0"],[/\\cyrchar\\cyrabhdze /g,"\u04e1"],[/\\cyrchar\\CYROTLD /g,"\u04e8"],[/\\cyrchar\\cyrotld /g,"\u04e9"],[/\\hspace\{0.6em\}/g,"\u2002"],[/\\hspace\{1em\}/g,"\u2003"],[/\\hspace\{0.33em\}/g,"\u2004"],[/\\hspace\{0.25em\}/g,"\u2005"],[/\\hspace\{0.166em\}/g,"\u2006"],[/\\hphantom\{0\}/g,"\u2007"],[/\\hphantom\{,\}/g,"\u2008"],[/\\hspace\{0.167em\}/g,"\u2009"],[/\\mkern1mu /g,"\u200a"],[/\\textendash /g,"\u2013"],[/\\textemdash /g,"\u2014"],[/\\rule\{1em\}\{1pt\}/g,"\u2015"],[/\\Vert /g,"\u2016"],[/\\Elzreapos /g,"\u201b"],[/\\textquotedblleft /g,"\u201c"],[/\\textquotedblright /g,"\u201d"],[/\\textdagger /g,"\u2020"],[/\\textdaggerdbl /g,"\u2021"],[/\\textbullet /g,"\u2022"],[/\\ldots /g,"\u2026"],[/\\textperthousand /g,"\u2030"],[/\\textpertenthousand /g,"\u2031"],[/\\backprime /g,"\u2035"],[/\\guilsinglleft /g,"\u2039"],[/\\guilsinglright /g,"\u203a"],[/\\mkern4mu /g,"\u205f"],[/\\nolinebreak /g,"\u2060"],[/\\ensuremath\{\\Elzpes\}/g,"\u20a7"],[/\\mbox\{\\texteuro\} /g,"\u20ac"],[/\\dddot /g,"\u20db"],[/\\ddddot /g,"\u20dc"],[/\\mathbb\{C\}/g,"\u2102"],[/\\mathscr\{g\}/g,"\u210a"],[/\\mathscr\{H\}/g,"\u210b"],[/\\mathfrak\{H\}/g,"\u210c"],[/\\mathbb\{H\}/g,"\u210d"],[/\\hslash /g,"\u210f"],[/\\mathscr\{I\}/g,"\u2110"],[/\\mathfrak\{I\}/g,"\u2111"],[/\\mathscr\{L\}/g,"\u2112"],[/\\mathscr\{l\}/g,"\u2113"],[/\\mathbb\{N\}/g,"\u2115"],[/\\cyrchar\\textnumero /g,"\u2116"],[/\\wp /g,"\u2118"],[/\\mathbb\{P\}/g,"\u2119"],[/\\mathbb\{Q\}/g,"\u211a"],[/\\mathscr\{R\}/g,"\u211b"],[/\\mathfrak\{R\}/g,"\u211c"],[/\\mathbb\{R\}/g,"\u211d"],[/\\Elzxrat /g,"\u211e"],[/\\texttrademark /g,"\u2122"],[/\\mathbb\{Z\}/g,"\u2124"],[/\\Omega /g,"\u2126"],[/\\mho /g,"\u2127"],[/\\mathfrak\{Z\}/g,"\u2128"],[/\\ElsevierGlyph\{2129\}/g,"\u2129"],[/\\AA /g,"\u212b"],[/\\mathscr\{B\}/g,"\u212c"],[/\\mathfrak\{C\}/g,"\u212d"],[/\\mathscr\{e\}/g,"\u212f"],[/\\mathscr\{E\}/g,"\u2130"],[/\\mathscr\{F\}/g,"\u2131"],[/\\mathscr\{M\}/g,"\u2133"],[/\\mathscr\{o\}/g,"\u2134"],[/\\aleph /g,"\u2135"],[/\\beth /g,"\u2136"],[/\\gimel /g,"\u2137"],[/\\daleth /g,"\u2138"],[/\\textfrac\{1\}\{3\}/g,"\u2153"],[/\\textfrac\{2\}\{3\}/g,"\u2154"],[/\\textfrac\{1\}\{5\}/g,"\u2155"],[/\\textfrac\{2\}\{5\}/g,"\u2156"],[/\\textfrac\{3\}\{5\}/g,"\u2157"],[/\\textfrac\{4\}\{5\}/g,"\u2158"],[/\\textfrac\{1\}\{6\}/g,"\u2159"],[/\\textfrac\{5\}\{6\}/g,"\u215a"],[/\\textfrac\{1\}\{8\}/g,"\u215b"],[/\\textfrac\{3\}\{8\}/g,"\u215c"],[/\\textfrac\{5\}\{8\}/g,"\u215d"],[/\\textfrac\{7\}\{8\}/g,"\u215e"],[/\\leftarrow /g,"\u2190"],[/\\uparrow /g,"\u2191"],[/\\rightarrow /g,"\u2192"],[/\\downarrow /g,"\u2193"],[/\\leftrightarrow /g,"\u2194"],[/\\updownarrow /g,"\u2195"],[/\\nwarrow /g,"\u2196"],[/\\nearrow /g,"\u2197"],[/\\searrow /g,"\u2198"],[/\\swarrow /g,"\u2199"],[/\\nleftarrow /g,"\u219a"],[/\\nrightarrow /g,"\u219b"],[/\\arrowwaveright /g,"\u219c"],[/\\arrowwaveright /g,"\u219d"],[/\\twoheadleftarrow /g,"\u219e"],[/\\twoheadrightarrow /g,"\u21a0"],[/\\leftarrowtail /g,"\u21a2"],[/\\rightarrowtail /g,"\u21a3"],[/\\mapsto /g,"\u21a6"],[/\\hookleftarrow /g,"\u21a9"],[/\\hookrightarrow /g,"\u21aa"],[/\\looparrowleft /g,"\u21ab"],[/\\looparrowright /g,"\u21ac"],[/\\leftrightsquigarrow /g,"\u21ad"],[/\\nleftrightarrow /g,"\u21ae"],[/\\Lsh /g,"\u21b0"],[/\\Rsh /g,"\u21b1"],[/\\ElsevierGlyph\{21B3\}/g,"\u21b3"],[/\\curvearrowleft /g,"\u21b6"],[/\\curvearrowright /g,"\u21b7"],[/\\circlearrowleft /g,"\u21ba"],[/\\circlearrowright /g,"\u21bb"],[/\\leftharpoonup /g,"\u21bc"],[/\\leftharpoondown /g,"\u21bd"],[/\\upharpoonright /g,"\u21be"],[/\\upharpoonleft /g,"\u21bf"],[/\\rightharpoonup /g,"\u21c0"],[/\\rightharpoondown /g,"\u21c1"],[/\\downharpoonright /g,"\u21c2"],[/\\downharpoonleft /g,"\u21c3"],[/\\rightleftarrows /g,"\u21c4"],[/\\dblarrowupdown /g,"\u21c5"],[/\\leftrightarrows /g,"\u21c6"],[/\\leftleftarrows /g,"\u21c7"],[/\\upuparrows /g,"\u21c8"],[/\\rightrightarrows /g,"\u21c9"],[/\\downdownarrows /g,"\u21ca"],[/\\leftrightharpoons /g,"\u21cb"],[/\\rightleftharpoons /g,"\u21cc"],[/\\nLeftarrow /g,"\u21cd"],[/\\nLeftrightarrow /g,"\u21ce"],[/\\nRightarrow /g,"\u21cf"],[/\\Leftarrow /g,"\u21d0"],[/\\Uparrow /g,"\u21d1"],[/\\Rightarrow /g,"\u21d2"],[/\\Downarrow /g,"\u21d3"],[/\\Leftrightarrow /g,"\u21d4"],[/\\Updownarrow /g,"\u21d5"],[/\\Lleftarrow /g,"\u21da"],[/\\Rrightarrow /g,"\u21db"],[/\\rightsquigarrow /g,"\u21dd"],[/\\DownArrowUpArrow /g,"\u21f5"],[/\\forall /g,"\u2200"],[/\\complement /g,"\u2201"],[/\\partial /g,"\u2202"],[/\\exists /g,"\u2203"],[/\\nexists /g,"\u2204"],[/\\varnothing /g,"\u2205"],[/\\nabla /g,"\u2207"],[/\\in /g,"\u2208"],[/\\not\\in /g,"\u2209"],[/\\ni /g,"\u220b"],[/\\not\\ni /g,"\u220c"],[/\\prod /g,"\u220f"],[/\\coprod /g,"\u2210"],[/\\sum /g,"\u2211"],[/\\mp /g,"\u2213"],[/\\dotplus /g,"\u2214"],[/\\setminus /g,"\u2216"],[/\\circ /g,"\u2218"],[/\\bullet /g,"\u2219"],[/\\surd /g,"\u221a"],[/\\propto /g,"\u221d"],[/\\infty /g,"\u221e"],[/\\rightangle /g,"\u221f"],[/\\angle /g,"\u2220"],[/\\measuredangle /g,"\u2221"],[/\\sphericalangle /g,"\u2222"],[/\\mid /g,"\u2223"],[/\\nmid /g,"\u2224"],[/\\parallel /g,"\u2225"],[/\\nparallel /g,"\u2226"],[/\\wedge /g,"\u2227"],[/\\vee /g,"\u2228"],[/\\cap /g,"\u2229"],[/\\cup /g,"\u222a"],[/\\int /g,"\u222b"],[/\\int\\!\\int /g,"\u222c"],[/\\int\\!\\int\\!\\int /g,"\u222d"],[/\\oint /g,"\u222e"],[/\\surfintegral /g,"\u222f"],[/\\volintegral /g,"\u2230"],[/\\clwintegral /g,"\u2231"],[/\\ElsevierGlyph\{2232\}/g,"\u2232"],[/\\ElsevierGlyph\{2233\}/g,"\u2233"],[/\\therefore /g,"\u2234"],[/\\because /g,"\u2235"],[/\\Colon /g,"\u2237"],[/\\ElsevierGlyph\{2238\}/g,"\u2238"],[/\\mathbin\{\{:\}\\!\\!\{\-\}\\!\\!\{:\}\}/g,"\u223a"],[/\\homothetic /g,"\u223b"],[/\\sim /g,"\u223c"],[/\\backsim /g,"\u223d"],[/\\lazysinv /g,"\u223e"],[/\\wr /g,"\u2240"],[/\\not\\sim /g,"\u2241"],[/\\ElsevierGlyph\{2242\}/g,"\u2242"],[/\\NotEqualTilde /g,"\u2242-00338"],[/\\simeq /g,"\u2243"],[/\\not\\simeq /g,"\u2244"],[/\\cong /g,"\u2245"],[/\\approxnotequal /g,"\u2246"],[/\\not\\cong /g,"\u2247"],[/\\approx /g,"\u2248"],[/\\not\\approx /g,"\u2249"],[/\\approxeq /g,"\u224a"],[/\\tildetrpl /g,"\u224b"],[/\\not\\apid /g,"\u224b-00338"],[/\\allequal /g,"\u224c"],[/\\asymp /g,"\u224d"],[/\\Bumpeq /g,"\u224e"],[/\\NotHumpDownHump /g,"\u224e-00338"],[/\\bumpeq /g,"\u224f"],[/\\NotHumpEqual /g,"\u224f-00338"],[/\\doteq /g,"\u2250"],[/\\not\\doteq/g,"\u2250-00338"],[/\\doteqdot /g,"\u2251"],[/\\fallingdotseq /g,"\u2252"],[/\\risingdotseq /g,"\u2253"],[/\\eqcirc /g,"\u2256"],[/\\circeq /g,"\u2257"],[/\\estimates /g,"\u2259"],[/\\ElsevierGlyph\{225A\}/g,"\u225a"],[/\\starequal /g,"\u225b"],[/\\triangleq /g,"\u225c"],[/\\ElsevierGlyph\{225F\}/g,"\u225f"],[/\\not =/g,"\u2260"],[/\\equiv /g,"\u2261"],[/\\not\\equiv /g,"\u2262"],[/\\leq /g,"\u2264"],[/\\geq /g,"\u2265"],[/\\leqq /g,"\u2266"],[/\\geqq /g,"\u2267"],[/\\lneqq /g,"\u2268"],[/\\lvertneqq /g,"\u2268-0FE00"],[/\\gneqq /g,"\u2269"],[/\\gvertneqq /g,"\u2269-0FE00"],[/\\ll /g,"\u226a"],[/\\NotLessLess /g,"\u226a-00338"],[/\\gg /g,"\u226b"],[/\\NotGreaterGreater /g,"\u226b-00338"],[/\\between /g,"\u226c"],[/\\not\\kern\-0.3em\\times /g,"\u226d"],[/\\not</g,"\u226e"],[/\\not>/g,"\u226f"],[/\\not\\leq /g,"\u2270"],[/\\not\\geq /g,"\u2271"],[/\\lessequivlnt /g,"\u2272"],[/\\greaterequivlnt /g,"\u2273"],[/\\ElsevierGlyph\{2274\}/g,"\u2274"],[/\\ElsevierGlyph\{2275\}/g,"\u2275"],[/\\lessgtr /g,"\u2276"],[/\\gtrless /g,"\u2277"],[/\\notlessgreater /g,"\u2278"],[/\\notgreaterless /g,"\u2279"],[/\\prec /g,"\u227a"],[/\\succ /g,"\u227b"],[/\\preccurlyeq /g,"\u227c"],[/\\succcurlyeq /g,"\u227d"],[/\\precapprox /g,"\u227e"],[/\\NotPrecedesTilde /g,"\u227e-00338"],[/\\succapprox /g,"\u227f"],[/\\NotSucceedsTilde /g,"\u227f-00338"],[/\\not\\prec /g,"\u2280"],[/\\not\\succ /g,"\u2281"],[/\\subset /g,"\u2282"],[/\\supset /g,"\u2283"],[/\\not\\subset /g,"\u2284"],[/\\not\\supset /g,"\u2285"],[/\\subseteq /g,"\u2286"],[/\\supseteq /g,"\u2287"],[/\\not\\subseteq /g,"\u2288"],[/\\not\\supseteq /g,"\u2289"],[/\\subsetneq /g,"\u228a"],[/\\varsubsetneqq /g,"\u228a-0FE00"],[/\\supsetneq /g,"\u228b"],[/\\varsupsetneq /g,"\u228b-0FE00"],[/\\uplus /g,"\u228e"],[/\\sqsubset /g,"\u228f"],[/\\NotSquareSubset /g,"\u228f-00338"],[/\\sqsupset /g,"\u2290"],[/\\NotSquareSuperset /g,"\u2290-00338"],[/\\sqsubseteq /g,"\u2291"],[/\\sqsupseteq /g,"\u2292"],[/\\sqcap /g,"\u2293"],[/\\sqcup /g,"\u2294"],[/\\oplus /g,"\u2295"],[/\\ominus /g,"\u2296"],[/\\otimes /g,"\u2297"],[/\\oslash /g,"\u2298"],[/\\odot /g,"\u2299"],[/\\circledcirc /g,"\u229a"],[/\\circledast /g,"\u229b"],[/\\circleddash /g,"\u229d"],[/\\boxplus /g,"\u229e"],[/\\boxminus /g,"\u229f"],[/\\boxtimes /g,"\u22a0"],[/\\boxdot /g,"\u22a1"],[/\\vdash /g,"\u22a2"],[/\\dashv /g,"\u22a3"],[/\\top /g,"\u22a4"],[/\\perp /g,"\u22a5"],[/\\truestate /g,"\u22a7"],[/\\forcesextra /g,"\u22a8"],[/\\Vdash /g,"\u22a9"],[/\\Vvdash /g,"\u22aa"],[/\\VDash /g,"\u22ab"],[/\\nvdash /g,"\u22ac"],[/\\nvDash /g,"\u22ad"],[/\\nVdash /g,"\u22ae"],[/\\nVDash /g,"\u22af"],[/\\vartriangleleft /g,"\u22b2"],[/\\vartriangleright /g,"\u22b3"],[/\\trianglelefteq /g,"\u22b4"],[/\\trianglerighteq /g,"\u22b5"],[/\\original /g,"\u22b6"],[/\\image /g,"\u22b7"],[/\\multimap /g,"\u22b8"],[/\\hermitconjmatrix /g,"\u22b9"],[/\\intercal /g,"\u22ba"],[/\\veebar /g,"\u22bb"],[/\\rightanglearc /g,"\u22be"],[/\\ElsevierGlyph\{22C0\}/g,"\u22c0"],[/\\ElsevierGlyph\{22C1\}/g,"\u22c1"],[/\\bigcap /g,"\u22c2"],[/\\bigcup /g,"\u22c3"],[/\\diamond /g,"\u22c4"],[/\\cdot /g,"\u22c5"],[/\\star /g,"\u22c6"],[/\\divideontimes /g,"\u22c7"],[/\\bowtie /g,"\u22c8"],[/\\ltimes /g,"\u22c9"],[/\\rtimes /g,"\u22ca"],[/\\leftthreetimes /g,"\u22cb"],[/\\rightthreetimes /g,"\u22cc"],[/\\backsimeq /g,"\u22cd"],[/\\curlyvee /g,"\u22ce"],[/\\curlywedge /g,"\u22cf"],[/\\Subset /g,"\u22d0"],[/\\Supset /g,"\u22d1"],[/\\Cap /g,"\u22d2"],[/\\Cup /g,"\u22d3"],[/\\pitchfork /g,"\u22d4"],[/\\lessdot /g,"\u22d6"],[/\\gtrdot /g,"\u22d7"],[/\\verymuchless /g,"\u22d8"],[/\\verymuchgreater /g,"\u22d9"],[/\\lesseqgtr /g,"\u22da"],[/\\gtreqless /g,"\u22db"],[/\\curlyeqprec /g,"\u22de"],[/\\curlyeqsucc /g,"\u22df"],[/\\not\\sqsubseteq /g,"\u22e2"],[/\\not\\sqsupseteq /g,"\u22e3"],[/\\Elzsqspne /g,"\u22e5"],[/\\lnsim /g,"\u22e6"],[/\\gnsim /g,"\u22e7"],[/\\precedesnotsimilar /g,"\u22e8"],[/\\succnsim /g,"\u22e9"],[/\\ntriangleleft /g,"\u22ea"],[/\\ntriangleright /g,"\u22eb"],[/\\ntrianglelefteq /g,"\u22ec"],[/\\ntrianglerighteq /g,"\u22ed"],[/\\vdots /g,"\u22ee"],[/\\cdots /g,"\u22ef"],[/\\upslopeellipsis /g,"\u22f0"],[/\\downslopeellipsis /g,"\u22f1"],[/\\barwedge /g,"\u2305"],[/\\perspcorrespond /g,"\u2306"],[/\\lceil /g,"\u2308"],[/\\rceil /g,"\u2309"],[/\\lfloor /g,"\u230a"],[/\\rfloor /g,"\u230b"],[/\\recorder /g,"\u2315"],[/\\mathchar"2208/g,"\u2316"],[/\\ulcorner /g,"\u231c"],[/\\urcorner /g,"\u231d"],[/\\llcorner /g,"\u231e"],[/\\lrcorner /g,"\u231f"],[/\\frown /g,"\u2322"],[/\\smile /g,"\u2323"],[/\\langle /g,"\u2329"],[/\\rangle /g,"\u232a"],[/\\ElsevierGlyph\{E838\}/g,"\u233d"],[/\\Elzdlcorn /g,"\u23a3"],[/\\lmoustache /g,"\u23b0"],[/\\rmoustache /g,"\u23b1"],[/\\textvisiblespace /g,"\u2423"],[/\\ding\{172\}/g,"\u2460"],[/\\ding\{173\}/g,"\u2461"],[/\\ding\{174\}/g,"\u2462"],[/\\ding\{175\}/g,"\u2463"],[/\\ding\{176\}/g,"\u2464"],[/\\ding\{177\}/g,"\u2465"],[/\\ding\{178\}/g,"\u2466"],[/\\ding\{179\}/g,"\u2467"],[/\\ding\{180\}/g,"\u2468"],[/\\ding\{181\}/g,"\u2469"],[/\\circledS /g,"\u24c8"],[/\\Elzdshfnc /g,"\u2506"],[/\\Elzsqfnw /g,"\u2519"],[/\\diagup /g,"\u2571"],[/\\ding\{110\}/g,"\u25a0"],[/\\square /g,"\u25a1"],[/\\blacksquare /g,"\u25aa"],[/\\fbox\{~~\}/g,"\u25ad"],[/\\Elzvrecto /g,"\u25af"],[/\\ElsevierGlyph\{E381\}/g,"\u25b1"],[/\\ding\{115\}/g,"\u25b2"],[/\\bigtriangleup /g,"\u25b3"],[/\\blacktriangle /g,"\u25b4"],[/\\vartriangle /g,"\u25b5"],[/\\blacktriangleright /g,"\u25b8"],[/\\triangleright /g,"\u25b9"],[/\\ding\{116\}/g,"\u25bc"],[/\\bigtriangledown /g,"\u25bd"],[/\\blacktriangledown /g,"\u25be"],[/\\triangledown /g,"\u25bf"],[/\\blacktriangleleft /g,"\u25c2"],[/\\triangleleft /g,"\u25c3"],[/\\ding\{117\}/g,"\u25c6"],[/\\lozenge /g,"\u25ca"],[/\\bigcirc /g,"\u25cb"],[/\\ding\{108\}/g,"\u25cf"],[/\\Elzcirfl /g,"\u25d0"],[/\\Elzcirfr /g,"\u25d1"],[/\\Elzcirfb /g,"\u25d2"],[/\\ding\{119\}/g,"\u25d7"],[/\\Elzrvbull /g,"\u25d8"],[/\\Elzsqfl /g,"\u25e7"],[/\\Elzsqfr /g,"\u25e8"],[/\\Elzsqfse /g,"\u25ea"],[/\\bigcirc /g,"\u25ef"],[/\\ding\{72\}/g,"\u2605"],[/\\ding\{73\}/g,"\u2606"],[/\\ding\{37\}/g,"\u260e"],[/\\ding\{42\}/g,"\u261b"],[/\\ding\{43\}/g,"\u261e"],[/\\rightmoon /g,"\u263e"],[/\\mercury /g,"\u263f"],[/\\venus /g,"\u2640"],[/\\male /g,"\u2642"],[/\\jupiter /g,"\u2643"],[/\\saturn /g,"\u2644"],[/\\uranus /g,"\u2645"],[/\\neptune /g,"\u2646"],[/\\pluto /g,"\u2647"],[/\\aries /g,"\u2648"],[/\\taurus /g,"\u2649"],[/\\gemini /g,"\u264a"],[/\\cancer /g,"\u264b"],[/\\leo /g,"\u264c"],[/\\virgo /g,"\u264d"],[/\\libra /g,"\u264e"],[/\\scorpio /g,"\u264f"],[/\\sagittarius /g,"\u2650"],[/\\capricornus /g,"\u2651"],[/\\aquarius /g,"\u2652"],[/\\pisces /g,"\u2653"],[/\\ding\{171\}/g,"\u2660"],[/\\diamond /g,"\u2662"],[/\\ding\{168\}/g,"\u2663"],[/\\ding\{170\}/g,"\u2665"],[/\\ding\{169\}/g,"\u2666"],[/\\quarternote /g,"\u2669"],[/\\eighthnote /g,"\u266a"],[/\\flat /g,"\u266d"],[/\\natural /g,"\u266e"],[/\\sharp /g,"\u266f"],[/\\ding\{33\}/g,"\u2701"],[/\\ding\{34\}/g,"\u2702"],[/\\ding\{35\}/g,"\u2703"],[/\\ding\{36\}/g,"\u2704"],[/\\ding\{38\}/g,"\u2706"],[/\\ding\{39\}/g,"\u2707"],[/\\ding\{40\}/g,"\u2708"],[/\\ding\{41\}/g,"\u2709"],[/\\ding\{44\}/g,"\u270c"],[/\\ding\{45\}/g,"\u270d"],[/\\ding\{46\}/g,"\u270e"],[/\\ding\{47\}/g,"\u270f"],[/\\ding\{48\}/g,"\u2710"],[/\\ding\{49\}/g,"\u2711"],[/\\ding\{50\}/g,"\u2712"],[/\\ding\{51\}/g,"\u2713"],[/\\ding\{52\}/g,"\u2714"],[/\\ding\{53\}/g,"\u2715"],[/\\ding\{54\}/g,"\u2716"],[/\\ding\{55\}/g,"\u2717"],[/\\ding\{56\}/g,"\u2718"],[/\\ding\{57\}/g,"\u2719"],[/\\ding\{58\}/g,"\u271a"],[/\\ding\{59\}/g,"\u271b"],[/\\ding\{60\}/g,"\u271c"],[/\\ding\{61\}/g,"\u271d"],[/\\ding\{62\}/g,"\u271e"],[/\\ding\{63\}/g,"\u271f"],[/\\ding\{64\}/g,"\u2720"],[/\\ding\{65\}/g,"\u2721"],[/\\ding\{66\}/g,"\u2722"],[/\\ding\{67\}/g,"\u2723"],[/\\ding\{68\}/g,"\u2724"],[/\\ding\{69\}/g,"\u2725"],[/\\ding\{70\}/g,"\u2726"],[/\\ding\{71\}/g,"\u2727"],[/\\ding\{73\}/g,"\u2729"],[/\\ding\{74\}/g,"\u272a"],[/\\ding\{75\}/g,"\u272b"],[/\\ding\{76\}/g,"\u272c"],[/\\ding\{77\}/g,"\u272d"],[/\\ding\{78\}/g,"\u272e"],[/\\ding\{79\}/g,"\u272f"],[/\\ding\{80\}/g,"\u2730"],[/\\ding\{81\}/g,"\u2731"],[/\\ding\{82\}/g,"\u2732"],[/\\ding\{83\}/g,"\u2733"],[/\\ding\{84\}/g,"\u2734"],[/\\ding\{85\}/g,"\u2735"],[/\\ding\{86\}/g,"\u2736"],[/\\ding\{87\}/g,"\u2737"],[/\\ding\{88\}/g,"\u2738"],[/\\ding\{89\}/g,"\u2739"],[/\\ding\{90\}/g,"\u273a"],[/\\ding\{91\}/g,"\u273b"],[/\\ding\{92\}/g,"\u273c"],[/\\ding\{93\}/g,"\u273d"],[/\\ding\{94\}/g,"\u273e"],[/\\ding\{95\}/g,"\u273f"],[/\\ding\{96\}/g,"\u2740"],[/\\ding\{97\}/g,"\u2741"],[/\\ding\{98\}/g,"\u2742"],[/\\ding\{99\}/g,"\u2743"],[/\\ding\{100\}/g,"\u2744"],[/\\ding\{101\}/g,"\u2745"],[/\\ding\{102\}/g,"\u2746"],[/\\ding\{103\}/g,"\u2747"],[/\\ding\{104\}/g,"\u2748"],[/\\ding\{105\}/g,"\u2749"],[/\\ding\{106\}/g,"\u274a"],[/\\ding\{107\}/g,"\u274b"],[/\\ding\{109\}/g,"\u274d"],[/\\ding\{111\}/g,"\u274f"],[/\\ding\{112\}/g,"\u2750"],[/\\ding\{113\}/g,"\u2751"],[/\\ding\{114\}/g,"\u2752"],[/\\ding\{118\}/g,"\u2756"],[/\\ding\{120\}/g,"\u2758"],[/\\ding\{121\}/g,"\u2759"],[/\\ding\{122\}/g,"\u275a"],[/\\ding\{123\}/g,"\u275b"],[/\\ding\{124\}/g,"\u275c"],[/\\ding\{125\}/g,"\u275d"],[/\\ding\{126\}/g,"\u275e"],[/\\ding\{161\}/g,"\u2761"],[/\\ding\{162\}/g,"\u2762"],[/\\ding\{163\}/g,"\u2763"],[/\\ding\{164\}/g,"\u2764"],[/\\ding\{165\}/g,"\u2765"],[/\\ding\{166\}/g,"\u2766"],[/\\ding\{167\}/g,"\u2767"],[/\\ding\{182\}/g,"\u2776"],[/\\ding\{183\}/g,"\u2777"],[/\\ding\{184\}/g,"\u2778"],[/\\ding\{185\}/g,"\u2779"],[/\\ding\{186\}/g,"\u277a"],[/\\ding\{187\}/g,"\u277b"],[/\\ding\{188\}/g,"\u277c"],[/\\ding\{189\}/g,"\u277d"],[/\\ding\{190\}/g,"\u277e"],[/\\ding\{191\}/g,"\u277f"],[/\\ding\{192\}/g,"\u2780"],[/\\ding\{193\}/g,"\u2781"],[/\\ding\{194\}/g,"\u2782"],[/\\ding\{195\}/g,"\u2783"],[/\\ding\{196\}/g,"\u2784"],[/\\ding\{197\}/g,"\u2785"],[/\\ding\{198\}/g,"\u2786"],[/\\ding\{199\}/g,"\u2787"],[/\\ding\{200\}/g,"\u2788"],[/\\ding\{201\}/g,"\u2789"],[/\\ding\{202\}/g,"\u278a"],[/\\ding\{203\}/g,"\u278b"],[/\\ding\{204\}/g,"\u278c"],[/\\ding\{205\}/g,"\u278d"],[/\\ding\{206\}/g,"\u278e"],[/\\ding\{207\}/g,"\u278f"],[/\\ding\{208\}/g,"\u2790"],[/\\ding\{209\}/g,"\u2791"],[/\\ding\{210\}/g,"\u2792"],[/\\ding\{211\}/g,"\u2793"],[/\\ding\{212\}/g,"\u2794"],[/\\ding\{216\}/g,"\u2798"],[/\\ding\{217\}/g,"\u2799"],[/\\ding\{218\}/g,"\u279a"],[/\\ding\{219\}/g,"\u279b"],[/\\ding\{220\}/g,"\u279c"],[/\\ding\{221\}/g,"\u279d"],[/\\ding\{222\}/g,"\u279e"],[/\\ding\{223\}/g,"\u279f"],[/\\ding\{224\}/g,"\u27a0"],[/\\ding\{225\}/g,"\u27a1"],[/\\ding\{226\}/g,"\u27a2"],[/\\ding\{227\}/g,"\u27a3"],[/\\ding\{228\}/g,"\u27a4"],[/\\ding\{229\}/g,"\u27a5"],[/\\ding\{230\}/g,"\u27a6"],[/\\ding\{231\}/g,"\u27a7"],[/\\ding\{232\}/g,"\u27a8"],[/\\ding\{233\}/g,"\u27a9"],[/\\ding\{234\}/g,"\u27aa"],[/\\ding\{235\}/g,"\u27ab"],[/\\ding\{236\}/g,"\u27ac"],[/\\ding\{237\}/g,"\u27ad"],[/\\ding\{238\}/g,"\u27ae"],[/\\ding\{239\}/g,"\u27af"],[/\\ding\{241\}/g,"\u27b1"],[/\\ding\{242\}/g,"\u27b2"],[/\\ding\{243\}/g,"\u27b3"],[/\\ding\{244\}/g,"\u27b4"],[/\\ding\{245\}/g,"\u27b5"],[/\\ding\{246\}/g,"\u27b6"],[/\\ding\{247\}/g,"\u27b7"],[/\\ding\{248\}/g,"\u27b8"],[/\\ding\{249\}/g,"\u27b9"],[/\\ding\{250\}/g,"\u27ba"],[/\\ding\{251\}/g,"\u27bb"],[/\\ding\{252\}/g,"\u27bc"],[/\\ding\{253\}/g,"\u27bd"],[/\\ding\{254\}/g,"\u27be"],[/\\longleftarrow /g,"\u27f5"],[/\\longrightarrow /g,"\u27f6"],[/\\longleftrightarrow /g,"\u27f7"],[/\\Longleftarrow /g,"\u27f8"],[/\\Longrightarrow /g,"\u27f9"],[/\\Longleftrightarrow /g,"\u27fa"],[/\\longmapsto /g,"\u27fc"],[/\\sim\\joinrel\\leadsto/g,"\u27ff"],[/\\ElsevierGlyph\{E212\}/g,"\u2905"],[/\\UpArrowBar /g,"\u2912"],[/\\DownArrowBar /g,"\u2913"],[/\\ElsevierGlyph\{E20C\}/g,"\u2923"],[/\\ElsevierGlyph\{E20D\}/g,"\u2924"],[/\\ElsevierGlyph\{E20B\}/g,"\u2925"],[/\\ElsevierGlyph\{E20A\}/g,"\u2926"],[/\\ElsevierGlyph\{E211\}/g,"\u2927"],[/\\ElsevierGlyph\{E20E\}/g,"\u2928"],[/\\ElsevierGlyph\{E20F\}/g,"\u2929"],[/\\ElsevierGlyph\{E210\}/g,"\u292a"],[/\\ElsevierGlyph\{E21C\}/g,"\u2933"],[/\\ElsevierGlyph\{E21D\}/g,"\u2933-00338"],[/\\ElsevierGlyph\{E21A\}/g,"\u2936"],[/\\ElsevierGlyph\{E219\}/g,"\u2937"],[/\\Elolarr /g,"\u2940"],[/\\Elorarr /g,"\u2941"],[/\\ElzRlarr /g,"\u2942"],[/\\ElzrLarr /g,"\u2944"],[/\\Elzrarrx /g,"\u2947"],[/\\LeftRightVector /g,"\u294e"],[/\\RightUpDownVector /g,"\u294f"],[/\\DownLeftRightVector /g,"\u2950"],[/\\LeftUpDownVector /g,"\u2951"],[/\\LeftVectorBar /g,"\u2952"],[/\\RightVectorBar /g,"\u2953"],[/\\RightUpVectorBar /g,"\u2954"],[/\\RightDownVectorBar /g,"\u2955"],[/\\DownLeftVectorBar /g,"\u2956"],[/\\DownRightVectorBar /g,"\u2957"],[/\\LeftUpVectorBar /g,"\u2958"],[/\\LeftDownVectorBar /g,"\u2959"],[/\\LeftTeeVector /g,"\u295a"],[/\\RightTeeVector /g,"\u295b"],[/\\RightUpTeeVector /g,"\u295c"],[/\\RightDownTeeVector /g,"\u295d"],[/\\DownLeftTeeVector /g,"\u295e"],[/\\DownRightTeeVector /g,"\u295f"],[/\\LeftUpTeeVector /g,"\u2960"],[/\\LeftDownTeeVector /g,"\u2961"],[/\\UpEquilibrium /g,"\u296e"],[/\\ReverseUpEquilibrium /g,"\u296f"],[/\\RoundImplies /g,"\u2970"],[/\\ElsevierGlyph\{E214\}/g,"\u297c"],[/\\ElsevierGlyph\{E215\}/g,"\u297d"],[/\\Elztfnc /g,"\u2980"],[/\\ElsevierGlyph\{3018\}/g,"\u2985"],[/\\Elroang /g,"\u2986"],[/\\ElsevierGlyph\{E291\}/g,"\u2994"],[/\\Elzddfnc /g,"\u2999"],[/\\Angle /g,"\u299c"],[/\\Elzlpargt /g,"\u29a0"],[/\\ElsevierGlyph\{E260\}/g,"\u29b5"],[/\\ElsevierGlyph\{E61B\}/g,"\u29b6"],[/\\ElzLap /g,"\u29ca"],[/\\Elzdefas /g,"\u29cb"],[/\\LeftTriangleBar /g,"\u29cf"],[/\\NotLeftTriangleBar /g,"\u29cf-00338"],[/\\RightTriangleBar /g,"\u29d0"],[/\\NotRightTriangleBar /g,"\u29d0-00338"],[/\\ElsevierGlyph\{E372\}/g,"\u29dc"],[/\\blacklozenge /g,"\u29eb"],[/\\RuleDelayed /g,"\u29f4"],[/\\Elxuplus /g,"\u2a04"],[/\\ElzThr /g,"\u2a05"],[/\\Elxsqcup /g,"\u2a06"],[/\\ElzInf /g,"\u2a07"],[/\\ElzSup /g,"\u2a08"],[/\\ElzCint /g,"\u2a0d"],[/\\clockoint /g,"\u2a0f"],[/\\ElsevierGlyph\{E395\}/g,"\u2a10"],[/\\sqrint /g,"\u2a16"],[/\\ElsevierGlyph\{E25A\}/g,"\u2a25"],[/\\ElsevierGlyph\{E25B\}/g,"\u2a2a"],[/\\ElsevierGlyph\{E25C\}/g,"\u2a2d"],[/\\ElsevierGlyph\{E25D\}/g,"\u2a2e"],[/\\ElzTimes /g,"\u2a2f"],[/\\ElsevierGlyph\{E25E\}/g,"\u2a34"],[/\\ElsevierGlyph\{E25E\}/g,"\u2a35"],[/\\ElsevierGlyph\{E259\}/g,"\u2a3c"],[/\\amalg /g,"\u2a3f"],[/\\ElzAnd /g,"\u2a53"],[/\\ElzOr /g,"\u2a54"],[/\\ElsevierGlyph\{E36E\}/g,"\u2a55"],[/\\ElOr /g,"\u2a56"],[/\\perspcorrespond /g,"\u2a5e"],[/\\Elzminhat /g,"\u2a5f"],[/\\ElsevierGlyph\{225A\}/g,"\u2a63"],[/\\stackrel\{*\}\{=\}/g,"\u2a6e"],[/\\Equal /g,"\u2a75"],[/\\leqslant /g,"\u2a7d"],[/\\nleqslant /g,"\u2a7d-00338"],[/\\geqslant /g,"\u2a7e"],[/\\ngeqslant /g,"\u2a7e-00338"],[/\\lessapprox /g,"\u2a85"],[/\\gtrapprox /g,"\u2a86"],[/\\lneq /g,"\u2a87"],[/\\gneq /g,"\u2a88"],[/\\lnapprox /g,"\u2a89"],[/\\gnapprox /g,"\u2a8a"],[/\\lesseqqgtr /g,"\u2a8b"],[/\\gtreqqless /g,"\u2a8c"],[/\\eqslantless /g,"\u2a95"],[/\\eqslantgtr /g,"\u2a96"],[/\\Pisymbol\{ppi020\}\{117\}/g,"\u2a9d"],[/\\Pisymbol\{ppi020\}\{105\}/g,"\u2a9e"],[/\\NestedLessLess /g,"\u2aa1"],[/\\NotNestedLessLess /g,"\u2aa1-00338"],[/\\NestedGreaterGreater /g,"\u2aa2"],[/\\NotNestedGreaterGreater /g,"\u2aa2-00338"],[/\\preceq /g,"\u2aaf"],[/\\not\\preceq /g,"\u2aaf-00338"],[/\\succeq /g,"\u2ab0"],[/\\not\\succeq /g,"\u2ab0-00338"],[/\\precneqq /g,"\u2ab5"],[/\\succneqq /g,"\u2ab6"],[/\\precapprox /g,"\u2ab7"],[/\\succapprox /g,"\u2ab8"],[/\\precnapprox /g,"\u2ab9"],[/\\succnapprox /g,"\u2aba"],[/\\subseteqq /g,"\u2ac5"],[/\\nsubseteqq /g,"\u2ac5-00338"],[/\\supseteqq /g,"\u2ac6"],[/\\nsupseteqq/g,"\u2ac6-00338"],[/\\subsetneqq /g,"\u2acb"],[/\\supsetneqq /g,"\u2acc"],[/\\ElsevierGlyph\{E30D\}/g,"\u2aeb"],[/\\Elztdcol /g,"\u2af6"],[/\\ElsevierGlyph\{300A\}/g,"\u300a"],[/\\ElsevierGlyph\{300B\}/g,"\u300b"],[/\\ElsevierGlyph\{3018\}/g,"\u3018"],[/\\ElsevierGlyph\{3019\}/g,"\u3019"],[/\\openbracketleft /g,"\u301a"],[/\\openbracketright /g,"\u301b"]],
this):{entries:[],errors:["Passed wrong argument in call to parser"+e]}}function updateMenuShareIcon(e){var t=$("#share_menu").find(".wl-icon");e.hasClass("protect")?t.removeClass("wl-icon-share").addClass("wl-icon-share-protected"):t.removeClass("wl-icon-share-protected").addClass("wl-icon-share")}!function(e){function t(e,t){var n=typeof e[t];return"function"===n||!("object"!=n||!e[t])||"unknown"==n}function n(e,t){return typeof e[t]!=v}function i(e,t){return!("object"!=typeof e[t]||!e[t])}function r(e){window.console&&window.console.log&&window.console.log("RangyInputs not supported in your browser. Reason: "+e)}function o(e,t,n){return 0>t&&(t+=e.value.length),typeof n==v&&(n=t),0>n&&(n+=e.value.length),{start:t,end:n}}function a(e,t,n){return{start:t,end:n,length:n-t,text:e.value.slice(t,n)}}function s(){return i(document,"body")?document.body:document.getElementsByTagName("body")[0]}var l,c,u,h,d,f,p,g,m,v="undefined";e(document).ready(function(){function y(e,t){return function(){var n=this.jquery?this[0]:this,i=n.nodeName.toLowerCase();if(1==n.nodeType&&("textarea"==i||"input"==i&&"text"==n.type)){var r=[n].concat(Array.prototype.slice.call(arguments)),o=e.apply(this,r);if(!t)return o}return t?this:void 0}}var b=document.createElement("textarea");if(s().appendChild(b),n(b,"selectionStart")&&n(b,"selectionEnd"))l=function(e){var t=e.selectionStart,n=e.selectionEnd;return a(e,t,n)},c=function(e,t,n){var i=o(e,t,n);e.selectionStart=i.start,e.selectionEnd=i.end},m=function(e,t){t?e.selectionEnd=e.selectionStart:e.selectionStart=e.selectionEnd};else{if(!(t(b,"createTextRange")&&i(document,"selection")&&t(document.selection,"createRange")))return s().removeChild(b),void r("No means of finding text input caret position");l=function(e){var t,n,i,r,o=0,s=0,l=document.selection.createRange();return l&&l.parentElement()==e&&(i=e.value.length,t=e.value.replace(/\r\n/g,"\n"),n=e.createTextRange(),n.moveToBookmark(l.getBookmark()),r=e.createTextRange(),r.collapse(!1),n.compareEndPoints("StartToEnd",r)>-1?o=s=i:(o=-n.moveStart("character",-i),o+=t.slice(0,o).split("\n").length-1,n.compareEndPoints("EndToEnd",r)>-1?s=i:(s=-n.moveEnd("character",-i),s+=t.slice(0,s).split("\n").length-1))),a(e,o,s)};var w=function(e,t){return t-(e.value.slice(0,t).split("\r\n").length-1)};c=function(e,t,n){var i=o(e,t,n),r=e.createTextRange(),a=w(e,i.start);r.collapse(!0),i.start==i.end?r.move("character",a):(r.moveEnd("character",w(e,i.end)),r.moveStart("character",a)),r.select()},m=function(e,t){var n=document.selection.createRange();n.collapse(t),n.select()}}s().removeChild(b),h=function(e,t,n,i){var r;t!=n&&(r=e.value,e.value=r.slice(0,t)+r.slice(n)),i&&c(e,t,t)},u=function(e){var t=l(e);h(e,t.start,t.end,!0)},g=function(e){var t,n=l(e);return n.start!=n.end&&(t=e.value,e.value=t.slice(0,n.start)+t.slice(n.end)),c(e,n.start,n.start),n.text};var C=function(e,t,n,i){var r=t+n.length;if(i="string"==typeof i?i.toLowerCase():"",("collapsetoend"==i||"select"==i)&&/[\r\n]/.test(n)){var o=n.replace(/\r\n/g,"\n").replace(/\r/g,"\n");r=t+o.length;var a=t+o.indexOf("\n");"\r\n"==e.value.slice(a,a+2)&&(r+=o.match(/\n/g).length)}switch(i){case"collapsetostart":c(e,t,t);break;case"collapsetoend":c(e,r,r);break;case"select":c(e,t,r)}};d=function(e,t,n,i){var r=e.value;e.value=r.slice(0,n)+t+r.slice(n),"boolean"==typeof i&&(i=i?"collapseToEnd":""),C(e,n,t,i)},f=function(e,t,n){var i=l(e),r=e.value;e.value=r.slice(0,i.start)+t+r.slice(i.end),C(e,i.start,t,n||"collapseToEnd")},p=function(e,t,n,i){typeof n==v&&(n=t);var r=l(e),o=e.value;e.value=o.slice(0,r.start)+t+r.text+n+o.slice(r.end);var a=r.start+t.length;C(e,a,r.text,i||"select")},e.fn.extend({getSelection:y(l,!1),setSelection:y(c,!0),collapseSelection:y(m,!0),deleteSelectedText:y(u,!0),deleteText:y(h,!0),extractSelectedText:y(g,!1),insertText:y(d,!0),replaceSelectedText:y(f,!0),surroundSelectedText:y(p,!0)})})}(jQuery),function(e){if(!e.support.cors&&e.ajaxTransport&&window.XDomainRequest){var t=/^https?:\/\//i,n=/^get|post$/i,i=new RegExp("^"+location.protocol,"i"),r=/text\/html/i,o=/\/json/i,a=/\/xml/i;e.ajaxTransport("* text html xml json",function(s,l){if(s.crossDomain&&s.async&&n.test(s.type)&&t.test(s.url)&&i.test(s.url)){var c=null,u=(l.dataType||"").toLowerCase();return{send:function(t,n){c=new XDomainRequest,/^\d+$/.test(l.timeout)&&(c.timeout=l.timeout),c.ontimeout=function(){n(500,"timeout")},c.onload=function(){var t="Content-Length: "+c.responseText.length+"\r\nContent-Type: "+c.contentType,i={code:200,message:"success"},s={text:c.responseText};try{if("html"===u||r.test(c.contentType))s.html=c.responseText;else if("json"===u||"text"!==u&&o.test(c.contentType))try{s.json=e.parseJSON(c.responseText)}catch(l){i.code=500,i.message="parseerror"}else if("xml"===u||"text"!==u&&a.test(c.contentType)){var h=new ActiveXObject("Microsoft.XMLDOM");h.async=!1;try{h.loadXML(c.responseText)}catch(l){h=void 0}if(!h||!h.documentElement||h.getElementsByTagName("parsererror").length)throw i.code=500,i.message="parseerror","Invalid XML: "+c.responseText;s.xml=h}}catch(d){throw d}finally{n(i.code,i.message,s,t)}},c.onprogress=function(){},c.onerror=function(){n(500,"error",{text:c.responseText})};var i="";l.data&&(i="string"===e.type(l.data)?l.data:e.param(l.data)),c.open(s.type,s.url),c.send(i)},abort:function(){c&&c.abort()}}}})}}(jQuery),function(e){function t(e){var t=new Image;return t.src=e,t}return"naturalWidth"in new Image?(e.fn.naturalWidth=function(){return this[0].naturalWidth},void(e.fn.naturalHeight=function(){return this[0].naturalHeight})):(e.fn.naturalWidth=function(){return t(this[0].src).width},void(e.fn.naturalHeight=function(){return t(this[0].src).height}))}(jQuery),/*! jQuery UI - v1.11.3 - 2015-03-11
* http://jqueryui.com
* Includes: core.js, widget.js, mouse.js, draggable.js, droppable.js
* Copyright 2015 jQuery Foundation and other contributors; Licensed MIT */
function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function(e){function t(t,i){var r,o,a,s=t.nodeName.toLowerCase();return"area"===s?(r=t.parentNode,o=r.name,t.href&&o&&"map"===r.nodeName.toLowerCase()?(a=e("img[usemap='#"+o+"']")[0],!!a&&n(a)):!1):(/^(input|select|textarea|button|object)$/.test(s)?!t.disabled:"a"===s?t.href||i:i)&&n(t)}function n(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}/*!
 * jQuery UI Core 1.11.3
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/category/ui-core/
 */
e.ui=e.ui||{},e.extend(e.ui,{version:"1.11.3",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({scrollParent:function(t){var n=this.css("position"),i="absolute"===n,r=t?/(auto|scroll|hidden)/:/(auto|scroll)/,o=this.parents().filter(function(){var t=e(this);return i&&"static"===t.css("position")?!1:r.test(t.css("overflow")+t.css("overflow-y")+t.css("overflow-x"))}).eq(0);return"fixed"!==n&&o.length?o:e(this[0].ownerDocument||document)},uniqueId:function(){var e=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(n){return!!e.data(n,t)}}):function(t,n,i){return!!e.data(t,i[3])},focusable:function(n){return t(n,!isNaN(e.attr(n,"tabindex")))},tabbable:function(n){var i=e.attr(n,"tabindex"),r=isNaN(i);return(r||i>=0)&&t(n,!r)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(t,n){function i(t,n,i,o){return e.each(r,function(){n-=parseFloat(e.css(t,"padding"+this))||0,i&&(n-=parseFloat(e.css(t,"border"+this+"Width"))||0),o&&(n-=parseFloat(e.css(t,"margin"+this))||0)}),n}var r="Width"===n?["Left","Right"]:["Top","Bottom"],o=n.toLowerCase(),a={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+n]=function(t){return void 0===t?a["inner"+n].call(this):this.each(function(){e(this).css(o,i(this,t)+"px")})},e.fn["outer"+n]=function(t,r){return"number"!=typeof t?a["outer"+n].call(this,t):this.each(function(){e(this).css(o,i(this,t,!0,r)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(n){return arguments.length?t.call(this,e.camelCase(n)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.fn.extend({focus:function(t){return function(n,i){return"number"==typeof n?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),i&&i.call(t)},n)}):t.apply(this,arguments)}}(e.fn.focus),disableSelection:function(){var e="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(e+".ui-disableSelection",function(e){e.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(t){if(void 0!==t)return this.css("zIndex",t);if(this.length)for(var n,i,r=e(this[0]);r.length&&r[0]!==document;){if(n=r.css("position"),("absolute"===n||"relative"===n||"fixed"===n)&&(i=parseInt(r.css("zIndex"),10),!isNaN(i)&&0!==i))return i;r=r.parent()}return 0}}),e.ui.plugin={add:function(t,n,i){var r,o=e.ui[t].prototype;for(r in i)o.plugins[r]=o.plugins[r]||[],o.plugins[r].push([n,i[r]])},call:function(e,t,n,i){var r,o=e.plugins[t];if(o&&(i||e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType))for(r=0;r<o.length;r++)e.options[o[r][0]]&&o[r][1].apply(e.element,n)}};/*!
 * jQuery UI Widget 1.11.3
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/jQuery.widget/
 */
var i=0,r=Array.prototype.slice;e.cleanData=function(t){return function(n){var i,r,o;for(o=0;null!=(r=n[o]);o++)try{i=e._data(r,"events"),i&&i.remove&&e(r).triggerHandler("remove")}catch(a){}t(n)}}(e.cleanData),e.widget=function(t,n,i){var r,o,a,s,l={},c=t.split(".")[0];return t=t.split(".")[1],r=c+"-"+t,i||(i=n,n=e.Widget),e.expr[":"][r.toLowerCase()]=function(t){return!!e.data(t,r)},e[c]=e[c]||{},o=e[c][t],a=e[c][t]=function(e,t){return this._createWidget?void(arguments.length&&this._createWidget(e,t)):new a(e,t)},e.extend(a,o,{version:i.version,_proto:e.extend({},i),_childConstructors:[]}),s=new n,s.options=e.widget.extend({},s.options),e.each(i,function(t,i){return e.isFunction(i)?void(l[t]=function(){var e=function(){return n.prototype[t].apply(this,arguments)},r=function(e){return n.prototype[t].apply(this,e)};return function(){var t,n=this._super,o=this._superApply;return this._super=e,this._superApply=r,t=i.apply(this,arguments),this._super=n,this._superApply=o,t}}()):void(l[t]=i)}),a.prototype=e.widget.extend(s,{widgetEventPrefix:o?s.widgetEventPrefix||t:t},l,{constructor:a,namespace:c,widgetName:t,widgetFullName:r}),o?(e.each(o._childConstructors,function(t,n){var i=n.prototype;e.widget(i.namespace+"."+i.widgetName,a,n._proto)}),delete o._childConstructors):n._childConstructors.push(a),e.widget.bridge(t,a),a},e.widget.extend=function(t){for(var n,i,o=r.call(arguments,1),a=0,s=o.length;s>a;a++)for(n in o[a])i=o[a][n],o[a].hasOwnProperty(n)&&void 0!==i&&(e.isPlainObject(i)?t[n]=e.isPlainObject(t[n])?e.widget.extend({},t[n],i):e.widget.extend({},i):t[n]=i);return t},e.widget.bridge=function(t,n){var i=n.prototype.widgetFullName||t;e.fn[t]=function(o){var a="string"==typeof o,s=r.call(arguments,1),l=this;return a?this.each(function(){var n,r=e.data(this,i);return"instance"===o?(l=r,!1):r?e.isFunction(r[o])&&"_"!==o.charAt(0)?(n=r[o].apply(r,s),n!==r&&void 0!==n?(l=n&&n.jquery?l.pushStack(n.get()):n,!1):void 0):e.error("no such method '"+o+"' for "+t+" widget instance"):e.error("cannot call methods on "+t+" prior to initialization; attempted to call method '"+o+"'")}):(s.length&&(o=e.widget.extend.apply(null,[o].concat(s))),this.each(function(){var t=e.data(this,i);t?(t.option(o||{}),t._init&&t._init()):e.data(this,i,new n(o,this))})),l}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,n){n=e(n||this.defaultElement||this)[0],this.element=e(n),this.uuid=i++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=e(),this.hoverable=e(),this.focusable=e(),n!==this&&(e.data(n,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===n&&this.destroy()}}),this.document=e(n.style?n.ownerDocument:n.document||n),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(t,n){var i,r,o,a=t;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof t)if(a={},i=t.split("."),t=i.shift(),i.length){for(r=a[t]=e.widget.extend({},this.options[t]),o=0;o<i.length-1;o++)r[i[o]]=r[i[o]]||{},r=r[i[o]];if(t=i.pop(),1===arguments.length)return void 0===r[t]?null:r[t];r[t]=n}else{if(1===arguments.length)return void 0===this.options[t]?null:this.options[t];a[t]=n}return this._setOptions(a),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!t),t&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(t,n,i){var r,o=this;"boolean"!=typeof t&&(i=n,n=t,t=!1),i?(n=r=e(n),this.bindings=this.bindings.add(n)):(i=n,n=this.element,r=this.widget()),e.each(i,function(i,a){function s(){return t||o.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled")?("string"==typeof a?o[a]:a).apply(o,arguments):void 0}"string"!=typeof a&&(s.guid=a.guid=a.guid||s.guid||e.guid++);var l=i.match(/^([\w:-]*)\s*(.*)$/),c=l[1]+o.eventNamespace,u=l[2];u?r.delegate(u,c,s):n.bind(c,s)})},_off:function(t,n){n=(n||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.unbind(n).undelegate(n),this.bindings=e(this.bindings.not(t).get()),this.focusable=e(this.focusable.not(t).get()),this.hoverable=e(this.hoverable.not(t).get())},_delay:function(e,t){function n(){return("string"==typeof e?i[e]:e).apply(i,arguments)}var i=this;return setTimeout(n,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,n,i){var r,o,a=this.options[t];if(i=i||{},n=e.Event(n),n.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),n.target=this.element[0],o=n.originalEvent)for(r in o)r in n||(n[r]=o[r]);return this.element.trigger(n,i),!(e.isFunction(a)&&a.apply(this.element[0],[n].concat(i))===!1||n.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,n){e.Widget.prototype["_"+t]=function(i,r,o){"string"==typeof r&&(r={effect:r});var a,s=r?r===!0||"number"==typeof r?n:r.effect||n:t;r=r||{},"number"==typeof r&&(r={duration:r}),a=!e.isEmptyObject(r),r.complete=o,r.delay&&i.delay(r.delay),a&&e.effects&&e.effects.effect[s]?i[t](r):s!==t&&i[s]?i[s](r.duration,r.easing,o):i.queue(function(n){e(this)[t](),o&&o.call(i[0]),n()})}});var o=(e.widget,!1);e(document).mouseup(function(){o=!1});e.widget("ui.mouse",{version:"1.11.3",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(n){return!0===e.data(n.target,t.widgetName+".preventClickEvent")?(e.removeData(n.target,t.widgetName+".preventClickEvent"),n.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(t){if(!o){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(t),this._mouseDownEvent=t;var n=this,i=1===t.which,r="string"==typeof this.options.cancel&&t.target.nodeName?e(t.target).closest(this.options.cancel).length:!1;return i&&!r&&this._mouseCapture(t)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){n.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(t)!==!1,!this._mouseStarted)?(t.preventDefault(),!0):(!0===e.data(t.target,this.widgetName+".preventClickEvent")&&e.removeData(t.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return n._mouseMove(e)},this._mouseUpDelegate=function(e){return n._mouseUp(e)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),t.preventDefault(),o=!0,!0)):!0}},_mouseMove:function(t){if(this._mouseMoved){if(e.ui.ie&&(!document.documentMode||document.documentMode<9)&&!t.button)return this._mouseUp(t);if(!t.which)return this._mouseUp(t)}return(t.which||t.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(t){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),o=!1,!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}});/*!
 * jQuery UI Draggable 1.11.3
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/draggable/
 */
e.widget("ui.draggable",e.ui.mouse,{version:"1.11.3",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._setHandleClassName(),this._mouseInit()},_setOption:function(e,t){this._super(e,t),"handle"===e&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){return(this.helper||this.element).is(".ui-draggable-dragging")?void(this.destroyOnClear=!0):(this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._removeHandleClassName(),void this._mouseDestroy())},_mouseCapture:function(t){var n=this.options;return this._blurActiveElement(t),this.helper||n.disabled||e(t.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(t),this.handle?(this._blockFrames(n.iframeFix===!0?"iframe":n.iframeFix),!0):!1)},_blockFrames:function(t){this.iframeBlocks=this.document.find(t).map(function(){var t=e(this);return e("<div>").css("position","absolute").appendTo(t.parent()).outerWidth(t.outerWidth()).outerHeight(t.outerHeight()).offset(t.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(t){var n=this.document[0];if(this.handleElement.is(t.target))try{n.activeElement&&"body"!==n.activeElement.nodeName.toLowerCase()&&e(n.activeElement).blur()}catch(i){}},_mouseStart:function(t){var n=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter(function(){return"fixed"===e(this).css("position")}).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(t),this.originalPosition=this.position=this._generatePosition(t,!1),this.originalPageX=t.pageX,this.originalPageY=t.pageY,n.cursorAt&&this._adjustOffsetFromHelper(n.cursorAt),this._setContainment(),this._trigger("start",t)===!1?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._normalizeRightBottom(),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_refreshOffsets:function(e){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:e.pageX-this.offset.left,top:e.pageY-this.offset.top}},_mouseDrag:function(t,n){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t,!0),this.positionAbs=this._convertPositionTo("absolute"),!n){var i=this._uiHash();if(this._trigger("drag",t,i)===!1)return this._mouseUp({}),!1;this.position=i.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var n=this,i=!1;return e.ui.ddmanager&&!this.options.dropBehaviour&&(i=e.ui.ddmanager.drop(this,t)),this.dropped&&(i=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!i||"valid"===this.options.revert&&i||this.options.revert===!0||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,i)?e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){n._trigger("stop",t)!==!1&&n._clear()}):this._trigger("stop",t)!==!1&&this._clear(),!1},_mouseUp:function(t){return this._unblockFrames(),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),this.handleElement.is(t.target)&&this.element.focus(),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){return this.options.handle?!!e(t.target).closest(this.element.find(this.options.handle)).length:!0},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this.handleElement.addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle")},_createHelper:function(t){var n=this.options,i=e.isFunction(n.helper),r=i?e(n.helper.apply(this.element[0],[t])):"clone"===n.helper?this.element.clone().removeAttr("id"):this.element;return r.parents("body").length||r.appendTo("parent"===n.appendTo?this.element[0].parentNode:n.appendTo),i&&r[0]===this.element[0]&&this._setPositionRelative(),r[0]===this.element[0]||/(fixed|absolute)/.test(r.css("position"))||r.css("position","absolute"),r},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_isRootNode:function(e){return/(html|body)/i.test(e.tagName)||e===this.document[0]},_getParentOffset:function(){var t=this.offsetParent.offset(),n=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==n&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var e=this.element.position(),t=this._isRootNode(this.scrollParent[0]);return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+(t?0:this.scrollParent.scrollTop()),left:e.left-(parseInt(this.helper.css("left"),10)||0)+(t?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,n,i,r=this.options,o=this.document[0];return this.relativeContainer=null,r.containment?"window"===r.containment?void(this.containment=[e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,e(window).scrollLeft()+e(window).width()-this.helperProportions.width-this.margins.left,e(window).scrollTop()+(e(window).height()||o.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===r.containment?void(this.containment=[0,0,e(o).width()-this.helperProportions.width-this.margins.left,(e(o).height()||o.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):r.containment.constructor===Array?void(this.containment=r.containment):("parent"===r.containment&&(r.containment=this.helper[0].parentNode),n=e(r.containment),i=n[0],void(i&&(t=/(scroll|auto)/.test(n.css("overflow")),this.containment=[(parseInt(n.css("borderLeftWidth"),10)||0)+(parseInt(n.css("paddingLeft"),10)||0),(parseInt(n.css("borderTopWidth"),10)||0)+(parseInt(n.css("paddingTop"),10)||0),(t?Math.max(i.scrollWidth,i.offsetWidth):i.offsetWidth)-(parseInt(n.css("borderRightWidth"),10)||0)-(parseInt(n.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(i.scrollHeight,i.offsetHeight):i.offsetHeight)-(parseInt(n.css("borderBottomWidth"),10)||0)-(parseInt(n.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=n))):void(this.containment=null)},_convertPositionTo:function(e,t){t||(t=this.position);var n="absolute"===e?1:-1,i=this._isRootNode(this.scrollParent[0]);return{top:t.top+this.offset.relative.top*n+this.offset.parent.top*n-("fixed"===this.cssPosition?-this.offset.scroll.top:i?0:this.offset.scroll.top)*n,left:t.left+this.offset.relative.left*n+this.offset.parent.left*n-("fixed"===this.cssPosition?-this.offset.scroll.left:i?0:this.offset.scroll.left)*n}},_generatePosition:function(e,t){var n,i,r,o,a=this.options,s=this._isRootNode(this.scrollParent[0]),l=e.pageX,c=e.pageY;return s&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),t&&(this.containment&&(this.relativeContainer?(i=this.relativeContainer.offset(),n=[this.containment[0]+i.left,this.containment[1]+i.top,this.containment[2]+i.left,this.containment[3]+i.top]):n=this.containment,e.pageX-this.offset.click.left<n[0]&&(l=n[0]+this.offset.click.left),e.pageY-this.offset.click.top<n[1]&&(c=n[1]+this.offset.click.top),e.pageX-this.offset.click.left>n[2]&&(l=n[2]+this.offset.click.left),e.pageY-this.offset.click.top>n[3]&&(c=n[3]+this.offset.click.top)),a.grid&&(r=a.grid[1]?this.originalPageY+Math.round((c-this.originalPageY)/a.grid[1])*a.grid[1]:this.originalPageY,c=n?r-this.offset.click.top>=n[1]||r-this.offset.click.top>n[3]?r:r-this.offset.click.top>=n[1]?r-a.grid[1]:r+a.grid[1]:r,o=a.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/a.grid[0])*a.grid[0]:this.originalPageX,l=n?o-this.offset.click.left>=n[0]||o-this.offset.click.left>n[2]?o:o-this.offset.click.left>=n[0]?o-a.grid[0]:o+a.grid[0]:o),"y"===a.axis&&(l=this.originalPageX),"x"===a.axis&&(c=this.originalPageY)),{top:c-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:s?0:this.offset.scroll.top),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:s?0:this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_normalizeRightBottom:function(){"y"!==this.options.axis&&"auto"!==this.helper.css("right")&&(this.helper.width(this.helper.width()),this.helper.css("right","auto")),"x"!==this.options.axis&&"auto"!==this.helper.css("bottom")&&(this.helper.height(this.helper.height()),this.helper.css("bottom","auto"))},_trigger:function(t,n,i){return i=i||this._uiHash(),e.ui.plugin.call(this,t,[n,i,this],!0),/^(drag|start|stop)/.test(t)&&(this.positionAbs=this._convertPositionTo("absolute"),i.offset=this.positionAbs),e.Widget.prototype._trigger.call(this,t,n,i)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,n,i){var r=e.extend({},n,{item:i.element});i.sortables=[],e(i.options.connectToSortable).each(function(){var n=e(this).sortable("instance");n&&!n.options.disabled&&(i.sortables.push(n),n.refreshPositions(),n._trigger("activate",t,r))})},stop:function(t,n,i){var r=e.extend({},n,{item:i.element});i.cancelHelperRemoval=!1,e.each(i.sortables,function(){var e=this;e.isOver?(e.isOver=0,i.cancelHelperRemoval=!0,e.cancelHelperRemoval=!1,e._storedCSS={position:e.placeholder.css("position"),top:e.placeholder.css("top"),left:e.placeholder.css("left")},e._mouseStop(t),e.options.helper=e.options._helper):(e.cancelHelperRemoval=!0,e._trigger("deactivate",t,r))})},drag:function(t,n,i){e.each(i.sortables,function(){var r=!1,o=this;o.positionAbs=i.positionAbs,o.helperProportions=i.helperProportions,o.offset.click=i.offset.click,o._intersectsWith(o.containerCache)&&(r=!0,e.each(i.sortables,function(){return this.positionAbs=i.positionAbs,this.helperProportions=i.helperProportions,this.offset.click=i.offset.click,this!==o&&this._intersectsWith(this.containerCache)&&e.contains(o.element[0],this.element[0])&&(r=!1),r})),r?(o.isOver||(o.isOver=1,o.currentItem=n.helper.appendTo(o.element).data("ui-sortable-item",!0),o.options._helper=o.options.helper,o.options.helper=function(){return n.helper[0]},t.target=o.currentItem[0],o._mouseCapture(t,!0),o._mouseStart(t,!0,!0),o.offset.click.top=i.offset.click.top,o.offset.click.left=i.offset.click.left,o.offset.parent.left-=i.offset.parent.left-o.offset.parent.left,o.offset.parent.top-=i.offset.parent.top-o.offset.parent.top,i._trigger("toSortable",t),i.dropped=o.element,e.each(i.sortables,function(){this.refreshPositions()}),i.currentItem=i.element,o.fromOutside=i),o.currentItem&&(o._mouseDrag(t),n.position=o.position)):o.isOver&&(o.isOver=0,o.cancelHelperRemoval=!0,o.options._revert=o.options.revert,o.options.revert=!1,o._trigger("out",t,o._uiHash(o)),o._mouseStop(t,!0),o.options.revert=o.options._revert,o.options.helper=o.options._helper,o.placeholder&&o.placeholder.remove(),i._refreshOffsets(t),n.position=i._generatePosition(t,!0),i._trigger("fromSortable",t),i.dropped=!1,e.each(i.sortables,function(){this.refreshPositions()}))})}}),e.ui.plugin.add("draggable","cursor",{start:function(t,n,i){var r=e("body"),o=i.options;r.css("cursor")&&(o._cursor=r.css("cursor")),r.css("cursor",o.cursor)},stop:function(t,n,i){var r=i.options;r._cursor&&e("body").css("cursor",r._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,n,i){var r=e(n.helper),o=i.options;r.css("opacity")&&(o._opacity=r.css("opacity")),r.css("opacity",o.opacity)},stop:function(t,n,i){var r=i.options;r._opacity&&e(n.helper).css("opacity",r._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(e,t,n){n.scrollParentNotHidden||(n.scrollParentNotHidden=n.helper.scrollParent(!1)),n.scrollParentNotHidden[0]!==n.document[0]&&"HTML"!==n.scrollParentNotHidden[0].tagName&&(n.overflowOffset=n.scrollParentNotHidden.offset())},drag:function(t,n,i){var r=i.options,o=!1,a=i.scrollParentNotHidden[0],s=i.document[0];a!==s&&"HTML"!==a.tagName?(r.axis&&"x"===r.axis||(i.overflowOffset.top+a.offsetHeight-t.pageY<r.scrollSensitivity?a.scrollTop=o=a.scrollTop+r.scrollSpeed:t.pageY-i.overflowOffset.top<r.scrollSensitivity&&(a.scrollTop=o=a.scrollTop-r.scrollSpeed)),r.axis&&"y"===r.axis||(i.overflowOffset.left+a.offsetWidth-t.pageX<r.scrollSensitivity?a.scrollLeft=o=a.scrollLeft+r.scrollSpeed:t.pageX-i.overflowOffset.left<r.scrollSensitivity&&(a.scrollLeft=o=a.scrollLeft-r.scrollSpeed))):(r.axis&&"x"===r.axis||(t.pageY-e(s).scrollTop()<r.scrollSensitivity?o=e(s).scrollTop(e(s).scrollTop()-r.scrollSpeed):e(window).height()-(t.pageY-e(s).scrollTop())<r.scrollSensitivity&&(o=e(s).scrollTop(e(s).scrollTop()+r.scrollSpeed))),r.axis&&"y"===r.axis||(t.pageX-e(s).scrollLeft()<r.scrollSensitivity?o=e(s).scrollLeft(e(s).scrollLeft()-r.scrollSpeed):e(window).width()-(t.pageX-e(s).scrollLeft())<r.scrollSensitivity&&(o=e(s).scrollLeft(e(s).scrollLeft()+r.scrollSpeed)))),o!==!1&&e.ui.ddmanager&&!r.dropBehaviour&&e.ui.ddmanager.prepareOffsets(i,t)}}),e.ui.plugin.add("draggable","snap",{start:function(t,n,i){var r=i.options;i.snapElements=[],e(r.snap.constructor!==String?r.snap.items||":data(ui-draggable)":r.snap).each(function(){var t=e(this),n=t.offset();this!==i.element[0]&&i.snapElements.push({item:this,width:t.outerWidth(),height:t.outerHeight(),top:n.top,left:n.left})})},drag:function(t,n,i){var r,o,a,s,l,c,u,h,d,f,p=i.options,g=p.snapTolerance,m=n.offset.left,v=m+i.helperProportions.width,y=n.offset.top,b=y+i.helperProportions.height;for(d=i.snapElements.length-1;d>=0;d--)l=i.snapElements[d].left-i.margins.left,c=l+i.snapElements[d].width,u=i.snapElements[d].top-i.margins.top,h=u+i.snapElements[d].height,l-g>v||m>c+g||u-g>b||y>h+g||!e.contains(i.snapElements[d].item.ownerDocument,i.snapElements[d].item)?(i.snapElements[d].snapping&&i.options.snap.release&&i.options.snap.release.call(i.element,t,e.extend(i._uiHash(),{snapItem:i.snapElements[d].item})),i.snapElements[d].snapping=!1):("inner"!==p.snapMode&&(r=Math.abs(u-b)<=g,o=Math.abs(h-y)<=g,a=Math.abs(l-v)<=g,s=Math.abs(c-m)<=g,r&&(n.position.top=i._convertPositionTo("relative",{top:u-i.helperProportions.height,left:0}).top),o&&(n.position.top=i._convertPositionTo("relative",{top:h,left:0}).top),a&&(n.position.left=i._convertPositionTo("relative",{top:0,left:l-i.helperProportions.width}).left),s&&(n.position.left=i._convertPositionTo("relative",{top:0,left:c}).left)),f=r||o||a||s,"outer"!==p.snapMode&&(r=Math.abs(u-y)<=g,o=Math.abs(h-b)<=g,a=Math.abs(l-m)<=g,s=Math.abs(c-v)<=g,r&&(n.position.top=i._convertPositionTo("relative",{top:u,left:0}).top),o&&(n.position.top=i._convertPositionTo("relative",{top:h-i.helperProportions.height,left:0}).top),a&&(n.position.left=i._convertPositionTo("relative",{top:0,left:l}).left),s&&(n.position.left=i._convertPositionTo("relative",{top:0,left:c-i.helperProportions.width}).left)),!i.snapElements[d].snapping&&(r||o||a||s||f)&&i.options.snap.snap&&i.options.snap.snap.call(i.element,t,e.extend(i._uiHash(),{snapItem:i.snapElements[d].item})),i.snapElements[d].snapping=r||o||a||s||f)}}),e.ui.plugin.add("draggable","stack",{start:function(t,n,i){var r,o=i.options,a=e.makeArray(e(o.stack)).sort(function(t,n){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(n).css("zIndex"),10)||0)});a.length&&(r=parseInt(e(a[0]).css("zIndex"),10)||0,e(a).each(function(t){e(this).css("zIndex",r+t)}),this.css("zIndex",r+a.length))}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,n,i){var r=e(n.helper),o=i.options;r.css("zIndex")&&(o._zIndex=r.css("zIndex")),r.css("zIndex",o.zIndex)},stop:function(t,n,i){var r=i.options;r._zIndex&&e(n.helper).css("zIndex",r._zIndex)}});e.ui.draggable;/*!
 * jQuery UI Droppable 1.11.3
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/droppable/
 */
e.widget("ui.droppable",{version:"1.11.3",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var t,n=this.options,i=n.accept;this.isover=!1,this.isout=!0,this.accept=e.isFunction(i)?i:function(e){return e.is(i)},this.proportions=function(){return arguments.length?void(t=arguments[0]):t?t:t={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}},this._addToManager(n.scope),n.addClasses&&this.element.addClass("ui-droppable")},_addToManager:function(t){e.ui.ddmanager.droppables[t]=e.ui.ddmanager.droppables[t]||[],e.ui.ddmanager.droppables[t].push(this)},_splice:function(e){for(var t=0;t<e.length;t++)e[t]===this&&e.splice(t,1)},_destroy:function(){var t=e.ui.ddmanager.droppables[this.options.scope];this._splice(t),this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(t,n){if("accept"===t)this.accept=e.isFunction(n)?n:function(e){return e.is(n)};else if("scope"===t){var i=e.ui.ddmanager.droppables[this.options.scope];this._splice(i),this._addToManager(n)}this._super(t,n)},_activate:function(t){var n=e.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),n&&this._trigger("activate",t,this.ui(n))},_deactivate:function(t){var n=e.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),n&&this._trigger("deactivate",t,this.ui(n))},_over:function(t){var n=e.ui.ddmanager.current;n&&(n.currentItem||n.element)[0]!==this.element[0]&&this.accept.call(this.element[0],n.currentItem||n.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",t,this.ui(n)))},_out:function(t){var n=e.ui.ddmanager.current;n&&(n.currentItem||n.element)[0]!==this.element[0]&&this.accept.call(this.element[0],n.currentItem||n.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",t,this.ui(n)))},_drop:function(t,n){var i=n||e.ui.ddmanager.current,r=!1;return i&&(i.currentItem||i.element)[0]!==this.element[0]?(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var n=e(this).droppable("instance");return n.options.greedy&&!n.options.disabled&&n.options.scope===i.options.scope&&n.accept.call(n.element[0],i.currentItem||i.element)&&e.ui.intersect(i,e.extend(n,{offset:n.element.offset()}),n.options.tolerance,t)?(r=!0,!1):void 0}),r?!1:this.accept.call(this.element[0],i.currentItem||i.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",t,this.ui(i)),this.element):!1):!1},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}}}),e.ui.intersect=function(){function e(e,t,n){return e>=t&&t+n>e}return function(t,n,i,r){if(!n.offset)return!1;var o=(t.positionAbs||t.position.absolute).left+t.margins.left,a=(t.positionAbs||t.position.absolute).top+t.margins.top,s=o+t.helperProportions.width,l=a+t.helperProportions.height,c=n.offset.left,u=n.offset.top,h=c+n.proportions().width,d=u+n.proportions().height;switch(i){case"fit":return o>=c&&h>=s&&a>=u&&d>=l;case"intersect":return c<o+t.helperProportions.width/2&&s-t.helperProportions.width/2<h&&u<a+t.helperProportions.height/2&&l-t.helperProportions.height/2<d;case"pointer":return e(r.pageY,u,n.proportions().height)&&e(r.pageX,c,n.proportions().width);case"touch":return(a>=u&&d>=a||l>=u&&d>=l||u>a&&l>d)&&(o>=c&&h>=o||s>=c&&h>=s||c>o&&s>h);default:return!1}}}(),e.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(t,n){var i,r,o=e.ui.ddmanager.droppables[t.options.scope]||[],a=n?n.type:null,s=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();e:for(i=0;i<o.length;i++)if(!(o[i].options.disabled||t&&!o[i].accept.call(o[i].element[0],t.currentItem||t.element))){for(r=0;r<s.length;r++)if(s[r]===o[i].element[0]){o[i].proportions().height=0;continue e}o[i].visible="none"!==o[i].element.css("display"),o[i].visible&&("mousedown"===a&&o[i]._activate.call(o[i],n),o[i].offset=o[i].element.offset(),o[i].proportions({width:o[i].element[0].offsetWidth,height:o[i].element[0].offsetHeight}))}},drop:function(t,n){var i=!1;return e.each((e.ui.ddmanager.droppables[t.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&e.ui.intersect(t,this,this.options.tolerance,n)&&(i=this._drop.call(this,n)||i),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,n)))}),i},dragStart:function(t,n){t.element.parentsUntil("body").bind("scroll.droppable",function(){t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,n)})},drag:function(t,n){t.options.refreshPositions&&e.ui.ddmanager.prepareOffsets(t,n),e.each(e.ui.ddmanager.droppables[t.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var i,r,o,a=e.ui.intersect(t,this,this.options.tolerance,n),s=!a&&this.isover?"isout":a&&!this.isover?"isover":null;s&&(this.options.greedy&&(r=this.options.scope,o=this.element.parents(":data(ui-droppable)").filter(function(){return e(this).droppable("instance").options.scope===r}),o.length&&(i=e(o[0]).droppable("instance"),i.greedyChild="isover"===s)),i&&"isover"===s&&(i.isover=!1,i.isout=!0,i._out.call(i,n)),this[s]=!0,this["isout"===s?"isover":"isout"]=!1,this["isover"===s?"_over":"_out"].call(this,n),i&&"isout"===s&&(i.isout=!1,i.isover=!0,i._over.call(i,n)))}})},dragStop:function(t,n){t.element.parentsUntil("body").unbind("scroll.droppable"),t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,n)}};e.ui.droppable}),WL.Constants={COMMAND_KEY_CODE:91,CTRL_KEY_CODE:17,ENTER_KEY_CODE:13,ESC_KEY_CODE:27},WL.Constants.bibCommands=["cite","citep","citet","footcite","nocite","autocite","autocites","citeauthor","citeyear","parencite","citealt"],
// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.CodeMirror=t()}(this,function(){"use strict";function e(e){return new RegExp("(^|\\s)"+e+"(?:$|\\s)\\s*")}function t(e){for(var t=e.childNodes.length;t>0;--t)e.removeChild(e.firstChild);return e}function n(e,n){return t(e).appendChild(n)}function i(e,t,n,i){var r=document.createElement(e);if(n&&(r.className=n),i&&(r.style.cssText=i),"string"==typeof t)r.appendChild(document.createTextNode(t));else if(t)for(var o=0;o<t.length;++o)r.appendChild(t[o]);return r}function r(e,t){if(3==t.nodeType&&(t=t.parentNode),e.contains)return e.contains(t);do if(11==t.nodeType&&(t=t.host),t==e)return!0;while(t=t.parentNode)}function o(){var e;try{e=document.activeElement}catch(t){e=document.body||null}for(;e&&e.root&&e.root.activeElement;)e=e.root.activeElement;return e}function a(t,n){var i=t.className;e(n).test(i)||(t.className+=(i?" ":"")+n)}function s(t,n){for(var i=t.split(" "),r=0;r<i.length;r++)i[r]&&!e(i[r]).test(n)&&(n+=" "+i[r]);return n}function l(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t)}}function c(e,t,n){t||(t={});for(var i in e)!e.hasOwnProperty(i)||n===!1&&t.hasOwnProperty(i)||(t[i]=e[i]);return t}function u(e,t,n,i,r){null==t&&(t=e.search(/[^\s\u00a0]/),-1==t&&(t=e.length));for(var o=i||0,a=r||0;;){var s=e.indexOf("	",o);if(0>s||s>=t)return a+(t-o);a+=s-o,a+=n-a%n,o=s+1}}function h(){this.id=null}function d(e,t){for(var n=0;n<e.length;++n)if(e[n]==t)return n;return-1}function f(e,t,n){for(var i=0,r=0;;){var o=e.indexOf("	",i);-1==o&&(o=e.length);var a=o-i;if(o==e.length||r+a>=t)return i+Math.min(a,t-r);if(r+=o-i,r+=n-r%n,i=o+1,r>=t)return i}}function p(e){for(;Ia.length<=e;)Ia.push(g(Ia)+" ");return Ia[e]}function g(e){return e[e.length-1]}function m(e,t){for(var n=[],i=0;i<e.length;i++)n[i]=t(e[i],i);return n}function v(e,t,n){for(var i=0,r=n(t);i<e.length&&n(e[i])<=r;)i++;e.splice(i,0,t)}function y(){}function b(e,t){var n;return Object.create?n=Object.create(e):(y.prototype=e,n=new y),t&&c(t,n),n}function w(e){return/\w/.test(e)||e>"\x80"&&(e.toUpperCase()!=e.toLowerCase()||$a.test(e))}function C(e,t){return t?t.source.indexOf("\\w")>-1&&w(e)?!0:t.test(e):w(e)}function x(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t])return!1;return!0}function k(e){return e.charCodeAt(0)>=768&&Oa.test(e)}function _(e,t,n){var r=this;this.input=n,r.scrollbarFiller=i("div",null,"CodeMirror-scrollbar-filler"),r.scrollbarFiller.setAttribute("cm-not-content","true"),r.gutterFiller=i("div",null,"CodeMirror-gutter-filler"),r.gutterFiller.setAttribute("cm-not-content","true"),r.lineDiv=i("div",null,"CodeMirror-code"),r.selectionDiv=i("div",null,null,"position: relative; z-index: 1"),r.cursorDiv=i("div",null,"CodeMirror-cursors"),r.measure=i("div",null,"CodeMirror-measure"),r.lineMeasure=i("div",null,"CodeMirror-measure"),r.lineSpace=i("div",[r.measure,r.lineMeasure,r.selectionDiv,r.cursorDiv,r.lineDiv],null,"position: relative; outline: none"),r.mover=i("div",[i("div",[r.lineSpace],"CodeMirror-lines")],null,"position: relative"),r.sizer=i("div",[r.mover],"CodeMirror-sizer"),r.sizerWidth=null,r.heightForcer=i("div",null,null,"position: absolute; height: "+La+"px; width: 1px;"),r.gutters=i("div",null,"CodeMirror-gutters"),r.lineGutter=null,r.scroller=i("div",[r.sizer,r.heightForcer,r.gutters],"CodeMirror-scroll"),r.scroller.setAttribute("tabIndex","-1"),r.wrapper=i("div",[r.scrollbarFiller,r.gutterFiller,r.scroller],"CodeMirror"),aa&&8>sa&&(r.gutters.style.zIndex=-1,r.scroller.style.paddingRight=0),la||ia&&ma||(r.scroller.draggable=!0),e&&(e.appendChild?e.appendChild(r.wrapper):e(r.wrapper)),r.viewFrom=r.viewTo=t.first,r.reportedViewFrom=r.reportedViewTo=t.first,r.view=[],r.renderedView=null,r.externalMeasured=null,r.viewOffset=0,r.lastWrapHeight=r.lastWrapWidth=0,r.updateLineNumbers=null,r.nativeBarWidth=r.barHeight=r.barWidth=0,r.scrollbarsClipped=!1,r.lineNumWidth=r.lineNumInnerWidth=r.lineNumChars=null,r.alignWidgets=!1,r.cachedCharWidth=r.cachedTextHeight=r.cachedPaddingH=null,r.maxLine=null,r.maxLineLength=0,r.maxLineChanged=!1,r.wheelDX=r.wheelDY=r.wheelStartX=r.wheelStartY=null,r.shift=!1,r.selForContextMenu=null,r.activeTouch=null,n.init(r)}function A(e,t){if(t-=e.first,0>t||t>=e.size)throw new Error("There is no line "+(t+e.first)+" in the document.");for(var n=e;!n.lines;)for(var i=0;;++i){var r=n.children[i],o=r.chunkSize();if(o>t){n=r;break}t-=o}return n.lines[t]}function S(e,t,n){var i=[],r=t.line;return e.iter(t.line,n.line+1,function(e){var o=e.text;r==n.line&&(o=o.slice(0,n.ch)),r==t.line&&(o=o.slice(t.ch)),i.push(o),++r}),i}function T(e,t,n){var i=[];return e.iter(t,n,function(e){i.push(e.text)}),i}function L(e,t){var n=t-e.height;if(n)for(var i=e;i;i=i.parent)i.height+=n}function E(e){if(null==e.parent)return null;for(var t=e.parent,n=d(t.lines,e),i=t.parent;i;t=i,i=i.parent)for(var r=0;i.children[r]!=t;++r)n+=i.children[r].chunkSize();return n+t.first}function M(e,t){var n=e.first;e:do{for(var i=0;i<e.children.length;++i){var r=e.children[i],o=r.height;if(o>t){e=r;continue e}t-=o,n+=r.chunkSize()}return n}while(!e.lines);for(var a=0;a<e.lines.length;++a){var s=e.lines[a],l=s.height;if(l>t)break;t-=l}return n+a}function P(e,t){return t>=e.first&&t<e.first+e.size}function R(e,t){return String(e.lineNumberFormatter(t+e.firstLineNumber))}function I(e,t){return this instanceof I?(this.line=e,void(this.ch=t)):new I(e,t)}function $(e,t){return e.line-t.line||e.ch-t.ch}function O(e){return I(e.line,e.ch)}function D(e,t){return $(e,t)<0?t:e}function F(e,t){return $(e,t)<0?e:t}function N(e,t){return Math.max(e.first,Math.min(t,e.first+e.size-1))}function W(e,t){if(t.line<e.first)return I(e.first,0);var n=e.first+e.size-1;return t.line>n?I(n,A(e,n).text.length):j(t,A(e,t.line).text.length)}function j(e,t){var n=e.ch;return null==n||n>t?I(e.line,t):0>n?I(e.line,0):e}function H(e,t){for(var n=[],i=0;i<t.length;i++)n[i]=W(e,t[i]);return n}function B(){Da=!0}function U(){Fa=!0}function z(e,t,n){this.marker=e,this.from=t,this.to=n}function G(e,t){if(e)for(var n=0;n<e.length;++n){var i=e[n];if(i.marker==t)return i}}function q(e,t){for(var n,i=0;i<e.length;++i)e[i]!=t&&(n||(n=[])).push(e[i]);return n}function Y(e,t){e.markedSpans=e.markedSpans?e.markedSpans.concat([t]):[t],t.marker.attachLine(e)}function K(e,t,n){var i;if(e)for(var r=0;r<e.length;++r){var o=e[r],a=o.marker,s=null==o.from||(a.inclusiveLeft?o.from<=t:o.from<t);if(s||o.from==t&&"bookmark"==a.type&&(!n||!o.marker.insertLeft)){var l=null==o.to||(a.inclusiveRight?o.to>=t:o.to>t);(i||(i=[])).push(new z(a,o.from,l?null:o.to))}}return i}function V(e,t,n){var i;if(e)for(var r=0;r<e.length;++r){var o=e[r],a=o.marker,s=null==o.to||(a.inclusiveRight?o.to>=t:o.to>t);if(s||o.from==t&&"bookmark"==a.type&&(!n||o.marker.insertLeft)){var l=null==o.from||(a.inclusiveLeft?o.from<=t:o.from<t);(i||(i=[])).push(new z(a,l?null:o.from-t,null==o.to?null:o.to-t))}}return i}function X(e,t){if(t.full)return null;var n=P(e,t.from.line)&&A(e,t.from.line).markedSpans,i=P(e,t.to.line)&&A(e,t.to.line).markedSpans;if(!n&&!i)return null;var r=t.from.ch,o=t.to.ch,a=0==$(t.from,t.to),s=K(n,r,a),l=V(i,o,a),c=1==t.text.length,u=g(t.text).length+(c?r:0);if(s)for(var h=0;h<s.length;++h){var d=s[h];if(null==d.to){var f=G(l,d.marker);f?c&&(d.to=null==f.to?null:f.to+u):d.to=r}}if(l)for(var p=0;p<l.length;++p){var m=l[p];if(null!=m.to&&(m.to+=u),null==m.from){var v=G(s,m.marker);v||(m.from=u,c&&(s||(s=[])).push(m))}else m.from+=u,c&&(s||(s=[])).push(m)}s&&(s=J(s)),l&&l!=s&&(l=J(l));var y=[s];if(!c){var b,w=t.text.length-2;if(w>0&&s)for(var C=0;C<s.length;++C)null==s[C].to&&(b||(b=[])).push(new z(s[C].marker,null,null));for(var x=0;w>x;++x)y.push(b);y.push(l)}return y}function J(e){for(var t=0;t<e.length;++t){var n=e[t];null!=n.from&&n.from==n.to&&n.marker.clearWhenEmpty!==!1&&e.splice(t--,1)}return e.length?e:null}function Q(e,t,n){var i=null;if(e.iter(t.line,n.line+1,function(e){if(e.markedSpans)for(var t=0;t<e.markedSpans.length;++t){var n=e.markedSpans[t].marker;!n.readOnly||i&&-1!=d(i,n)||(i||(i=[])).push(n)}}),!i)return null;for(var r=[{from:t,to:n}],o=0;o<i.length;++o)for(var a=i[o],s=a.find(0),l=0;l<r.length;++l){var c=r[l];if(!($(c.to,s.from)<0||$(c.from,s.to)>0)){var u=[l,1],h=$(c.from,s.from),f=$(c.to,s.to);(0>h||!a.inclusiveLeft&&!h)&&u.push({from:c.from,to:s.from}),(f>0||!a.inclusiveRight&&!f)&&u.push({from:s.to,to:c.to}),r.splice.apply(r,u),l+=u.length-1}}return r}function Z(e){var t=e.markedSpans;if(t){for(var n=0;n<t.length;++n)t[n].marker.detachLine(e);e.markedSpans=null}}function ee(e,t){if(t){for(var n=0;n<t.length;++n)t[n].marker.attachLine(e);e.markedSpans=t}}function te(e){return e.inclusiveLeft?-1:0}function ne(e){return e.inclusiveRight?1:0}function ie(e,t){var n=e.lines.length-t.lines.length;if(0!=n)return n;var i=e.find(),r=t.find(),o=$(i.from,r.from)||te(e)-te(t);if(o)return-o;var a=$(i.to,r.to)||ne(e)-ne(t);return a?a:t.id-e.id}function re(e,t){var n,i=Fa&&e.markedSpans;if(i)for(var r=void 0,o=0;o<i.length;++o)r=i[o],r.marker.collapsed&&null==(t?r.from:r.to)&&(!n||ie(n,r.marker)<0)&&(n=r.marker);return n}function oe(e){return re(e,!0)}function ae(e){return re(e,!1)}function se(e,t,n,i,r){var o=A(e,t),a=Fa&&o.markedSpans;if(a)for(var s=0;s<a.length;++s){var l=a[s];if(l.marker.collapsed){var c=l.marker.find(0),u=$(c.from,n)||te(l.marker)-te(r),h=$(c.to,i)||ne(l.marker)-ne(r);if(!(u>=0&&0>=h||0>=u&&h>=0)&&(0>=u&&(l.marker.inclusiveRight&&r.inclusiveLeft?$(c.to,n)>=0:$(c.to,n)>0)||u>=0&&(l.marker.inclusiveRight&&r.inclusiveLeft?$(c.from,i)<=0:$(c.from,i)<0)))return!0}}}function le(e){for(var t;t=oe(e);)e=t.find(-1,!0).line;return e}function ce(e){for(var t,n;t=ae(e);)e=t.find(1,!0).line,(n||(n=[])).push(e);return n}function ue(e,t){var n=A(e,t),i=le(n);return n==i?t:E(i)}function he(e,t){if(t>e.lastLine())return t;var n,i=A(e,t);if(!de(e,i))return t;for(;n=ae(i);)i=n.find(1,!0).line;return E(i)+1}function de(e,t){var n=Fa&&t.markedSpans;if(n)for(var i=void 0,r=0;r<n.length;++r)if(i=n[r],i.marker.collapsed){if(null==i.from)return!0;if(!i.marker.widgetNode&&0==i.from&&i.marker.inclusiveLeft&&fe(e,t,i))return!0}}function fe(e,t,n){if(null==n.to){var i=n.marker.find(1,!0);return fe(e,i.line,G(i.line.markedSpans,n.marker))}if(n.marker.inclusiveRight&&n.to==t.text.length)return!0;for(var r=void 0,o=0;o<t.markedSpans.length;++o)if(r=t.markedSpans[o],r.marker.collapsed&&!r.marker.widgetNode&&r.from==n.to&&(null==r.to||r.to!=n.from)&&(r.marker.inclusiveLeft||n.marker.inclusiveRight)&&fe(e,t,r))return!0}function pe(e){e=le(e);for(var t=0,n=e.parent,i=0;i<n.lines.length;++i){var r=n.lines[i];if(r==e)break;t+=r.height}for(var o=n.parent;o;n=o,o=n.parent)for(var a=0;a<o.children.length;++a){var s=o.children[a];if(s==n)break;t+=s.height}return t}function ge(e){if(0==e.height)return 0;for(var t,n=e.text.length,i=e;t=oe(i);){var r=t.find(0,!0);i=r.from.line,n+=r.from.ch-r.to.ch}for(i=e;t=ae(i);){var o=t.find(0,!0);n-=i.text.length-o.from.ch,i=o.to.line,n+=i.text.length-o.to.ch}return n}function me(e){var t=e.display,n=e.doc;t.maxLine=A(n,n.first),t.maxLineLength=ge(t.maxLine),t.maxLineChanged=!0,n.iter(function(e){var n=ge(e);n>t.maxLineLength&&(t.maxLineLength=n,t.maxLine=e)})}function ve(e,t,n,i){if(!e)return i(t,n,"ltr");for(var r=!1,o=0;o<e.length;++o){var a=e[o];(a.from<n&&a.to>t||t==n&&a.to==t)&&(i(Math.max(a.from,t),Math.min(a.to,n),1==a.level?"rtl":"ltr"),r=!0)}r||i(t,n,"ltr")}function ye(e){return e.level%2?e.to:e.from}function be(e){return e.level%2?e.from:e.to}function we(e){var t=Te(e);return t?ye(t[0]):0}function Ce(e){var t=Te(e);return t?be(g(t)):e.text.length}function xe(e,t,n){var i=e[0].level;return t==i?!0:n==i?!1:n>t}function ke(e,t){var n;Na=null;for(var i=0;i<e.length;++i){var r=e[i];if(r.from<t&&r.to>t)return i;if(r.from==t||r.to==t){if(null!=n)return xe(e,r.level,e[n].level)?(r.from!=r.to&&(Na=n),i):(r.from!=r.to&&(Na=i),n);n=i}}return n}function _e(e,t,n,i){if(!i)return t+n;do t+=n;while(t>0&&k(e.text.charAt(t)));return t}function Ae(e,t,n,i){var r=Te(e);if(!r)return Se(e,t,n,i);for(var o=ke(r,t),a=r[o],s=_e(e,t,a.level%2?-n:n,i);;){if(s>a.from&&s<a.to)return s;if(s==a.from||s==a.to)return ke(r,s)==o?s:(a=r[o+=n],n>0==a.level%2?a.to:a.from);if(a=r[o+=n],!a)return null;s=n>0==a.level%2?_e(e,a.to,-1,i):_e(e,a.from,1,i)}}function Se(e,t,n,i){var r=t+n;if(i)for(;r>0&&k(e.text.charAt(r));)r+=n;return 0>r||r>e.text.length?null:r}function Te(e){var t=e.order;return null==t&&(t=e.order=Wa(e.text)),t}function Le(e,t){return e._handlers&&e._handlers[t]||ja}function Ee(e,t,n){if(e.removeEventListener)e.removeEventListener(t,n,!1);else if(e.detachEvent)e.detachEvent("on"+t,n);else{var i=e._handlers,r=i&&i[t];if(r){var o=d(r,n);o>-1&&(i[t]=r.slice(0,o).concat(r.slice(o+1)))}}}function Me(e,t){var n=Le(e,t);if(n.length)for(var i=Array.prototype.slice.call(arguments,2),r=0;r<n.length;++r)n[r].apply(null,i)}function Pe(e,t,n){return"string"==typeof t&&(t={type:t,preventDefault:function(){this.defaultPrevented=!0}}),Me(e,n||t.type,e,t),Fe(t)||t.codemirrorIgnore}function Re(e){var t=e._handlers&&e._handlers.cursorActivity;if(t)for(var n=e.curOp.cursorActivityHandlers||(e.curOp.cursorActivityHandlers=[]),i=0;i<t.length;++i)-1==d(n,t[i])&&n.push(t[i])}function Ie(e,t){return Le(e,t).length>0}function $e(e){e.prototype.on=function(e,t){Ha(this,e,t)},e.prototype.off=function(e,t){Ee(this,e,t)}}function Oe(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function De(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function Fe(e){return null!=e.defaultPrevented?e.defaultPrevented:0==e.returnValue}function Ne(e){Oe(e),De(e)}function We(e){return e.target||e.srcElement}function je(e){var t=e.which;return null==t&&(1&e.button?t=1:2&e.button?t=3:4&e.button&&(t=2)),va&&e.ctrlKey&&1==t&&(t=3),t}function He(e){if(null==Sa){var t=i("span","\u200b");n(e,i("span",[t,document.createTextNode("x")])),0!=e.firstChild.offsetHeight&&(Sa=t.offsetWidth<=1&&t.offsetHeight>2&&!(aa&&8>sa))}var r=Sa?i("span","\u200b"):i("span","\xa0",null,"display: inline-block; width: 1px; margin-right: -1px");return r.setAttribute("cm-text",""),r}function Be(e){if(null!=Ta)return Ta;var i=n(e,document.createTextNode("A\u062eA")),r=Ca(i,0,1).getBoundingClientRect(),o=Ca(i,1,2).getBoundingClientRect();return t(e),r&&r.left!=r.right?Ta=o.right-r.right<3:!1}function Ue(e){if(null!=qa)return qa;var t=n(e,i("span","x")),r=t.getBoundingClientRect(),o=Ca(t,0,1).getBoundingClientRect();return qa=Math.abs(r.left-o.left)>1}function ze(e,t){arguments.length>2&&(t.dependencies=Array.prototype.slice.call(arguments,2)),Ya[e]=t}function Ge(e,t){Ka[e]=t}function qe(e){if("string"==typeof e&&Ka.hasOwnProperty(e))e=Ka[e];else if(e&&"string"==typeof e.name&&Ka.hasOwnProperty(e.name)){var t=Ka[e.name];"string"==typeof t&&(t={name:t}),e=b(t,e),e.name=t.name}else{if("string"==typeof e&&/^[\w\-]+\/[\w\-]+\+xml$/.test(e))return qe("application/xml");if("string"==typeof e&&/^[\w\-]+\/[\w\-]+\+json$/.test(e))return qe("application/json")}return"string"==typeof e?{name:e}:e||{name:"null"}}function Ye(e,t){t=qe(t);var n=Ya[t.name];if(!n)return Ye(e,"text/plain");var i=n(e,t);if(Va.hasOwnProperty(t.name)){var r=Va[t.name];for(var o in r)r.hasOwnProperty(o)&&(i.hasOwnProperty(o)&&(i["_"+o]=i[o]),i[o]=r[o])}if(i.name=t.name,t.helperType&&(i.helperType=t.helperType),t.modeProps)for(var a in t.modeProps)i[a]=t.modeProps[a];return i}function Ke(e,t){var n=Va.hasOwnProperty(e)?Va[e]:Va[e]={};c(t,n)}function Ve(e,t){if(t===!0)return t;if(e.copyState)return e.copyState(t);var n={};for(var i in t){var r=t[i];r instanceof Array&&(r=r.concat([])),n[i]=r}return n}function Xe(e,t){for(var n;e.innerMode&&(n=e.innerMode(t),n&&n.mode!=e);)t=n.state,e=n.mode;return n||{mode:e,state:t}}function Je(e,t,n){return e.startState?e.startState(t,n):!0}function Qe(e,t,n,i){var r=[e.state.modeGen],o={};at(e,t.text,e.doc.mode,n,function(e,t){return r.push(e,t)},o,i);for(var a=function(n){var i=e.state.overlays[n],a=1,s=0;at(e,t.text,i.mode,!0,function(e,t){for(var n=a;e>s;){var o=r[a];o>e&&r.splice(a,1,e,r[a+1],o),a+=2,s=Math.min(e,o)}if(t)if(i.opaque)r.splice(n,a-n,e,"overlay "+t),a=n+2;else for(;a>n;n+=2){var l=r[n+1];r[n+1]=(l?l+" ":"")+"overlay "+t}},o)},s=0;s<e.state.overlays.length;++s)a(s);return{styles:r,classes:o.bgClass||o.textClass?o:null}}function Ze(e,t,n){if(!t.styles||t.styles[0]!=e.state.modeGen){var i=et(e,E(t)),r=Qe(e,t,t.text.length>e.options.maxHighlightLength?Ve(e.doc.mode,i):i);t.stateAfter=i,t.styles=r.styles,r.classes?t.styleClasses=r.classes:t.styleClasses&&(t.styleClasses=null),n===e.doc.frontier&&e.doc.frontier++}return t.styles}function et(e,t,n){var i=e.doc,r=e.display;if(!i.mode.startState)return!0;var o=st(e,t,n),a=o>i.first&&A(i,o-1).stateAfter;return a=a?Ve(i.mode,a):Je(i.mode),i.iter(o,t,function(n){tt(e,n.text,a);var s=o==t-1||o%5==0||o>=r.viewFrom&&o<r.viewTo;n.stateAfter=s?Ve(i.mode,a):null,++o}),n&&(i.frontier=o),a}function tt(e,t,n,i){var r=e.doc.mode,o=new Xa(t,e.options.tabSize);for(o.start=o.pos=i||0,""==t&&nt(r,n);!o.eol();)it(r,o,n),o.start=o.pos}function nt(e,t){if(e.blankLine)return e.blankLine(t);if(e.innerMode){var n=Xe(e,t);return n.mode.blankLine?n.mode.blankLine(n.state):void 0}}function it(e,t,n,i){for(var r=0;10>r;r++){i&&(i[0]=Xe(e,n).mode);var o=e.token(t,n);if(t.pos>t.start)return o}throw new Error("Mode "+e.name+" failed to advance stream.")}function rt(e,t,n,i){var r,o=function(e){return{start:h.start,end:h.pos,string:h.current(),type:r||null,state:e?Ve(a.mode,u):u}},a=e.doc,s=a.mode;t=W(a,t);var l,c=A(a,t.line),u=et(e,t.line,n),h=new Xa(c.text,e.options.tabSize);for(i&&(l=[]);(i||h.pos<t.ch)&&!h.eol();)h.start=h.pos,r=it(s,h,u),i&&l.push(o(!0));return i?l:o()}function ot(e,t){if(e)for(;;){var n=e.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!n)break;e=e.slice(0,n.index)+e.slice(n.index+n[0].length);var i=n[1]?"bgClass":"textClass";null==t[i]?t[i]=n[2]:new RegExp("(?:^|s)"+n[2]+"(?:$|s)").test(t[i])||(t[i]+=" "+n[2])}return e}function at(e,t,n,i,r,o,a){var s=n.flattenSpans;null==s&&(s=e.options.flattenSpans);var l,c=0,u=null,h=new Xa(t,e.options.tabSize),d=e.options.addModeClass&&[null];for(""==t&&ot(nt(n,i),o);!h.eol();){if(h.pos>e.options.maxHighlightLength?(s=!1,a&&tt(e,t,i,h.pos),h.pos=t.length,l=null):l=ot(it(n,h,i,d),o),d){var f=d[0].name;f&&(l="m-"+(l?f+" "+l:f))}if(!s||u!=l){for(;c<h.start;)c=Math.min(h.start,c+5e3),r(c,u);u=l}h.start=h.pos}for(;c<h.pos;){var p=Math.min(h.pos,c+5e3);r(p,u),c=p}}function st(e,t,n){for(var i,r,o=e.doc,a=n?-1:t-(e.doc.mode.innerMode?1e3:100),s=t;s>a;--s){if(s<=o.first)return o.first;var l=A(o,s-1);if(l.stateAfter&&(!n||s<=o.frontier))return s;var c=u(l.text,null,e.options.tabSize);(null==r||i>c)&&(r=s-1,i=c)}return r}function lt(e,t,n){this.text=e,ee(this,t),this.height=n?n(this):1}function ct(e,t,n,i){e.text=t,e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null),null!=e.order&&(e.order=null),Z(e),ee(e,n);var r=i?i(e):1;r!=e.height&&L(e,r)}function ut(e){e.parent=null,Z(e)}function ht(e,t){if(!e||/^\s*$/.test(e))return null;var n=t.addModeClass?Za:Qa;return n[e]||(n[e]=e.replace(/\S+/g,"cm-$&"))}function dt(e,t){var n=i("span",null,null,la?"padding-right: .1px":null),r={pre:i("pre",[n],"CodeMirror-line"),content:n,col:0,pos:0,cm:e,trailingSpace:!1,splitSpaces:(aa||la)&&e.getOption("lineWrapping")};t.measure={};for(var o=0;o<=(t.rest?t.rest.length:0);o++){var a=o?t.rest[o-1]:t.line,l=void 0;r.pos=0,r.addToken=pt,Be(e.display.measure)&&(l=Te(a))&&(r.addToken=mt(r.addToken,l)),r.map=[];var c=t!=e.display.externalMeasured&&E(a);yt(a,r,Ze(e,a,c)),a.styleClasses&&(a.styleClasses.bgClass&&(r.bgClass=s(a.styleClasses.bgClass,r.bgClass||"")),a.styleClasses.textClass&&(r.textClass=s(a.styleClasses.textClass,r.textClass||""))),0==r.map.length&&r.map.push(0,0,r.content.appendChild(He(e.display.measure))),0==o?(t.measure.map=r.map,t.measure.cache={}):((t.measure.maps||(t.measure.maps=[])).push(r.map),(t.measure.caches||(t.measure.caches=[])).push({}))}if(la){var u=r.content.lastChild;(/\bcm-tab\b/.test(u.className)||u.querySelector&&u.querySelector(".cm-tab"))&&(r.content.className="cm-tab-wrap-hack")}return Me(e,"renderLine",e,t.line,r.pre),r.pre.className&&(r.textClass=s(r.pre.className,r.textClass||"")),r}function ft(e){var t=i("span","\u2022","cm-invalidchar");return t.title="\\u"+e.charCodeAt(0).toString(16),t.setAttribute("aria-label",t.title),t}function pt(e,t,n,r,o,a,s){if(t){var l,c=e.splitSpaces?gt(t,e.trailingSpace):t,u=e.cm.state.specialChars,h=!1;if(u.test(t)){l=document.createDocumentFragment();for(var d=0;;){u.lastIndex=d;var f=u.exec(t),g=f?f.index-d:t.length-d;if(g){var m=document.createTextNode(c.slice(d,d+g));aa&&9>sa?l.appendChild(i("span",[m])):l.appendChild(m),e.map.push(e.pos,e.pos+g,m),e.col+=g,e.pos+=g}if(!f)break;d+=g+1;var v=void 0;if("	"==f[0]){var y=e.cm.options.tabSize,b=y-e.col%y;v=l.appendChild(i("span",p(b),"cm-tab")),v.setAttribute("role","presentation"),v.setAttribute("cm-text","	"),e.col+=b}else"\r"==f[0]||"\n"==f[0]?(v=l.appendChild(i("span","\r"==f[0]?"\u240d":"\u2424","cm-invalidchar")),v.setAttribute("cm-text",f[0]),e.col+=1):(v=e.cm.options.specialCharPlaceholder(f[0]),v.setAttribute("cm-text",f[0]),aa&&9>sa?l.appendChild(i("span",[v])):l.appendChild(v),e.col+=1);e.map.push(e.pos,e.pos+1,v),e.pos++}}else e.col+=t.length,l=document.createTextNode(c),e.map.push(e.pos,e.pos+t.length,l),aa&&9>sa&&(h=!0),e.pos+=t.length;if(e.trailingSpace=32==c.charCodeAt(t.length-1),n||r||o||h||s){var w=n||"";r&&(w+=r),o&&(w+=o);var C=i("span",[l],w,s);return a&&(C.title=a),e.content.appendChild(C)}e.content.appendChild(l)}}function gt(e,t){if(e.length>1&&!/  /.test(e))return e;for(var n=t,i="",r=0;r<e.length;r++){var o=e.charAt(r);" "!=o||!n||r!=e.length-1&&32!=e.charCodeAt(r+1)||(o="\xa0"),i+=o,n=" "==o}return i}function mt(e,t){return function(n,i,r,o,a,s,l){r=r?r+" cm-force-border":"cm-force-border";for(var c=n.pos,u=c+i.length;;){for(var h=void 0,d=0;d<t.length&&(h=t[d],!(h.to>c&&h.from<=c));d++);if(h.to>=u)return e(n,i,r,o,a,s,l);e(n,i.slice(0,h.to-c),r,o,null,s,l),o=null,i=i.slice(h.to-c),c=h.to}}}function vt(e,t,n,i){var r=!i&&n.widgetNode;r&&e.map.push(e.pos,e.pos+t,r),!i&&e.cm.display.input.needsContentAttribute&&(r||(r=e.content.appendChild(document.createElement("span"))),r.setAttribute("cm-marker",n.id)),r&&(e.cm.display.input.setUneditable(r),e.content.appendChild(r)),e.pos+=t,e.trailingSpace=!1}function yt(e,t,n){var i=e.markedSpans,r=e.text,o=0;if(i)for(var a,s,l,c,u,h,d,f=r.length,p=0,g=1,m="",v=0;;){if(v==p){l=c=u=h=s="",d=null,v=1/0;for(var y=[],b=void 0,w=0;w<i.length;++w){var C=i[w],x=C.marker;"bookmark"==x.type&&C.from==p&&x.widgetNode?y.push(x):C.from<=p&&(null==C.to||C.to>p||x.collapsed&&C.to==p&&C.from==p)?(null!=C.to&&C.to!=p&&v>C.to&&(v=C.to,c=""),x.className&&(l+=" "+x.className),x.css&&(s=(s?s+";":"")+x.css),x.startStyle&&C.from==p&&(u+=" "+x.startStyle),x.endStyle&&C.to==v&&(b||(b=[])).push(x.endStyle,C.to),x.title&&!h&&(h=x.title),x.collapsed&&(!d||ie(d.marker,x)<0)&&(d=C)):C.from>p&&v>C.from&&(v=C.from)}if(b)for(var k=0;k<b.length;k+=2)b[k+1]==v&&(c+=" "+b[k]);if(!d||d.from==p)for(var _=0;_<y.length;++_)vt(t,0,y[_]);if(d&&(d.from||0)==p){if(vt(t,(null==d.to?f+1:d.to)-p,d.marker,null==d.from),null==d.to)return;d.to==p&&(d=!1)}}if(p>=f)break;for(var A=Math.min(f,v);;){if(m){var S=p+m.length;if(!d){var T=S>A?m.slice(0,A-p):m;t.addToken(t,T,a?a+l:l,u,p+T.length==v?c:"",h,s)}if(S>=A){m=m.slice(A-p),p=A;break}p=S,u=""}m=r.slice(o,o=n[g++]),a=ht(n[g++],t.cm.options)}}else for(var L=1;L<n.length;L+=2)t.addToken(t,r.slice(o,o=n[L]),ht(n[L+1],t.cm.options))}function bt(e,t,n){this.line=t,this.rest=ce(t),this.size=this.rest?E(g(this.rest))-n+1:1,this.node=this.text=null,this.hidden=de(e,t)}function wt(e,t,n){for(var i,r=[],o=t;n>o;o=i){var a=new bt(e.doc,A(e.doc,o),o);i=o+a.size,r.push(a)}return r}function Ct(e){es?es.ops.push(e):e.ownsGroup=es={ops:[e],delayedCallbacks:[]}}function xt(e){var t=e.delayedCallbacks,n=0;do{for(;n<t.length;n++)t[n].call(null);for(var i=0;i<e.ops.length;i++){var r=e.ops[i];if(r.cursorActivityHandlers)for(;r.cursorActivityCalled<r.cursorActivityHandlers.length;)r.cursorActivityHandlers[r.cursorActivityCalled++].call(null,r.cm)}}while(n<t.length)}function kt(e,t){var n=e.ownsGroup;if(n)try{xt(n)}finally{es=null,t(n)}}function _t(e,t){var n=Le(e,t);if(n.length){var i,r=Array.prototype.slice.call(arguments,2);es?i=es.delayedCallbacks:ts?i=ts:(i=ts=[],setTimeout(At,0));for(var o=function(e){i.push(function(){return n[e].apply(null,r)})},a=0;a<n.length;++a)o(a)}}function At(){var e=ts;ts=null;for(var t=0;t<e.length;++t)e[t]()}function St(e,t,n,i){for(var r=0;r<t.changes.length;r++){var o=t.changes[r];"text"==o?Mt(e,t):"gutter"==o?Rt(e,t,n,i):"class"==o?Pt(t):"widget"==o&&It(e,t,i)}t.changes=null}function Tt(e){return e.node==e.text&&(e.node=i("div",null,null,"position: relative"),e.text.parentNode&&e.text.parentNode.replaceChild(e.node,e.text),e.node.appendChild(e.text),aa&&8>sa&&(e.node.style.zIndex=2)),e.node}function Lt(e){var t=e.bgClass?e.bgClass+" "+(e.line.bgClass||""):e.line.bgClass;if(t&&(t+=" CodeMirror-linebackground"),e.background)t?e.background.className=t:(e.background.parentNode.removeChild(e.background),e.background=null);else if(t){var n=Tt(e);e.background=n.insertBefore(i("div",null,t),n.firstChild)}}function Et(e,t){var n=e.display.externalMeasured;return n&&n.line==t.line?(e.display.externalMeasured=null,t.measure=n.measure,n.built):dt(e,t)}function Mt(e,t){var n=t.text.className,i=Et(e,t);t.text==t.node&&(t.node=i.pre),t.text.parentNode.replaceChild(i.pre,t.text),t.text=i.pre,i.bgClass!=t.bgClass||i.textClass!=t.textClass?(t.bgClass=i.bgClass,t.textClass=i.textClass,Pt(t)):n&&(t.text.className=n)}function Pt(e){Lt(e),e.line.wrapClass?Tt(e).className=e.line.wrapClass:e.node!=e.text&&(e.node.className="");var t=e.textClass?e.textClass+" "+(e.line.textClass||""):e.line.textClass;e.text.className=t||""}function Rt(e,t,n,r){if(t.gutter&&(t.node.removeChild(t.gutter),t.gutter=null),t.gutterBackground&&(t.node.removeChild(t.gutterBackground),t.gutterBackground=null),t.line.gutterClass){var o=Tt(t);t.gutterBackground=i("div",null,"CodeMirror-gutter-background "+t.line.gutterClass,"left: "+(e.options.fixedGutter?r.fixedPos:-r.gutterTotalWidth)+"px; width: "+r.gutterTotalWidth+"px"),o.insertBefore(t.gutterBackground,t.text)}var a=t.line.gutterMarkers;if(e.options.lineNumbers||a){var s=Tt(t),l=t.gutter=i("div",null,"CodeMirror-gutter-wrapper","left: "+(e.options.fixedGutter?r.fixedPos:-r.gutterTotalWidth)+"px");if(e.display.input.setUneditable(l),s.insertBefore(l,t.text),t.line.gutterClass&&(l.className+=" "+t.line.gutterClass),!e.options.lineNumbers||a&&a["CodeMirror-linenumbers"]||(t.lineNumber=l.appendChild(i("div",R(e.options,n),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+r.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+e.display.lineNumInnerWidth+"px"))),a)for(var c=0;c<e.options.gutters.length;++c){var u=e.options.gutters[c],h=a.hasOwnProperty(u)&&a[u];h&&l.appendChild(i("div",[h],"CodeMirror-gutter-elt","left: "+r.gutterLeft[u]+"px; width: "+r.gutterWidth[u]+"px"))}}}function It(e,t,n){t.alignable&&(t.alignable=null);for(var i=t.node.firstChild,r=void 0;i;i=r)r=i.nextSibling,"CodeMirror-linewidget"==i.className&&t.node.removeChild(i);Ot(e,t,n)}function $t(e,t,n,i){var r=Et(e,t);return t.text=t.node=r.pre,r.bgClass&&(t.bgClass=r.bgClass),r.textClass&&(t.textClass=r.textClass),Pt(t),Rt(e,t,n,i),Ot(e,t,i),t.node}function Ot(e,t,n){if(Dt(e,t.line,t,n,!0),t.rest)for(var i=0;i<t.rest.length;i++)Dt(e,t.rest[i],t,n,!1)}function Dt(e,t,n,r,o){if(t.widgets)for(var a=Tt(n),s=0,l=t.widgets;s<l.length;++s){var c=l[s],u=i("div",[c.node],"CodeMirror-linewidget");c.handleMouseEvents||u.setAttribute("cm-ignore-events","true"),Ft(c,u,n,r),e.display.input.setUneditable(u),o&&c.above?a.insertBefore(u,n.gutter||n.text):a.appendChild(u),_t(c,"redraw")}}function Ft(e,t,n,i){if(e.noHScroll){(n.alignable||(n.alignable=[])).push(t);var r=i.wrapperWidth;t.style.left=i.fixedPos+"px",e.coverGutter||(r-=i.gutterTotalWidth,t.style.paddingLeft=i.gutterTotalWidth+"px"),t.style.width=r+"px"}e.coverGutter&&(t.style.zIndex=5,t.style.position="relative",e.noHScroll||(t.style.marginLeft=-i.gutterTotalWidth+"px"))}function Nt(e){if(null!=e.height)return e.height;var t=e.doc.cm;if(!t)return 0;if(!r(document.body,e.node)){var o="position: relative;";e.coverGutter&&(o+="margin-left: -"+t.display.gutters.offsetWidth+"px;"),e.noHScroll&&(o+="width: "+t.display.wrapper.clientWidth+"px;"),n(t.display.measure,i("div",[e.node],null,o))}return e.height=e.node.parentNode.offsetHeight}function Wt(e,t){for(var n=We(t);n!=e.wrapper;n=n.parentNode)if(!n||1==n.nodeType&&"true"==n.getAttribute("cm-ignore-events")||n.parentNode==e.sizer&&n!=e.mover)return!0}function jt(e){return e.lineSpace.offsetTop}function Ht(e){return e.mover.offsetHeight-e.lineSpace.offsetHeight}function Bt(e){if(e.cachedPaddingH)return e.cachedPaddingH;var t=n(e.measure,i("pre","x")),r=window.getComputedStyle?window.getComputedStyle(t):t.currentStyle,o={left:parseInt(r.paddingLeft),right:parseInt(r.paddingRight)};return isNaN(o.left)||isNaN(o.right)||(e.cachedPaddingH=o),o}function Ut(e){return La-e.display.nativeBarWidth}function zt(e){return e.display.scroller.clientWidth-Ut(e)-e.display.barWidth}function Gt(e){return e.display.scroller.clientHeight-Ut(e)-e.display.barHeight}function qt(e,t,n){var i=e.options.lineWrapping,r=i&&zt(e);if(!t.measure.heights||i&&t.measure.width!=r){var o=t.measure.heights=[];if(i){t.measure.width=r;for(var a=t.text.firstChild.getClientRects(),s=0;s<a.length-1;s++){var l=a[s],c=a[s+1];Math.abs(l.bottom-c.bottom)>2&&o.push((l.bottom+c.top)/2-n.top)}}o.push(n.bottom-n.top)}}function Yt(e,t,n){if(e.line==t)return{map:e.measure.map,cache:e.measure.cache};for(var i=0;i<e.rest.length;i++)if(e.rest[i]==t)return{map:e.measure.maps[i],cache:e.measure.caches[i]};for(var r=0;r<e.rest.length;r++)if(E(e.rest[r])>n)return{map:e.measure.maps[r],cache:e.measure.caches[r],before:!0}}function Kt(e,t){t=le(t);var i=E(t),r=e.display.externalMeasured=new bt(e.doc,t,i);r.lineN=i;var o=r.built=dt(e,r);return r.text=o.pre,n(e.display.lineMeasure,o.pre),r}function Vt(e,t,n,i){return Qt(e,Jt(e,t),n,i)}function Xt(e,t){if(t>=e.display.viewFrom&&t<e.display.viewTo)return e.display.view[_n(e,t)];var n=e.display.externalMeasured;return n&&t>=n.lineN&&t<n.lineN+n.size?n:void 0}function Jt(e,t){var n=E(t),i=Xt(e,n);i&&!i.text?i=null:i&&i.changes&&(St(e,i,n,bn(e)),e.curOp.forceUpdate=!0),i||(i=Kt(e,t));var r=Yt(i,t,n);return{line:t,view:i,rect:null,map:r.map,cache:r.cache,before:r.before,hasHeights:!1}}function Qt(e,t,n,i,r){t.before&&(n=-1);var o,a=n+(i||"");return t.cache.hasOwnProperty(a)?o=t.cache[a]:(t.rect||(t.rect=t.view.text.getBoundingClientRect()),t.hasHeights||(qt(e,t.view,t.rect),t.hasHeights=!0),o=tn(e,t,n,i),o.bogus||(t.cache[a]=o)),{left:o.left,right:o.right,top:r?o.rtop:o.top,bottom:r?o.rbottom:o.bottom}}function Zt(e,t,n){for(var i,r,o,a,s,l,c=0;c<e.length;c+=3)if(s=e[c],l=e[c+1],s>t?(r=0,o=1,a="left"):l>t?(r=t-s,o=r+1):(c==e.length-3||t==l&&e[c+3]>t)&&(o=l-s,r=o-1,t>=l&&(a="right")),null!=r){if(i=e[c+2],s==l&&n==(i.insertLeft?"left":"right")&&(a=n),"left"==n&&0==r)for(;c&&e[c-2]==e[c-3]&&e[c-1].insertLeft;)i=e[(c-=3)+2],a="left";if("right"==n&&r==l-s)for(;c<e.length-3&&e[c+3]==e[c+4]&&!e[c+5].insertLeft;)i=e[(c+=3)+2],a="right";break}return{node:i,start:r,end:o,collapse:a,coverStart:s,coverEnd:l}}function en(e,t){var n=ns;if("left"==t)for(var i=0;i<e.length&&(n=e[i]).left==n.right;i++);else for(var r=e.length-1;r>=0&&(n=e[r]).left==n.right;r--);return n}function tn(e,t,n,i){var r,o=Zt(t.map,n,i),a=o.node,s=o.start,l=o.end,c=o.collapse;if(3==a.nodeType){for(var u=0;4>u;u++){for(;s&&k(t.line.text.charAt(o.coverStart+s));)--s;for(;o.coverStart+l<o.coverEnd&&k(t.line.text.charAt(o.coverStart+l));)++l;if(r=aa&&9>sa&&0==s&&l==o.coverEnd-o.coverStart?a.parentNode.getBoundingClientRect():en(Ca(a,s,l).getClientRects(),i),r.left||r.right||0==s)break;l=s,s-=1,c="right"}aa&&11>sa&&(r=nn(e.display.measure,r))}else{s>0&&(c=i="right");var h;r=e.options.lineWrapping&&(h=a.getClientRects()).length>1?h["right"==i?h.length-1:0]:a.getBoundingClientRect()}if(aa&&9>sa&&!s&&(!r||!r.left&&!r.right)){var d=a.parentNode.getClientRects()[0];r=d?{left:d.left,right:d.left+yn(e.display),top:d.top,bottom:d.bottom}:ns}for(var f=r.top-t.rect.top,p=r.bottom-t.rect.top,g=(f+p)/2,m=t.view.measure.heights,v=0;v<m.length-1&&!(g<m[v]);v++);var y=v?m[v-1]:0,b=m[v],w={left:("right"==c?r.right:r.left)-t.rect.left,right:("left"==c?r.left:r.right)-t.rect.left,top:y,bottom:b};return r.left||r.right||(w.bogus=!0),e.options.singleCursorHeightPerLine||(w.rtop=f,
w.rbottom=p),w}function nn(e,t){if(!window.screen||null==screen.logicalXDPI||screen.logicalXDPI==screen.deviceXDPI||!Ue(e))return t;var n=screen.logicalXDPI/screen.deviceXDPI,i=screen.logicalYDPI/screen.deviceYDPI;return{left:t.left*n,right:t.right*n,top:t.top*i,bottom:t.bottom*i}}function rn(e){if(e.measure&&(e.measure.cache={},e.measure.heights=null,e.rest))for(var t=0;t<e.rest.length;t++)e.measure.caches[t]={}}function on(e){e.display.externalMeasure=null,t(e.display.lineMeasure);for(var n=0;n<e.display.view.length;n++)rn(e.display.view[n])}function an(e){on(e),e.display.cachedCharWidth=e.display.cachedTextHeight=e.display.cachedPaddingH=null,e.options.lineWrapping||(e.display.maxLineChanged=!0),e.display.lineNumChars=null}function sn(){return window.pageXOffset||(document.documentElement||document.body).scrollLeft}function ln(){return window.pageYOffset||(document.documentElement||document.body).scrollTop}function cn(e,t,n,i,r){if(!r&&t.widgets)for(var o=0;o<t.widgets.length;++o)if(t.widgets[o].above){var a=Nt(t.widgets[o]);n.top+=a,n.bottom+=a}if("line"==i)return n;i||(i="local");var s=pe(t);if("local"==i?s+=jt(e.display):s-=e.display.viewOffset,"page"==i||"window"==i){var l=e.display.lineSpace.getBoundingClientRect();s+=l.top+("window"==i?0:ln());var c=l.left+("window"==i?0:sn());n.left+=c,n.right+=c}return n.top+=s,n.bottom+=s,n}function un(e,t,n){if("div"==n)return t;var i=t.left,r=t.top;if("page"==n)i-=sn(),r-=ln();else if("local"==n||!n){var o=e.display.sizer.getBoundingClientRect();i+=o.left,r+=o.top}var a=e.display.lineSpace.getBoundingClientRect();return{left:i-a.left,top:r-a.top}}function hn(e,t,n,i,r){return i||(i=A(e.doc,t.line)),cn(e,i,Vt(e,i,t.ch,r),n)}function dn(e,t,n,i,r,o){function a(t,a){var s=Qt(e,r,t,a?"right":"left",o);return a?s.left=s.right:s.right=s.left,cn(e,i,s,n)}function s(e,t){var n=l[t],i=n.level%2;return e==ye(n)&&t&&n.level<l[t-1].level?(n=l[--t],e=be(n)-(n.level%2?0:1),i=!0):e==be(n)&&t<l.length-1&&n.level<l[t+1].level&&(n=l[++t],e=ye(n)-n.level%2,i=!1),i&&e==n.to&&e>n.from?a(e-1):a(e,i)}i=i||A(e.doc,t.line),r||(r=Jt(e,i));var l=Te(i),c=t.ch;if(!l)return a(c);var u=ke(l,c),h=s(c,u);return null!=Na&&(h.other=s(c,Na)),h}function fn(e,t){var n=0;t=W(e.doc,t),e.options.lineWrapping||(n=yn(e.display)*t.ch);var i=A(e.doc,t.line),r=pe(i)+jt(e.display);return{left:n,right:n,top:r,bottom:r+i.height}}function pn(e,t,n,i){var r=I(e,t);return r.xRel=i,n&&(r.outside=!0),r}function gn(e,t,n){var i=e.doc;if(n+=e.display.viewOffset,0>n)return pn(i.first,0,!0,-1);var r=M(i,n),o=i.first+i.size-1;if(r>o)return pn(i.first+i.size-1,A(i,o).text.length,!0,1);0>t&&(t=0);for(var a=A(i,r);;){var s=mn(e,a,r,t,n),l=ae(a),c=l&&l.find(0,!0);if(!l||!(s.ch>c.from.ch||s.ch==c.from.ch&&s.xRel>0))return s;r=E(a=c.to.line)}}function mn(e,t,n,i,r){function o(i){var r=dn(e,I(n,i),"line",t,c);return s=!0,a>r.bottom?r.left-l:a<r.top?r.left+l:(s=!1,r.left)}var a=r-pe(t),s=!1,l=2*e.display.wrapper.clientWidth,c=Jt(e,t),u=Te(t),h=t.text.length,d=we(t),f=Ce(t),p=o(d),g=s,m=o(f),v=s;if(i>m)return pn(n,f,v,1);for(;;){if(u?f==d||f==Ae(t,d,1):1>=f-d){var y=p>i||m-i>=i-p?d:f,b=y==d?g:v,w=i-(y==d?p:m);if(v&&!u&&!/\s/.test(t.text.charAt(y))&&w>0&&y<t.text.length&&c.view.measure.heights.length>1){var C=Qt(e,c,y,"right");a<=C.bottom&&a>=C.top&&Math.abs(i-C.right)<w&&(b=!1,y++,w=i-C.right)}for(;k(t.text.charAt(y));)++y;var x=pn(n,y,b,-1>w?-1:w>1?1:0);return x}var _=Math.ceil(h/2),A=d+_;if(u){A=d;for(var S=0;_>S;++S)A=Ae(t,A,1)}var T=o(A);T>i?(f=A,m=T,(v=s)&&(m+=1e3),h=_):(d=A,p=T,g=s,h-=_)}}function vn(e){if(null!=e.cachedTextHeight)return e.cachedTextHeight;if(null==Ja){Ja=i("pre");for(var r=0;49>r;++r)Ja.appendChild(document.createTextNode("x")),Ja.appendChild(i("br"));Ja.appendChild(document.createTextNode("x"))}n(e.measure,Ja);var o=Ja.offsetHeight/50;return o>3&&(e.cachedTextHeight=o),t(e.measure),o||1}function yn(e){if(null!=e.cachedCharWidth)return e.cachedCharWidth;var t=i("span","xxxxxxxxxx"),r=i("pre",[t]);n(e.measure,r);var o=t.getBoundingClientRect(),a=(o.right-o.left)/10;return a>2&&(e.cachedCharWidth=a),a||10}function bn(e){for(var t=e.display,n={},i={},r=t.gutters.clientLeft,o=t.gutters.firstChild,a=0;o;o=o.nextSibling,++a)n[e.options.gutters[a]]=o.offsetLeft+o.clientLeft+r,i[e.options.gutters[a]]=o.clientWidth;return{fixedPos:wn(t),gutterTotalWidth:t.gutters.offsetWidth,gutterLeft:n,gutterWidth:i,wrapperWidth:t.wrapper.clientWidth}}function wn(e){return e.scroller.getBoundingClientRect().left-e.sizer.getBoundingClientRect().left}function Cn(e){var t=vn(e.display),n=e.options.lineWrapping,i=n&&Math.max(5,e.display.scroller.clientWidth/yn(e.display)-3);return function(r){if(de(e.doc,r))return 0;var o=0;if(r.widgets)for(var a=0;a<r.widgets.length;a++)r.widgets[a].height&&(o+=r.widgets[a].height);return n?o+(Math.ceil(r.text.length/i)||1)*t:o+t}}function xn(e){var t=e.doc,n=Cn(e);t.iter(function(e){var t=n(e);t!=e.height&&L(e,t)})}function kn(e,t,n,i){var r=e.display;if(!n&&"true"==We(t).getAttribute("cm-not-content"))return null;var o,a,s=r.lineSpace.getBoundingClientRect();try{o=t.clientX-s.left,a=t.clientY-s.top}catch(t){return null}var l,c=gn(e,o,a);if(i&&1==c.xRel&&(l=A(e.doc,c.line).text).length==c.ch){var h=u(l,l.length,e.options.tabSize)-l.length;c=I(c.line,Math.max(0,Math.round((o-Bt(e.display).left)/yn(e.display))-h))}return c}function _n(e,t){if(t>=e.display.viewTo)return null;if(t-=e.display.viewFrom,0>t)return null;for(var n=e.display.view,i=0;i<n.length;i++)if(t-=n[i].size,0>t)return i}function An(e){e.display.input.showSelection(e.display.input.prepareSelection())}function Sn(e,t){for(var n=e.doc,i={},r=i.cursors=document.createDocumentFragment(),o=i.selection=document.createDocumentFragment(),a=0;a<n.sel.ranges.length;a++)if(t!==!1||a!=n.sel.primIndex){var s=n.sel.ranges[a];if(!(s.from().line>=e.display.viewTo||s.to().line<e.display.viewFrom)){var l=s.empty();(l||e.options.showCursorWhenSelecting)&&Tn(e,s.head,r),l||Ln(e,s,o)}}return i}function Tn(e,t,n){var r=dn(e,t,"div",null,null,!e.options.singleCursorHeightPerLine),o=n.appendChild(i("div","\xa0","CodeMirror-cursor"));if(o.style.left=r.left+"px",o.style.top=r.top+"px",o.style.height=Math.max(0,r.bottom-r.top)*e.options.cursorHeight+"px",r.other){var a=n.appendChild(i("div","\xa0","CodeMirror-cursor CodeMirror-secondarycursor"));a.style.display="",a.style.left=r.other.left+"px",a.style.top=r.other.top+"px",a.style.height=.85*(r.other.bottom-r.other.top)+"px"}}function Ln(e,t,n){function r(e,t,n,r){0>t&&(t=0),t=Math.round(t),r=Math.round(r),l.appendChild(i("div",null,"CodeMirror-selected","position: absolute; left: "+e+"px;\n                             top: "+t+"px; width: "+(null==n?h-e:n)+"px;\n                             height: "+(r-t)+"px"))}function o(t,n,i){function o(n,i){return hn(e,I(t,n),"div",c,i)}var a,l,c=A(s,t),d=c.text.length;return ve(Te(c),n||0,null==i?d:i,function(e,t,s){var c,f,p,g=o(e,"left");if(e==t)c=g,f=p=g.left;else{if(c=o(t-1,"right"),"rtl"==s){var m=g;g=c,c=m}f=g.left,p=c.right}null==n&&0==e&&(f=u),c.top-g.top>3&&(r(f,g.top,null,g.bottom),f=u,g.bottom<c.top&&r(f,g.bottom,null,c.top)),null==i&&t==d&&(p=h),(!a||g.top<a.top||g.top==a.top&&g.left<a.left)&&(a=g),(!l||c.bottom>l.bottom||c.bottom==l.bottom&&c.right>l.right)&&(l=c),u+1>f&&(f=u),r(f,c.top,p-f,c.bottom)}),{start:a,end:l}}var a=e.display,s=e.doc,l=document.createDocumentFragment(),c=Bt(e.display),u=c.left,h=Math.max(a.sizerWidth,zt(e)-a.sizer.offsetLeft)-c.right,d=t.from(),f=t.to();if(d.line==f.line)o(d.line,d.ch,f.ch);else{var p=A(s,d.line),g=A(s,f.line),m=le(p)==le(g),v=o(d.line,d.ch,m?p.text.length+1:null).end,y=o(f.line,m?0:null,f.ch).start;m&&(v.top<y.top-2?(r(v.right,v.top,null,v.bottom),r(u,y.top,y.left,y.bottom)):r(v.right,v.top,y.left-v.right,v.bottom)),v.bottom<y.top&&r(u,v.bottom,null,y.top)}n.appendChild(l)}function En(e){if(e.state.focused){var t=e.display;clearInterval(t.blinker);var n=!0;t.cursorDiv.style.visibility="",e.options.cursorBlinkRate>0?t.blinker=setInterval(function(){return t.cursorDiv.style.visibility=(n=!n)?"":"hidden"},e.options.cursorBlinkRate):e.options.cursorBlinkRate<0&&(t.cursorDiv.style.visibility="hidden")}}function Mn(e){e.state.focused||(e.display.input.focus(),Rn(e))}function Pn(e){e.state.delayingBlurEvent=!0,setTimeout(function(){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1,In(e))},100)}function Rn(e,t){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1),"nocursor"!=e.options.readOnly&&(e.state.focused||(Me(e,"focus",e,t),e.state.focused=!0,a(e.display.wrapper,"CodeMirror-focused"),e.curOp||e.display.selForContextMenu==e.doc.sel||(e.display.input.reset(),la&&setTimeout(function(){return e.display.input.reset(!0)},20)),e.display.input.receivedFocus()),En(e))}function In(e,t){e.state.delayingBlurEvent||(e.state.focused&&(Me(e,"blur",e,t),e.state.focused=!1,_a(e.display.wrapper,"CodeMirror-focused")),clearInterval(e.display.blinker),setTimeout(function(){e.state.focused||(e.display.shift=!1)},150))}function $n(e){var t=e.display,n=t.view;if(t.alignWidgets||t.gutters.firstChild&&e.options.fixedGutter){for(var i=wn(t)-t.scroller.scrollLeft+e.doc.scrollLeft,r=t.gutters.offsetWidth,o=i+"px",a=0;a<n.length;a++)if(!n[a].hidden){e.options.fixedGutter&&(n[a].gutter&&(n[a].gutter.style.left=o),n[a].gutterBackground&&(n[a].gutterBackground.style.left=o));var s=n[a].alignable;if(s)for(var l=0;l<s.length;l++)s[l].style.left=o}e.options.fixedGutter&&(t.gutters.style.left=i+r+"px")}}function On(e){if(!e.options.lineNumbers)return!1;var t=e.doc,n=R(e.options,t.first+t.size-1),r=e.display;if(n.length!=r.lineNumChars){var o=r.measure.appendChild(i("div",[i("div",n)],"CodeMirror-linenumber CodeMirror-gutter-elt")),a=o.firstChild.offsetWidth,s=o.offsetWidth-a;return r.lineGutter.style.width="",r.lineNumInnerWidth=Math.max(a,r.lineGutter.offsetWidth-s)+1,r.lineNumWidth=r.lineNumInnerWidth+s,r.lineNumChars=r.lineNumInnerWidth?n.length:-1,r.lineGutter.style.width=r.lineNumWidth+"px",Ei(e),!0}return!1}function Dn(e){for(var t=e.display,n=t.lineDiv.offsetTop,i=0;i<t.view.length;i++){var r=t.view[i],o=void 0;if(!r.hidden){if(aa&&8>sa){var a=r.node.offsetTop+r.node.offsetHeight;o=a-n,n=a}else{var s=r.node.getBoundingClientRect();o=s.bottom-s.top}var l=r.line.height-o;if(2>o&&(o=vn(t)),(l>.001||-.001>l)&&(L(r.line,o),Fn(r.line),r.rest))for(var c=0;c<r.rest.length;c++)Fn(r.rest[c])}}}function Fn(e){if(e.widgets)for(var t=0;t<e.widgets.length;++t)e.widgets[t].height=e.widgets[t].node.parentNode.offsetHeight}function Nn(e,t,n){var i=n&&null!=n.top?Math.max(0,n.top):e.scroller.scrollTop;i=Math.floor(i-jt(e));var r=n&&null!=n.bottom?n.bottom:i+e.wrapper.clientHeight,o=M(t,i),a=M(t,r);if(n&&n.ensure){var s=n.ensure.from.line,l=n.ensure.to.line;o>s?(o=s,a=M(t,pe(A(t,s))+e.wrapper.clientHeight)):Math.min(l,t.lastLine())>=a&&(o=M(t,pe(A(t,l))-e.wrapper.clientHeight),a=l)}return{from:o,to:Math.max(a,o+1)}}function Wn(e,t){Math.abs(e.doc.scrollTop-t)<2||(e.doc.scrollTop=t,ia||Ti(e,{top:t}),e.display.scroller.scrollTop!=t&&(e.display.scroller.scrollTop=t),e.display.scrollbars.setScrollTop(t),ia&&Ti(e),Ci(e,100))}function jn(e,t,n){(n?t==e.doc.scrollLeft:Math.abs(e.doc.scrollLeft-t)<2)||(t=Math.min(t,e.display.scroller.scrollWidth-e.display.scroller.clientWidth),e.doc.scrollLeft=t,$n(e),e.display.scroller.scrollLeft!=t&&(e.display.scroller.scrollLeft=t),e.display.scrollbars.setScrollLeft(t))}function Hn(e){var t=e.wheelDeltaX,n=e.wheelDeltaY;return null==t&&e.detail&&e.axis==e.HORIZONTAL_AXIS&&(t=e.detail),null==n&&e.detail&&e.axis==e.VERTICAL_AXIS?n=e.detail:null==n&&(n=e.wheelDelta),{x:t,y:n}}function Bn(e){var t=Hn(e);return t.x*=rs,t.y*=rs,t}function Un(e,t){var n=Hn(t),i=n.x,r=n.y,o=e.display,a=o.scroller,s=a.scrollWidth>a.clientWidth,l=a.scrollHeight>a.clientHeight;if(i&&s||r&&l){if(r&&va&&la)e:for(var c=t.target,u=o.view;c!=a;c=c.parentNode)for(var h=0;h<u.length;h++)if(u[h].node==c){e.display.currentWheelTarget=c;break e}if(i&&!ia&&!ha&&null!=rs)return r&&l&&Wn(e,Math.max(0,Math.min(a.scrollTop+r*rs,a.scrollHeight-a.clientHeight))),jn(e,Math.max(0,Math.min(a.scrollLeft+i*rs,a.scrollWidth-a.clientWidth))),(!r||r&&l)&&Oe(t),void(o.wheelStartX=null);if(r&&null!=rs){var d=r*rs,f=e.doc.scrollTop,p=f+o.wrapper.clientHeight;0>d?f=Math.max(0,f+d-50):p=Math.min(e.doc.height,p+d+50),Ti(e,{top:f,bottom:p})}20>is&&(null==o.wheelStartX?(o.wheelStartX=a.scrollLeft,o.wheelStartY=a.scrollTop,o.wheelDX=i,o.wheelDY=r,setTimeout(function(){if(null!=o.wheelStartX){var e=a.scrollLeft-o.wheelStartX,t=a.scrollTop-o.wheelStartY,n=t&&o.wheelDY&&t/o.wheelDY||e&&o.wheelDX&&e/o.wheelDX;o.wheelStartX=o.wheelStartY=null,n&&(rs=(rs*is+n)/(is+1),++is)}},200)):(o.wheelDX+=i,o.wheelDY+=r))}}function zn(e){var t=e.display,n=t.gutters.offsetWidth,i=Math.round(e.doc.height+Ht(e.display));return{clientHeight:t.scroller.clientHeight,viewHeight:t.wrapper.clientHeight,scrollWidth:t.scroller.scrollWidth,clientWidth:t.scroller.clientWidth,viewWidth:t.wrapper.clientWidth,barLeft:e.options.fixedGutter?n:0,docHeight:i,scrollHeight:i+Ut(e)+t.barHeight,nativeBarWidth:t.nativeBarWidth,gutterWidth:n}}function Gn(e,t,n){this.cm=n;var r=this.vert=i("div",[i("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),o=this.horiz=i("div",[i("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");e(r),e(o),Ha(r,"scroll",function(){r.clientHeight&&t(r.scrollTop,"vertical")}),Ha(o,"scroll",function(){o.clientWidth&&t(o.scrollLeft,"horizontal")}),this.checkedZeroWidth=!1,aa&&8>sa&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")}function qn(){}function Yn(e,t){t||(t=zn(e));var n=e.display.barWidth,i=e.display.barHeight;Kn(e,t);for(var r=0;4>r&&n!=e.display.barWidth||i!=e.display.barHeight;r++)n!=e.display.barWidth&&e.options.lineWrapping&&Dn(e),Kn(e,zn(e)),n=e.display.barWidth,i=e.display.barHeight}function Kn(e,t){var n=e.display,i=n.scrollbars.update(t);n.sizer.style.paddingRight=(n.barWidth=i.right)+"px",n.sizer.style.paddingBottom=(n.barHeight=i.bottom)+"px",n.heightForcer.style.borderBottom=i.bottom+"px solid transparent",i.right&&i.bottom?(n.scrollbarFiller.style.display="block",n.scrollbarFiller.style.height=i.bottom+"px",n.scrollbarFiller.style.width=i.right+"px"):n.scrollbarFiller.style.display="",i.bottom&&e.options.coverGutterNextToScrollbar&&e.options.fixedGutter?(n.gutterFiller.style.display="block",n.gutterFiller.style.height=i.bottom+"px",n.gutterFiller.style.width=t.gutterWidth+"px"):n.gutterFiller.style.display=""}function Vn(e){e.display.scrollbars&&(e.display.scrollbars.clear(),e.display.scrollbars.addClass&&_a(e.display.wrapper,e.display.scrollbars.addClass)),e.display.scrollbars=new os[e.options.scrollbarStyle](function(t){e.display.wrapper.insertBefore(t,e.display.scrollbarFiller),Ha(t,"mousedown",function(){e.state.focused&&setTimeout(function(){return e.display.input.focus()},0)}),t.setAttribute("cm-not-content","true")},function(t,n){"horizontal"==n?jn(e,t):Wn(e,t)},e),e.display.scrollbars.addClass&&a(e.display.wrapper,e.display.scrollbars.addClass)}function Xn(e,t){if(!Pe(e,"scrollCursorIntoView")){var n=e.display,r=n.sizer.getBoundingClientRect(),o=null;if(t.top+r.top<0?o=!0:t.bottom+r.top>(window.innerHeight||document.documentElement.clientHeight)&&(o=!1),null!=o&&!pa){var a=i("div","\u200b",null,"position: absolute;\n                         top: "+(t.top-n.viewOffset-jt(e.display))+"px;\n                         height: "+(t.bottom-t.top+Ut(e)+n.barHeight)+"px;\n                         left: "+t.left+"px; width: 2px;");e.display.lineSpace.appendChild(a),a.scrollIntoView(o),e.display.lineSpace.removeChild(a)}}}function Jn(e,t,n,i){null==i&&(i=0);for(var r,o=0;5>o;o++){var a=!1;r=dn(e,t);var s=n&&n!=t?dn(e,n):r,l=Zn(e,Math.min(r.left,s.left),Math.min(r.top,s.top)-i,Math.max(r.left,s.left),Math.max(r.bottom,s.bottom)+i),c=e.doc.scrollTop,u=e.doc.scrollLeft;if(null!=l.scrollTop&&(Wn(e,l.scrollTop),Math.abs(e.doc.scrollTop-c)>1&&(a=!0)),null!=l.scrollLeft&&(jn(e,l.scrollLeft),Math.abs(e.doc.scrollLeft-u)>1&&(a=!0)),!a)break}return r}function Qn(e,t,n,i,r){var o=Zn(e,t,n,i,r);null!=o.scrollTop&&Wn(e,o.scrollTop),null!=o.scrollLeft&&jn(e,o.scrollLeft)}function Zn(e,t,n,i,r){var o=e.display,a=vn(e.display);0>n&&(n=0);var s=e.curOp&&null!=e.curOp.scrollTop?e.curOp.scrollTop:o.scroller.scrollTop,l=Gt(e),c={};r-n>l&&(r=n+l);var u=e.doc.height+Ht(o),h=a>n,d=r>u-a;if(s>n)c.scrollTop=h?0:n;else if(r>s+l){var f=Math.min(n,(d?u:r)-l);f!=s&&(c.scrollTop=f)}var p=e.curOp&&null!=e.curOp.scrollLeft?e.curOp.scrollLeft:o.scroller.scrollLeft,g=zt(e)-(e.options.fixedGutter?o.gutters.offsetWidth:0),m=i-t>g;return m&&(i=t+g),10>t?c.scrollLeft=0:p>t?c.scrollLeft=Math.max(0,t-(m?0:10)):i>g+p-3&&(c.scrollLeft=i+(m?0:10)-g),c}function ei(e,t,n){null==t&&null==n||ni(e),null!=t&&(e.curOp.scrollLeft=(null==e.curOp.scrollLeft?e.doc.scrollLeft:e.curOp.scrollLeft)+t),null!=n&&(e.curOp.scrollTop=(null==e.curOp.scrollTop?e.doc.scrollTop:e.curOp.scrollTop)+n)}function ti(e){ni(e);var t=e.getCursor(),n=t,i=t;e.options.lineWrapping||(n=t.ch?I(t.line,t.ch-1):t,i=I(t.line,t.ch+1)),e.curOp.scrollToPos={from:n,to:i,margin:e.options.cursorScrollMargin,isCursor:!0}}function ni(e){var t=e.curOp.scrollToPos;if(t){e.curOp.scrollToPos=null;var n=fn(e,t.from),i=fn(e,t.to),r=Zn(e,Math.min(n.left,i.left),Math.min(n.top,i.top)-t.margin,Math.max(n.right,i.right),Math.max(n.bottom,i.bottom)+t.margin);e.scrollTo(r.scrollLeft,r.scrollTop)}}function ii(e){e.curOp={cm:e,viewChanged:!1,startHeight:e.doc.height,forceUpdate:!1,updateInput:null,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++as},Ct(e.curOp)}function ri(e){var t=e.curOp;kt(t,function(e){for(var t=0;t<e.ops.length;t++)e.ops[t].cm.curOp=null;oi(e)})}function oi(e){for(var t=e.ops,n=0;n<t.length;n++)ai(t[n]);for(var i=0;i<t.length;i++)si(t[i]);for(var r=0;r<t.length;r++)li(t[r]);for(var o=0;o<t.length;o++)ci(t[o]);for(var a=0;a<t.length;a++)ui(t[a])}function ai(e){var t=e.cm,n=t.display;_i(t),e.updateMaxLine&&me(t),e.mustUpdate=e.viewChanged||e.forceUpdate||null!=e.scrollTop||e.scrollToPos&&(e.scrollToPos.from.line<n.viewFrom||e.scrollToPos.to.line>=n.viewTo)||n.maxLineChanged&&t.options.lineWrapping,e.update=e.mustUpdate&&new ki(t,e.mustUpdate&&{top:e.scrollTop,ensure:e.scrollToPos},e.forceUpdate)}function si(e){e.updatedDisplay=e.mustUpdate&&Ai(e.cm,e.update)}function li(e){var t=e.cm,n=t.display;e.updatedDisplay&&Dn(t),e.barMeasure=zn(t),n.maxLineChanged&&!t.options.lineWrapping&&(e.adjustWidthTo=Vt(t,n.maxLine,n.maxLine.text.length).left+3,t.display.sizerWidth=e.adjustWidthTo,e.barMeasure.scrollWidth=Math.max(n.scroller.clientWidth,n.sizer.offsetLeft+e.adjustWidthTo+Ut(t)+t.display.barWidth),e.maxScrollLeft=Math.max(0,n.sizer.offsetLeft+e.adjustWidthTo-zt(t))),(e.updatedDisplay||e.selectionChanged)&&(e.preparedSelection=n.input.prepareSelection(e.focus))}function ci(e){var t=e.cm;null!=e.adjustWidthTo&&(t.display.sizer.style.minWidth=e.adjustWidthTo+"px",e.maxScrollLeft<t.doc.scrollLeft&&jn(t,Math.min(t.display.scroller.scrollLeft,e.maxScrollLeft),!0),t.display.maxLineChanged=!1);var n=e.focus&&e.focus==o()&&(!document.hasFocus||document.hasFocus());e.preparedSelection&&t.display.input.showSelection(e.preparedSelection,n),(e.updatedDisplay||e.startHeight!=t.doc.height)&&Yn(t,e.barMeasure),e.updatedDisplay&&Mi(t,e.barMeasure),e.selectionChanged&&En(t),t.state.focused&&e.updateInput&&t.display.input.reset(e.typing),n&&Mn(e.cm)}function ui(e){var t=e.cm,n=t.display,i=t.doc;if(e.updatedDisplay&&Si(t,e.update),null==n.wheelStartX||null==e.scrollTop&&null==e.scrollLeft&&!e.scrollToPos||(n.wheelStartX=n.wheelStartY=null),null==e.scrollTop||n.scroller.scrollTop==e.scrollTop&&!e.forceScroll||(i.scrollTop=Math.max(0,Math.min(n.scroller.scrollHeight-n.scroller.clientHeight,e.scrollTop)),n.scrollbars.setScrollTop(i.scrollTop),n.scroller.scrollTop=i.scrollTop),null==e.scrollLeft||n.scroller.scrollLeft==e.scrollLeft&&!e.forceScroll||(i.scrollLeft=Math.max(0,Math.min(n.scroller.scrollWidth-n.scroller.clientWidth,e.scrollLeft)),n.scrollbars.setScrollLeft(i.scrollLeft),n.scroller.scrollLeft=i.scrollLeft,$n(t)),e.scrollToPos){var r=Jn(t,W(i,e.scrollToPos.from),W(i,e.scrollToPos.to),e.scrollToPos.margin);e.scrollToPos.isCursor&&t.state.focused&&Xn(t,r)}var o=e.maybeHiddenMarkers,a=e.maybeUnhiddenMarkers;if(o)for(var s=0;s<o.length;++s)o[s].lines.length||Me(o[s],"hide");if(a)for(var l=0;l<a.length;++l)a[l].lines.length&&Me(a[l],"unhide");n.wrapper.offsetHeight&&(i.scrollTop=t.display.scroller.scrollTop),e.changeObjs&&Me(t,"changes",t,e.changeObjs),e.update&&e.update.finish()}function hi(e,t){if(e.curOp)return t();ii(e);try{return t()}finally{ri(e)}}function di(e,t){return function(){if(e.curOp)return t.apply(e,arguments);ii(e);try{return t.apply(e,arguments)}finally{ri(e)}}}function fi(e){return function(){if(this.curOp)return e.apply(this,arguments);ii(this);try{return e.apply(this,arguments)}finally{ri(this)}}}function pi(e){return function(){var t=this.cm;if(!t||t.curOp)return e.apply(this,arguments);ii(t);try{return e.apply(this,arguments)}finally{ri(t)}}}function gi(e,t,n,i){null==t&&(t=e.doc.first),null==n&&(n=e.doc.first+e.doc.size),i||(i=0);var r=e.display;if(i&&n<r.viewTo&&(null==r.updateLineNumbers||r.updateLineNumbers>t)&&(r.updateLineNumbers=t),e.curOp.viewChanged=!0,t>=r.viewTo)Fa&&ue(e.doc,t)<r.viewTo&&vi(e);else if(n<=r.viewFrom)Fa&&he(e.doc,n+i)>r.viewFrom?vi(e):(r.viewFrom+=i,r.viewTo+=i);else if(t<=r.viewFrom&&n>=r.viewTo)vi(e);else if(t<=r.viewFrom){var o=yi(e,n,n+i,1);o?(r.view=r.view.slice(o.index),r.viewFrom=o.lineN,r.viewTo+=i):vi(e)}else if(n>=r.viewTo){var a=yi(e,t,t,-1);a?(r.view=r.view.slice(0,a.index),r.viewTo=a.lineN):vi(e)}else{var s=yi(e,t,t,-1),l=yi(e,n,n+i,1);s&&l?(r.view=r.view.slice(0,s.index).concat(wt(e,s.lineN,l.lineN)).concat(r.view.slice(l.index)),r.viewTo+=i):vi(e)}var c=r.externalMeasured;c&&(n<c.lineN?c.lineN+=i:t<c.lineN+c.size&&(r.externalMeasured=null))}function mi(e,t,n){e.curOp.viewChanged=!0;var i=e.display,r=e.display.externalMeasured;if(r&&t>=r.lineN&&t<r.lineN+r.size&&(i.externalMeasured=null),!(t<i.viewFrom||t>=i.viewTo)){var o=i.view[_n(e,t)];if(null!=o.node){var a=o.changes||(o.changes=[]);-1==d(a,n)&&a.push(n)}}}function vi(e){e.display.viewFrom=e.display.viewTo=e.doc.first,e.display.view=[],e.display.viewOffset=0}function yi(e,t,n,i){var r,o=_n(e,t),a=e.display.view;if(!Fa||n==e.doc.first+e.doc.size)return{index:o,lineN:n};for(var s=e.display.viewFrom,l=0;o>l;l++)s+=a[l].size;if(s!=t){if(i>0){if(o==a.length-1)return null;r=s+a[o].size-t,o++}else r=s-t;t+=r,n+=r}for(;ue(e.doc,n)!=n;){if(o==(0>i?0:a.length-1))return null;n+=i*a[o-(0>i?1:0)].size,o+=i}return{index:o,lineN:n}}function bi(e,t,n){var i=e.display,r=i.view;0==r.length||t>=i.viewTo||n<=i.viewFrom?(i.view=wt(e,t,n),i.viewFrom=t):(i.viewFrom>t?i.view=wt(e,t,i.viewFrom).concat(i.view):i.viewFrom<t&&(i.view=i.view.slice(_n(e,t))),i.viewFrom=t,i.viewTo<n?i.view=i.view.concat(wt(e,i.viewTo,n)):i.viewTo>n&&(i.view=i.view.slice(0,_n(e,n)))),i.viewTo=n}function wi(e){for(var t=e.display.view,n=0,i=0;i<t.length;i++){var r=t[i];r.hidden||r.node&&!r.changes||++n}return n}function Ci(e,t){e.doc.mode.startState&&e.doc.frontier<e.display.viewTo&&e.state.highlight.set(t,l(xi,e))}function xi(e){var t=e.doc;if(t.frontier<t.first&&(t.frontier=t.first),!(t.frontier>=e.display.viewTo)){var n=+new Date+e.options.workTime,i=Ve(t.mode,et(e,t.frontier)),r=[];t.iter(t.frontier,Math.min(t.first+t.size,e.display.viewTo+500),function(o){if(t.frontier>=e.display.viewFrom){var a=o.styles,s=o.text.length>e.options.maxHighlightLength,l=Qe(e,o,s?Ve(t.mode,i):i,!0);o.styles=l.styles;var c=o.styleClasses,u=l.classes;u?o.styleClasses=u:c&&(o.styleClasses=null);for(var h=!a||a.length!=o.styles.length||c!=u&&(!c||!u||c.bgClass!=u.bgClass||c.textClass!=u.textClass),d=0;!h&&d<a.length;++d)h=a[d]!=o.styles[d];h&&r.push(t.frontier),o.stateAfter=s?i:Ve(t.mode,i)}else o.text.length<=e.options.maxHighlightLength&&tt(e,o.text,i),o.stateAfter=t.frontier%5==0?Ve(t.mode,i):null;return++t.frontier,+new Date>n?(Ci(e,e.options.workDelay),!0):void 0}),r.length&&hi(e,function(){for(var t=0;t<r.length;t++)mi(e,r[t],"text")})}}function ki(e,t,n){var i=e.display;this.viewport=t,this.visible=Nn(i,e.doc,t),this.editorIsHidden=!i.wrapper.offsetWidth,this.wrapperHeight=i.wrapper.clientHeight,this.wrapperWidth=i.wrapper.clientWidth,this.oldDisplayWidth=zt(e),this.force=n,this.dims=bn(e),this.events=[]}function _i(e){var t=e.display;!t.scrollbarsClipped&&t.scroller.offsetWidth&&(t.nativeBarWidth=t.scroller.offsetWidth-t.scroller.clientWidth,t.heightForcer.style.height=Ut(e)+"px",t.sizer.style.marginBottom=-t.nativeBarWidth+"px",t.sizer.style.borderRightWidth=Ut(e)+"px",t.scrollbarsClipped=!0)}function Ai(e,n){var i=e.display,r=e.doc;if(n.editorIsHidden)return vi(e),!1;if(!n.force&&n.visible.from>=i.viewFrom&&n.visible.to<=i.viewTo&&(null==i.updateLineNumbers||i.updateLineNumbers>=i.viewTo)&&i.renderedView==i.view&&0==wi(e))return!1;On(e)&&(vi(e),n.dims=bn(e));var a=r.first+r.size,s=Math.max(n.visible.from-e.options.viewportMargin,r.first),l=Math.min(a,n.visible.to+e.options.viewportMargin);i.viewFrom<s&&s-i.viewFrom<20&&(s=Math.max(r.first,i.viewFrom)),i.viewTo>l&&i.viewTo-l<20&&(l=Math.min(a,i.viewTo)),Fa&&(s=ue(e.doc,s),l=he(e.doc,l));var c=s!=i.viewFrom||l!=i.viewTo||i.lastWrapHeight!=n.wrapperHeight||i.lastWrapWidth!=n.wrapperWidth;bi(e,s,l),i.viewOffset=pe(A(e.doc,i.viewFrom)),e.display.mover.style.top=i.viewOffset+"px";var u=wi(e);if(!c&&0==u&&!n.force&&i.renderedView==i.view&&(null==i.updateLineNumbers||i.updateLineNumbers>=i.viewTo))return!1;var h=o();return u>4&&(i.lineDiv.style.display="none"),Li(e,i.updateLineNumbers,n.dims),u>4&&(i.lineDiv.style.display=""),i.renderedView=i.view,h&&o()!=h&&h.offsetHeight&&h.focus(),t(i.cursorDiv),t(i.selectionDiv),i.gutters.style.height=i.sizer.style.minHeight=0,c&&(i.lastWrapHeight=n.wrapperHeight,i.lastWrapWidth=n.wrapperWidth,Ci(e,400)),i.updateLineNumbers=null,!0}function Si(e,t){for(var n=t.viewport,i=!0;(i&&e.options.lineWrapping&&t.oldDisplayWidth!=zt(e)||(n&&null!=n.top&&(n={top:Math.min(e.doc.height+Ht(e.display)-Gt(e),n.top)}),t.visible=Nn(e.display,e.doc,n),!(t.visible.from>=e.display.viewFrom&&t.visible.to<=e.display.viewTo)))&&Ai(e,t);i=!1){Dn(e);var r=zn(e);An(e),Yn(e,r),Mi(e,r)}t.signal(e,"update",e),e.display.viewFrom==e.display.reportedViewFrom&&e.display.viewTo==e.display.reportedViewTo||(t.signal(e,"viewportChange",e,e.display.viewFrom,e.display.viewTo),e.display.reportedViewFrom=e.display.viewFrom,e.display.reportedViewTo=e.display.viewTo)}function Ti(e,t){var n=new ki(e,t);if(Ai(e,n)){Dn(e),Si(e,n);var i=zn(e);An(e),Yn(e,i),Mi(e,i),n.finish()}}function Li(e,n,i){function r(t){var n=t.nextSibling;return la&&va&&e.display.currentWheelTarget==t?t.style.display="none":t.parentNode.removeChild(t),n}for(var o=e.display,a=e.options.lineNumbers,s=o.lineDiv,l=s.firstChild,c=o.view,u=o.viewFrom,h=0;h<c.length;h++){var f=c[h];if(f.hidden);else if(f.node&&f.node.parentNode==s){for(;l!=f.node;)l=r(l);var p=a&&null!=n&&u>=n&&f.lineNumber;f.changes&&(d(f.changes,"gutter")>-1&&(p=!1),St(e,f,u,i)),p&&(t(f.lineNumber),f.lineNumber.appendChild(document.createTextNode(R(e.options,u)))),l=f.node.nextSibling}else{var g=$t(e,f,u,i);s.insertBefore(g,l)}u+=f.size}for(;l;)l=r(l)}function Ei(e){var t=e.display.gutters.offsetWidth;e.display.sizer.style.marginLeft=t+"px"}function Mi(e,t){e.display.sizer.style.minHeight=t.docHeight+"px",e.display.heightForcer.style.top=t.docHeight+"px",e.display.gutters.style.height=t.docHeight+e.display.barHeight+Ut(e)+"px"}function Pi(e){var n=e.display.gutters,r=e.options.gutters;t(n);for(var o=0;o<r.length;++o){var a=r[o],s=n.appendChild(i("div",null,"CodeMirror-gutter "+a));"CodeMirror-linenumbers"==a&&(e.display.lineGutter=s,s.style.width=(e.display.lineNumWidth||1)+"px")}n.style.display=o?"":"none",Ei(e)}function Ri(e){var t=d(e.gutters,"CodeMirror-linenumbers");-1==t&&e.lineNumbers?e.gutters=e.gutters.concat(["CodeMirror-linenumbers"]):t>-1&&!e.lineNumbers&&(e.gutters=e.gutters.slice(0),e.gutters.splice(t,1))}function Ii(e,t){this.ranges=e,this.primIndex=t}function $i(e,t){this.anchor=e,this.head=t}function Oi(e,t){var n=e[t];e.sort(function(e,t){return $(e.from(),t.from())}),t=d(e,n);for(var i=1;i<e.length;i++){var r=e[i],o=e[i-1];if($(o.to(),r.from())>=0){var a=F(o.from(),r.from()),s=D(o.to(),r.to()),l=o.empty()?r.from()==r.head:o.from()==o.head;t>=i&&--t,e.splice(--i,2,new $i(l?s:a,l?a:s))}}return new Ii(e,t)}function Di(e,t){return new Ii([new $i(e,t||e)],0)}function Fi(e){return e.text?I(e.from.line+e.text.length-1,g(e.text).length+(1==e.text.length?e.from.ch:0)):e.to}function Ni(e,t){if($(e,t.from)<0)return e;if($(e,t.to)<=0)return Fi(t);var n=e.line+t.text.length-(t.to.line-t.from.line)-1,i=e.ch;return e.line==t.to.line&&(i+=Fi(t).ch-t.to.ch),I(n,i)}function Wi(e,t){for(var n=[],i=0;i<e.sel.ranges.length;i++){var r=e.sel.ranges[i];n.push(new $i(Ni(r.anchor,t),Ni(r.head,t)))}return Oi(n,e.sel.primIndex)}function ji(e,t,n){return e.line==t.line?I(n.line,e.ch-t.ch+n.ch):I(n.line+(e.line-t.line),e.ch)}function Hi(e,t,n){for(var i=[],r=I(e.first,0),o=r,a=0;a<t.length;a++){var s=t[a],l=ji(s.from,r,o),c=ji(Fi(s),r,o);if(r=s.to,o=c,"around"==n){var u=e.sel.ranges[a],h=$(u.head,u.anchor)<0;i[a]=new $i(h?c:l,h?l:c)}else i[a]=new $i(l,l)}return new Ii(i,e.sel.primIndex)}function Bi(e){e.doc.mode=Ye(e.options,e.doc.modeOption),Ui(e)}function Ui(e){e.doc.iter(function(e){e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null)}),e.doc.frontier=e.doc.first,Ci(e,100),e.state.modeGen++,e.curOp&&gi(e)}function zi(e,t){return 0==t.from.ch&&0==t.to.ch&&""==g(t.text)&&(!e.cm||e.cm.options.wholeLineUpdateBefore)}function Gi(e,t,n,i){function r(e){return n?n[e]:null}function o(e,n,r){ct(e,n,r,i),_t(e,"change",e,t)}function a(e,t){for(var n=[],o=e;t>o;++o)n.push(new lt(c[o],r(o),i));return n}var s=t.from,l=t.to,c=t.text,u=A(e,s.line),h=A(e,l.line),d=g(c),f=r(c.length-1),p=l.line-s.line;if(t.full)e.insert(0,a(0,c.length)),e.remove(c.length,e.size-c.length);else if(zi(e,t)){var m=a(0,c.length-1);o(h,h.text,f),p&&e.remove(s.line,p),m.length&&e.insert(s.line,m)}else if(u==h)if(1==c.length)o(u,u.text.slice(0,s.ch)+d+u.text.slice(l.ch),f);else{var v=a(1,c.length-1);v.push(new lt(d+u.text.slice(l.ch),f,i)),o(u,u.text.slice(0,s.ch)+c[0],r(0)),e.insert(s.line+1,v)}else if(1==c.length)o(u,u.text.slice(0,s.ch)+c[0]+h.text.slice(l.ch),r(0)),e.remove(s.line+1,p);else{o(u,u.text.slice(0,s.ch)+c[0],r(0)),o(h,d+h.text.slice(l.ch),f);var y=a(1,c.length-1);p>1&&e.remove(s.line+1,p-1),e.insert(s.line+1,y)}_t(e,"change",e,t)}function qi(e,t,n){function i(e,r,o){if(e.linked)for(var a=0;a<e.linked.length;++a){var s=e.linked[a];if(s.doc!=r){var l=o&&s.sharedHist;n&&!l||(t(s.doc,l),i(s.doc,e,l))}}}i(e,null,!0)}function Yi(e,t){if(t.cm)throw new Error("This document is already in use.");e.doc=t,t.cm=e,xn(e),Bi(e),e.options.lineWrapping||me(e),e.options.mode=t.modeOption,gi(e)}function Ki(e){this.done=[],this.undone=[],this.undoDepth=1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=e||1}function Vi(e,t){var n={from:O(t.from),to:Fi(t),text:S(e,t.from,t.to)};return nr(e,n,t.from.line,t.to.line+1),qi(e,function(e){return nr(e,n,t.from.line,t.to.line+1)},!0),n}function Xi(e){for(;e.length;){var t=g(e);if(!t.ranges)break;e.pop()}}function Ji(e,t){return t?(Xi(e.done),g(e.done)):e.done.length&&!g(e.done).ranges?g(e.done):e.done.length>1&&!e.done[e.done.length-2].ranges?(e.done.pop(),g(e.done)):void 0}function Qi(e,t,n,i){var r=e.history;r.undone.length=0;var o,a,s=+new Date;if((r.lastOp==i||r.lastOrigin==t.origin&&t.origin&&("+"==t.origin.charAt(0)&&e.cm&&r.lastModTime>s-e.cm.options.historyEventDelay||"*"==t.origin.charAt(0)))&&(o=Ji(r,r.lastOp==i)))a=g(o.changes),0==$(t.from,t.to)&&0==$(t.from,a.to)?a.to=Fi(t):o.changes.push(Vi(e,t));else{var l=g(r.done);for(l&&l.ranges||tr(e.sel,r.done),o={changes:[Vi(e,t)],generation:r.generation},r.done.push(o);r.done.length>r.undoDepth;)r.done.shift(),r.done[0].ranges||r.done.shift()}r.done.push(n),r.generation=++r.maxGeneration,r.lastModTime=r.lastSelTime=s,r.lastOp=r.lastSelOp=i,r.lastOrigin=r.lastSelOrigin=t.origin,a||Me(e,"historyAdded")}function Zi(e,t,n,i){var r=t.charAt(0);return"*"==r||"+"==r&&n.ranges.length==i.ranges.length&&n.somethingSelected()==i.somethingSelected()&&new Date-e.history.lastSelTime<=(e.cm?e.cm.options.historyEventDelay:500)}function er(e,t,n,i){var r=e.history,o=i&&i.origin;n==r.lastSelOp||o&&r.lastSelOrigin==o&&(r.lastModTime==r.lastSelTime&&r.lastOrigin==o||Zi(e,o,g(r.done),t))?r.done[r.done.length-1]=t:tr(t,r.done),
r.lastSelTime=+new Date,r.lastSelOrigin=o,r.lastSelOp=n,i&&i.clearRedo!==!1&&Xi(r.undone)}function tr(e,t){var n=g(t);n&&n.ranges&&n.equals(e)||t.push(e)}function nr(e,t,n,i){var r=t["spans_"+e.id],o=0;e.iter(Math.max(e.first,n),Math.min(e.first+e.size,i),function(n){n.markedSpans&&((r||(r=t["spans_"+e.id]={}))[o]=n.markedSpans),++o})}function ir(e){if(!e)return null;for(var t,n=0;n<e.length;++n)e[n].marker.explicitlyCleared?t||(t=e.slice(0,n)):t&&t.push(e[n]);return t?t.length?t:null:e}function rr(e,t){var n=t["spans_"+e.id];if(!n)return null;for(var i=[],r=0;r<t.text.length;++r)i.push(ir(n[r]));return i}function or(e,t){var n=rr(e,t),i=X(e,t);if(!n)return i;if(!i)return n;for(var r=0;r<n.length;++r){var o=n[r],a=i[r];if(o&&a)e:for(var s=0;s<a.length;++s){for(var l=a[s],c=0;c<o.length;++c)if(o[c].marker==l.marker)continue e;o.push(l)}else a&&(n[r]=a)}return n}function ar(e,t,n){for(var i=[],r=0;r<e.length;++r){var o=e[r];if(o.ranges)i.push(n?Ii.prototype.deepCopy.call(o):o);else{var a=o.changes,s=[];i.push({changes:s});for(var l=0;l<a.length;++l){var c=a[l],u=void 0;if(s.push({from:c.from,to:c.to,text:c.text}),t)for(var h in c)(u=h.match(/^spans_(\d+)$/))&&d(t,Number(u[1]))>-1&&(g(s)[h]=c[h],delete c[h])}}}return i}function sr(e,t,n,i){if(e.cm&&e.cm.display.shift||e.extend){var r=t.anchor;if(i){var o=$(n,r)<0;o!=$(i,r)<0?(r=n,n=i):o!=$(n,i)<0&&(n=i)}return new $i(r,n)}return new $i(i||n,n)}function lr(e,t,n,i){pr(e,new Ii([sr(e,e.sel.primary(),t,n)],0),i)}function cr(e,t,n){for(var i=[],r=0;r<e.sel.ranges.length;r++)i[r]=sr(e,e.sel.ranges[r],t[r],null);var o=Oi(i,e.sel.primIndex);pr(e,o,n)}function ur(e,t,n,i){var r=e.sel.ranges.slice(0);r[t]=n,pr(e,Oi(r,e.sel.primIndex),i)}function hr(e,t,n,i){pr(e,Di(t,n),i)}function dr(e,t,n){var i={ranges:t.ranges,update:function(t){var n=this;this.ranges=[];for(var i=0;i<t.length;i++)n.ranges[i]=new $i(W(e,t[i].anchor),W(e,t[i].head))},origin:n&&n.origin};return Me(e,"beforeSelectionChange",e,i),e.cm&&Me(e.cm,"beforeSelectionChange",e.cm,i),i.ranges!=t.ranges?Oi(i.ranges,i.ranges.length-1):t}function fr(e,t,n){var i=e.history.done,r=g(i);r&&r.ranges?(i[i.length-1]=t,gr(e,t,n)):pr(e,t,n)}function pr(e,t,n){gr(e,t,n),er(e,e.sel,e.cm?e.cm.curOp.id:NaN,n)}function gr(e,t,n){(Ie(e,"beforeSelectionChange")||e.cm&&Ie(e.cm,"beforeSelectionChange"))&&(t=dr(e,t,n));var i=n&&n.bias||($(t.primary().head,e.sel.primary().head)<0?-1:1);mr(e,yr(e,t,i,!0)),n&&n.scroll===!1||!e.cm||ti(e.cm)}function mr(e,t){t.equals(e.sel)||(e.sel=t,e.cm&&(e.cm.curOp.updateInput=e.cm.curOp.selectionChanged=!0,Re(e.cm)),_t(e,"cursorActivity",e))}function vr(e){mr(e,yr(e,e.sel,null,!1),Ma)}function yr(e,t,n,i){for(var r,o=0;o<t.ranges.length;o++){var a=t.ranges[o],s=t.ranges.length==e.sel.ranges.length&&e.sel.ranges[o],l=wr(e,a.anchor,s&&s.anchor,n,i),c=wr(e,a.head,s&&s.head,n,i);(r||l!=a.anchor||c!=a.head)&&(r||(r=t.ranges.slice(0,o)),r[o]=new $i(l,c))}return r?Oi(r,t.primIndex):t}function br(e,t,n,i,r){var o=A(e,t.line);if(o.markedSpans)for(var a=0;a<o.markedSpans.length;++a){var s=o.markedSpans[a],l=s.marker;if((null==s.from||(l.inclusiveLeft?s.from<=t.ch:s.from<t.ch))&&(null==s.to||(l.inclusiveRight?s.to>=t.ch:s.to>t.ch))){if(r&&(Me(l,"beforeCursorEnter"),l.explicitlyCleared)){if(o.markedSpans){--a;continue}break}if(!l.atomic)continue;if(n){var c=l.find(0>i?1:-1),u=void 0;if((0>i?l.inclusiveRight:l.inclusiveLeft)&&(c=Cr(e,c,-i,c&&c.line==t.line?o:null)),c&&c.line==t.line&&(u=$(c,n))&&(0>i?0>u:u>0))return br(e,c,t,i,r)}var h=l.find(0>i?-1:1);return(0>i?l.inclusiveLeft:l.inclusiveRight)&&(h=Cr(e,h,i,h.line==t.line?o:null)),h?br(e,h,t,i,r):null}}return t}function wr(e,t,n,i,r){var o=i||1,a=br(e,t,n,o,r)||!r&&br(e,t,n,o,!0)||br(e,t,n,-o,r)||!r&&br(e,t,n,-o,!0);return a?a:(e.cantEdit=!0,I(e.first,0))}function Cr(e,t,n,i){return 0>n&&0==t.ch?t.line>e.first?W(e,I(t.line-1)):null:n>0&&t.ch==(i||A(e,t.line)).text.length?t.line<e.first+e.size-1?I(t.line+1,0):null:new I(t.line,t.ch+n)}function xr(e){e.setSelection(I(e.firstLine(),0),I(e.lastLine()),Ma)}function kr(e,t,n){var i={canceled:!1,from:t.from,to:t.to,text:t.text,origin:t.origin,cancel:function(){return i.canceled=!0}};return n&&(i.update=function(t,n,r,o){t&&(i.from=W(e,t)),n&&(i.to=W(e,n)),r&&(i.text=r),void 0!==o&&(i.origin=o)}),Me(e,"beforeChange",e,i),e.cm&&Me(e.cm,"beforeChange",e.cm,i),i.canceled?null:{from:i.from,to:i.to,text:i.text,origin:i.origin}}function _r(e,t,n){if(e.cm){if(!e.cm.curOp)return di(e.cm,_r)(e,t,n);if(e.cm.state.suppressEdits)return}if(!(Ie(e,"beforeChange")||e.cm&&Ie(e.cm,"beforeChange"))||(t=kr(e,t,!0))){var i=Da&&!n&&Q(e,t.from,t.to);if(i)for(var r=i.length-1;r>=0;--r)Ar(e,{from:i[r].from,to:i[r].to,text:r?[""]:t.text});else Ar(e,t)}}function Ar(e,t){if(1!=t.text.length||""!=t.text[0]||0!=$(t.from,t.to)){var n=Wi(e,t);Qi(e,t,n,e.cm?e.cm.curOp.id:NaN),Lr(e,t,n,X(e,t));var i=[];qi(e,function(e,n){n||-1!=d(i,e.history)||(Ir(e.history,t),i.push(e.history)),Lr(e,t,null,X(e,t))})}}function Sr(e,t,n){if(!e.cm||!e.cm.state.suppressEdits||n){for(var i,r=e.history,o=e.sel,a="undo"==t?r.done:r.undone,s="undo"==t?r.undone:r.done,l=0;l<a.length&&(i=a[l],n?!i.ranges||i.equals(e.sel):i.ranges);l++);if(l!=a.length){for(r.lastOrigin=r.lastSelOrigin=null;i=a.pop(),i.ranges;){if(tr(i,s),n&&!i.equals(e.sel))return void pr(e,i,{clearRedo:!1});o=i}var c=[];tr(o,s),s.push({changes:c,generation:r.generation}),r.generation=i.generation||++r.maxGeneration;for(var u=Ie(e,"beforeChange")||e.cm&&Ie(e.cm,"beforeChange"),h=function(n){var r=i.changes[n];if(r.origin=t,u&&!kr(e,r,!1))return a.length=0,{};c.push(Vi(e,r));var o=n?Wi(e,r):g(a);Lr(e,r,o,or(e,r)),!n&&e.cm&&e.cm.scrollIntoView({from:r.from,to:Fi(r)});var s=[];qi(e,function(e,t){t||-1!=d(s,e.history)||(Ir(e.history,r),s.push(e.history)),Lr(e,r,null,or(e,r))})},f=i.changes.length-1;f>=0;--f){var p=h(f);if(p)return p.v}}}}function Tr(e,t){if(0!=t&&(e.first+=t,e.sel=new Ii(m(e.sel.ranges,function(e){return new $i(I(e.anchor.line+t,e.anchor.ch),I(e.head.line+t,e.head.ch))}),e.sel.primIndex),e.cm)){gi(e.cm,e.first,e.first-t,t);for(var n=e.cm.display,i=n.viewFrom;i<n.viewTo;i++)mi(e.cm,i,"gutter")}}function Lr(e,t,n,i){if(e.cm&&!e.cm.curOp)return di(e.cm,Lr)(e,t,n,i);if(t.to.line<e.first)return void Tr(e,t.text.length-1-(t.to.line-t.from.line));if(!(t.from.line>e.lastLine())){if(t.from.line<e.first){var r=t.text.length-1-(e.first-t.from.line);Tr(e,r),t={from:I(e.first,0),to:I(t.to.line+r,t.to.ch),text:[g(t.text)],origin:t.origin}}var o=e.lastLine();t.to.line>o&&(t={from:t.from,to:I(o,A(e,o).text.length),text:[t.text[0]],origin:t.origin}),t.removed=S(e,t.from,t.to),n||(n=Wi(e,t)),e.cm?Er(e.cm,t,i):Gi(e,t,i),gr(e,n,Ma)}}function Er(e,t,n){var i=e.doc,r=e.display,o=t.from,a=t.to,s=!1,l=o.line;e.options.lineWrapping||(l=E(le(A(i,o.line))),i.iter(l,a.line+1,function(e){return e==r.maxLine?(s=!0,!0):void 0})),i.sel.contains(t.from,t.to)>-1&&Re(e),Gi(i,t,n,Cn(e)),e.options.lineWrapping||(i.iter(l,o.line+t.text.length,function(e){var t=ge(e);t>r.maxLineLength&&(r.maxLine=e,r.maxLineLength=t,r.maxLineChanged=!0,s=!1)}),s&&(e.curOp.updateMaxLine=!0)),i.frontier=Math.min(i.frontier,o.line),Ci(e,400);var c=t.text.length-(a.line-o.line)-1;t.full?gi(e):o.line!=a.line||1!=t.text.length||zi(e.doc,t)?gi(e,o.line,a.line+1,c):mi(e,o.line,"text");var u=Ie(e,"changes"),h=Ie(e,"change");if(h||u){var d={from:o,to:a,text:t.text,removed:t.removed,origin:t.origin};h&&_t(e,"change",e,d),u&&(e.curOp.changeObjs||(e.curOp.changeObjs=[])).push(d)}e.display.selForContextMenu=null}function Mr(e,t,n,i,r){if(i||(i=n),$(i,n)<0){var o=i;i=n,n=o}"string"==typeof t&&(t=e.splitLines(t)),_r(e,{from:n,to:i,text:t,origin:r})}function Pr(e,t,n,i){n<e.line?e.line+=i:t<e.line&&(e.line=t,e.ch=0)}function Rr(e,t,n,i){for(var r=0;r<e.length;++r){var o=e[r],a=!0;if(o.ranges){o.copied||(o=e[r]=o.deepCopy(),o.copied=!0);for(var s=0;s<o.ranges.length;s++)Pr(o.ranges[s].anchor,t,n,i),Pr(o.ranges[s].head,t,n,i)}else{for(var l=0;l<o.changes.length;++l){var c=o.changes[l];if(n<c.from.line)c.from=I(c.from.line+i,c.from.ch),c.to=I(c.to.line+i,c.to.ch);else if(t<=c.to.line){a=!1;break}}a||(e.splice(0,r+1),r=0)}}}function Ir(e,t){var n=t.from.line,i=t.to.line,r=t.text.length-(i-n)-1;Rr(e.done,n,i,r),Rr(e.undone,n,i,r)}function $r(e,t,n,i){var r=t,o=t;return"number"==typeof t?o=A(e,N(e,t)):r=E(t),null==r?null:(i(o,r)&&e.cm&&mi(e.cm,r,n),o)}function Or(e){var t=this;this.lines=e,this.parent=null;for(var n=0,i=0;i<e.length;++i)e[i].parent=t,n+=e[i].height;this.height=n}function Dr(e){var t=this;this.children=e;for(var n=0,i=0,r=0;r<e.length;++r){var o=e[r];n+=o.chunkSize(),i+=o.height,o.parent=t}this.size=n,this.height=i,this.parent=null}function Fr(e,t,n){var i=this;if(n)for(var r in n)n.hasOwnProperty(r)&&(i[r]=n[r]);this.doc=e,this.node=t}function Nr(e,t,n){pe(t)<(e.curOp&&e.curOp.scrollTop||e.doc.scrollTop)&&ei(e,null,n)}function Wr(e,t,n,i){var r=new Fr(e,n,i),o=e.cm;return o&&r.noHScroll&&(o.display.alignWidgets=!0),$r(e,t,"widget",function(t){var n=t.widgets||(t.widgets=[]);if(null==r.insertAt?n.push(r):n.splice(Math.min(n.length-1,Math.max(0,r.insertAt)),0,r),r.line=t,o&&!de(e,t)){var i=pe(t)<e.scrollTop;L(t,t.height+Nt(r)),i&&ei(o,null,r.height),o.curOp.forceUpdate=!0}return!0}),r}function jr(e,t){this.lines=[],this.type=t,this.doc=e,this.id=++ss}function Hr(e,t,n,r,o){if(r&&r.shared)return Ur(e,t,n,r,o);if(e.cm&&!e.cm.curOp)return di(e.cm,Hr)(e,t,n,r,o);var a=new jr(e,o),s=$(t,n);if(r&&c(r,a,!1),s>0||0==s&&a.clearWhenEmpty!==!1)return a;if(a.replacedWith&&(a.collapsed=!0,a.widgetNode=i("span",[a.replacedWith],"CodeMirror-widget"),r.handleMouseEvents||a.widgetNode.setAttribute("cm-ignore-events","true"),r.insertLeft&&(a.widgetNode.insertLeft=!0)),a.collapsed){if(se(e,t.line,t,n,a)||t.line!=n.line&&se(e,n.line,t,n,a))throw new Error("Inserting collapsed marker partially overlapping an existing one");U()}a.addToHistory&&Qi(e,{from:t,to:n,origin:"markText"},e.sel,NaN);var l,u=t.line,h=e.cm;if(e.iter(u,n.line+1,function(e){h&&a.collapsed&&!h.options.lineWrapping&&le(e)==h.display.maxLine&&(l=!0),a.collapsed&&u!=t.line&&L(e,0),Y(e,new z(a,u==t.line?t.ch:null,u==n.line?n.ch:null)),++u}),a.collapsed&&e.iter(t.line,n.line+1,function(t){de(e,t)&&L(t,0)}),a.clearOnEnter&&Ha(a,"beforeCursorEnter",function(){return a.clear()}),a.readOnly&&(B(),(e.history.done.length||e.history.undone.length)&&e.clearHistory()),a.collapsed&&(a.id=++ss,a.atomic=!0),h){if(l&&(h.curOp.updateMaxLine=!0),a.collapsed)gi(h,t.line,n.line+1);else if(a.className||a.title||a.startStyle||a.endStyle||a.css)for(var d=t.line;d<=n.line;d++)mi(h,d,"text");a.atomic&&vr(h.doc),_t(h,"markerAdded",h,a)}return a}function Br(e,t){var n=this;this.markers=e,this.primary=t;for(var i=0;i<e.length;++i)e[i].parent=n}function Ur(e,t,n,i,r){i=c(i),i.shared=!1;var o=[Hr(e,t,n,i,r)],a=o[0],s=i.widgetNode;return qi(e,function(e){s&&(i.widgetNode=s.cloneNode(!0)),o.push(Hr(e,W(e,t),W(e,n),i,r));for(var l=0;l<e.linked.length;++l)if(e.linked[l].isParent)return;a=g(o)}),new Br(o,a)}function zr(e){return e.findMarks(I(e.first,0),e.clipPos(I(e.lastLine())),function(e){return e.parent})}function Gr(e,t){for(var n=0;n<t.length;n++){var i=t[n],r=i.find(),o=e.clipPos(r.from),a=e.clipPos(r.to);if($(o,a)){var s=Hr(e,o,a,i.primary,i.primary.type);i.markers.push(s),s.parent=i}}}function qr(e){for(var t=function(t){var n=e[t],i=[n.primary.doc];qi(n.primary.doc,function(e){return i.push(e)});for(var r=0;r<n.markers.length;r++){var o=n.markers[r];-1==d(i,o.doc)&&(o.parent=null,n.markers.splice(r--,1))}},n=0;n<e.length;n++)t(n)}function Yr(e){var t=this;if(Xr(t),!Pe(t,e)&&!Wt(t.display,e)){Oe(e),aa&&(us=+new Date);var n=kn(t,e,!0),i=e.dataTransfer.files;if(n&&!t.isReadOnly())if(i&&i.length&&window.FileReader&&window.File)for(var r=i.length,o=Array(r),a=0,s=function(e,i){if(!t.options.allowDropFileTypes||-1!=d(t.options.allowDropFileTypes,e.type)){var s=new FileReader;s.onload=di(t,function(){var e=s.result;if(/[\x00-\x08\x0e-\x1f]{2}/.test(e)&&(e=""),o[i]=e,++a==r){n=W(t.doc,n);var l={from:n,to:n,text:t.doc.splitLines(o.join(t.doc.lineSeparator())),origin:"paste"};_r(t.doc,l),fr(t.doc,Di(n,Fi(l)))}}),s.readAsText(e)}},l=0;r>l;++l)s(i[l],l);else{if(t.state.draggingText&&t.doc.sel.contains(n)>-1)return t.state.draggingText(e),void setTimeout(function(){return t.display.input.focus()},20);try{var c=e.dataTransfer.getData("Text");if(c){var u;if(t.state.draggingText&&!t.state.draggingText.copy&&(u=t.listSelections()),gr(t.doc,Di(n,n)),u)for(var h=0;h<u.length;++h)Mr(t.doc,"",u[h].anchor,u[h].head,"drag");t.replaceSelection(c,"around","paste"),t.display.input.focus()}}catch(e){}}}}function Kr(e,t){if(aa&&(!e.state.draggingText||+new Date-us<100))return void Ne(t);if(!Pe(e,t)&&!Wt(e.display,t)&&(t.dataTransfer.setData("Text",e.getSelection()),t.dataTransfer.effectAllowed="copyMove",t.dataTransfer.setDragImage&&!da)){var n=i("img",null,null,"position: fixed; left: 0; top: 0;");n.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",ha&&(n.width=n.height=1,e.display.wrapper.appendChild(n),n._top=n.offsetTop),t.dataTransfer.setDragImage(n,0,0),ha&&n.parentNode.removeChild(n)}}function Vr(e,t){var r=kn(e,t);if(r){var o=document.createDocumentFragment();Tn(e,r,o),e.display.dragCursor||(e.display.dragCursor=i("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),e.display.lineSpace.insertBefore(e.display.dragCursor,e.display.cursorDiv)),n(e.display.dragCursor,o)}}function Xr(e){e.display.dragCursor&&(e.display.lineSpace.removeChild(e.display.dragCursor),e.display.dragCursor=null)}function Jr(e){if(document.body.getElementsByClassName)for(var t=document.body.getElementsByClassName("CodeMirror"),n=0;n<t.length;n++){var i=t[n].CodeMirror;i&&e(i)}}function Qr(){hs||(Zr(),hs=!0)}function Zr(){var e;Ha(window,"resize",function(){null==e&&(e=setTimeout(function(){e=null,Jr(eo)},100))}),Ha(window,"blur",function(){return Jr(In)})}function eo(e){var t=e.display;t.lastWrapHeight==t.wrapper.clientHeight&&t.lastWrapWidth==t.wrapper.clientWidth||(t.cachedCharWidth=t.cachedTextHeight=t.cachedPaddingH=null,t.scrollbarsClipped=!1,e.setSize())}function to(e){var t=e.split(/-(?!$)/);e=t[t.length-1];for(var n,i,r,o,a=0;a<t.length-1;a++){var s=t[a];if(/^(cmd|meta|m)$/i.test(s))o=!0;else if(/^a(lt)?$/i.test(s))n=!0;else if(/^(c|ctrl|control)$/i.test(s))i=!0;else{if(!/^s(hift)?$/i.test(s))throw new Error("Unrecognized modifier name: "+s);r=!0}}return n&&(e="Alt-"+e),i&&(e="Ctrl-"+e),o&&(e="Cmd-"+e),r&&(e="Shift-"+e),e}function no(e){var t={};for(var n in e)if(e.hasOwnProperty(n)){var i=e[n];if(/^(name|fallthrough|(de|at)tach)$/.test(n))continue;if("..."==i){delete e[n];continue}for(var r=m(n.split(" "),to),o=0;o<r.length;o++){var a=void 0,s=void 0;o==r.length-1?(s=r.join(" "),a=i):(s=r.slice(0,o+1).join(" "),a="...");var l=t[s];if(l){if(l!=a)throw new Error("Inconsistent bindings for "+s)}else t[s]=a}delete e[n]}for(var c in t)e[c]=t[c];return e}function io(e,t,n,i){t=ao(t);var r=t.call?t.call(e,i):t[e];if(r===!1)return"nothing";if("..."===r)return"multi";if(null!=r&&n(r))return"handled";if(t.fallthrough){if("[object Array]"!=Object.prototype.toString.call(t.fallthrough))return io(e,t.fallthrough,n,i);for(var o=0;o<t.fallthrough.length;o++){var a=io(e,t.fallthrough[o],n,i);if(a)return a}}}function ro(e){var t="string"==typeof e?e:ds[e.keyCode];return"Ctrl"==t||"Alt"==t||"Shift"==t||"Mod"==t}function oo(e,t){if(ha&&34==e.keyCode&&e["char"])return!1;var n=ds[e.keyCode],i=n;return null==i||e.altGraphKey?!1:(e.altKey&&"Alt"!=n&&(i="Alt-"+i),(xa?e.metaKey:e.ctrlKey)&&"Ctrl"!=n&&(i="Ctrl-"+i),(xa?e.ctrlKey:e.metaKey)&&"Cmd"!=n&&(i="Cmd-"+i),!t&&e.shiftKey&&"Shift"!=n&&(i="Shift-"+i),i)}function ao(e){return"string"==typeof e?ms[e]:e}function so(e,t){for(var n=e.doc.sel.ranges,i=[],r=0;r<n.length;r++){for(var o=t(n[r]);i.length&&$(o.from,g(i).to)<=0;){var a=i.pop();if($(a.from,o.from)<0){o.from=a.from;break}}i.push(o)}hi(e,function(){for(var t=i.length-1;t>=0;t--)Mr(e.doc,"",i[t].from,i[t].to,"+delete");ti(e)})}function lo(e,t){var n=A(e.doc,t),i=le(n);i!=n&&(t=E(i));var r=Te(i),o=r?r[0].level%2?Ce(i):we(i):0;return I(t,o)}function co(e,t){for(var n,i=A(e.doc,t);n=ae(i);)i=n.find(1,!0).line,t=null;var r=Te(i),o=r?r[0].level%2?we(i):Ce(i):i.text.length;return I(null==t?E(i):t,o)}function uo(e,t){var n=lo(e,t.line),i=A(e.doc,n.line),r=Te(i);if(!r||0==r[0].level){var o=Math.max(0,i.text.search(/\S/)),a=t.line==n.line&&t.ch<=o&&t.ch;return I(n.line,a?0:o)}return n}function ho(e,t,n){if("string"==typeof t&&(t=bs[t],!t))return!1;e.display.input.ensurePolled();var i=e.display.shift,r=!1;try{e.isReadOnly()&&(e.state.suppressEdits=!0),n&&(e.display.shift=!1),r=t(e)!=Ea}finally{e.display.shift=i,e.state.suppressEdits=!1}return r}function fo(e,t,n){for(var i=0;i<e.state.keyMaps.length;i++){var r=io(t,e.state.keyMaps[i],n,e);if(r)return r}return e.options.extraKeys&&io(t,e.options.extraKeys,n,e)||io(t,e.options.keyMap,n,e)}function po(e,t,n,i){var r=e.state.keySeq;if(r){if(ro(t))return"handled";ws.set(50,function(){e.state.keySeq==r&&(e.state.keySeq=null,e.display.input.reset())}),t=r+" "+t}var o=fo(e,t,i);return"multi"==o&&(e.state.keySeq=t),"handled"==o&&_t(e,"keyHandled",e,t,n),"handled"!=o&&"multi"!=o||(Oe(n),En(e)),r&&!o&&/\'$/.test(t)?(Oe(n),!0):!!o}function go(e,t){var n=oo(t,!0);return n?t.shiftKey&&!e.state.keySeq?po(e,"Shift-"+n,t,function(t){return ho(e,t,!0)})||po(e,n,t,function(t){return("string"==typeof t?/^go[A-Z]/.test(t):t.motion)?ho(e,t):void 0}):po(e,n,t,function(t){return ho(e,t)}):!1}function mo(e,t,n){return po(e,"'"+n+"'",t,function(t){return ho(e,t,!0)})}function vo(e){var t=this;if(t.curOp.focus=o(),!Pe(t,e)){aa&&11>sa&&27==e.keyCode&&(e.returnValue=!1);var n=e.keyCode;t.display.shift=16==n||e.shiftKey;var i=go(t,e);ha&&(Cs=i?n:null,!i&&88==n&&!Ga&&(va?e.metaKey:e.ctrlKey)&&t.replaceSelection("",null,"cut")),18!=n||/\bCodeMirror-crosshair\b/.test(t.display.lineDiv.className)||yo(t)}}function yo(e){function t(e){18!=e.keyCode&&e.altKey||(_a(n,"CodeMirror-crosshair"),Ee(document,"keyup",t),Ee(document,"mouseover",t))}var n=e.display.lineDiv;a(n,"CodeMirror-crosshair"),Ha(document,"keyup",t),Ha(document,"mouseover",t)}function bo(e){16==e.keyCode&&(this.doc.sel.shift=!1),Pe(this,e)}function wo(e){var t=this;if(!(Wt(t.display,e)||Pe(t,e)||e.ctrlKey&&!e.altKey||va&&e.metaKey)){var n=e.keyCode,i=e.charCode;if(ha&&n==Cs)return Cs=null,void Oe(e);if(!ha||e.which&&!(e.which<10)||!go(t,e)){var r=String.fromCharCode(null==i?n:i);"\b"!=r&&(mo(t,e,r)||t.display.input.onKeyPress(e))}}}function Co(e){var t=this,n=t.display;if(!(Pe(t,e)||n.activeTouch&&n.input.supportsTouch())){if(n.input.ensurePolled(),n.shift=e.shiftKey,Wt(n,e))return void(la||(n.scroller.draggable=!1,setTimeout(function(){return n.scroller.draggable=!0},100)));if(!So(t,e)){var i=kn(t,e);switch(window.focus(),je(e)){case 1:t.state.selectingText?t.state.selectingText(e):i?xo(t,e,i):We(e)==n.scroller&&Oe(e);break;case 2:la&&(t.state.lastMiddleDown=+new Date),i&&lr(t.doc,i),setTimeout(function(){return n.input.focus()},20),Oe(e);break;case 3:ka?To(t,e):Pn(t)}}}}function xo(e,t,n){aa?setTimeout(l(Mn,e),0):e.curOp.focus=o();var i,r=+new Date;ys&&ys.time>r-400&&0==$(ys.pos,n)?i="triple":vs&&vs.time>r-400&&0==$(vs.pos,n)?(i="double",ys={time:r,pos:n}):(i="single",vs={time:r,pos:n});var a,s=e.doc.sel,c=va?t.metaKey:t.ctrlKey;e.options.dragDrop&&Ba&&!e.isReadOnly()&&"single"==i&&(a=s.contains(n))>-1&&($((a=s.ranges[a]).from(),n)<0||n.xRel>0)&&($(a.to(),n)>0||n.xRel<0)?ko(e,t,n,c):_o(e,t,n,i,c)}function ko(e,t,n,i){var r=e.display,o=+new Date,a=di(e,function(s){la&&(r.scroller.draggable=!1),e.state.draggingText=!1,Ee(document,"mouseup",a),Ee(r.scroller,"drop",a),Math.abs(t.clientX-s.clientX)+Math.abs(t.clientY-s.clientY)<10&&(Oe(s),!i&&+new Date-200<o&&lr(e.doc,n),la||aa&&9==sa?setTimeout(function(){document.body.focus(),r.input.focus()},20):r.input.focus())});la&&(r.scroller.draggable=!0),e.state.draggingText=a,a.copy=va?t.altKey:t.ctrlKey,r.scroller.dragDrop&&r.scroller.dragDrop(),Ha(document,"mouseup",a),Ha(r.scroller,"drop",a)}function _o(e,t,n,i,r){function a(t){if(0!=$(b,t))if(b=t,"rect"==i){for(var r=[],o=e.options.tabSize,a=u(A(h,n.line).text,n.ch,o),s=u(A(h,t.line).text,t.ch,o),l=Math.min(a,s),c=Math.max(a,s),m=Math.min(n.line,t.line),v=Math.min(e.lastLine(),Math.max(n.line,t.line));v>=m;m++){var y=A(h,m).text,w=f(y,l,o);l==c?r.push(new $i(I(m,w),I(m,w))):y.length>w&&r.push(new $i(I(m,w),I(m,f(y,c,o))))}r.length||r.push(new $i(n,n)),pr(h,Oi(g.ranges.slice(0,p).concat(r),p),{origin:"*mouse",scroll:!1}),e.scrollIntoView(t)}else{var C=d,x=C.anchor,k=t;if("single"!=i){var _;_="double"==i?e.findWordAt(t):new $i(I(t.line,0),W(h,I(t.line+1,0))),$(_.anchor,x)>0?(k=_.head,x=F(C.from(),_.anchor)):(k=_.anchor,x=D(C.to(),_.head))}var S=g.ranges.slice(0);S[p]=new $i(W(h,x),k),pr(h,Oi(S,p),Pa)}}function s(t){var n=++C,r=kn(e,t,!0,"rect"==i);if(r)if(0!=$(r,b)){e.curOp.focus=o(),a(r);var l=Nn(c,h);(r.line>=l.to||r.line<l.from)&&setTimeout(di(e,function(){C==n&&s(t)}),150)}else{var u=t.clientY<w.top?-20:t.clientY>w.bottom?20:0;u&&setTimeout(di(e,function(){C==n&&(c.scroller.scrollTop+=u,s(t))}),50)}}function l(t){e.state.selectingText=!1,C=1/0,Oe(t),c.input.focus(),Ee(document,"mousemove",x),Ee(document,"mouseup",k),h.history.lastSelOrigin=null}var c=e.display,h=e.doc;Oe(t);var d,p,g=h.sel,m=g.ranges;if(r&&!t.shiftKey?(p=h.sel.contains(n),d=p>-1?m[p]:new $i(n,n)):(d=h.sel.primary(),p=h.sel.primIndex),ya?t.shiftKey&&t.metaKey:t.altKey)i="rect",r||(d=new $i(n,n)),n=kn(e,t,!0,!0),p=-1;else if("double"==i){var v=e.findWordAt(n);d=e.display.shift||h.extend?sr(h,d,v.anchor,v.head):v}else if("triple"==i){var y=new $i(I(n.line,0),W(h,I(n.line+1,0)));d=e.display.shift||h.extend?sr(h,d,y.anchor,y.head):y}else d=sr(h,d,n);r?-1==p?(p=m.length,pr(h,Oi(m.concat([d]),p),{scroll:!1,origin:"*mouse"})):m.length>1&&m[p].empty()&&"single"==i&&!t.shiftKey?(pr(h,Oi(m.slice(0,p).concat(m.slice(p+1)),0),{scroll:!1,origin:"*mouse"}),g=h.sel):ur(h,p,d,Pa):(p=0,pr(h,new Ii([d],0),Pa),g=h.sel);var b=n,w=c.wrapper.getBoundingClientRect(),C=0,x=di(e,function(e){je(e)?s(e):l(e)}),k=di(e,l);e.state.selectingText=k,Ha(document,"mousemove",x),Ha(document,"mouseup",k)}function Ao(e,t,n,i){var r,o;try{r=t.clientX,o=t.clientY}catch(t){return!1}if(r>=Math.floor(e.display.gutters.getBoundingClientRect().right))return!1;i&&Oe(t);var a=e.display,s=a.lineDiv.getBoundingClientRect();if(o>s.bottom||!Ie(e,n))return Fe(t);o-=s.top-a.viewOffset;for(var l=0;l<e.options.gutters.length;++l){var c=a.gutters.childNodes[l];if(c&&c.getBoundingClientRect().right>=r){var u=M(e.doc,o),h=e.options.gutters[l];return Me(e,n,e,u,h,t),Fe(t)}}}function So(e,t){return Ao(e,t,"gutterClick",!0)}function To(e,t){Wt(e.display,t)||Lo(e,t)||Pe(e,t,"contextmenu")||e.display.input.onContextMenu(t)}function Lo(e,t){return Ie(e,"gutterContextMenu")?Ao(e,t,"gutterContextMenu",!1):!1}function Eo(e){e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+e.options.theme.replace(/(^|\s)\s*/g," cm-s-"),an(e)}function Mo(e){function t(t,i,r,o){e.defaults[t]=i,r&&(n[t]=o?function(e,t,n){n!=xs&&r(e,t,n)}:r)}var n=e.optionHandlers;e.defineOption=t,e.Init=xs,t("value","",function(e,t){return e.setValue(t)},!0),t("mode",null,function(e,t){e.doc.modeOption=t,Bi(e)},!0),t("indentUnit",2,Bi,!0),t("indentWithTabs",!1),t("smartIndent",!0),t("tabSize",4,function(e){Ui(e),an(e),gi(e)},!0),t("lineSeparator",null,function(e,t){if(e.doc.lineSep=t,t){var n=[],i=e.doc.first;e.doc.iter(function(e){for(var r=0;;){var o=e.text.indexOf(t,r);if(-1==o)break;r=o+t.length,n.push(I(i,o))}i++});for(var r=n.length-1;r>=0;r--)Mr(e.doc,t,n[r],I(n[r].line,n[r].ch+t.length))}}),t("specialChars",/[\u0000-\u001f\u007f\u00ad\u200b-\u200f\u2028\u2029\ufeff]/g,function(e,t,n){e.state.specialChars=new RegExp(t.source+(t.test("	")?"":"|	"),"g"),n!=xs&&e.refresh()}),t("specialCharPlaceholder",ft,function(e){return e.refresh()},!0),t("electricChars",!0),t("inputStyle",ma?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},!0),t("spellcheck",!1,function(e,t){return e.getInputField().spellcheck=t},!0),t("rtlMoveVisually",!ba),t("wholeLineUpdateBefore",!0),t("theme","default",function(e){Eo(e),Po(e)},!0),t("keyMap","default",function(e,t,n){var i=ao(t),r=n!=xs&&ao(n);r&&r.detach&&r.detach(e,i),i.attach&&i.attach(e,r||null)}),t("extraKeys",null),t("lineWrapping",!1,Io,!0),t("gutters",[],function(e){Ri(e.options),Po(e)},!0),t("fixedGutter",!0,function(e,t){e.display.gutters.style.left=t?wn(e.display)+"px":"0",e.refresh()},!0),t("coverGutterNextToScrollbar",!1,function(e){return Yn(e)},!0),t("scrollbarStyle","native",function(e){Vn(e),Yn(e),e.display.scrollbars.setScrollTop(e.doc.scrollTop),e.display.scrollbars.setScrollLeft(e.doc.scrollLeft)},!0),t("lineNumbers",!1,function(e){Ri(e.options),Po(e)},!0),t("firstLineNumber",1,Po,!0),t("lineNumberFormatter",function(e){return e},Po,!0),t("showCursorWhenSelecting",!1,An,!0),t("resetSelectionOnContextMenu",!0),t("lineWiseCopyCut",!0),t("readOnly",!1,function(e,t){"nocursor"==t?(In(e),e.display.input.blur(),e.display.disabled=!0):e.display.disabled=!1,e.display.input.readOnlyChanged(t)}),t("disableInput",!1,function(e,t){t||e.display.input.reset()},!0),t("dragDrop",!0,Ro),t("allowDropFileTypes",null),t("cursorBlinkRate",530),t("cursorScrollMargin",0),t("cursorHeight",1,An,!0),t("singleCursorHeightPerLine",!0,An,!0),t("workTime",100),t("workDelay",100),t("flattenSpans",!0,Ui,!0),t("addModeClass",!1,Ui,!0),t("pollInterval",100),t("undoDepth",200,function(e,t){return e.doc.history.undoDepth=t}),t("historyEventDelay",1250),t("viewportMargin",10,function(e){return e.refresh()},!0),t("maxHighlightLength",1e4,Ui,!0),t("moveInputWithCursor",!0,function(e,t){t||e.display.input.resetPosition()}),t("tabindex",null,function(e,t){return e.display.input.getField().tabIndex=t||""}),t("autofocus",null)}function Po(e){Pi(e),gi(e),setTimeout(function(){return $n(e)},20)}function Ro(e,t,n){var i=n&&n!=xs;if(!t!=!i){var r=e.display.dragFunctions,o=t?Ha:Ee;o(e.display.scroller,"dragstart",r.start),o(e.display.scroller,"dragenter",r.enter),o(e.display.scroller,"dragover",r.over),o(e.display.scroller,"dragleave",r.leave),o(e.display.scroller,"drop",r.drop)}}function Io(e){e.options.lineWrapping?(a(e.display.wrapper,"CodeMirror-wrap"),e.display.sizer.style.minWidth="",e.display.sizerWidth=null):(_a(e.display.wrapper,"CodeMirror-wrap"),me(e)),xn(e),gi(e),an(e),setTimeout(function(){return Yn(e)},100)}function $o(e,t){var n=this;if(!(this instanceof $o))return new $o(e,t);this.options=t=t?c(t):{},c(ks,t,!1),Ri(t);var i=t.value;"string"==typeof i&&(i=new cs(i,t.mode,null,t.lineSeparator)),this.doc=i;var r=new $o.inputStyles[t.inputStyle](this),o=this.display=new _(e,i,r);o.wrapper.CodeMirror=this,Pi(this),Eo(this),t.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),t.autofocus&&!ma&&o.input.focus(),Vn(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:!1,cutIncoming:!1,selectingText:!1,draggingText:!1,highlight:new h,keySeq:null,specialChars:null},aa&&11>sa&&setTimeout(function(){return n.display.input.reset(!0)},20),Oo(this),Qr(),ii(this),this.curOp.forceUpdate=!0,Yi(this,i),t.autofocus&&!ma||this.hasFocus()?setTimeout(l(Rn,this),20):In(this);for(var a in _s)_s.hasOwnProperty(a)&&_s[a](n,t[a],xs);On(this),t.finishInit&&t.finishInit(this);for(var s=0;s<As.length;++s)As[s](n);ri(this),la&&t.lineWrapping&&"optimizelegibility"==getComputedStyle(o.lineDiv).textRendering&&(o.lineDiv.style.textRendering="auto")}function Oo(e){function t(){r.activeTouch&&(o=setTimeout(function(){return r.activeTouch=null},1e3),a=r.activeTouch,a.end=+new Date)}function n(e){if(1!=e.touches.length)return!1;var t=e.touches[0];return t.radiusX<=1&&t.radiusY<=1}function i(e,t){if(null==t.left)return!0;var n=t.left-e.left,i=t.top-e.top;return n*n+i*i>400}var r=e.display;Ha(r.scroller,"mousedown",di(e,Co)),aa&&11>sa?Ha(r.scroller,"dblclick",di(e,function(t){if(!Pe(e,t)){var n=kn(e,t);if(n&&!So(e,t)&&!Wt(e.display,t)){Oe(t);var i=e.findWordAt(n);lr(e.doc,i.anchor,i.head)}}})):Ha(r.scroller,"dblclick",function(t){return Pe(e,t)||Oe(t)}),ka||Ha(r.scroller,"contextmenu",function(t){return To(e,t)});var o,a={end:0};Ha(r.scroller,"touchstart",function(t){if(!Pe(e,t)&&!n(t)){r.input.ensurePolled(),clearTimeout(o);var i=+new Date;r.activeTouch={start:i,moved:!1,prev:i-a.end<=300?a:null},1==t.touches.length&&(r.activeTouch.left=t.touches[0].pageX,r.activeTouch.top=t.touches[0].pageY)}}),Ha(r.scroller,"touchmove",function(){r.activeTouch&&(r.activeTouch.moved=!0)}),Ha(r.scroller,"touchend",function(n){var o=r.activeTouch;if(o&&!Wt(r,n)&&null!=o.left&&!o.moved&&new Date-o.start<300){var a,s=e.coordsChar(r.activeTouch,"page");a=!o.prev||i(o,o.prev)?new $i(s,s):!o.prev.prev||i(o,o.prev.prev)?e.findWordAt(s):new $i(I(s.line,0),W(e.doc,I(s.line+1,0))),e.setSelection(a.anchor,a.head),e.focus(),Oe(n)}t()}),Ha(r.scroller,"touchcancel",t),Ha(r.scroller,"scroll",function(){r.scroller.clientHeight&&(Wn(e,r.scroller.scrollTop),jn(e,r.scroller.scrollLeft,!0),Me(e,"scroll",e))}),Ha(r.scroller,"mousewheel",function(t){return Un(e,t)}),Ha(r.scroller,"DOMMouseScroll",function(t){return Un(e,t)}),Ha(r.wrapper,"scroll",function(){return r.wrapper.scrollTop=r.wrapper.scrollLeft=0}),r.dragFunctions={enter:function(t){Pe(e,t)||Ne(t)},over:function(t){Pe(e,t)||(Vr(e,t),Ne(t))},start:function(t){return Kr(e,t)},drop:di(e,Yr),leave:function(t){Pe(e,t)||Xr(e)}};var s=r.input.getField();Ha(s,"keyup",function(t){return bo.call(e,t)}),Ha(s,"keydown",di(e,vo)),Ha(s,"keypress",di(e,wo)),Ha(s,"focus",function(t){return Rn(e,t)}),Ha(s,"blur",function(t){return In(e,t)})}function Do(e,t,n,i){var r,o=e.doc;null==n&&(n="add"),"smart"==n&&(o.mode.indent?r=et(e,t):n="prev");var a=e.options.tabSize,s=A(o,t),l=u(s.text,null,a);s.stateAfter&&(s.stateAfter=null);var c,h=s.text.match(/^\s*/)[0];if(i||/\S/.test(s.text)){if("smart"==n&&(c=o.mode.indent(r,s.text.slice(h.length),s.text),c==Ea||c>150)){if(!i)return;n="prev"}}else c=0,n="not";"prev"==n?c=t>o.first?u(A(o,t-1).text,null,a):0:"add"==n?c=l+e.options.indentUnit:"subtract"==n?c=l-e.options.indentUnit:"number"==typeof n&&(c=l+n),c=Math.max(0,c);var d="",f=0;if(e.options.indentWithTabs)for(var g=Math.floor(c/a);g;--g)f+=a,d+="	";if(c>f&&(d+=p(c-f)),d!=h)return Mr(o,d,I(t,0),I(t,h.length),"+input"),s.stateAfter=null,!0;for(var m=0;m<o.sel.ranges.length;m++){var v=o.sel.ranges[m];if(v.head.line==t&&v.head.ch<h.length){var y=I(t,h.length);ur(o,m,new $i(y,y));break}}}function Fo(e){Ss=e}function No(e,t,n,i,r){var o=e.doc;e.display.shift=!1,i||(i=o.sel);var a=e.state.pasteIncoming||"paste"==r,s=Ua(t),l=null;if(a&&i.ranges.length>1)if(Ss&&Ss.text.join("\n")==t){if(i.ranges.length%Ss.text.length==0){l=[];for(var c=0;c<Ss.text.length;c++)l.push(o.splitLines(Ss.text[c]))}}else s.length==i.ranges.length&&(l=m(s,function(e){return[e]}));for(var u,h=i.ranges.length-1;h>=0;h--){var d=i.ranges[h],f=d.from(),p=d.to();d.empty()&&(n&&n>0?f=I(f.line,f.ch-n):e.state.overwrite&&!a?p=I(p.line,Math.min(A(o,p.line).text.length,p.ch+g(s).length)):Ss&&Ss.lineWise&&Ss.text.join("\n")==t&&(f=p=I(f.line,0))),u=e.curOp.updateInput;var v={from:f,to:p,text:l?l[h%l.length]:s,origin:r||(a?"paste":e.state.cutIncoming?"cut":"+input")};_r(e.doc,v),_t(e,"inputRead",e,v)}t&&!a&&jo(e,t),ti(e),e.curOp.updateInput=u,e.curOp.typing=!0,e.state.pasteIncoming=e.state.cutIncoming=!1}function Wo(e,t){var n=e.clipboardData&&e.clipboardData.getData("Text");return n?(e.preventDefault(),t.isReadOnly()||t.options.disableInput||hi(t,function(){return No(t,n,0,null,"paste")}),!0):void 0}function jo(e,t){if(e.options.electricChars&&e.options.smartIndent)for(var n=e.doc.sel,i=n.ranges.length-1;i>=0;i--){var r=n.ranges[i];if(!(r.head.ch>100||i&&n.ranges[i-1].head.line==r.head.line)){var o=e.getModeAt(r.head),a=!1;if(o.electricChars){for(var s=0;s<o.electricChars.length;s++)if(t.indexOf(o.electricChars.charAt(s))>-1){a=Do(e,r.head.line,"smart");break}}else o.electricInput&&o.electricInput.test(A(e.doc,r.head.line).text.slice(0,r.head.ch))&&(a=Do(e,r.head.line,"smart"));a&&_t(e,"electricInput",e,r.head.line)}}}function Ho(e){for(var t=[],n=[],i=0;i<e.doc.sel.ranges.length;i++){var r=e.doc.sel.ranges[i].head.line,o={anchor:I(r,0),head:I(r+1,0)};n.push(o),t.push(e.getRange(o.anchor,o.head))}return{text:t,ranges:n}}function Bo(e,t){e.setAttribute("autocorrect","off"),e.setAttribute("autocapitalize","off"),e.setAttribute("spellcheck",!!t)}function Uo(){var e=i("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; outline: none"),t=i("div",[e],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");
return la?e.style.width="1000px":e.setAttribute("wrap","off"),ga&&(e.style.border="1px solid black"),Bo(e),t}function zo(e,t,n,i,r){function o(){var t=s+n;return t<e.first||t>=e.first+e.size?!1:(s=t,u=A(e,t))}function a(e){var t=(r?Ae:Se)(u,l,n,!0);if(null==t){if(e||!o())return!1;l=r?(0>n?Ce:we)(u):0>n?u.text.length:0}else l=t;return!0}var s=t.line,l=t.ch,c=n,u=A(e,s);if("char"==i)a();else if("column"==i)a(!0);else if("word"==i||"group"==i)for(var h=null,d="group"==i,f=e.cm&&e.cm.getHelper(t,"wordChars"),p=!0;!(0>n)||a(!p);p=!1){var g=u.text.charAt(l)||"\n",m=C(g,f)?"w":d&&"\n"==g?"n":!d||/\s/.test(g)?null:"p";if(!d||p||m||(m="s"),h&&h!=m){0>n&&(n=1,a());break}if(m&&(h=m),n>0&&!a(!p))break}var v=wr(e,I(s,l),t,c,!0);return $(t,v)||(v.hitSide=!0),v}function Go(e,t,n,i){var r,o=e.doc,a=t.left;if("page"==i){var s=Math.min(e.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight),l=Math.max(s-.5*vn(e.display),3);r=(n>0?t.bottom:t.top)+n*l}else"line"==i&&(r=n>0?t.bottom+3:t.top-3);for(var c;c=gn(e,a,r),c.outside;){if(0>n?0>=r:r>=o.height){c.hitSide=!0;break}r+=5*n}return c}function qo(e){this.cm=e,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new h,this.composing=null,this.gracePeriod=!1,this.readDOMTimeout=null}function Yo(e,t){var n=Xt(e,t.line);if(!n||n.hidden)return null;var i=A(e.doc,t.line),r=Yt(n,i,t.line),o=Te(i),a="left";if(o){var s=ke(o,t.ch);a=s%2?"right":"left"}var l=Zt(r.map,t.ch,a);return l.offset="right"==l.collapse?l.end:l.start,l}function Ko(e,t){return t&&(e.bad=!0),e}function Vo(e,t,n,i,r){function o(e){return function(t){return t.id==e}}function a(t){if(1==t.nodeType){var n=t.getAttribute("cm-text");if(null!=n)return void(s+=""==n?t.textContent.replace(/\u200b/g,""):n);var u,h=t.getAttribute("cm-marker");if(h){var d=e.findMarks(I(i,0),I(r+1,0),o(+h));return void(d.length&&(u=d[0].find())&&(s+=S(e.doc,u.from,u.to).join(c)))}if("false"==t.getAttribute("contenteditable"))return;for(var f=0;f<t.childNodes.length;f++)a(t.childNodes[f]);/^(pre|div|p)$/i.test(t.nodeName)&&(l=!0)}else if(3==t.nodeType){var p=t.nodeValue;if(!p)return;l&&(s+=c,l=!1),s+=p}}for(var s="",l=!1,c=e.doc.lineSeparator();a(t),t!=n;)t=t.nextSibling;return s}function Xo(e,t,n){var i;if(t==e.display.lineDiv){if(i=e.display.lineDiv.childNodes[n],!i)return Ko(e.clipPos(I(e.display.viewTo-1)),!0);t=null,n=0}else for(i=t;;i=i.parentNode){if(!i||i==e.display.lineDiv)return null;if(i.parentNode&&i.parentNode==e.display.lineDiv)break}for(var r=0;r<e.display.view.length;r++){var o=e.display.view[r];if(o.node==i)return Jo(o,t,n)}}function Jo(e,t,n){function i(t,n,i){for(var r=-1;r<(h?h.length:0);r++)for(var o=0>r?u.map:h[r],a=0;a<o.length;a+=3){var s=o[a+2];if(s==t||s==n){var l=E(0>r?e.line:e.rest[r]),c=o[a]+i;return(0>i||s!=t)&&(c=o[a+(i?1:0)]),I(l,c)}}}var o=e.text.firstChild,a=!1;if(!t||!r(o,t))return Ko(I(E(e.line),0),!0);if(t==o&&(a=!0,t=o.childNodes[n],n=0,!t)){var s=e.rest?g(e.rest):e.line;return Ko(I(E(s),s.text.length),a)}var l=3==t.nodeType?t:null,c=t;for(l||1!=t.childNodes.length||3!=t.firstChild.nodeType||(l=t.firstChild,n&&(n=l.nodeValue.length));c.parentNode!=o;)c=c.parentNode;var u=e.measure,h=u.maps,d=i(l,c,n);if(d)return Ko(d,a);for(var f=c.nextSibling,p=l?l.nodeValue.length-n:0;f;f=f.nextSibling){if(d=i(f,f.firstChild,0))return Ko(I(d.line,d.ch-p),a);p+=f.textContent.length}for(var m=c.previousSibling,v=n;m;m=m.previousSibling){if(d=i(m,m.firstChild,-1))return Ko(I(d.line,d.ch+v),a);v+=m.textContent.length}}function Qo(e){this.cm=e,this.prevInput="",this.pollingFast=!1,this.polling=new h,this.inaccurateSelection=!1,this.hasSelection=!1,this.composing=null}function Zo(e,t){function n(){e.value=u.getValue()}if(t=t?c(t):{},t.value=e.value,!t.tabindex&&e.tabIndex&&(t.tabindex=e.tabIndex),!t.placeholder&&e.placeholder&&(t.placeholder=e.placeholder),null==t.autofocus){var i=o();t.autofocus=i==e||null!=e.getAttribute("autofocus")&&i==document.body}var r;if(e.form&&(Ha(e.form,"submit",n),!t.leaveSubmitMethodAlone)){var a=e.form;r=a.submit;try{var s=a.submit=function(){n(),a.submit=r,a.submit(),a.submit=s}}catch(l){}}t.finishInit=function(t){t.save=n,t.getTextArea=function(){return e},t.toTextArea=function(){t.toTextArea=isNaN,n(),e.parentNode.removeChild(t.getWrapperElement()),e.style.display="",e.form&&(Ee(e.form,"submit",n),"function"==typeof e.form.submit&&(e.form.submit=r))}},e.style.display="none";var u=$o(function(t){return e.parentNode.insertBefore(t,e.nextSibling)},t);return u}function ea(e){e.off=Ee,e.on=Ha,e.wheelEventPixels=Bn,e.Doc=cs,e.splitLines=Ua,e.countColumn=u,e.findColumn=f,e.isWordChar=w,e.Pass=Ea,e.signal=Me,e.Line=lt,e.changeEnd=Fi,e.scrollbarModel=os,e.Pos=I,e.cmpPos=$,e.modes=Ya,e.mimeModes=Ka,e.resolveMode=qe,e.getMode=Ye,e.modeExtensions=Va,e.extendMode=Ke,e.copyState=Ve,e.startState=Je,e.innerMode=Xe,e.commands=bs,e.keyMap=ms,e.keyName=oo,e.isModifierKey=ro,e.lookupKey=io,e.normalizeKeyMap=no,e.StringStream=Xa,e.SharedTextMarker=Br,e.TextMarker=jr,e.LineWidget=Fr,e.e_preventDefault=Oe,e.e_stopPropagation=De,e.e_stop=Ne,e.addClass=a,e.contains=r,e.rmClass=_a,e.keyNames=ds}var ta=navigator.userAgent,na=navigator.platform,ia=/gecko\/\d/i.test(ta),ra=/MSIE \d/.test(ta),oa=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(ta),aa=ra||oa,sa=aa&&(ra?document.documentMode||6:oa[1]),la=/WebKit\//.test(ta),ca=la&&/Qt\/\d+\.\d+/.test(ta),ua=/Chrome\//.test(ta),ha=/Opera\//.test(ta),da=/Apple Computer/.test(navigator.vendor),fa=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(ta),pa=/PhantomJS/.test(ta),ga=/AppleWebKit/.test(ta)&&/Mobile\/\w+/.test(ta),ma=ga||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(ta),va=ga||/Mac/.test(na),ya=/\bCrOS\b/.test(ta),ba=/win/i.test(na),wa=ha&&ta.match(/Version\/(\d*\.\d*)/);wa&&(wa=Number(wa[1])),wa&&wa>=15&&(ha=!1,la=!0);var Ca,xa=va&&(ca||ha&&(null==wa||12.11>wa)),ka=ia||aa&&sa>=9,_a=function(t,n){var i=t.className,r=e(n).exec(i);if(r){var o=i.slice(r.index+r[0].length);t.className=i.slice(0,r.index)+(o?r[1]+o:"")}};Ca=document.createRange?function(e,t,n,i){var r=document.createRange();return r.setEnd(i||e,n),r.setStart(e,t),r}:function(e,t,n){var i=document.body.createTextRange();try{i.moveToElementText(e.parentNode)}catch(r){return i}return i.collapse(!0),i.moveEnd("character",n),i.moveStart("character",t),i};var Aa=function(e){e.select()};ga?Aa=function(e){e.selectionStart=0,e.selectionEnd=e.value.length}:aa&&(Aa=function(e){try{e.select()}catch(t){}}),h.prototype.set=function(e,t){clearTimeout(this.id),this.id=setTimeout(t,e)};var Sa,Ta,La=30,Ea={toString:function(){return"CodeMirror.Pass"}},Ma={scroll:!1},Pa={origin:"*mouse"},Ra={origin:"+move"},Ia=[""],$a=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/,Oa=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/,Da=!1,Fa=!1,Na=null,Wa=function(){function e(e){return 247>=e?n.charAt(e):e>=1424&&1524>=e?"R":e>=1536&&1773>=e?i.charAt(e-1536):e>=1774&&2220>=e?"r":e>=8192&&8203>=e?"w":8204==e?"b":"L"}function t(e,t,n){this.level=e,this.from=t,this.to=n}var n="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",i="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmm",r=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,o=/[stwN]/,a=/[LRr]/,s=/[Lb1n]/,l=/[1n]/,c="L";return function(n){if(!r.test(n))return!1;for(var i=n.length,u=[],h=0;i>h;++h)u.push(e(n.charCodeAt(h)));for(var d=0,f=c;i>d;++d){var p=u[d];"m"==p?u[d]=f:f=p}for(var m=0,v=c;i>m;++m){var y=u[m];"1"==y&&"r"==v?u[m]="n":a.test(y)&&(v=y,"r"==y&&(u[m]="R"))}for(var b=1,w=u[0];i-1>b;++b){var C=u[b];"+"==C&&"1"==w&&"1"==u[b+1]?u[b]="1":","!=C||w!=u[b+1]||"1"!=w&&"n"!=w||(u[b]=w),w=C}for(var x=0;i>x;++x){var k=u[x];if(","==k)u[x]="N";else if("%"==k){var _=void 0;for(_=x+1;i>_&&"%"==u[_];++_);for(var A=x&&"!"==u[x-1]||i>_&&"1"==u[_]?"1":"N",S=x;_>S;++S)u[S]=A;x=_-1}}for(var T=0,L=c;i>T;++T){var E=u[T];"L"==L&&"1"==E?u[T]="L":a.test(E)&&(L=E)}for(var M=0;i>M;++M)if(o.test(u[M])){var P=void 0;for(P=M+1;i>P&&o.test(u[P]);++P);for(var R="L"==(M?u[M-1]:c),I="L"==(i>P?u[P]:c),$=R||I?"L":"R",O=M;P>O;++O)u[O]=$;M=P-1}for(var D,F=[],N=0;i>N;)if(s.test(u[N])){var W=N;for(++N;i>N&&s.test(u[N]);++N);F.push(new t(0,W,N))}else{var j=N,H=F.length;for(++N;i>N&&"L"!=u[N];++N);for(var B=j;N>B;)if(l.test(u[B])){B>j&&F.splice(H,0,new t(1,j,B));var U=B;for(++B;N>B&&l.test(u[B]);++B);F.splice(H,0,new t(2,U,B)),j=B}else++B;N>j&&F.splice(H,0,new t(1,j,N))}return 1==F[0].level&&(D=n.match(/^\s+/))&&(F[0].from=D[0].length,F.unshift(new t(0,0,D[0].length))),1==g(F).level&&(D=n.match(/\s+$/))&&(g(F).to-=D[0].length,F.push(new t(0,i-D[0].length,i))),2==F[0].level&&F.unshift(new t(1,F[0].to,F[0].to)),F[0].level!=g(F).level&&F.push(new t(F[0].level,i,i)),F}}(),ja=[],Ha=function(e,t,n){if(e.addEventListener)e.addEventListener(t,n,!1);else if(e.attachEvent)e.attachEvent("on"+t,n);else{var i=e._handlers||(e._handlers={});i[t]=(i[t]||ja).concat(n)}},Ba=function(){if(aa&&9>sa)return!1;var e=i("div");return"draggable"in e||"dragDrop"in e}(),Ua=3!="\n\nb".split(/\n/).length?function(e){for(var t=0,n=[],i=e.length;i>=t;){var r=e.indexOf("\n",t);-1==r&&(r=e.length);var o=e.slice(t,"\r"==e.charAt(r-1)?r-1:r),a=o.indexOf("\r");-1!=a?(n.push(o.slice(0,a)),t+=a+1):(n.push(o),t=r+1)}return n}:function(e){return e.split(/\r\n?|\n/)},za=window.getSelection?function(e){try{return e.selectionStart!=e.selectionEnd}catch(t){return!1}}:function(e){var t;try{t=e.ownerDocument.selection.createRange()}catch(n){}return t&&t.parentElement()==e?0!=t.compareEndPoints("StartToEnd",t):!1},Ga=function(){var e=i("div");return"oncopy"in e?!0:(e.setAttribute("oncopy","return;"),"function"==typeof e.oncopy)}(),qa=null,Ya={},Ka={},Va={},Xa=function(e,t){this.pos=this.start=0,this.string=e,this.tabSize=t||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0};Xa.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==this.lineStart},peek:function(){return this.string.charAt(this.pos)||void 0},next:function(){return this.pos<this.string.length?this.string.charAt(this.pos++):void 0},eat:function(e){var t,n=this.string.charAt(this.pos);return t="string"==typeof e?n==e:n&&(e.test?e.test(n):e(n)),t?(++this.pos,n):void 0},eatWhile:function(e){for(var t=this.pos;this.eat(e););return this.pos>t},eatSpace:function(){for(var e=this,t=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++e.pos;return this.pos>t},skipToEnd:function(){this.pos=this.string.length},skipTo:function(e){var t=this.string.indexOf(e,this.pos);return t>-1?(this.pos=t,!0):void 0},backUp:function(e){this.pos-=e},column:function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=u(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?u(this.string,this.lineStart,this.tabSize):0)},indentation:function(){return u(this.string,null,this.tabSize)-(this.lineStart?u(this.string,this.lineStart,this.tabSize):0)},match:function(e,t,n){if("string"!=typeof e){var i=this.string.slice(this.pos).match(e);return i&&i.index>0?null:(i&&t!==!1&&(this.pos+=i[0].length),i)}var r=function(e){return n?e.toLowerCase():e},o=this.string.substr(this.pos,e.length);return r(o)==r(e)?(t!==!1&&(this.pos+=e.length),!0):void 0},current:function(){return this.string.slice(this.start,this.pos)},hideFirstChars:function(e,t){this.lineStart+=e;try{return t()}finally{this.lineStart-=e}}},$e(lt),lt.prototype.lineNo=function(){return E(this)};var Ja,Qa={},Za={},es=null,ts=null,ns={left:0,right:0,top:0,bottom:0},is=0,rs=null;aa?rs=-.53:ia?rs=15:ua?rs=-.7:da&&(rs=-1/3),Gn.prototype=c({update:function(e){var t=e.scrollWidth>e.clientWidth+1,n=e.scrollHeight>e.clientHeight+1,i=e.nativeBarWidth;if(n){this.vert.style.display="block",this.vert.style.bottom=t?i+"px":"0";var r=e.viewHeight-(t?i:0);this.vert.firstChild.style.height=Math.max(0,e.scrollHeight-e.clientHeight+r)+"px"}else this.vert.style.display="",this.vert.firstChild.style.height="0";if(t){this.horiz.style.display="block",this.horiz.style.right=n?i+"px":"0",this.horiz.style.left=e.barLeft+"px";var o=e.viewWidth-e.barLeft-(n?i:0);this.horiz.firstChild.style.width=e.scrollWidth-e.clientWidth+o+"px"}else this.horiz.style.display="",this.horiz.firstChild.style.width="0";return!this.checkedZeroWidth&&e.clientHeight>0&&(0==i&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:n?i:0,bottom:t?i:0}},setScrollLeft:function(e){this.horiz.scrollLeft!=e&&(this.horiz.scrollLeft=e),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz)},setScrollTop:function(e){this.vert.scrollTop!=e&&(this.vert.scrollTop=e),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert)},zeroWidthHack:function(){var e=va&&!fa?"12px":"18px";this.horiz.style.height=this.vert.style.width=e,this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none",this.disableHoriz=new h,this.disableVert=new h},enableZeroWidthBar:function(e,t){function n(){var i=e.getBoundingClientRect(),r=document.elementFromPoint(i.left+1,i.bottom-1);r!=e?e.style.pointerEvents="none":t.set(1e3,n)}e.style.pointerEvents="auto",t.set(1e3,n)},clear:function(){var e=this.horiz.parentNode;e.removeChild(this.horiz),e.removeChild(this.vert)}},Gn.prototype),qn.prototype=c({update:function(){return{bottom:0,right:0}},setScrollLeft:function(){},setScrollTop:function(){},clear:function(){}},qn.prototype);var os={"native":Gn,"null":qn},as=0;ki.prototype.signal=function(e,t){Ie(e,t)&&this.events.push(arguments)},ki.prototype.finish=function(){for(var e=this,t=0;t<this.events.length;t++)Me.apply(null,e.events[t])},Ii.prototype={primary:function(){return this.ranges[this.primIndex]},equals:function(e){var t=this;if(e==this)return!0;if(e.primIndex!=this.primIndex||e.ranges.length!=this.ranges.length)return!1;for(var n=0;n<this.ranges.length;n++){var i=t.ranges[n],r=e.ranges[n];if(0!=$(i.anchor,r.anchor)||0!=$(i.head,r.head))return!1}return!0},deepCopy:function(){for(var e=this,t=[],n=0;n<this.ranges.length;n++)t[n]=new $i(O(e.ranges[n].anchor),O(e.ranges[n].head));return new Ii(t,this.primIndex)},somethingSelected:function(){for(var e=this,t=0;t<this.ranges.length;t++)if(!e.ranges[t].empty())return!0;return!1},contains:function(e,t){var n=this;t||(t=e);for(var i=0;i<this.ranges.length;i++){var r=n.ranges[i];if($(t,r.from())>=0&&$(e,r.to())<=0)return i}return-1}},$i.prototype={from:function(){return F(this.anchor,this.head)},to:function(){return D(this.anchor,this.head)},empty:function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch}},Or.prototype={chunkSize:function(){return this.lines.length},removeInner:function(e,t){for(var n=this,i=e,r=e+t;r>i;++i){var o=n.lines[i];n.height-=o.height,ut(o),_t(o,"delete")}this.lines.splice(e,t)},collapse:function(e){e.push.apply(e,this.lines)},insertInner:function(e,t,n){var i=this;this.height+=n,this.lines=this.lines.slice(0,e).concat(t).concat(this.lines.slice(e));for(var r=0;r<t.length;++r)t[r].parent=i},iterN:function(e,t,n){for(var i=this,r=e+t;r>e;++e)if(n(i.lines[e]))return!0}},Dr.prototype={chunkSize:function(){return this.size},removeInner:function(e,t){var n=this;this.size-=t;for(var i=0;i<this.children.length;++i){var r=n.children[i],o=r.chunkSize();if(o>e){var a=Math.min(t,o-e),s=r.height;if(r.removeInner(e,a),n.height-=s-r.height,o==a&&(n.children.splice(i--,1),r.parent=null),0==(t-=a))break;e=0}else e-=o}if(this.size-t<25&&(this.children.length>1||!(this.children[0]instanceof Or))){var l=[];this.collapse(l),this.children=[new Or(l)],this.children[0].parent=this}},collapse:function(e){for(var t=this,n=0;n<this.children.length;++n)t.children[n].collapse(e)},insertInner:function(e,t,n){var i=this;this.size+=t.length,this.height+=n;for(var r=0;r<this.children.length;++r){var o=i.children[r],a=o.chunkSize();if(a>=e){if(o.insertInner(e,t,n),o.lines&&o.lines.length>50){for(var s=o.lines.length%25+25,l=s;l<o.lines.length;){var c=new Or(o.lines.slice(l,l+=25));o.height-=c.height,i.children.splice(++r,0,c),c.parent=i}o.lines=o.lines.slice(0,s),i.maybeSpill()}break}e-=a}},maybeSpill:function(){if(!(this.children.length<=10)){var e=this;do{var t=e.children.splice(e.children.length-5,5),n=new Dr(t);if(e.parent){e.size-=n.size,e.height-=n.height;var i=d(e.parent.children,e);e.parent.children.splice(i+1,0,n)}else{var r=new Dr(e.children);r.parent=e,e.children=[r,n],e=r}n.parent=e.parent}while(e.children.length>10);e.parent.maybeSpill()}},iterN:function(e,t,n){for(var i=this,r=0;r<this.children.length;++r){var o=i.children[r],a=o.chunkSize();if(a>e){var s=Math.min(t,a-e);if(o.iterN(e,s,n))return!0;if(0==(t-=s))break;e=0}else e-=a}}},$e(Fr),Fr.prototype.clear=function(){var e=this,t=this.doc.cm,n=this.line.widgets,i=this.line,r=E(i);if(null!=r&&n){for(var o=0;o<n.length;++o)n[o]==e&&n.splice(o--,1);n.length||(i.widgets=null);var a=Nt(this);L(i,Math.max(0,i.height-a)),t&&hi(t,function(){Nr(t,i,-a),mi(t,r,"widget")})}},Fr.prototype.changed=function(){var e=this.height,t=this.doc.cm,n=this.line;this.height=null;var i=Nt(this)-e;i&&(L(n,n.height+i),t&&hi(t,function(){t.curOp.forceUpdate=!0,Nr(t,n,i)}))};var ss=0;$e(jr),jr.prototype.clear=function(){var e=this;if(!this.explicitlyCleared){var t=this.doc.cm,n=t&&!t.curOp;if(n&&ii(t),Ie(this,"clear")){var i=this.find();i&&_t(this,"clear",i.from,i.to)}for(var r=null,o=null,a=0;a<this.lines.length;++a){var s=e.lines[a],l=G(s.markedSpans,e);t&&!e.collapsed?mi(t,E(s),"text"):t&&(null!=l.to&&(o=E(s)),null!=l.from&&(r=E(s))),s.markedSpans=q(s.markedSpans,l),null==l.from&&e.collapsed&&!de(e.doc,s)&&t&&L(s,vn(t.display))}if(t&&this.collapsed&&!t.options.lineWrapping)for(var c=0;c<this.lines.length;++c){var u=le(e.lines[c]),h=ge(u);h>t.display.maxLineLength&&(t.display.maxLine=u,t.display.maxLineLength=h,t.display.maxLineChanged=!0)}null!=r&&t&&this.collapsed&&gi(t,r,o+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,t&&vr(t.doc)),t&&_t(t,"markerCleared",t,this),n&&ri(t),this.parent&&this.parent.clear()}},jr.prototype.find=function(e,t){var n=this;null==e&&"bookmark"==this.type&&(e=1);for(var i,r,o=0;o<this.lines.length;++o){var a=n.lines[o],s=G(a.markedSpans,n);if(null!=s.from&&(i=I(t?a:E(a),s.from),-1==e))return i;if(null!=s.to&&(r=I(t?a:E(a),s.to),1==e))return r}return i&&{from:i,to:r}},jr.prototype.changed=function(){var e=this.find(-1,!0),t=this,n=this.doc.cm;e&&n&&hi(n,function(){var i=e.line,r=E(e.line),o=Xt(n,r);if(o&&(rn(o),n.curOp.selectionChanged=n.curOp.forceUpdate=!0),n.curOp.updateMaxLine=!0,!de(t.doc,i)&&null!=t.height){var a=t.height;t.height=null;var s=Nt(t)-a;s&&L(i,i.height+s)}})},jr.prototype.attachLine=function(e){if(!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;t.maybeHiddenMarkers&&-1!=d(t.maybeHiddenMarkers,this)||(t.maybeUnhiddenMarkers||(t.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(e)},jr.prototype.detachLine=function(e){if(this.lines.splice(d(this.lines,e),1),!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;(t.maybeHiddenMarkers||(t.maybeHiddenMarkers=[])).push(this)}},$e(Br),Br.prototype.clear=function(){var e=this;if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var t=0;t<this.markers.length;++t)e.markers[t].clear();_t(this,"clear")}},Br.prototype.find=function(e,t){return this.primary.find(e,t)};var ls=0,cs=function(e,t,n,i){if(!(this instanceof cs))return new cs(e,t,n,i);null==n&&(n=0),Dr.call(this,[new Or([new lt("",null)])]),this.first=n,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.frontier=n;var r=I(n,0);this.sel=Di(r),this.history=new Ki(null),this.id=++ls,this.modeOption=t,this.lineSep=i,this.extend=!1,"string"==typeof e&&(e=this.splitLines(e)),Gi(this,{from:r,to:r,text:e}),pr(this,Di(r),Ma)};cs.prototype=b(Dr.prototype,{constructor:cs,iter:function(e,t,n){n?this.iterN(e-this.first,t-e,n):this.iterN(this.first,this.first+this.size,e)},insert:function(e,t){for(var n=0,i=0;i<t.length;++i)n+=t[i].height;this.insertInner(e-this.first,t,n)},remove:function(e,t){this.removeInner(e-this.first,t)},getValue:function(e){var t=T(this,this.first,this.first+this.size);return e===!1?t:t.join(e||this.lineSeparator())},setValue:pi(function(e){var t=I(this.first,0),n=this.first+this.size-1;_r(this,{from:t,to:I(n,A(this,n).text.length),text:this.splitLines(e),origin:"setValue",full:!0},!0),pr(this,Di(t))}),replaceRange:function(e,t,n,i){t=W(this,t),n=n?W(this,n):t,Mr(this,e,t,n,i)},getRange:function(e,t,n){var i=S(this,W(this,e),W(this,t));return n===!1?i:i.join(n||this.lineSeparator())},getLine:function(e){var t=this.getLineHandle(e);return t&&t.text},getLineHandle:function(e){return P(this,e)?A(this,e):void 0},getLineNumber:function(e){return E(e)},getLineHandleVisualStart:function(e){return"number"==typeof e&&(e=A(this,e)),le(e)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(e){return W(this,e)},getCursor:function(e){var t,n=this.sel.primary();return t=null==e||"head"==e?n.head:"anchor"==e?n.anchor:"end"==e||"to"==e||e===!1?n.to():n.from()},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:pi(function(e,t,n){hr(this,W(this,"number"==typeof e?I(e,t||0):e),null,n)}),setSelection:pi(function(e,t,n){hr(this,W(this,e),W(this,t||e),n)}),extendSelection:pi(function(e,t,n){lr(this,W(this,e),t&&W(this,t),n)}),extendSelections:pi(function(e,t){cr(this,H(this,e),t)}),extendSelectionsBy:pi(function(e,t){var n=m(this.sel.ranges,e);cr(this,H(this,n),t)}),setSelections:pi(function(e,t,n){var i=this;if(e.length){for(var r=[],o=0;o<e.length;o++)r[o]=new $i(W(i,e[o].anchor),W(i,e[o].head));null==t&&(t=Math.min(e.length-1,this.sel.primIndex)),pr(this,Oi(r,t),n)}}),addSelection:pi(function(e,t,n){var i=this.sel.ranges.slice(0);i.push(new $i(W(this,e),W(this,t||e))),pr(this,Oi(i,i.length-1),n)}),getSelection:function(e){for(var t,n=this,i=this.sel.ranges,r=0;r<i.length;r++){var o=S(n,i[r].from(),i[r].to());t=t?t.concat(o):o}return e===!1?t:t.join(e||this.lineSeparator())},getSelections:function(e){for(var t=this,n=[],i=this.sel.ranges,r=0;r<i.length;r++){var o=S(t,i[r].from(),i[r].to());e!==!1&&(o=o.join(e||t.lineSeparator())),n[r]=o}return n},replaceSelection:function(e,t,n){for(var i=[],r=0;r<this.sel.ranges.length;r++)i[r]=e;this.replaceSelections(i,t,n||"+input")},replaceSelections:pi(function(e,t,n){for(var i=this,r=[],o=this.sel,a=0;a<o.ranges.length;a++){var s=o.ranges[a];r[a]={from:s.from(),to:s.to(),text:i.splitLines(e[a]),origin:n}}for(var l=t&&"end"!=t&&Hi(this,r,t),c=r.length-1;c>=0;c--)_r(i,r[c]);l?fr(this,l):this.cm&&ti(this.cm)}),undo:pi(function(){Sr(this,"undo")}),redo:pi(function(){Sr(this,"redo")}),undoSelection:pi(function(){Sr(this,"undo",!0)}),redoSelection:pi(function(){Sr(this,"redo",!0)}),setExtending:function(e){this.extend=e},getExtending:function(){return this.extend},historySize:function(){for(var e=this.history,t=0,n=0,i=0;i<e.done.length;i++)e.done[i].ranges||++t;for(var r=0;r<e.undone.length;r++)e.undone[r].ranges||++n;return{undo:t,redo:n}},clearHistory:function(){this.history=new Ki(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(e){return e&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(e){return this.history.generation==(e||this.cleanGeneration)},getHistory:function(){return{done:ar(this.history.done),undone:ar(this.history.undone)}},setHistory:function(e){var t=this.history=new Ki(this.history.maxGeneration);t.done=ar(e.done.slice(0),null,!0),t.undone=ar(e.undone.slice(0),null,!0)},setGutterMarker:pi(function(e,t,n){return $r(this,e,"gutter",function(e){var i=e.gutterMarkers||(e.gutterMarkers={});return i[t]=n,!n&&x(i)&&(e.gutterMarkers=null),!0})}),clearGutter:pi(function(e){var t=this,n=this.first;this.iter(function(i){i.gutterMarkers&&i.gutterMarkers[e]&&$r(t,i,"gutter",function(){return i.gutterMarkers[e]=null,x(i.gutterMarkers)&&(i.gutterMarkers=null),!0}),++n})}),lineInfo:function(e){var t;if("number"==typeof e){if(!P(this,e))return null;if(t=e,e=A(this,e),!e)return null}else if(t=E(e),null==t)return null;return{line:t,handle:e,text:e.text,gutterMarkers:e.gutterMarkers,textClass:e.textClass,bgClass:e.bgClass,wrapClass:e.wrapClass,widgets:e.widgets}},addLineClass:pi(function(t,n,i){return $r(this,t,"gutter"==n?"gutter":"class",function(t){var r="text"==n?"textClass":"background"==n?"bgClass":"gutter"==n?"gutterClass":"wrapClass";if(t[r]){if(e(i).test(t[r]))return!1;t[r]+=" "+i}else t[r]=i;return!0})}),removeLineClass:pi(function(t,n,i){return $r(this,t,"gutter"==n?"gutter":"class",function(t){var r="text"==n?"textClass":"background"==n?"bgClass":"gutter"==n?"gutterClass":"wrapClass",o=t[r];if(!o)return!1;if(null==i)t[r]=null;else{var a=o.match(e(i));if(!a)return!1;var s=a.index+a[0].length;t[r]=o.slice(0,a.index)+(a.index&&s!=o.length?" ":"")+o.slice(s)||null}return!0})}),addLineWidget:pi(function(e,t,n){return Wr(this,e,t,n)}),removeLineWidget:function(e){e.clear()},markText:function(e,t,n){return Hr(this,W(this,e),W(this,t),n,n&&n.type||"range")},setBookmark:function(e,t){var n={replacedWith:t&&(null==t.nodeType?t.widget:t),insertLeft:t&&t.insertLeft,clearWhenEmpty:!1,shared:t&&t.shared,handleMouseEvents:t&&t.handleMouseEvents};return e=W(this,e),Hr(this,e,e,n,"bookmark")},findMarksAt:function(e){e=W(this,e);var t=[],n=A(this,e.line).markedSpans;if(n)for(var i=0;i<n.length;++i){var r=n[i];(null==r.from||r.from<=e.ch)&&(null==r.to||r.to>=e.ch)&&t.push(r.marker.parent||r.marker)}return t},findMarks:function(e,t,n){e=W(this,e),t=W(this,t);var i=[],r=e.line;return this.iter(e.line,t.line+1,function(o){var a=o.markedSpans;if(a)for(var s=0;s<a.length;s++){var l=a[s];null!=l.to&&r==e.line&&e.ch>=l.to||null==l.from&&r!=e.line||null!=l.from&&r==t.line&&l.from>=t.ch||n&&!n(l.marker)||i.push(l.marker.parent||l.marker)}++r}),i},getAllMarks:function(){var e=[];return this.iter(function(t){var n=t.markedSpans;if(n)for(var i=0;i<n.length;++i)null!=n[i].from&&e.push(n[i].marker)}),e},posFromIndex:function(e){var t,n=this.first,i=this.lineSeparator().length;return this.iter(function(r){var o=r.text.length+i;return o>e?(t=e,!0):(e-=o,void++n)}),W(this,I(n,t))},indexFromPos:function(e){e=W(this,e);var t=e.ch;if(e.line<this.first||e.ch<0)return 0;var n=this.lineSeparator().length;return this.iter(this.first,e.line,function(e){t+=e.text.length+n}),t},copy:function(e){var t=new cs(T(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep);return t.scrollTop=this.scrollTop,t.scrollLeft=this.scrollLeft,t.sel=this.sel,t.extend=!1,e&&(t.history.undoDepth=this.history.undoDepth,t.setHistory(this.getHistory())),t},linkedDoc:function(e){e||(e={});var t=this.first,n=this.first+this.size;null!=e.from&&e.from>t&&(t=e.from),null!=e.to&&e.to<n&&(n=e.to);var i=new cs(T(this,t,n),e.mode||this.modeOption,t,this.lineSep);return e.sharedHist&&(i.history=this.history),(this.linked||(this.linked=[])).push({doc:i,sharedHist:e.sharedHist}),i.linked=[{doc:this,isParent:!0,sharedHist:e.sharedHist}],Gr(i,zr(this)),i},unlinkDoc:function(e){var t=this;if(e instanceof $o&&(e=e.doc),this.linked)for(var n=0;n<this.linked.length;++n){var i=t.linked[n];if(i.doc==e){t.linked.splice(n,1),e.unlinkDoc(t),qr(zr(t));break}}if(e.history==this.history){var r=[e.id];qi(e,function(e){return r.push(e.id)},!0),e.history=new Ki(null),e.history.done=ar(this.history.done,r),e.history.undone=ar(this.history.undone,r)}},iterLinkedDocs:function(e){qi(this,e)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(e){return this.lineSep?e.split(this.lineSep):Ua(e)},lineSeparator:function(){return this.lineSep||"\n"}}),cs.prototype.eachLine=cs.prototype.iter;for(var us=0,hs=!1,ds={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",127:"Delete",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"},fs=0;10>fs;fs++)ds[fs+48]=ds[fs+96]=String(fs);for(var ps=65;90>=ps;ps++)ds[ps]=String.fromCharCode(ps);for(var gs=1;12>=gs;gs++)ds[gs+111]=ds[gs+63235]="F"+gs;var ms={};ms.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},ms.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},ms.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"},ms.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter",
"Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},ms["default"]=va?ms.macDefault:ms.pcDefault;var vs,ys,bs={selectAll:xr,singleSelection:function(e){return e.setSelection(e.getCursor("anchor"),e.getCursor("head"),Ma)},killLine:function(e){return so(e,function(t){if(t.empty()){var n=A(e.doc,t.head.line).text.length;return t.head.ch==n&&t.head.line<e.lastLine()?{from:t.head,to:I(t.head.line+1,0)}:{from:t.head,to:I(t.head.line,n)}}return{from:t.from(),to:t.to()}})},deleteLine:function(e){return so(e,function(t){return{from:I(t.from().line,0),to:W(e.doc,I(t.to().line+1,0))}})},delLineLeft:function(e){return so(e,function(e){return{from:I(e.from().line,0),to:e.from()}})},delWrappedLineLeft:function(e){return so(e,function(t){var n=e.charCoords(t.head,"div").top+5,i=e.coordsChar({left:0,top:n},"div");return{from:i,to:t.from()}})},delWrappedLineRight:function(e){return so(e,function(t){var n=e.charCoords(t.head,"div").top+5,i=e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:n},"div");return{from:t.from(),to:i}})},undo:function(e){return e.undo()},redo:function(e){return e.redo()},undoSelection:function(e){return e.undoSelection()},redoSelection:function(e){return e.redoSelection()},goDocStart:function(e){return e.extendSelection(I(e.firstLine(),0))},goDocEnd:function(e){return e.extendSelection(I(e.lastLine()))},goLineStart:function(e){return e.extendSelectionsBy(function(t){return lo(e,t.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(e){return e.extendSelectionsBy(function(t){return uo(e,t.head)},{origin:"+move",bias:1})},goLineEnd:function(e){return e.extendSelectionsBy(function(t){return co(e,t.head.line)},{origin:"+move",bias:-1})},goLineRight:function(e){return e.extendSelectionsBy(function(t){var n=e.charCoords(t.head,"div").top+5;return e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:n},"div")},Ra)},goLineLeft:function(e){return e.extendSelectionsBy(function(t){var n=e.charCoords(t.head,"div").top+5;return e.coordsChar({left:0,top:n},"div")},Ra)},goLineLeftSmart:function(e){return e.extendSelectionsBy(function(t){var n=e.charCoords(t.head,"div").top+5,i=e.coordsChar({left:0,top:n},"div");return i.ch<e.getLine(i.line).search(/\S/)?uo(e,t.head):i},Ra)},goLineUp:function(e){return e.moveV(-1,"line")},goLineDown:function(e){return e.moveV(1,"line")},goPageUp:function(e){return e.moveV(-1,"page")},goPageDown:function(e){return e.moveV(1,"page")},goCharLeft:function(e){return e.moveH(-1,"char")},goCharRight:function(e){return e.moveH(1,"char")},goColumnLeft:function(e){return e.moveH(-1,"column")},goColumnRight:function(e){return e.moveH(1,"column")},goWordLeft:function(e){return e.moveH(-1,"word")},goGroupRight:function(e){return e.moveH(1,"group")},goGroupLeft:function(e){return e.moveH(-1,"group")},goWordRight:function(e){return e.moveH(1,"word")},delCharBefore:function(e){return e.deleteH(-1,"char")},delCharAfter:function(e){return e.deleteH(1,"char")},delWordBefore:function(e){return e.deleteH(-1,"word")},delWordAfter:function(e){return e.deleteH(1,"word")},delGroupBefore:function(e){return e.deleteH(-1,"group")},delGroupAfter:function(e){return e.deleteH(1,"group")},indentAuto:function(e){return e.indentSelection("smart")},indentMore:function(e){return e.indentSelection("add")},indentLess:function(e){return e.indentSelection("subtract")},insertTab:function(e){return e.replaceSelection("	")},insertSoftTab:function(e){for(var t=[],n=e.listSelections(),i=e.options.tabSize,r=0;r<n.length;r++){var o=n[r].from(),a=u(e.getLine(o.line),o.ch,i);t.push(p(i-a%i))}e.replaceSelections(t)},defaultTab:function(e){e.somethingSelected()?e.indentSelection("add"):e.execCommand("insertTab")},transposeChars:function(e){return hi(e,function(){for(var t=e.listSelections(),n=[],i=0;i<t.length;i++)if(t[i].empty()){var r=t[i].head,o=A(e.doc,r.line).text;if(o)if(r.ch==o.length&&(r=new I(r.line,r.ch-1)),r.ch>0)r=new I(r.line,r.ch+1),e.replaceRange(o.charAt(r.ch-1)+o.charAt(r.ch-2),I(r.line,r.ch-2),r,"+transpose");else if(r.line>e.doc.first){var a=A(e.doc,r.line-1).text;a&&(r=new I(r.line,1),e.replaceRange(o.charAt(0)+e.doc.lineSeparator()+a.charAt(a.length-1),I(r.line-1,a.length-1),r,"+transpose"))}n.push(new $i(r,r))}e.setSelections(n)})},newlineAndIndent:function(e){return hi(e,function(){for(var t=e.listSelections(),n=t.length-1;n>=0;n--)e.replaceRange(e.doc.lineSeparator(),t[n].anchor,t[n].head,"+input");t=e.listSelections();for(var i=0;i<t.length;i++)e.indentLine(t[i].from().line,null,!0);ti(e)})},openLine:function(e){return e.replaceSelection("\n","start")},toggleOverwrite:function(e){return e.toggleOverwrite()}},ws=new h,Cs=null,xs={toString:function(){return"CodeMirror.Init"}},ks={},_s={};$o.defaults=ks,$o.optionHandlers=_s;var As=[];$o.defineInitHook=function(e){return As.push(e)};var Ss=null,Ts=function(e){var t=e.optionHandlers,n=e.helpers={};e.prototype={constructor:e,focus:function(){window.focus(),this.display.input.focus()},setOption:function(e,n){var i=this.options,r=i[e];i[e]==n&&"mode"!=e||(i[e]=n,t.hasOwnProperty(e)&&di(this,t[e])(this,n,r))},getOption:function(e){return this.options[e]},getDoc:function(){return this.doc},addKeyMap:function(e,t){this.state.keyMaps[t?"push":"unshift"](ao(e))},removeKeyMap:function(e){for(var t=this.state.keyMaps,n=0;n<t.length;++n)if(t[n]==e||t[n].name==e)return t.splice(n,1),!0},addOverlay:fi(function(t,n){var i=t.token?t:e.getMode(this.options,t);if(i.startState)throw new Error("Overlays may not be stateful.");v(this.state.overlays,{mode:i,modeSpec:t,opaque:n&&n.opaque,priority:n&&n.priority||0},function(e){return e.priority}),this.state.modeGen++,gi(this)}),removeOverlay:fi(function(e){for(var t=this,n=this.state.overlays,i=0;i<n.length;++i){var r=n[i].modeSpec;if(r==e||"string"==typeof e&&r.name==e)return n.splice(i,1),t.state.modeGen++,void gi(t)}}),indentLine:fi(function(e,t,n){"string"!=typeof t&&"number"!=typeof t&&(t=null==t?this.options.smartIndent?"smart":"prev":t?"add":"subtract"),P(this.doc,e)&&Do(this,e,t,n)}),indentSelection:fi(function(e){for(var t=this,n=this.doc.sel.ranges,i=-1,r=0;r<n.length;r++){var o=n[r];if(o.empty())o.head.line>i&&(Do(t,o.head.line,e,!0),i=o.head.line,r==t.doc.sel.primIndex&&ti(t));else{var a=o.from(),s=o.to(),l=Math.max(i,a.line);i=Math.min(t.lastLine(),s.line-(s.ch?0:1))+1;for(var c=l;i>c;++c)Do(t,c,e);var u=t.doc.sel.ranges;0==a.ch&&n.length==u.length&&u[r].from().ch>0&&ur(t.doc,r,new $i(a,u[r].to()),Ma)}}}),getTokenAt:function(e,t){return rt(this,e,t)},getLineTokens:function(e,t){return rt(this,I(e),t,!0)},getTokenTypeAt:function(e){e=W(this.doc,e);var t,n=Ze(this,A(this.doc,e.line)),i=0,r=(n.length-1)/2,o=e.ch;if(0==o)t=n[2];else for(;;){var a=i+r>>1;if((a?n[2*a-1]:0)>=o)r=a;else{if(!(n[2*a+1]<o)){t=n[2*a+2];break}i=a+1}}var s=t?t.indexOf("overlay "):-1;return 0>s?t:0==s?null:t.slice(0,s-1)},getModeAt:function(t){var n=this.doc.mode;return n.innerMode?e.innerMode(n,this.getTokenAt(t).state).mode:n},getHelper:function(e,t){return this.getHelpers(e,t)[0]},getHelpers:function(e,t){var i=this,r=[];if(!n.hasOwnProperty(t))return r;var o=n[t],a=this.getModeAt(e);if("string"==typeof a[t])o[a[t]]&&r.push(o[a[t]]);else if(a[t])for(var s=0;s<a[t].length;s++){var l=o[a[t][s]];l&&r.push(l)}else a.helperType&&o[a.helperType]?r.push(o[a.helperType]):o[a.name]&&r.push(o[a.name]);for(var c=0;c<o._global.length;c++){var u=o._global[c];u.pred(a,i)&&-1==d(r,u.val)&&r.push(u.val)}return r},getStateAfter:function(e,t){var n=this.doc;return e=N(n,null==e?n.first+n.size-1:e),et(this,e+1,t)},cursorCoords:function(e,t){var n,i=this.doc.sel.primary();return n=null==e?i.head:"object"==typeof e?W(this.doc,e):e?i.from():i.to(),dn(this,n,t||"page")},charCoords:function(e,t){return hn(this,W(this.doc,e),t||"page")},coordsChar:function(e,t){return e=un(this,e,t||"page"),gn(this,e.left,e.top)},lineAtHeight:function(e,t){return e=un(this,{top:e,left:0},t||"page").top,M(this.doc,e+this.display.viewOffset)},heightAtLine:function(e,t,n){var i,r=!1;if("number"==typeof e){var o=this.doc.first+this.doc.size-1;e<this.doc.first?e=this.doc.first:e>o&&(e=o,r=!0),i=A(this.doc,e)}else i=e;return cn(this,i,{top:0,left:0},t||"page",n).top+(r?this.doc.height-pe(i):0)},defaultTextHeight:function(){return vn(this.display)},defaultCharWidth:function(){return yn(this.display)},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(e,t,n,i,r){var o=this.display;e=dn(this,W(this.doc,e));var a=e.bottom,s=e.left;if(t.style.position="absolute",t.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(t),o.sizer.appendChild(t),"over"==i)a=e.top;else if("above"==i||"near"==i){var l=Math.max(o.wrapper.clientHeight,this.doc.height),c=Math.max(o.sizer.clientWidth,o.lineSpace.clientWidth);("above"==i||e.bottom+t.offsetHeight>l)&&e.top>t.offsetHeight?a=e.top-t.offsetHeight:e.bottom+t.offsetHeight<=l&&(a=e.bottom),s+t.offsetWidth>c&&(s=c-t.offsetWidth)}t.style.top=a+"px",t.style.left=t.style.right="","right"==r?(s=o.sizer.clientWidth-t.offsetWidth,t.style.right="0px"):("left"==r?s=0:"middle"==r&&(s=(o.sizer.clientWidth-t.offsetWidth)/2),t.style.left=s+"px"),n&&Qn(this,s,a,s+t.offsetWidth,a+t.offsetHeight)},triggerOnKeyDown:fi(vo),triggerOnKeyPress:fi(wo),triggerOnKeyUp:bo,execCommand:function(e){return bs.hasOwnProperty(e)?bs[e].call(null,this):void 0},triggerElectric:fi(function(e){jo(this,e)}),findPosH:function(e,t,n,i){var r=this,o=1;0>t&&(o=-1,t=-t);for(var a=W(this.doc,e),s=0;t>s&&(a=zo(r.doc,a,o,n,i),!a.hitSide);++s);return a},moveH:fi(function(e,t){var n=this;this.extendSelectionsBy(function(i){return n.display.shift||n.doc.extend||i.empty()?zo(n.doc,i.head,e,t,n.options.rtlMoveVisually):0>e?i.from():i.to()},Ra)}),deleteH:fi(function(e,t){var n=this.doc.sel,i=this.doc;n.somethingSelected()?i.replaceSelection("",null,"+delete"):so(this,function(n){var r=zo(i,n.head,e,t,!1);return 0>e?{from:r,to:n.head}:{from:n.head,to:r}})}),findPosV:function(e,t,n,i){var r=this,o=1,a=i;0>t&&(o=-1,t=-t);for(var s=W(this.doc,e),l=0;t>l;++l){var c=dn(r,s,"div");if(null==a?a=c.left:c.left=a,s=Go(r,c,o,n),s.hitSide)break}return s},moveV:fi(function(e,t){var n=this,i=this.doc,r=[],o=!this.display.shift&&!i.extend&&i.sel.somethingSelected();if(i.extendSelectionsBy(function(a){if(o)return 0>e?a.from():a.to();var s=dn(n,a.head,"div");null!=a.goalColumn&&(s.left=a.goalColumn),r.push(s.left);var l=Go(n,s,e,t);return"page"==t&&a==i.sel.primary()&&ei(n,null,hn(n,l,"div").top-s.top),l},Ra),r.length)for(var a=0;a<i.sel.ranges.length;a++)i.sel.ranges[a].goalColumn=r[a]}),findWordAt:function(e){var t=this.doc,n=A(t,e.line).text,i=e.ch,r=e.ch;if(n){var o=this.getHelper(e,"wordChars");(e.xRel<0||r==n.length)&&i?--i:++r;for(var a=n.charAt(i),s=C(a,o)?function(e){return C(e,o)}:/\s/.test(a)?function(e){return/\s/.test(e)}:function(e){return!/\s/.test(e)&&!C(e)};i>0&&s(n.charAt(i-1));)--i;for(;r<n.length&&s(n.charAt(r));)++r}return new $i(I(e.line,i),I(e.line,r))},toggleOverwrite:function(e){null!=e&&e==this.state.overwrite||((this.state.overwrite=!this.state.overwrite)?a(this.display.cursorDiv,"CodeMirror-overwrite"):_a(this.display.cursorDiv,"CodeMirror-overwrite"),Me(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==o()},isReadOnly:function(){return!(!this.options.readOnly&&!this.doc.cantEdit)},scrollTo:fi(function(e,t){null==e&&null==t||ni(this),null!=e&&(this.curOp.scrollLeft=e),null!=t&&(this.curOp.scrollTop=t)}),getScrollInfo:function(){var e=this.display.scroller;return{left:e.scrollLeft,top:e.scrollTop,height:e.scrollHeight-Ut(this)-this.display.barHeight,width:e.scrollWidth-Ut(this)-this.display.barWidth,clientHeight:Gt(this),clientWidth:zt(this)}},scrollIntoView:fi(function(e,t){if(null==e?(e={from:this.doc.sel.primary().head,to:null},null==t&&(t=this.options.cursorScrollMargin)):"number"==typeof e?e={from:I(e,0),to:null}:null==e.from&&(e={from:e,to:null}),e.to||(e.to=e.from),e.margin=t||0,null!=e.from.line)ni(this),this.curOp.scrollToPos=e;else{var n=Zn(this,Math.min(e.from.left,e.to.left),Math.min(e.from.top,e.to.top)-e.margin,Math.max(e.from.right,e.to.right),Math.max(e.from.bottom,e.to.bottom)+e.margin);this.scrollTo(n.scrollLeft,n.scrollTop)}}),setSize:fi(function(e,t){var n=this,i=function(e){return"number"==typeof e||/^\d+$/.test(String(e))?e+"px":e};null!=e&&(this.display.wrapper.style.width=i(e)),null!=t&&(this.display.wrapper.style.height=i(t)),this.options.lineWrapping&&on(this);var r=this.display.viewFrom;this.doc.iter(r,this.display.viewTo,function(e){if(e.widgets)for(var t=0;t<e.widgets.length;t++)if(e.widgets[t].noHScroll){mi(n,r,"widget");break}++r}),this.curOp.forceUpdate=!0,Me(this,"refresh",this)}),operation:function(e){return hi(this,e)},refresh:fi(function(){var e=this.display.cachedTextHeight;gi(this),this.curOp.forceUpdate=!0,an(this),this.scrollTo(this.doc.scrollLeft,this.doc.scrollTop),Ei(this),(null==e||Math.abs(e-vn(this.display))>.5)&&xn(this),Me(this,"refresh",this)}),swapDoc:fi(function(e){var t=this.doc;return t.cm=null,Yi(this,e),an(this),this.display.input.reset(),this.scrollTo(e.scrollLeft,e.scrollTop),this.curOp.forceScroll=!0,_t(this,"swapDoc",this,t),t}),getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},$e(e),e.registerHelper=function(t,i,r){n.hasOwnProperty(t)||(n[t]=e[t]={_global:[]}),n[t][i]=r},e.registerGlobalHelper=function(t,i,r,o){e.registerHelper(t,i,o),n[t]._global.push({pred:r,val:o})}};qo.prototype=c({init:function(e){function t(e){if(!Pe(r,e)){if(r.somethingSelected())Fo({lineWise:!1,text:r.getSelections()}),"cut"==e.type&&r.replaceSelection("",null,"cut");else{if(!r.options.lineWiseCopyCut)return;var t=Ho(r);Fo({lineWise:!0,text:t.text}),"cut"==e.type&&r.operation(function(){r.setSelections(t.ranges,0,Ma),r.replaceSelection("",null,"cut")})}if(e.clipboardData){e.clipboardData.clearData();var n=Ss.text.join("\n");if(e.clipboardData.setData("Text",n),e.clipboardData.getData("Text")==n)return void e.preventDefault()}var a=Uo(),s=a.firstChild;r.display.lineSpace.insertBefore(a,r.display.lineSpace.firstChild),s.value=Ss.text.join("\n");var l=document.activeElement;Aa(s),setTimeout(function(){r.display.lineSpace.removeChild(a),l.focus(),l==o&&i.showPrimarySelection()},50)}}var n=this,i=this,r=i.cm,o=i.div=e.lineDiv;Bo(o,r.options.spellcheck),Ha(o,"paste",function(e){Pe(r,e)||Wo(e,r)||11>=sa&&setTimeout(di(r,function(){i.pollContent()||gi(r)}),20)}),Ha(o,"compositionstart",function(e){n.composing={data:e.data}}),Ha(o,"compositionupdate",function(e){n.composing||(n.composing={data:e.data})}),Ha(o,"compositionend",function(e){n.composing&&(e.data!=n.composing.data&&n.readFromDOMSoon(),n.composing=null)}),Ha(o,"touchstart",function(){return i.forceCompositionEnd()}),Ha(o,"input",function(){n.composing||n.readFromDOMSoon()}),Ha(o,"copy",t),Ha(o,"cut",t)},prepareSelection:function(){var e=Sn(this.cm,!1);return e.focus=this.cm.state.focused,e},showSelection:function(e,t){e&&this.cm.display.view.length&&((e.focus||t)&&this.showPrimarySelection(),this.showMultipleSelections(e))},showPrimarySelection:function(){var e=window.getSelection(),t=this.cm.doc.sel.primary(),n=Xo(this.cm,e.anchorNode,e.anchorOffset),i=Xo(this.cm,e.focusNode,e.focusOffset);if(!n||n.bad||!i||i.bad||0!=$(F(n,i),t.from())||0!=$(D(n,i),t.to())){var r=Yo(this.cm,t.from()),o=Yo(this.cm,t.to());if(r||o){var a=this.cm.display.view,s=e.rangeCount&&e.getRangeAt(0);if(r){if(!o){var l=a[a.length-1].measure,c=l.maps?l.maps[l.maps.length-1]:l.map;o={node:c[c.length-1],offset:c[c.length-2]-c[c.length-3]}}}else r={node:a[0].measure.map[2],offset:0};var u;try{u=Ca(r.node,r.offset,o.offset,o.node)}catch(h){}u&&(!ia&&this.cm.state.focused?(e.collapse(r.node,r.offset),u.collapsed||(e.removeAllRanges(),e.addRange(u))):(e.removeAllRanges(),e.addRange(u)),s&&null==e.anchorNode?e.addRange(s):ia&&this.startGracePeriod()),this.rememberSelection()}}},startGracePeriod:function(){var e=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout(function(){e.gracePeriod=!1,e.selectionChanged()&&e.cm.operation(function(){return e.cm.curOp.selectionChanged=!0})},20)},showMultipleSelections:function(e){n(this.cm.display.cursorDiv,e.cursors),n(this.cm.display.selectionDiv,e.selection)},rememberSelection:function(){var e=window.getSelection();this.lastAnchorNode=e.anchorNode,this.lastAnchorOffset=e.anchorOffset,this.lastFocusNode=e.focusNode,this.lastFocusOffset=e.focusOffset},selectionInEditor:function(){var e=window.getSelection();if(!e.rangeCount)return!1;var t=e.getRangeAt(0).commonAncestorContainer;return r(this.div,t)},focus:function(){"nocursor"!=this.cm.options.readOnly&&(this.selectionInEditor()||this.showSelection(this.prepareSelection(),!0),this.div.focus())},blur:function(){this.div.blur()},getField:function(){return this.div},supportsTouch:function(){return!0},receivedFocus:function(){function e(){t.cm.state.focused&&(t.pollSelection(),t.polling.set(t.cm.options.pollInterval,e))}var t=this;this.selectionInEditor()?this.pollSelection():hi(this.cm,function(){return t.cm.curOp.selectionChanged=!0}),this.polling.set(this.cm.options.pollInterval,e)},selectionChanged:function(){var e=window.getSelection();return e.anchorNode!=this.lastAnchorNode||e.anchorOffset!=this.lastAnchorOffset||e.focusNode!=this.lastFocusNode||e.focusOffset!=this.lastFocusOffset},pollSelection:function(){if(!this.composing&&null==this.readDOMTimeout&&!this.gracePeriod&&this.selectionChanged()){var e=window.getSelection(),t=this.cm;this.rememberSelection();var n=Xo(t,e.anchorNode,e.anchorOffset),i=Xo(t,e.focusNode,e.focusOffset);n&&i&&hi(t,function(){pr(t.doc,Di(n,i),Ma),(n.bad||i.bad)&&(t.curOp.selectionChanged=!0)})}},pollContent:function(){null!=this.readDOMTimeout&&(clearTimeout(this.readDOMTimeout),this.readDOMTimeout=null);var e=this.cm,t=e.display,n=e.doc.sel.primary(),i=n.from(),r=n.to();if(0==i.ch&&i.line>e.firstLine()&&(i=I(i.line-1,A(e.doc,i.line-1).length)),r.ch==A(e.doc,r.line).text.length&&r.line<e.lastLine()&&(r=I(r.line+1,0)),i.line<t.viewFrom||r.line>t.viewTo-1)return!1;var o,a,s;i.line==t.viewFrom||0==(o=_n(e,i.line))?(a=E(t.view[0].line),s=t.view[0].node):(a=E(t.view[o].line),s=t.view[o-1].node.nextSibling);var l,c,u=_n(e,r.line);if(u==t.view.length-1?(l=t.viewTo-1,c=t.lineDiv.lastChild):(l=E(t.view[u+1].line)-1,c=t.view[u+1].node.previousSibling),!s)return!1;for(var h=e.doc.splitLines(Vo(e,s,c,a,l)),d=S(e.doc,I(a,0),I(l,A(e.doc,l).text.length));h.length>1&&d.length>1;)if(g(h)==g(d))h.pop(),d.pop(),l--;else{if(h[0]!=d[0])break;h.shift(),d.shift(),a++}for(var f=0,p=0,m=h[0],v=d[0],y=Math.min(m.length,v.length);y>f&&m.charCodeAt(f)==v.charCodeAt(f);)++f;for(var b=g(h),w=g(d),C=Math.min(b.length-(1==h.length?f:0),w.length-(1==d.length?f:0));C>p&&b.charCodeAt(b.length-p-1)==w.charCodeAt(w.length-p-1);)++p;h[h.length-1]=b.slice(0,b.length-p).replace(/^\u200b+/,""),h[0]=h[0].slice(f).replace(/\u200b+$/,"");var x=I(a,f),k=I(l,d.length?g(d).length-p:0);return h.length>1||h[0]||$(x,k)?(Mr(e.doc,h,x,k,"+input"),!0):void 0},ensurePolled:function(){this.forceCompositionEnd()},reset:function(){this.forceCompositionEnd()},forceCompositionEnd:function(){this.composing&&(this.composing=null,this.pollContent()||gi(this.cm),this.div.blur(),this.div.focus())},readFromDOMSoon:function(){var e=this;null==this.readDOMTimeout&&(this.readDOMTimeout=setTimeout(function(){e.readDOMTimeout=null,e.composing||!e.cm.isReadOnly()&&e.pollContent()||hi(e.cm,function(){return gi(e.cm)})},80))},setUneditable:function(e){e.contentEditable="false"},onKeyPress:function(e){e.preventDefault(),this.cm.isReadOnly()||di(this.cm,No)(this.cm,String.fromCharCode(null==e.charCode?e.keyCode:e.charCode),0)},readOnlyChanged:function(e){this.div.contentEditable=String("nocursor"!=e)},onContextMenu:y,resetPosition:y,needsContentAttribute:!0},qo.prototype),Qo.prototype=c({init:function(e){function t(e){if(!Pe(r,e)){if(r.somethingSelected())Fo({lineWise:!1,text:r.getSelections()}),i.inaccurateSelection&&(i.prevInput="",i.inaccurateSelection=!1,a.value=Ss.text.join("\n"),Aa(a));else{if(!r.options.lineWiseCopyCut)return;var t=Ho(r);Fo({lineWise:!0,text:t.text}),"cut"==e.type?r.setSelections(t.ranges,null,Ma):(i.prevInput="",a.value=t.text.join("\n"),Aa(a))}"cut"==e.type&&(r.state.cutIncoming=!0)}}var n=this,i=this,r=this.cm,o=this.wrapper=Uo(),a=this.textarea=o.firstChild;e.wrapper.insertBefore(o,e.wrapper.firstChild),ga&&(a.style.width="0px"),Ha(a,"input",function(){aa&&sa>=9&&n.hasSelection&&(n.hasSelection=null),i.poll()}),Ha(a,"paste",function(e){Pe(r,e)||Wo(e,r)||(r.state.pasteIncoming=!0,i.fastPoll())}),Ha(a,"cut",t),Ha(a,"copy",t),Ha(e.scroller,"paste",function(t){Wt(e,t)||Pe(r,t)||(r.state.pasteIncoming=!0,i.focus())}),Ha(e.lineSpace,"selectstart",function(t){Wt(e,t)||Oe(t)}),Ha(a,"compositionstart",function(){var e=r.getCursor("from");i.composing&&i.composing.range.clear(),i.composing={start:e,range:r.markText(e,r.getCursor("to"),{className:"CodeMirror-composing"})}}),Ha(a,"compositionend",function(){i.composing&&(i.poll(),i.composing.range.clear(),i.composing=null)})},prepareSelection:function(){var e=this.cm,t=e.display,n=e.doc,i=Sn(e);if(e.options.moveInputWithCursor){var r=dn(e,n.sel.primary().head,"div"),o=t.wrapper.getBoundingClientRect(),a=t.lineDiv.getBoundingClientRect();i.teTop=Math.max(0,Math.min(t.wrapper.clientHeight-10,r.top+a.top-o.top)),i.teLeft=Math.max(0,Math.min(t.wrapper.clientWidth-10,r.left+a.left-o.left))}return i},showSelection:function(e){var t=this.cm,i=t.display;n(i.cursorDiv,e.cursors),n(i.selectionDiv,e.selection),null!=e.teTop&&(this.wrapper.style.top=e.teTop+"px",this.wrapper.style.left=e.teLeft+"px")},reset:function(e){if(!this.contextMenuPending){var t,n,i=this.cm,r=i.doc;if(i.somethingSelected()){this.prevInput="";var o=r.sel.primary();t=Ga&&(o.to().line-o.from().line>100||(n=i.getSelection()).length>1e3);var a=t?"-":n||i.getSelection();this.textarea.value=a,i.state.focused&&Aa(this.textarea),aa&&sa>=9&&(this.hasSelection=a)}else e||(this.prevInput=this.textarea.value="",aa&&sa>=9&&(this.hasSelection=null));this.inaccurateSelection=t}},getField:function(){return this.textarea},supportsTouch:function(){return!1},focus:function(){if("nocursor"!=this.cm.options.readOnly&&(!ma||o()!=this.textarea))try{this.textarea.focus()}catch(e){}},blur:function(){this.textarea.blur()},resetPosition:function(){this.wrapper.style.top=this.wrapper.style.left=0},receivedFocus:function(){this.slowPoll()},slowPoll:function(){var e=this;this.pollingFast||this.polling.set(this.cm.options.pollInterval,function(){e.poll(),e.cm.state.focused&&e.slowPoll()})},fastPoll:function(){function e(){var i=n.poll();i||t?(n.pollingFast=!1,n.slowPoll()):(t=!0,n.polling.set(60,e))}var t=!1,n=this;n.pollingFast=!0,n.polling.set(20,e)},poll:function(){var e=this,t=this.cm,n=this.textarea,i=this.prevInput;if(this.contextMenuPending||!t.state.focused||za(n)&&!i&&!this.composing||t.isReadOnly()||t.options.disableInput||t.state.keySeq)return!1;var r=n.value;if(r==i&&!t.somethingSelected())return!1;if(aa&&sa>=9&&this.hasSelection===r||va&&/[\uf700-\uf7ff]/.test(r))return t.display.input.reset(),!1;if(t.doc.sel==t.display.selForContextMenu){var o=r.charCodeAt(0);if(8203!=o||i||(i="\u200b"),8666==o)return this.reset(),this.cm.execCommand("undo")}for(var a=0,s=Math.min(i.length,r.length);s>a&&i.charCodeAt(a)==r.charCodeAt(a);)++a;return hi(t,function(){No(t,r.slice(a),i.length-a,null,e.composing?"*compose":null),r.length>1e3||r.indexOf("\n")>-1?n.value=e.prevInput="":e.prevInput=r,e.composing&&(e.composing.range.clear(),e.composing.range=t.markText(e.composing.start,t.getCursor("to"),{className:"CodeMirror-composing"}))}),!0},ensurePolled:function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},onKeyPress:function(){aa&&sa>=9&&(this.hasSelection=null),this.fastPoll()},onContextMenu:function(e){function t(){if(null!=a.selectionStart){var e=r.somethingSelected(),t="\u200b"+(e?a.value:"");a.value="\u21da",a.value=t,i.prevInput=e?"":"\u200b",a.selectionStart=1,a.selectionEnd=t.length,o.selForContextMenu=r.doc.sel}}function n(){if(i.contextMenuPending=!1,i.wrapper.style.cssText=h,a.style.cssText=u,aa&&9>sa&&o.scrollbars.setScrollTop(o.scroller.scrollTop=l),null!=a.selectionStart){(!aa||aa&&9>sa)&&t();var e=0,n=function(){o.selForContextMenu==r.doc.sel&&0==a.selectionStart&&a.selectionEnd>0&&"\u200b"==i.prevInput?di(r,xr)(r):e++<10?o.detectingSelectAll=setTimeout(n,500):o.input.reset()};o.detectingSelectAll=setTimeout(n,200)}}var i=this,r=i.cm,o=r.display,a=i.textarea,s=kn(r,e),l=o.scroller.scrollTop;if(s&&!ha){var c=r.options.resetSelectionOnContextMenu;c&&-1==r.doc.sel.contains(s)&&di(r,pr)(r.doc,Di(s),Ma);var u=a.style.cssText,h=i.wrapper.style.cssText;i.wrapper.style.cssText="position: absolute";var d=i.wrapper.getBoundingClientRect();a.style.cssText="position: absolute; width: 30px; height: 30px;\n      top: "+(e.clientY-d.top-5)+"px; left: "+(e.clientX-d.left-5)+"px;\n      z-index: 1000; background: "+(aa?"rgba(255, 255, 255, .05)":"transparent")+";\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);";var f;if(la&&(f=window.scrollY),o.input.focus(),la&&window.scrollTo(null,f),o.input.reset(),r.somethingSelected()||(a.value=i.prevInput=" "),i.contextMenuPending=!0,o.selForContextMenu=r.doc.sel,clearTimeout(o.detectingSelectAll),aa&&sa>=9&&t(),ka){Ne(e);var p=function(){Ee(window,"mouseup",p),setTimeout(n,20)};Ha(window,"mouseup",p)}else setTimeout(n,50)}},readOnlyChanged:function(e){e||this.reset()},setUneditable:y,needsContentAttribute:!1},Qo.prototype),Mo($o),Ts($o);var Ls="iter insert remove copy getEditor constructor".split(" ");for(var Es in cs.prototype)cs.prototype.hasOwnProperty(Es)&&d(Ls,Es)<0&&($o.prototype[Es]=function(e){return function(){return e.apply(this.doc,arguments)}}(cs.prototype[Es]));return $e(cs),$o.inputStyles={textarea:Qo,contenteditable:qo},$o.defineMode=function(e){$o.defaults.mode||"null"==e||($o.defaults.mode=e),ze.apply(this,arguments)},$o.defineMIME=Ge,$o.defineMode("null",function(){return{token:function(e){return e.skipToEnd()}}}),$o.defineMIME("text/plain","null"),$o.defineExtension=function(e,t){$o.prototype[e]=t},$o.defineDocExtension=function(e,t){cs.prototype[e]=t},$o.fromTextArea=Zo,ea($o),$o.version="5.21.0",$o}),
// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(e,t){this.cm=e,this.options=t,this.widget=null,this.debounce=0,this.tick=0,this.startPos=this.cm.getCursor("start"),this.startLen=this.cm.getLine(this.startPos.line).length-this.cm.getSelection().length;var n=this;e.on("cursorActivity",this.activityFunc=function(){n.cursorActivity()})}function n(t,n){var i=e.cmpPos(n.from,t.from);return i>0&&t.to.ch-t.from.ch!=n.to.ch-n.from.ch}function i(e,t,n){var i=e.options.hintOptions,r={};for(var o in g)r[o]=g[o];if(i)for(var o in i)void 0!==i[o]&&(r[o]=i[o]);if(n)for(var o in n)void 0!==n[o]&&(r[o]=n[o]);return r.hint.resolve&&(r.hint=r.hint.resolve(e,t)),r}function r(e){return"string"==typeof e?e:e.text}function o(e,t){function n(e,n){var r;r="string"!=typeof n?function(e){return n(e,t)}:i.hasOwnProperty(n)?i[n]:n,o[e]=r}var i={Up:function(){t.moveFocus(-1)},Down:function(){t.moveFocus(1)},PageUp:function(){t.moveFocus(-t.menuSize()+1,!0)},PageDown:function(){t.moveFocus(t.menuSize()-1,!0)},Home:function(){t.setFocus(0)},End:function(){t.setFocus(t.length-1)},Enter:t.pick,Tab:t.pick,Esc:t.close},r=e.options.customKeys,o=r?{}:i;if(r)for(var a in r)r.hasOwnProperty(a)&&n(a,r[a]);var s=e.options.extraKeys;if(s)for(var a in s)s.hasOwnProperty(a)&&n(a,s[a]);return o}function a(e,t){for(;t&&t!=e;){if("LI"===t.nodeName.toUpperCase()&&t.parentNode==e)return t;t=t.parentNode}}function s(t,n){this.completion=t,this.data=n,this.picked=!1;var i=this,s=t.cm,l=this.hints=document.createElement("ul");l.className="CodeMirror-hints",this.selectedHint=n.selectedHint||0;for(var c=n.list,u=0;u<c.length;++u){var f=l.appendChild(document.createElement("li")),p=c[u],g=h+(u!=this.selectedHint?"":" "+d);null!=p.className&&(g=p.className+" "+g),f.className=g,p.render?p.render(f,n,p):f.appendChild(document.createTextNode(p.displayText||r(p))),f.hintId=u}var m=s.cursorCoords(t.options.alignWithWord?n.from:null),v=m.left,y=m.bottom,b=!0;l.style.left=v+"px",l.style.top=y+"px";var w=window.innerWidth||Math.max(document.body.offsetWidth,document.documentElement.offsetWidth),C=window.innerHeight||Math.max(document.body.offsetHeight,document.documentElement.offsetHeight);(t.options.container||document.body).appendChild(l);var x=l.getBoundingClientRect(),k=x.bottom-C,_=l.scrollHeight>l.clientHeight+1,A=s.getScrollInfo();if(k>0){var S=x.bottom-x.top,T=m.top-(m.bottom-x.top);if(T-S>0)l.style.top=(y=m.top-S)+"px",b=!1;else if(S>C){l.style.height=C-5+"px",l.style.top=(y=m.bottom-x.top)+"px";var L=s.getCursor();n.from.ch!=L.ch&&(m=s.cursorCoords(L),l.style.left=(v=m.left)+"px",x=l.getBoundingClientRect())}}var E=x.right-w;if(E>0&&(x.right-x.left>w&&(l.style.width=w-5+"px",E-=x.right-x.left-w),l.style.left=(v=m.left-E)+"px"),_)for(var M=l.firstChild;M;M=M.nextSibling)M.style.paddingRight=s.display.nativeBarWidth+"px";if(s.addKeyMap(this.keyMap=o(t,{moveFocus:function(e,t){i.changeActive(i.selectedHint+e,t)},setFocus:function(e){i.changeActive(e)},menuSize:function(){return i.screenAmount()},length:c.length,close:function(){t.close()},pick:function(){i.pick()},data:n})),t.options.closeOnUnfocus){var P;s.on("blur",this.onBlur=function(){P=setTimeout(function(){t.close()},100)}),s.on("focus",this.onFocus=function(){clearTimeout(P)})}return s.on("scroll",this.onScroll=function(){var e=s.getScrollInfo(),n=s.getWrapperElement().getBoundingClientRect(),i=y+A.top-e.top,r=i-(window.pageYOffset||(document.documentElement||document.body).scrollTop);return b||(r+=l.offsetHeight),r<=n.top||r>=n.bottom?t.close():(l.style.top=i+"px",void(l.style.left=v+A.left-e.left+"px"))}),e.on(l,"dblclick",function(e){var t=a(l,e.target||e.srcElement);t&&null!=t.hintId&&(i.changeActive(t.hintId),i.pick())}),e.on(l,"click",function(e){var n=a(l,e.target||e.srcElement);n&&null!=n.hintId&&(i.changeActive(n.hintId),t.options.completeOnSingleClick&&i.pick())}),e.on(l,"mousedown",function(){setTimeout(function(){s.focus()},20)}),t.options.completeOnSingleClick&&e.on(l,"mousemove",function(e){var t=a(l,e.target||e.srcElement);t&&null!=t.hintId&&i.changeActive(t.hintId)}),e.signal(n,"select",c[0],l.firstChild),!0}function l(e,t){if(!e.somethingSelected())return t;for(var n=[],i=0;i<t.length;i++)t[i].supportsSelection&&n.push(t[i]);return n}function c(e,t,n,i){if(e.async)e(t,i,n);else{var r=e(t,n);r&&r.then?r.then(i):i(r)}}function u(t,n){var i,r=t.getHelpers(n,"hint");if(r.length){var o=function(e,t,n){function i(r){return r==o.length?t(null):void c(o[r],e,n,function(e){e&&e.list.length>0?t(e):i(r+1)})}var o=l(e,r);i(0)};return o.async=!0,o.supportsSelection=!0,o}return(i=t.getHelper(t.getCursor(),"hintWords"))?function(t){return e.hint.fromList(t,{words:i})}:e.hint.anyword?function(t,n){return e.hint.anyword(t,n)}:function(){}}var h="CodeMirror-hint",d="CodeMirror-hint-active";e.showHint=function(e,t,n){if(!t)return e.showHint(n);n&&n.async&&(t.async=!0);var i={hint:t};if(n)for(var r in n)i[r]=n[r];return e.showHint(i)},e.defineExtension("showHint",function(n){n=i(this,this.getCursor("start"),n);var r=this.listSelections();if(!(r.length>1)){if(this.somethingSelected()){if(!n.hint.supportsSelection)return;for(var o=0;o<r.length;o++)if(r[o].head.line!=r[o].anchor.line)return}this.state.completionActive&&this.state.completionActive.close();var a=this.state.completionActive=new t(this,n);a.options.hint&&(e.signal(this,"startCompletion",this),a.update(!0))}});var f=window.requestAnimationFrame||function(e){return setTimeout(e,1e3/60)},p=window.cancelAnimationFrame||clearTimeout;t.prototype={close:function(){this.active()&&(this.cm.state.completionActive=null,this.tick=null,this.cm.off("cursorActivity",this.activityFunc),this.widget&&this.data&&e.signal(this.data,"close"),this.widget&&this.widget.close(),e.signal(this.cm,"endCompletion",this.cm))},active:function(){return this.cm.state.completionActive==this},pick:function(t,n){var i=t.list[n];i.hint?i.hint(this.cm,t,i):this.cm.replaceRange(r(i),i.from||t.from,i.to||t.to,"complete"),e.signal(t,"pick",i),this.close()},cursorActivity:function(){this.debounce&&(p(this.debounce),this.debounce=0);var e=this.cm.getCursor(),t=this.cm.getLine(e.line);if(e.line!=this.startPos.line||t.length-e.ch!=this.startLen-this.startPos.ch||e.ch<this.startPos.ch||this.cm.somethingSelected()||e.ch&&this.options.closeCharacters.test(t.charAt(e.ch-1)))this.close();else{var n=this;this.debounce=f(function(){n.update()}),this.widget&&this.widget.disable()}},update:function(e){if(null!=this.tick){var t=this,n=++this.tick;c(this.options.hint,this.cm,this.options,function(i){t.tick==n&&t.finishUpdate(i,e)})}},finishUpdate:function(t,i){this.data&&e.signal(this.data,"update");var r=this.widget&&this.widget.picked||i&&this.options.completeSingle;this.widget&&this.widget.close(),t&&this.data&&n(this.data,t)||(this.data=t,t&&t.list.length&&(r&&1==t.list.length?this.pick(t,0):(this.widget=new s(this,t),e.signal(t,"shown"))))}},s.prototype={close:function(){if(this.completion.widget==this){this.completion.widget=null,this.hints.parentNode.removeChild(this.hints),this.completion.cm.removeKeyMap(this.keyMap);var e=this.completion.cm;this.completion.options.closeOnUnfocus&&(e.off("blur",this.onBlur),e.off("focus",this.onFocus)),e.off("scroll",this.onScroll)}},disable:function(){this.completion.cm.removeKeyMap(this.keyMap);var e=this;this.keyMap={Enter:function(){e.picked=!0}},this.completion.cm.addKeyMap(this.keyMap)},pick:function(){this.completion.pick(this.data,this.selectedHint)},changeActive:function(t,n){if(t>=this.data.list.length?t=n?this.data.list.length-1:0:0>t&&(t=n?0:this.data.list.length-1),this.selectedHint!=t){var i=this.hints.childNodes[this.selectedHint];i.className=i.className.replace(" "+d,""),i=this.hints.childNodes[this.selectedHint=t],i.className+=" "+d,i.offsetTop<this.hints.scrollTop?this.hints.scrollTop=i.offsetTop-3:i.offsetTop+i.offsetHeight>this.hints.scrollTop+this.hints.clientHeight&&(this.hints.scrollTop=i.offsetTop+i.offsetHeight-this.hints.clientHeight+3),e.signal(this.data,"select",this.data.list[this.selectedHint],i)}},screenAmount:function(){return Math.floor(this.hints.clientHeight/this.hints.firstChild.offsetHeight)||1}},e.registerHelper("hint","auto",{resolve:u}),e.registerHelper("hint","fromList",function(t,n){var i=t.getCursor(),r=t.getTokenAt(i),o=e.Pos(i.line,r.end);if(r.string&&/\w/.test(r.string[r.string.length-1]))var a=r.string,s=e.Pos(i.line,r.start);else var a="",s=o;for(var l=[],c=0;c<n.words.length;c++){var u=n.words[c];u.slice(0,a.length)==a&&l.push(u)}return l.length?{list:l,from:s,to:o}:void 0}),e.commands.autocomplete=e.showHint;var g={hint:e.hint.auto,completeSingle:!0,alignWithWord:!0,closeCharacters:/[\s()\[\]{};:>,]/,closeOnUnfocus:!0,completeOnSingleClick:!0,container:null,customKeys:null,extraKeys:null};e.defineOption("hintOptions",null)}),function(){function e(e,t){return t?u[e][t]:u[e]}function t(e){var t,n=[],i=e.getDoc().lineCount(),r=i>c?i-c:0;return e.getDoc().eachLine(r,i,function(e){t=e.text.match(/\\bibitem{(.+?)}/),t&&n.push(t[1])}),n}function n(e,n){var r=n._bibtex?n._bibtex.entries:[];u.bibtex=_.union(r,t(e));var o={latexCommands:p,latexProperties:f},c=e.getCursor(),h=e.getTokenAt(c);if(!/\b(?:string|comment)\b/.test(h.type)){var d=h.string.lastIndexOf(",",c.ch-h.start-1)+1,g=h.string.indexOf(",",c.ch-h.start)+1;g&&(h.end=h.start+g-1),h.start+=d;var m=g?g-1:void 0;h.string=h.string.slice(d,m).trim(),e.somethingSelected()&&(h={start:h.start,end:h.end,string:"",state:h.state,type:h.type});var v=l(c.line,c.ch-1),y=l(c.line,c.ch+1),b=e.doc.getRange(v,y);"  "==b||" "==b?h={start:c.ch,end:c.ch,string:"",state:h.state,type:"tag"}:"\\ "==b?h={start:c.ch-1,end:c.ch,string:"\\",state:h.state,type:"tag"}:"\\"==h.string&&(h.type="tag");var w=a(e,c.line,h),C=null;w!=h&&"tag"==w.type&&(C=w,"{"!=h.string&&"["!=h.string||(h.start=h.end,h.string=""));var x={list:s(e,h,C,o,n),from:l(c.line,h.start),to:l(c.line,h.end)};return CodeMirror.on(x,"pick",function(t){i(e,o,t,n)}),x}}function i(e,t,n,i){var o=e.doc.getCursor();if(n.isCommand||t.latexCommands.indexOf(n)>=0){if(n.isCommand&&(n=n.text,r(n))){e.doc.replaceSelection("\n\n\\end{}","end");var s=o.line,c=e.doc.getLine(s).match(/^\s*/);e.doc.replaceRange(c[0],{line:s+1,ch:0}),e.doc.replaceRange(c[0],{line:s+2,ch:0})}var u=/[\{|\[]([\w -_]*)[\}|\]]/.exec(n);if(null!==u){var h=u[1].length,d=u.index,f=n.length,p=o.ch-f,g=p+d+1,m=l(o.line,g),v=g+h,y=l(o.line,v);e.doc.setSelection(m,y),setTimeout(function(){CodeMirror.showHint(e,CodeMirror.latexHint,i)},100)}}else{var b=e.getTokenAt(o),w=a(e,o.line,b),C=l(o.line,o.ch);if(r(w.string)){var x=o.line+1,k=e.getLine(x),_=o.line+2,A=e.getLine(_),S=A.indexOf("\\end{}");if(-1!==S&&(e.replaceRange(n,{line:_,ch:S+5}),("itemize"===n||"enumerate"===n)&&(/^\s+$/.test(k)||!k))){var T=A.match(/^\s*/);e.replaceRange(T[0]+"\\item ",{line:x,ch:0},{line:x})}C=l(x)}e.doc.setCursor(C)}}function r(e){return/^\\begin/.test(e)}function o(e){return/^\\(eq)?ref/.test(e)}function a(e,t,n){for(;"tag"!=n.type&&n.start>0;)n=e.getTokenAt(l(t,n.start));return n}function s(e,t,n,i){function r(e){var t=e.indexOf(l);0!==t&&1!==t||_.contains(s,e)||s.push(e)}var a,s=[],l=t.string;if(n){var c=i.latexProperties[n.string];if(_.isFunction(c)&&(a=h(c(),n.string)),a)if(l)try{_.forEach(a.search(l),function(e){s.push(a.list[e])})}catch(u){if("Error: Pattern length is too long"!=u)throw u}else s=a.list;if(o(n.string)){var d;e.eachLine(function(e){d=/\\label{([^{}]*)}/.exec(e.text),null!==d&&(r(d[1]),d=null)})}}else{a=h(i.latexCommands,"all");try{_.forEach(a.search(l),function(e){s.push(a.list[e])})}catch(u){if("Error: Pattern length is too long"!=u)throw u}}var f=s.indexOf("\\begin{}");return f>=0&&(s[f]={text:"\\begin{}",displayText:"\\begin{} ... \\end{}",isCommand:!0}),s}var l=CodeMirror.Pos,c=1e4,u={begin:["abstract","align","align*","alignat","alignat*","aligned","alignedat","array","block","bmatrix","center","description","displaymath","document","enumerate","eqnarray","equation","figure","flushleft","flushright","footnotesize","frame","huge","Huge","itemize","large","Large","LARGE","list","matrix","minipage","minipage","normalsize","pmatrix","proof","quotation","quote","scriptsize","small","split","tabbing","table","tabular","theorem","tiny","titlepage","verbatim","verse","vmatrix","Vmatrix"],bibtex:{},inlineBibtex:{}},h=WL.memoizeLastOnKey(function(e){return new Fuse(e,d)}),d={caseSensitive:!1,includeScore:!1,shouldSort:!0,threshold:.3,location:0,distance:100,maxPatternLength:32};CodeMirror.latexHint=n,CodeMirror.registerHelper("hint","latex",n);var f={"\\begin":_.partial(e,"begin")},p=["\\abstractname{}","\\acute{}","\\addbibresource{}","\\addcontentsline{file}{sec_unit}{entry}","\\address{Return address}","\\addtocontents{file}{text}","\\addtocounter{counter}{value}","\\addtolength{len-cmd}{len}","\\addvspace","\\alph{}","\\Alph{}","\\alpha","\\appendix","\\approx","\\arabic","\\arccos","\\arcsin","\\arctan","\\author","\\author{}","\\backslash","\\bar{}","\\baselineskip","\\baselinestretch","\\because","\\begin{}","\\beta","\\bf","\\bibitem{}","\\bibitem[]{}","\\bibliography{}","\\bibliographystyle{}","\\bigcap","\\bigcup","\\bigodot","\\bigoplus","\\bigotimes","\\bigskip","\\bigskipamount","\\bigsqcup","\\biguplus","\\bigvee","\\bigwedge","\\blacktriangleleft","\\blacktriangleright","\\boldmath","\\boldsymbol","\\breve{}","\\bullet","\\cal","\\cap","\\caption{}","\\cdot","\\cdots","\\centering","\\chapter{}","\\chapter*{}","\\check{}","\\chi","\\circle","\\circle*","\\cleardoublepage","\\clearpage","\\cline","\\closing","\\color","\\columnbreak","\\coprod","\\copyright","\\cos","\\cosh","\\cot","\\coth","\\csc","\\cup","\\dashbox","\\date","\\ddot{}","\\ddots","\\deg","\\delta","\\Delta","\\det","\\dfrac{}{}","\\dim","\\div","\\documentclass[]{}","\\dot{}","\\dotfill","\\downarrow","\\Downarrow","\\em","\\emph{}","\\emptyset","\\end{}","\\ensuremath (LaTeX2e)","\\epigraph","\\epsilon","\\eqref{}","\\eta","\\euro","\\exists","\\exp","\\fbox","\\fg","\\flushbottom","\\fnsymbol","\\footnote{}","\\footnotemark","\\footnotesize","\\footnotetext","\\forall","\\frac{}{}","\\frame","\\framebox","\\frenchspacing","\\gamma","\\Gamma","\\gcd","\\geometry{}","\\geq","\\geqslant","\\glqq","\\grave{}","\\grqq","\\hat{}","\\hfill","\\hline","\\hom","\\href{}{}","\\hrule","\\hrulefill","\\hspace{}","\\hspace*{}","\\huge","\\Huge","\\hyphenation{word list}","\\include{}","\\includegraphics[]{}","\\includeonly","\\index{}","\\inf","\\infty","\\input{}","\\int","\\iota","\\it","\\item","\\kappa","\\ker","\\kill","\\label{}","\\lambda","\\Lambda","\\langle","\\large","\\Large","\\LARGE","\\LaTeX","\\LaTeXe","\\lbrace","\\ldots","\\left","\\left.","\\left(","\\left)","\\left[","\\left]","\\left\\langle","\\left\\lbrace","\\left\\rangle","\\left\\rbrace","\\leftarrow","\\Leftarrow","\\lefteqn","\\leftrightarrow","\\Leftrightarrow","\\leq","\\leqslant","\\lim","\\liminf","\\limits","\\limsup","\\line","\\linebreak","\\linethickness","\\linewidth","\\listoffigures","\\listoftables","\\location","\\log","\\longleftarrow","\\Longleftarrow","\\longleftrightarrow","\\Longleftrightarrow","\\longmapsto","\\longrightarrow","\\Longrightarrow","\\makebox","\\makeindex","\\maketitle","\\mapsto","\\markboth","\\markright","\\mathbb{}","\\mathbf{}","\\mathcal{}","\\mathfrak{}","\\mathit{}","\\mathop","\\mathrm{}","\\mathsf{}","\\mathtt{}","\\max","\\mbox","\\medskip","\\min","\\multicolumn{}{}{}","\\multiput","\\neq","\\newcolumntype","\\newcommand{}{}","\\newcounter","\\newenvironment{}{}{}","\\newfont","\\newlength","\\newline","\\newpage","\\newsavebox","\\newtheorem","\\nexists","\\noindent","\\nolinebreak","\\nonfrenchspacing","\\nopagebreak","\\normalsize","\\not","\\og","\\oint","\\omega","\\Omega","\\onecolumn","\\opening","\\oval","\\overbrace{}","\\overleftarrow{}","\\overline{}","\\overrightarrow{}","\\pagebreak","\\pagename","\\pagenumbering{}","\\pageref{}","\\pagestyle","\\par","\\paragraph{}","\\paragraph*{}","\\parallel","\\parbox","\\parindent","\\parskip","\\part{}","\\part*{}","\\partial","\\perp","\\phi","\\Phi","\\prime","\\prod","\\protect","\\providecommand","\\psi","\\Psi","\\put","\\qquad","\\quad","\\raggedbottom","\\raggedleft","\\raggedright","\\raisebox","\\rangle","\\rbrace","\\ref{}","\\renewcommand{}{}","\\renewenvironment{}{}{}","\\RequirePackage{}","\\rho","\\right","\\right.","\\right(","\\right)","\\right[","\\right]","\\right\\langle","\\right\\lbrace","\\right\\rangle","\\right\\rbrace","\\rightarrow","\\Rightarrow","\\rm","\\roman{}","\\Roman{}","\\rule","\\savebox","\\sbox","\\sc","\\scriptsize","\\sec","\\section{}","\\section*{}","\\setcounter","\\setlength{}{}","\\settowidth","\\sf","\\shortstack","\\sigma","\\Sigma","\\signature","\\sin","\\sinh","\\sl","\\slash","\\small","\\smallskip","\\sout","\\space","\\sqrt[]{}","\\stackrel","\\star","\\stepcounter{}","\\subparagraph{}","\\subparagraph*{}","\\subsection{}","\\subsection*{}","\\subset","\\subsubsection{}","\\subsubsection*{}","\\sum","\\sup","\\supset","\\tableofcontents","\\tan","\\tanh","\\tau","\\telephone","\\TeX","\\textbf{}","\\textcolor{}{}","\\textheight","\\textit{}","\\textmd{}","\\textnormal{}","\\textrm{}","\\textsc{}","\\textsf{}","\\textsl{}","\\texttt{}","\\textup{}","\\textwidth","\\thanks","\\therefore","\\theta","\\Theta","\\thispagestyle","\\tilde{}","\\times","\\tiny","\\title{}","\\today","\\tt","\\twocolumn","\\typein","\\typeout","\\uline","\\underbrace{}","\\underline{}","\\unitlength","\\uparrow","\\Uparrow","\\updownarrow","\\Updownarrow","\\uplus","\\upsilon","\\Upsilon","\\usebox","\\usecounter","\\usepackage{}","\\usepackage[]{}","\\uwave","\\value","\\varepsilon","\\varphi","\\varpi","\\varrho","\\varsigma","\\vartheta","\\vbox{text}","\\vcenter","\\vdots","\\vec{}","\\vector","\\verb","\\verb*","\\vert","\\Vert","\\vfill","\\vline","\\vphantom","\\vskip","\\vspace{}","\\vspace*{}","\\wedge","\\widehat{}","\\zeta"];_.each(WL.Constants.bibCommands,function(t){f["\\"+t]=_.partial(e,"bibtex"),p.push("\\"+t+"{}")})}(),
// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){function t(e,t,i,r){var o=e.getLineHandle(t.line),l=t.ch-1,c=l>=0&&s[o.text.charAt(l)]||s[o.text.charAt(++l)];if(!c)return null;var u=">"==c.charAt(1)?1:-1;if(i&&u>0!=(l==t.ch))return null;var h=e.getTokenTypeAt(a(t.line,l+1)),d=n(e,a(t.line,l+(u>0?1:0)),u,h||null,r);return null==d?null:{from:a(t.line,l),to:d&&d.pos,match:d&&d.ch==c.charAt(0),forward:u>0}}function n(e,t,n,i,r){for(var o=r&&r.maxScanLineLength||1e4,l=r&&r.maxScanLines||1e3,c=[],u=r&&r.bracketRegex?r.bracketRegex:/[(){}[\]]/,h=n>0?Math.min(t.line+l,e.lastLine()+1):Math.max(e.firstLine()-1,t.line-l),d=t.line;d!=h;d+=n){var f=e.getLine(d);if(f){var p=n>0?0:f.length-1,g=n>0?f.length:-1;if(!(f.length>o))for(d==t.line&&(p=t.ch-(0>n?1:0));p!=g;p+=n){var m=f.charAt(p);if(u.test(m)&&(void 0===i||e.getTokenTypeAt(a(d,p+1))==i)){var v=s[m];if(">"==v.charAt(1)==n>0)c.push(m);else{if(!c.length)return{pos:a(d,p),ch:m};c.pop()}}}}}return d-n==(n>0?e.lastLine():e.firstLine())?!1:null}function i(e,n,i){for(var r=e.state.matchBrackets.maxHighlightLineLength||1e3,s=[],l=e.listSelections(),c=0;c<l.length;c++){var u=l[c].empty()&&t(e,l[c].head,!1,i);if(u&&e.getLine(u.from.line).length<=r){var h=u.match?"CodeMirror-matchingbracket":"CodeMirror-nonmatchingbracket";s.push(e.markText(u.from,a(u.from.line,u.from.ch+1),{className:h})),u.to&&e.getLine(u.to.line).length<=r&&s.push(e.markText(u.to,a(u.to.line,u.to.ch+1),{className:h}))}}if(s.length){o&&e.state.focused&&e.focus();var d=function(){e.operation(function(){for(var e=0;e<s.length;e++)s[e].clear()})};if(!n)return d;setTimeout(d,800)}}function r(e){e.operation(function(){l&&(l(),l=null),l=i(e,!1,e.state.matchBrackets)})}var o=/MSIE \d/.test(navigator.userAgent)&&(null==document.documentMode||document.documentMode<8),a=e.Pos,s={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<"},l=null;e.defineOption("matchBrackets",!1,function(t,n,i){i&&i!=e.Init&&(t.off("cursorActivity",r),l&&(l(),l=null)),n&&(t.state.matchBrackets="object"==typeof n?n:{},t.on("cursorActivity",r))}),e.defineExtension("matchBrackets",function(){i(this,!0)}),e.defineExtension("findMatchingBracket",function(e,n,i){return t(this,e,n,i)}),e.defineExtension("scanForBracket",function(e,t,i,r){return n(this,e,t,i,r)})});var DIFF_DELETE=-1,DIFF_INSERT=1,DIFF_EQUAL=0;diff_match_patch.Diff,diff_match_patch.prototype.diff_main=function(e,t,n,i){"undefined"==typeof i&&(i=this.Diff_Timeout<=0?Number.MAX_VALUE:(new Date).getTime()+1e3*this.Diff_Timeout);var r=i;if(null==e||null==t)throw new Error("Null input. (diff_main)");if(e==t)return e?[[DIFF_EQUAL,e]]:[];"undefined"==typeof n&&(n=!0);var o=n,a=this.diff_commonPrefix(e,t),s=e.substring(0,a);e=e.substring(a),t=t.substring(a),a=this.diff_commonSuffix(e,t);var l=e.substring(e.length-a);e=e.substring(0,e.length-a),t=t.substring(0,t.length-a);var c=this.diff_compute_(e,t,o,r);return s&&c.unshift([DIFF_EQUAL,s]),l&&c.push([DIFF_EQUAL,l]),this.diff_cleanupMerge(c),c},diff_match_patch.prototype.diff_compute_=function(e,t,n,i){var r;if(!e)return[[DIFF_INSERT,t]];if(!t)return[[DIFF_DELETE,e]];var o=e.length>t.length?e:t,a=e.length>t.length?t:e,s=o.indexOf(a);if(-1!=s)return r=[[DIFF_INSERT,o.substring(0,s)],[DIFF_EQUAL,a],[DIFF_INSERT,o.substring(s+a.length)]],e.length>t.length&&(r[0][0]=r[2][0]=DIFF_DELETE),r;if(1==a.length)return[[DIFF_DELETE,e],[DIFF_INSERT,t]];var l=this.diff_halfMatch_(e,t);if(l){var c=l[0],u=l[1],h=l[2],d=l[3],f=l[4],p=this.diff_main(c,h,n,i),g=this.diff_main(u,d,n,i);return p.concat([[DIFF_EQUAL,f]],g)}return n&&e.length>100&&t.length>100?this.diff_lineMode_(e,t,i):this.diff_bisect_(e,t,i)},diff_match_patch.prototype.diff_lineMode_=function(e,t,n){var i=this.diff_linesToChars_(e,t);e=i.chars1,t=i.chars2;var r=i.lineArray,o=this.diff_main(e,t,!1,n);this.diff_charsToLines_(o,r),this.diff_cleanupSemantic(o),o.push([DIFF_EQUAL,""]);for(var a=0,s=0,l=0,c="",u="";a<o.length;){switch(o[a][0]){case DIFF_INSERT:l++,u+=o[a][1];break;case DIFF_DELETE:s++,c+=o[a][1];break;case DIFF_EQUAL:if(s>=1&&l>=1){o.splice(a-s-l,s+l),a=a-s-l;for(var i=this.diff_main(c,u,!1,n),h=i.length-1;h>=0;h--)o.splice(a,0,i[h]);a+=i.length}l=0,s=0,c="",u=""}a++}return o.pop(),o},diff_match_patch.prototype.diff_bisect_=function(e,t,n){for(var i=e.length,r=t.length,o=Math.ceil((i+r)/2),a=o,s=2*o,l=new Array(s),c=new Array(s),u=0;s>u;u++)l[u]=-1,c[u]=-1;l[a+1]=0,c[a+1]=0;for(var h=i-r,d=h%2!=0,f=0,p=0,g=0,m=0,v=0;o>v&&!((new Date).getTime()>n);v++){for(var y=-v+f;v-p>=y;y+=2){var b,w=a+y;b=y==-v||y!=v&&l[w-1]<l[w+1]?l[w+1]:l[w-1]+1;for(var C=b-y;i>b&&r>C&&e.charAt(b)==t.charAt(C);)b++,C++;if(l[w]=b,b>i)p+=2;else if(C>r)f+=2;else if(d){var x=a+h-y;if(x>=0&&s>x&&-1!=c[x]){var k=i-c[x];if(b>=k)return this.diff_bisectSplit_(e,t,b,C,n)}}}for(var _=-v+g;v-m>=_;_+=2){var k,x=a+_;k=_==-v||_!=v&&c[x-1]<c[x+1]?c[x+1]:c[x-1]+1;for(var A=k-_;i>k&&r>A&&e.charAt(i-k-1)==t.charAt(r-A-1);)k++,A++;if(c[x]=k,k>i)m+=2;else if(A>r)g+=2;else if(!d){var w=a+h-_;if(w>=0&&s>w&&-1!=l[w]){var b=l[w],C=a+b-w;if(k=i-k,b>=k)return this.diff_bisectSplit_(e,t,b,C,n)}}}}return[[DIFF_DELETE,e],[DIFF_INSERT,t]]},diff_match_patch.prototype.diff_bisectSplit_=function(e,t,n,i,r){var o=e.substring(0,n),a=t.substring(0,i),s=e.substring(n),l=t.substring(i),c=this.diff_main(o,a,!1,r),u=this.diff_main(s,l,!1,r);return c.concat(u)},diff_match_patch.prototype.diff_linesToChars_=function(e,t){function n(e){for(var t="",n=0,o=-1,a=i.length;o<e.length-1;){o=e.indexOf("\n",n),-1==o&&(o=e.length-1);var s=e.substring(n,o+1);n=o+1,(r.hasOwnProperty?r.hasOwnProperty(s):void 0!==r[s])?t+=String.fromCharCode(r[s]):(t+=String.fromCharCode(a),r[s]=a,i[a++]=s)}return t}var i=[],r={};i[0]="";var o=n(e),a=n(t);return{chars1:o,chars2:a,lineArray:i}},diff_match_patch.prototype.diff_charsToLines_=function(e,t){for(var n=0;n<e.length;n++){for(var i=e[n][1],r=[],o=0;o<i.length;o++)r[o]=t[i.charCodeAt(o)];e[n][1]=r.join("")}},diff_match_patch.prototype.diff_commonPrefix=function(e,t){if(!e||!t||e.charAt(0)!=t.charAt(0))return 0;for(var n=0,i=Math.min(e.length,t.length),r=i,o=0;r>n;)e.substring(o,r)==t.substring(o,r)?(n=r,o=n):i=r,r=Math.floor((i-n)/2+n);return r},diff_match_patch.prototype.diff_commonSuffix=function(e,t){if(!e||!t||e.charAt(e.length-1)!=t.charAt(t.length-1))return 0;for(var n=0,i=Math.min(e.length,t.length),r=i,o=0;r>n;)e.substring(e.length-r,e.length-o)==t.substring(t.length-r,t.length-o)?(n=r,o=n):i=r,r=Math.floor((i-n)/2+n);return r},diff_match_patch.prototype.diff_commonOverlap_=function(e,t){var n=e.length,i=t.length;if(0==n||0==i)return 0;n>i?e=e.substring(n-i):i>n&&(t=t.substring(0,n));var r=Math.min(n,i);if(e==t)return r;for(var o=0,a=1;;){var s=e.substring(r-a),l=t.indexOf(s);if(-1==l)return o;a+=l,0!=l&&e.substring(r-a)!=t.substring(0,a)||(o=a,a++)}},diff_match_patch.prototype.diff_halfMatch_=function(e,t){function n(e,t,n){for(var i,r,o,s,l=e.substring(n,n+Math.floor(e.length/4)),c=-1,u="";-1!=(c=t.indexOf(l,c+1));){var h=a.diff_commonPrefix(e.substring(n),t.substring(c)),d=a.diff_commonSuffix(e.substring(0,n),t.substring(0,c));u.length<d+h&&(u=t.substring(c-d,c)+t.substring(c,c+h),i=e.substring(0,n-d),r=e.substring(n+h),o=t.substring(0,c-d),s=t.substring(c+h))}return 2*u.length>=e.length?[i,r,o,s,u]:null}if(this.Diff_Timeout<=0)return null;var i=e.length>t.length?e:t,r=e.length>t.length?t:e;if(i.length<4||2*r.length<i.length)return null;var o,a=this,s=n(i,r,Math.ceil(i.length/4)),l=n(i,r,Math.ceil(i.length/2));if(!s&&!l)return null;o=l?s&&s[4].length>l[4].length?s:l:s;var c,u,h,d;e.length>t.length?(c=o[0],u=o[1],h=o[2],d=o[3]):(h=o[0],d=o[1],c=o[2],u=o[3]);var f=o[4];return[c,u,h,d,f]},diff_match_patch.prototype.diff_cleanupSemantic=function(e){for(var t=!1,n=[],i=0,r=null,o=0,a=0,s=0,l=0,c=0;o<e.length;)e[o][0]==DIFF_EQUAL?(n[i++]=o,a=l,s=c,l=0,c=0,r=e[o][1]):(e[o][0]==DIFF_INSERT?l+=e[o][1].length:c+=e[o][1].length,r&&r.length<=Math.max(a,s)&&r.length<=Math.max(l,c)&&r.length<=80&&!/\n/.test(r)&&(e.splice(n[i-1],0,[DIFF_DELETE,r]),e[n[i-1]+1][0]=DIFF_INSERT,i--,i--,o=i>0?n[i-1]:-1,a=0,s=0,l=0,c=0,r=null,t=!0)),o++;for(t&&this.diff_cleanupMerge(e),this.diff_cleanupSemanticLossless(e),o=1;o<e.length;){if(e[o-1][0]==DIFF_DELETE&&e[o][0]==DIFF_INSERT){var u=e[o-1][1],h=e[o][1],d=this.diff_commonOverlap_(u,h),f=this.diff_commonOverlap_(h,u);d>=f?(d>=u.length/2||d>=h.length/2)&&(e.splice(o,0,[DIFF_EQUAL,h.substring(0,d)]),e[o-1][1]=u.substring(0,u.length-d),e[o+1][1]=h.substring(d),o++):(f>=u.length/2||f>=h.length/2)&&(e.splice(o,0,[DIFF_EQUAL,u.substring(0,f)]),e[o-1][0]=DIFF_INSERT,e[o-1][1]=h.substring(0,h.length-f),e[o+1][0]=DIFF_DELETE,e[o+1][1]=u.substring(f),o++),o++}o++}},diff_match_patch.prototype.diff_cleanupSemanticLossless=function(e){function t(e,t){if(!e||!t)return 6;var n=e.charAt(e.length-1),i=t.charAt(0),r=n.match(diff_match_patch.nonAlphaNumericRegex_),o=i.match(diff_match_patch.nonAlphaNumericRegex_),a=r&&n.match(diff_match_patch.whitespaceRegex_),s=o&&i.match(diff_match_patch.whitespaceRegex_),l=a&&n.match(diff_match_patch.linebreakRegex_),c=s&&i.match(diff_match_patch.linebreakRegex_),u=l&&e.match(diff_match_patch.blanklineEndRegex_),h=c&&t.match(diff_match_patch.blanklineStartRegex_);return u||h?5:l||c?4:r&&!a&&s?3:a||s?2:r||o?1:0}for(var n=1;n<e.length-1;){if(e[n-1][0]==DIFF_EQUAL&&e[n+1][0]==DIFF_EQUAL){var i=e[n-1][1],r=e[n][1],o=e[n+1][1],a=this.diff_commonSuffix(i,r);if(a){var s=r.substring(r.length-a);i=i.substring(0,i.length-a),r=s+r.substring(0,r.length-a),o=s+o}for(var l=i,c=r,u=o,h=t(i,r)+t(r,o);r.charAt(0)===o.charAt(0);){i+=r.charAt(0),r=r.substring(1)+o.charAt(0),o=o.substring(1);var d=t(i,r)+t(r,o);d>=h&&(h=d,l=i,c=r,u=o)}e[n-1][1]!=l&&(l?e[n-1][1]=l:(e.splice(n-1,1),n--),e[n][1]=c,u?e[n+1][1]=u:(e.splice(n+1,1),n--))}n++}},diff_match_patch.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/,diff_match_patch.whitespaceRegex_=/\s/,diff_match_patch.linebreakRegex_=/[\r\n]/,diff_match_patch.blanklineEndRegex_=/\n\r?\n$/,diff_match_patch.blanklineStartRegex_=/^\r?\n\r?\n/,diff_match_patch.prototype.diff_cleanupEfficiency=function(e){for(var t=!1,n=[],i=0,r=null,o=0,a=!1,s=!1,l=!1,c=!1;o<e.length;)e[o][0]==DIFF_EQUAL?(e[o][1].length<this.Diff_EditCost&&(l||c)?(n[i++]=o,a=l,s=c,r=e[o][1]):(i=0,r=null),l=c=!1):(e[o][0]==DIFF_DELETE?c=!0:l=!0,r&&(a&&s&&l&&c||r.length<this.Diff_EditCost/2&&a+s+l+c==3)&&(e.splice(n[i-1],0,[DIFF_DELETE,r]),e[n[i-1]+1][0]=DIFF_INSERT,i--,r=null,a&&s?(l=c=!0,i=0):(i--,o=i>0?n[i-1]:-1,l=c=!1),t=!0)),o++;t&&this.diff_cleanupMerge(e)},diff_match_patch.prototype.diff_cleanupMerge=function(e){e.push([DIFF_EQUAL,""]);for(var t,n=0,i=0,r=0,o="",a="";n<e.length;)switch(e[n][0]){case DIFF_INSERT:r++,a+=e[n][1],n++;break;case DIFF_DELETE:i++,o+=e[n][1],n++;break;case DIFF_EQUAL:i+r>1?(0!==i&&0!==r&&(t=this.diff_commonPrefix(a,o),0!==t&&(n-i-r>0&&e[n-i-r-1][0]==DIFF_EQUAL?e[n-i-r-1][1]+=a.substring(0,t):(e.splice(0,0,[DIFF_EQUAL,a.substring(0,t)]),n++),a=a.substring(t),o=o.substring(t)),t=this.diff_commonSuffix(a,o),0!==t&&(e[n][1]=a.substring(a.length-t)+e[n][1],a=a.substring(0,a.length-t),o=o.substring(0,o.length-t))),0===i?e.splice(n-r,i+r,[DIFF_INSERT,a]):0===r?e.splice(n-i,i+r,[DIFF_DELETE,o]):e.splice(n-i-r,i+r,[DIFF_DELETE,o],[DIFF_INSERT,a]),n=n-i-r+(i?1:0)+(r?1:0)+1):0!==n&&e[n-1][0]==DIFF_EQUAL?(e[n-1][1]+=e[n][1],e.splice(n,1)):n++,r=0,i=0,o="",a=""}""===e[e.length-1][1]&&e.pop();var s=!1;for(n=1;n<e.length-1;)e[n-1][0]==DIFF_EQUAL&&e[n+1][0]==DIFF_EQUAL&&(e[n][1].substring(e[n][1].length-e[n-1][1].length)==e[n-1][1]?(e[n][1]=e[n-1][1]+e[n][1].substring(0,e[n][1].length-e[n-1][1].length),e[n+1][1]=e[n-1][1]+e[n+1][1],e.splice(n-1,1),s=!0):e[n][1].substring(0,e[n+1][1].length)==e[n+1][1]&&(e[n-1][1]+=e[n+1][1],e[n][1]=e[n][1].substring(e[n+1][1].length)+e[n+1][1],e.splice(n+1,1),s=!0)),n++;s&&this.diff_cleanupMerge(e)},diff_match_patch.prototype.diff_xIndex=function(e,t){var n,i=0,r=0,o=0,a=0;for(n=0;n<e.length&&(e[n][0]!==DIFF_INSERT&&(i+=e[n][1].length),e[n][0]!==DIFF_DELETE&&(r+=e[n][1].length),!(i>t));n++)o=i,a=r;return e.length!=n&&e[n][0]===DIFF_DELETE?a:a+(t-o)},diff_match_patch.prototype.diff_prettyHtml=function(e){for(var t=[],n=/&/g,i=/</g,r=/>/g,o=/\n/g,a=0;a<e.length;a++){var s=e[a][0],l=e[a][1],c=l.replace(n,"&amp;").replace(i,"&lt;").replace(r,"&gt;").replace(o,"&para;<br>");switch(s){case DIFF_INSERT:t[a]='<ins style="background:#e6ffe6;">'+c+"</ins>";break;case DIFF_DELETE:t[a]='<del style="background:#ffe6e6;">'+c+"</del>";break;case DIFF_EQUAL:t[a]="<span>"+c+"</span>"}}return t.join("")},diff_match_patch.prototype.diff_text1=function(e){for(var t=[],n=0;n<e.length;n++)e[n][0]!==DIFF_INSERT&&(t[n]=e[n][1]);return t.join("")},diff_match_patch.prototype.diff_text2=function(e){for(var t=[],n=0;n<e.length;n++)e[n][0]!==DIFF_DELETE&&(t[n]=e[n][1]);return t.join("")},diff_match_patch.prototype.diff_levenshtein=function(e){for(var t=0,n=0,i=0,r=0;r<e.length;r++){var o=e[r][0],a=e[r][1];switch(o){case DIFF_INSERT:n+=a.length;break;case DIFF_DELETE:i+=a.length;break;case DIFF_EQUAL:t+=Math.max(n,i),n=0,i=0}}return t+=Math.max(n,i)},diff_match_patch.prototype.diff_toDelta=function(e){for(var t=[],n=0;n<e.length;n++)switch(e[n][0]){case DIFF_INSERT:t[n]="+"+encodeURI(e[n][1]);break;case DIFF_DELETE:t[n]="-"+e[n][1].length;break;case DIFF_EQUAL:t[n]="="+e[n][1].length}return t.join("	").replace(/%20/g," ")},diff_match_patch.prototype.diff_fromDelta=function(e,t){for(var n=[],i=0,r=0,o=t.split(/\t/g),a=0;a<o.length;a++){var s=o[a].substring(1);switch(o[a].charAt(0)){case"+":try{n[i++]=[DIFF_INSERT,decodeURI(s)]}catch(l){throw new Error("Illegal escape in diff_fromDelta: "+s)}break;case"-":case"=":var c=parseInt(s,10);if(isNaN(c)||0>c)throw new Error("Invalid number in diff_fromDelta: "+s);var u=e.substring(r,r+=c);"="==o[a].charAt(0)?n[i++]=[DIFF_EQUAL,u]:n[i++]=[DIFF_DELETE,u];break;default:if(o[a])throw new Error("Invalid diff operation in diff_fromDelta: "+o[a])}}if(r!=e.length)throw new Error("Delta length ("+r+") does not equal source text length ("+e.length+").");return n},diff_match_patch.prototype.match_main=function(e,t,n){if(null==e||null==t||null==n)throw new Error("Null input. (match_main)");return n=Math.max(0,Math.min(n,e.length)),e==t?0:e.length?e.substring(n,n+t.length)==t?n:this.match_bitap_(e,t,n):-1},diff_match_patch.prototype.match_bitap_=function(e,t,n){function i(e,i){var r=e/t.length,a=Math.abs(n-i);return o.Match_Distance?r+a/o.Match_Distance:a?1:r}if(t.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var r=this.match_alphabet_(t),o=this,a=this.Match_Threshold,s=e.indexOf(t,n);-1!=s&&(a=Math.min(i(0,s),a),s=e.lastIndexOf(t,n+t.length),-1!=s&&(a=Math.min(i(0,s),a)));var l=1<<t.length-1;s=-1;for(var c,u,h,d=t.length+e.length,f=0;f<t.length;f++){for(c=0,u=d;u>c;)i(f,n+u)<=a?c=u:d=u,u=Math.floor((d-c)/2+c);d=u;var p=Math.max(1,n-u+1),g=Math.min(n+u,e.length)+t.length,m=Array(g+2);m[g+1]=(1<<f)-1;for(var v=g;v>=p;v--){var y=r[e.charAt(v-1)];if(0===f?m[v]=(m[v+1]<<1|1)&y:m[v]=(m[v+1]<<1|1)&y|((h[v+1]|h[v])<<1|1)|h[v+1],m[v]&l){var b=i(f,v-1);if(a>=b){if(a=b,s=v-1,!(s>n))break;p=Math.max(1,2*n-s)}}}if(i(f+1,n)>a)break;h=m}return s},diff_match_patch.prototype.match_alphabet_=function(e){for(var t={},n=0;n<e.length;n++)t[e.charAt(n)]=0;for(var n=0;n<e.length;n++)t[e.charAt(n)]|=1<<e.length-n-1;return t},diff_match_patch.prototype.patch_addContext_=function(e,t){if(0!=t.length){for(var n=t.substring(e.start2,e.start2+e.length1),i=0;t.indexOf(n)!=t.lastIndexOf(n)&&n.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)i+=this.Patch_Margin,n=t.substring(e.start2-i,e.start2+e.length1+i);i+=this.Patch_Margin;var r=t.substring(e.start2-i,e.start2);r&&e.diffs.unshift([DIFF_EQUAL,r]);var o=t.substring(e.start2+e.length1,e.start2+e.length1+i);o&&e.diffs.push([DIFF_EQUAL,o]),e.start1-=r.length,e.start2-=r.length,e.length1+=r.length+o.length,e.length2+=r.length+o.length}},diff_match_patch.prototype.patch_make=function(e,t,n){var i,r;if("string"==typeof e&&"string"==typeof t&&"undefined"==typeof n)i=e,r=this.diff_main(i,t,!0),r.length>2&&(this.diff_cleanupSemantic(r),this.diff_cleanupEfficiency(r));else if(e&&"object"==typeof e&&"undefined"==typeof t&&"undefined"==typeof n)r=e,i=this.diff_text1(r);else if("string"==typeof e&&t&&"object"==typeof t&&"undefined"==typeof n)i=e,r=t;else{if("string"!=typeof e||"string"!=typeof t||!n||"object"!=typeof n)throw new Error("Unknown call format to patch_make.");i=e,r=n}if(0===r.length)return[];for(var o=[],a=new diff_match_patch.patch_obj,s=0,l=0,c=0,u=i,h=i,d=0;d<r.length;d++){var f=r[d][0],p=r[d][1];switch(s||f===DIFF_EQUAL||(a.start1=l,a.start2=c),f){case DIFF_INSERT:a.diffs[s++]=r[d],a.length2+=p.length,h=h.substring(0,c)+p+h.substring(c);break;case DIFF_DELETE:a.length1+=p.length,a.diffs[s++]=r[d],h=h.substring(0,c)+h.substring(c+p.length);break;case DIFF_EQUAL:p.length<=2*this.Patch_Margin&&s&&r.length!=d+1?(a.diffs[s++]=r[d],a.length1+=p.length,a.length2+=p.length):p.length>=2*this.Patch_Margin&&s&&(this.patch_addContext_(a,u),o.push(a),a=new diff_match_patch.patch_obj,s=0,u=h,l=c)}f!==DIFF_INSERT&&(l+=p.length),f!==DIFF_DELETE&&(c+=p.length)}return s&&(this.patch_addContext_(a,u),o.push(a)),o},diff_match_patch.prototype.patch_deepCopy=function(e){for(var t=[],n=0;n<e.length;n++){var i=e[n],r=new diff_match_patch.patch_obj;r.diffs=[];for(var o=0;o<i.diffs.length;o++)r.diffs[o]=i.diffs[o].slice();r.start1=i.start1,r.start2=i.start2,r.length1=i.length1,r.length2=i.length2,t[n]=r}return t},diff_match_patch.prototype.patch_apply=function(e,t){if(0==e.length)return[t,[]];e=this.patch_deepCopy(e);var n=this.patch_addPadding(e);t=n+t+n,this.patch_splitMax(e);for(var i=0,r=[],o=0;o<e.length;o++){var a,s=e[o].start2+i,l=this.diff_text1(e[o].diffs),c=-1;if(l.length>this.Match_MaxBits?(a=this.match_main(t,l.substring(0,this.Match_MaxBits),s),-1!=a&&(c=this.match_main(t,l.substring(l.length-this.Match_MaxBits),s+l.length-this.Match_MaxBits),(-1==c||a>=c)&&(a=-1))):a=this.match_main(t,l,s),-1==a)r[o]=!1,i-=e[o].length2-e[o].length1;else{r[o]=!0,i=a-s;var u;if(u=-1==c?t.substring(a,a+l.length):t.substring(a,c+this.Match_MaxBits),l==u)t=t.substring(0,a)+this.diff_text2(e[o].diffs)+t.substring(a+l.length);else{var h=this.diff_main(l,u,!1);if(l.length>this.Match_MaxBits&&this.diff_levenshtein(h)/l.length>this.Patch_DeleteThreshold)r[o]=!1;else{this.diff_cleanupSemanticLossless(h);for(var d,f=0,p=0;p<e[o].diffs.length;p++){var g=e[o].diffs[p];g[0]!==DIFF_EQUAL&&(d=this.diff_xIndex(h,f)),g[0]===DIFF_INSERT?t=t.substring(0,a+d)+g[1]+t.substring(a+d):g[0]===DIFF_DELETE&&(t=t.substring(0,a+d)+t.substring(a+this.diff_xIndex(h,f+g[1].length))),g[0]!==DIFF_DELETE&&(f+=g[1].length)}}}}}return t=t.substring(n.length,t.length-n.length),[t,r]},diff_match_patch.prototype.patch_addPadding=function(e){for(var t=this.Patch_Margin,n="",i=1;t>=i;i++)n+=String.fromCharCode(i);for(var i=0;i<e.length;i++)e[i].start1+=t,e[i].start2+=t;var r=e[0],o=r.diffs;if(0==o.length||o[0][0]!=DIFF_EQUAL)o.unshift([DIFF_EQUAL,n]),r.start1-=t,r.start2-=t,r.length1+=t,r.length2+=t;else if(t>o[0][1].length){var a=t-o[0][1].length;o[0][1]=n.substring(o[0][1].length)+o[0][1],r.start1-=a,r.start2-=a,r.length1+=a,r.length2+=a}if(r=e[e.length-1],o=r.diffs,0==o.length||o[o.length-1][0]!=DIFF_EQUAL)o.push([DIFF_EQUAL,n]),r.length1+=t,r.length2+=t;else if(t>o[o.length-1][1].length){var a=t-o[o.length-1][1].length;o[o.length-1][1]+=n.substring(0,a),r.length1+=a,r.length2+=a}return n},diff_match_patch.prototype.patch_splitMax=function(e){for(var t=this.Match_MaxBits,n=0;n<e.length;n++)if(!(e[n].length1<=t)){var i=e[n];e.splice(n--,1);for(var r=i.start1,o=i.start2,a="";0!==i.diffs.length;){var s=new diff_match_patch.patch_obj,l=!0;for(s.start1=r-a.length,s.start2=o-a.length,""!==a&&(s.length1=s.length2=a.length,s.diffs.push([DIFF_EQUAL,a]));0!==i.diffs.length&&s.length1<t-this.Patch_Margin;){var c=i.diffs[0][0],u=i.diffs[0][1];c===DIFF_INSERT?(s.length2+=u.length,o+=u.length,s.diffs.push(i.diffs.shift()),l=!1):c===DIFF_DELETE&&1==s.diffs.length&&s.diffs[0][0]==DIFF_EQUAL&&u.length>2*t?(s.length1+=u.length,r+=u.length,l=!1,s.diffs.push([c,u]),i.diffs.shift()):(u=u.substring(0,t-s.length1-this.Patch_Margin),s.length1+=u.length,r+=u.length,c===DIFF_EQUAL?(s.length2+=u.length,o+=u.length):l=!1,s.diffs.push([c,u]),u==i.diffs[0][1]?i.diffs.shift():i.diffs[0][1]=i.diffs[0][1].substring(u.length))}a=this.diff_text2(s.diffs),a=a.substring(a.length-this.Patch_Margin);var h=this.diff_text1(i.diffs).substring(0,this.Patch_Margin);""!==h&&(s.length1+=h.length,s.length2+=h.length,0!==s.diffs.length&&s.diffs[s.diffs.length-1][0]===DIFF_EQUAL?s.diffs[s.diffs.length-1][1]+=h:s.diffs.push([DIFF_EQUAL,h])),l||e.splice(++n,0,s)}}},diff_match_patch.prototype.patch_toText=function(e){for(var t=[],n=0;n<e.length;n++)t[n]=e[n];return t.join("")},diff_match_patch.prototype.patch_fromText=function(e){var t=[];if(!e)return t;for(var n=e.split("\n"),i=0,r=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;i<n.length;){var o=n[i].match(r);if(!o)throw new Error("Invalid patch string: "+n[i]);var a=new diff_match_patch.patch_obj;for(t.push(a),a.start1=parseInt(o[1],10),""===o[2]?(a.start1--,a.length1=1):"0"==o[2]?a.length1=0:(a.start1--,a.length1=parseInt(o[2],10)),a.start2=parseInt(o[3],10),""===o[4]?(a.start2--,a.length2=1):"0"==o[4]?a.length2=0:(a.start2--,a.length2=parseInt(o[4],10)),i++;i<n.length;){var s=n[i].charAt(0);try{var l=decodeURI(n[i].substring(1))}catch(c){throw new Error("Illegal escape in patch_fromText: "+l)}if("-"==s)a.diffs.push([DIFF_DELETE,l]);else if("+"==s)a.diffs.push([DIFF_INSERT,l]);else if(" "==s)a.diffs.push([DIFF_EQUAL,l]);else{if("@"==s)break;if(""!==s)throw new Error('Invalid patch mode "'+s+'" in: '+l)}i++}}return t},diff_match_patch.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0},diff_match_patch.patch_obj.prototype.toString=function(){var e,t;e=0===this.length1?this.start1+",0":1==this.length1?this.start1+1:this.start1+1+","+this.length1,t=0===this.length2?this.start2+",0":1==this.length2?this.start2+1:this.start2+1+","+this.length2;for(var n,i=["@@ -"+e+" +"+t+" @@\n"],r=0;r<this.diffs.length;r++){switch(this.diffs[r][0]){case DIFF_INSERT:n="+";break;case DIFF_DELETE:n="-";break;case DIFF_EQUAL:n=" "}i[r+1]=n+encodeURI(this.diffs[r][1])+"\n"}return i.join("").replace(/%20/g," ")},this.diff_match_patch=diff_match_patch,this.DIFF_DELETE=DIFF_DELETE,this.DIFF_INSERT=DIFF_INSERT,this.DIFF_EQUAL=DIFF_EQUAL,
// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","diff_match_patch"],e):e(CodeMirror)}(function(e){"use strict";function t(e,t){this.mv=e,this.type=t,this.classes="left"==t?{chunk:"CodeMirror-merge-l-chunk",start:"CodeMirror-merge-l-chunk-start",end:"CodeMirror-merge-l-chunk-end",insert:"CodeMirror-merge-l-inserted",del:"CodeMirror-merge-l-deleted",connect:"CodeMirror-merge-l-connect"}:{chunk:"CodeMirror-merge-r-chunk",start:"CodeMirror-merge-r-chunk-start",end:"CodeMirror-merge-r-chunk-end",insert:"CodeMirror-merge-r-inserted",del:"CodeMirror-merge-r-deleted",connect:"CodeMirror-merge-r-connect"}}function n(t){t.diffOutOfDate&&(t.diff=k(t.orig.getValue(),t.edit.getValue()),t.chunks=_(t.diff),t.diffOutOfDate=!1,e.signal(t.edit,"updateDiff",t.diff))}function i(e){function t(t){G=!0,d=!1,"full"==t&&(e.svg&&I(e.svg),e.copyButtons&&I(e.copyButtons),c(e.edit,l.marked,e.classes),c(e.orig,h.marked,e.classes),l.from=l.to=h.from=h.to=0),n(e),e.showDifferences&&(u(e.edit,e.diff,l,DIFF_INSERT,e.classes),u(e.orig,e.diff,h,DIFF_DELETE,e.classes)),"align"==e.mv.options.connect&&m(e),f(e),G=!1}function i(t){G||(e.dealigned=!0,r(t))}function r(e){G||d||(clearTimeout(s),e===!0&&(d=!0),s=setTimeout(t,e===!0?20:250))}function o(t,n){e.diffOutOfDate||(e.diffOutOfDate=!0,l.from=l.to=h.from=h.to=0),i(n.text.length-1!=n.to.line-n.from.line)}function a(){e.diffOutOfDate=!0,t("full")}var s,l={from:0,to:0,marked:[]},h={from:0,to:0,marked:[]},d=!1;return e.edit.on("change",o),e.orig.on("change",o),e.edit.on("swapDoc",a),e.orig.on("swapDoc",a),e.edit.on("markerAdded",i),e.edit.on("markerCleared",i),e.orig.on("markerAdded",i),e.orig.on("markerCleared",i),e.edit.on("viewportChange",function(){r(!1)}),e.orig.on("viewportChange",function(){r(!1)}),t(),t}function r(e){e.edit.on("scroll",function(){o(e,DIFF_INSERT)&&f(e)}),e.orig.on("scroll",function(){o(e,DIFF_DELETE)&&f(e)})}function o(e,t){if(e.diffOutOfDate)return!1;if(!e.lockScroll)return!0;var n,i,r=+new Date;if(t==DIFF_INSERT?(n=e.edit,i=e.orig):(n=e.orig,i=e.edit),n.state.scrollSetBy==e&&(n.state.scrollSetAt||0)+50>r)return!1;var o=n.getScrollInfo();if("align"==e.mv.options.connect)m=o.top;else{var s,l,c=.5*o.clientHeight,u=o.top+c,h=n.lineAtHeight(u,"local"),d=T(e.chunks,h,t==DIFF_INSERT),f=a(n,t==DIFF_INSERT?d.edit:d.orig),p=a(i,t==DIFF_INSERT?d.orig:d.edit),g=(u-f.top)/(f.bot-f.top),m=p.top-c+g*(p.bot-p.top);if(m>o.top&&(l=o.top/c)<1)m=m*l+o.top*(1-l);else if((s=o.height-o.clientHeight-o.top)<c){var v=i.getScrollInfo(),y=v.height-v.clientHeight-m;y>s&&(l=s/c)<1&&(m=m*l+(v.height-v.clientHeight-s)*(1-l))}}return i.scrollTo(o.left,m),i.state.scrollSetAt=r,i.state.scrollSetBy=e,!0}function a(e,t){var n=t.after;return null==n&&(n=e.lastLine()+1),{top:e.heightAtLine(t.before||0,"local"),bot:e.heightAtLine(n,"local")}}function s(e,t,n){e.lockScroll=t,t&&0!=n&&o(e,DIFF_INSERT)&&f(e),e.lockButton.innerHTML=t?"\u21db\u21da":"\u21db&nbsp;&nbsp;\u21da"}function l(e,t,n){for(var i=n.classLocation,r=0;r<i.length;r++)e.removeLineClass(t,i[r],n.chunk),e.removeLineClass(t,i[r],n.start),e.removeLineClass(t,i[r],n.end)}function c(t,n,i){for(var r=0;r<n.length;++r){var o=n[r];o instanceof e.TextMarker?o.clear():o.parent&&l(t,o,i)}n.length=0}function u(e,t,n,i,r){var o=e.getViewport();e.operation(function(){n.from==n.to||o.from-n.to>20||n.from-o.to>20?(c(e,n.marked,r),d(e,t,i,n.marked,o.from,o.to,r),n.from=o.from,n.to=o.to):(o.from<n.from&&(d(e,t,i,n.marked,o.from,n.from,r),n.from=o.from),o.to>n.to&&(d(e,t,i,n.marked,n.to,o.to,r),n.to=o.to))})}function h(e,t,n,i,r,o){for(var a=n.classLocation,s=e.getLineHandle(t),l=0;l<a.length;l++)i&&e.addLineClass(s,a[l],n.chunk),r&&e.addLineClass(s,a[l],n.start),o&&e.addLineClass(s,a[l],n.end);return s}function d(e,t,n,i,r,o,a){function s(t,n){for(var s=Math.max(r,t),l=Math.min(o,n),c=s;l>c;++c)i.push(h(e,c,a,!0,c==t,c==n-1));t==n&&s==n&&l==n&&(s?i.push(h(e,s-1,a,!1,!1,!0)):i.push(h(e,s,a,!1,!0,!1)))}for(var l=U(0,0),c=U(r,0),u=e.clipPos(U(o-1)),d=n==DIFF_DELETE?a.del:a.insert,f=0,p=0;p<t.length;++p){var g=t[p],m=g[0],v=g[1];if(m==DIFF_EQUAL){var y=l.line+(S(t,p)?0:1);D(l,v);var b=l.line+(A(t,p)?1:0);b>y&&(p&&s(f,y),f=b)}else if(m==n){var w=D(l,v,!0),C=N(c,l),x=F(u,w);W(C,x)||i.push(e.markText(C,x,{className:d})),l=w}}f<=l.line&&s(f,l.line+1)}function f(e){if(e.showDifferences){if(e.svg){I(e.svg);var t=e.gap.offsetWidth;$(e.svg,"width",t,"height",e.gap.offsetHeight)}e.copyButtons&&I(e.copyButtons);for(var n=e.edit.getViewport(),i=e.orig.getViewport(),r=e.mv.wrap.getBoundingClientRect().top,o=r-e.edit.getScrollerElement().getBoundingClientRect().top+e.edit.getScrollInfo().top,a=r-e.orig.getScrollerElement().getBoundingClientRect().top+e.orig.getScrollInfo().top,s=0;s<e.chunks.length;s++){var l=e.chunks[s];l.editFrom<=n.to&&l.editTo>=n.from&&l.origFrom<=i.to&&l.origTo>=i.from&&b(e,l,a,o,t)}}}function p(e,t){for(var n=0,i=0,r=0;r<t.length;r++){var o=t[r];if(o.editTo>e&&o.editFrom<=e)return null;if(o.editFrom>e)break;n=o.editTo,i=o.origTo}return i+(e-n)}function g(e,t){for(var n=[],i=0;i<e.chunks.length;i++){var r=e.chunks[i];n.push([r.origTo,r.editTo,t?p(r.editTo,t.chunks):null])}if(t)e:for(var i=0;i<t.chunks.length;i++){for(var r=t.chunks[i],o=0;o<n.length;o++){var a=n[o][1]-r.editTo;if(0==a)continue e;if(a>0)break}n.splice(o,0,[p(r.editTo,e.chunks),r.editTo,r.origTo])}return n}function m(e,t){if(e.dealigned||t){if(!e.orig.curOp)return e.orig.operation(function(){m(e,t)});e.dealigned=!1;var i=e.mv.left==e?e.mv.right:e.mv.left;i&&(n(i),i.dealigned=!1);for(var r=g(e,i),o=e.mv.aligners,a=0;a<o.length;a++)o[a].clear();o.length=0;var s=[e.orig,e.edit],l=[];i&&s.push(i.orig);for(var a=0;a<s.length;a++)l.push(s[a].getScrollInfo().top);for(var c=0;c<r.length;c++)v(s,r[c],o);for(var a=0;a<s.length;a++)s[a].scrollTo(null,l[a])}}function v(e,t,n){for(var i=0,r=[],o=0;o<e.length;o++)if(null!=t[o]){var a=e[o].heightAtLine(t[o],"local");r[o]=a,i=Math.max(i,a)}for(var o=0;o<e.length;o++)if(null!=t[o]){var s=i-r[o];s>1&&n.push(y(e[o],t[o],s))}}function y(e,t,n){var i=!0;t>e.lastLine()&&(t--,i=!1);var r=document.createElement("div");return r.className="CodeMirror-merge-spacer",r.style.height=n+"px",r.style.minWidth="1px",e.addLineWidget(t,r,{height:n,above:i})}function b(e,t,n,i,r){var o="left"==e.type,a=e.orig.heightAtLine(t.origFrom,"local",!0)-n;if(e.svg){var s=a,l=e.edit.heightAtLine(t.editFrom,"local",!0)-i;if(o){var c=s;s=l,l=c}var u=e.orig.heightAtLine(t.origTo,"local",!0)-n,h=e.edit.heightAtLine(t.editTo,"local",!0)-i;if(o){var c=u;u=h,h=c}var d=" C "+r/2+" "+l+" "+r/2+" "+s+" "+(r+2)+" "+s,f=" C "+r/2+" "+u+" "+r/2+" "+h+" -1 "+h;$(e.svg.appendChild(document.createElementNS(z,"path")),"d","M -1 "+l+d+" L "+(r+2)+" "+u+f+" z","class",e.classes.connect)}if(e.copyButtons){var p=e.copyButtons.appendChild(R("div","left"==e.type?"\u21dd":"\u21dc","CodeMirror-merge-copy")),g=e.mv.options.allowEditingOriginals;if(p.title=g?"Push to left":"Revert chunk",p.chunk=t,p.style.top=a+"px",g){var m=e.orig.heightAtLine(t.editFrom,"local")-i,v=e.copyButtons.appendChild(R("div","right"==e.type?"\u21dd":"\u21dc","CodeMirror-merge-copy-reverse"));v.title="Push to right",v.chunk={editFrom:t.origFrom,editTo:t.origTo,origFrom:t.editFrom,origTo:t.editTo},v.style.top=m+"px","right"==e.type?v.style.left="2px":v.style.right="2px"}}}function w(e,t,n,i){if(!e.diffOutOfDate){var r=i.editTo>t.lastLine()?U(i.editFrom-1):U(i.editFrom,0),o=i.origTo>n.lastLine()?U(i.origFrom-1):U(i.origFrom,0);t.replaceRange(n.getRange(o,U(i.origTo,0)),r,U(i.editTo,0))}}function C(t){var n=t.lockButton=R("div",null,"CodeMirror-merge-scrolllock");n.title="Toggle locked scrolling";var i=R("div",[n],"CodeMirror-merge-scrolllock-wrap");e.on(n,"click",function(){s(t,!t.lockScroll)});var r=[i];if(t.mv.options.revertButtons!==!1&&(t.copyButtons=R("div",null,"CodeMirror-merge-copybuttons-"+t.type),e.on(t.copyButtons,"click",function(e){var n=e.target||e.srcElement;if(n.chunk)return"CodeMirror-merge-copy-reverse"==n.className?void w(t,t.orig,t.edit,n.chunk):void w(t,t.edit,t.orig,n.chunk)}),r.unshift(t.copyButtons)),"align"!=t.mv.options.connect){var o=document.createElementNS&&document.createElementNS(z,"svg");o&&!o.createSVGRect&&(o=null),t.svg=o,o&&r.push(o)}return t.gap=R("div",r,"CodeMirror-merge-gap")}function x(e){return"string"==typeof e?e:e.getValue()}function k(e,t){var n=Y.diff_main(e,t);Y.diff_cleanupSemantic(n);for(var i=0;i<n.length;++i){var r=n[i];r[1]?i&&n[i-1][0]==r[0]&&(n.splice(i--,1),n[i][1]+=r[1]):n.splice(i--,1)}return n}function _(e){for(var t=[],n=0,i=0,r=U(0,0),o=U(0,0),a=0;a<e.length;++a){var s=e[a],l=s[0];if(l==DIFF_EQUAL){var c=S(e,a)?0:1,u=r.line+c,h=o.line+c;D(r,s[1],null,o);var d=A(e,a)?1:0,f=r.line+d,p=o.line+d;f>u&&(a&&t.push({origFrom:i,origTo:h,editFrom:n,editTo:u}),n=f,i=p)}else D(l==DIFF_INSERT?r:o,s[1])}return(n<=r.line||i<=o.line)&&t.push({origFrom:i,origTo:o.line+1,editFrom:n,editTo:r.line+1}),t}function A(e,t){if(t==e.length-1)return!0;var n=e[t+1][1];return 1==n.length||10!=n.charCodeAt(0)?!1:t==e.length-2?!0:(n=e[t+2][1],n.length>1&&10==n.charCodeAt(0))}function S(e,t){if(0==t)return!0;var n=e[t-1][1];return 10!=n.charCodeAt(n.length-1)?!1:1==t?!0:(n=e[t-2][1],10==n.charCodeAt(n.length-1))}function T(e,t,n){for(var i,r,o,a,s=0;s<e.length;s++){var l=e[s],c=n?l.editFrom:l.origFrom,u=n?l.editTo:l.origTo;null==r&&(c>t?(r=l.editFrom,a=l.origFrom):u>t&&(r=l.editTo,a=l.origTo)),t>=u?(i=l.editTo,o=l.origTo):t>=c&&(i=l.editFrom,o=l.origFrom)}return{edit:{before:i,after:r},orig:{before:o,after:a}}}function L(t,n,i){function r(){a.clear(),t.removeLineClass(n,"wrap","CodeMirror-merge-collapsed-line")}t.addLineClass(n,"wrap","CodeMirror-merge-collapsed-line");var o=document.createElement("span");o.className="CodeMirror-merge-collapsed-widget",o.title="Identical text collapsed. Click to expand.";var a=t.markText(U(n,0),U(i-1),{inclusiveLeft:!0,inclusiveRight:!0,replacedWith:o,clearOnEnter:!0});return e.on(o,"click",r),{mark:a,clear:r}}function E(e,t){function n(){for(var e=0;e<i.length;e++)i[e].clear()}for(var i=[],r=0;r<t.length;r++){var o=t[r],a=L(o.cm,o.line,o.line+e);i.push(a),a.mark.on("clear",n)}return i[0].mark}function M(e,t,n,i){for(var r=0;r<e.chunks.length;r++)for(var o=e.chunks[r],a=o.editFrom-t;a<o.editTo+t;a++){var s=a+n;s>=0&&s<i.length&&(i[s]=!1)}}function P(e,t){"number"!=typeof t&&(t=2);for(var n=[],i=e.editor(),r=i.firstLine(),o=r,a=i.lastLine();a>=o;o++)n.push(!0);e.left&&M(e.left,t,r,n),e.right&&M(e.right,t,r,n);for(var s=0;s<n.length;s++)if(n[s]){for(var l=s+r,c=1;s<n.length-1&&n[s+1];s++,c++);if(c>t){var u=[{line:l,cm:i}];e.left&&u.push({line:p(l,e.left.chunks),cm:e.left.orig}),e.right&&u.push({line:p(l,e.right.chunks),cm:e.right.orig});var h=E(c,u);e.options.onCollapse&&e.options.onCollapse(e,l,c,h)}}}function R(e,t,n,i){var r=document.createElement(e);if(n&&(r.className=n),i&&(r.style.cssText=i),"string"==typeof t)r.appendChild(document.createTextNode(t));else if(t)for(var o=0;o<t.length;++o)r.appendChild(t[o]);return r}function I(e){for(var t=e.childNodes.length;t>0;--t)e.removeChild(e.firstChild)}function $(e){for(var t=1;t<arguments.length;t+=2)e.setAttribute(arguments[t],arguments[t+1])}function O(e,t){t||(t={});for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function D(e,t,n,i){for(var r=n?U(e.line,e.ch):e,o=0;;){var a=t.indexOf("\n",o);if(-1==a)break;++r.line,i&&++i.line,o=a+1}return r.ch=(o?0:r.ch)+(t.length-o),i&&(i.ch=(o?0:i.ch)+(t.length-o)),r}function F(e,t){return(e.line-t.line||e.ch-t.ch)<0?e:t}function N(e,t){return(e.line-t.line||e.ch-t.ch)>0?e:t}function W(e,t){return e.line==t.line&&e.ch==t.ch}function j(e,t,n){for(var i=e.length-1;i>=0;i--){var r=e[i],o=(n?r.origTo:r.editTo)-1;if(t>o)return o}}function H(e,t,n){for(var i=0;i<e.length;i++){var r=e[i],o=n?r.origFrom:r.editFrom;if(o>t)return o}}function B(t,i){var r=null,o=t.state.diffViews,a=t.getCursor().line;if(o)for(var s=0;s<o.length;s++){var l=o[s],c=t==l.orig;n(l);var u=0>i?j(l.chunks,a,c):H(l.chunks,a,c);null==u||null!=r&&!(0>i?u>r:r>u)||(r=u)}return null==r?e.Pass:void t.setCursor(r,0)}var U=e.Pos,z="http://www.w3.org/2000/svg";t.prototype={constructor:t,init:function(t,n,i){this.edit=this.mv.edit,(this.edit.state.diffViews||(this.edit.state.diffViews=[])).push(this),this.orig=e(t,O({value:n,readOnly:!this.mv.options.allowEditingOriginals},O(i))),this.orig.state.diffViews=[this];var r=i.chunkClassLocation||"background";"[object Array]"!=Object.prototype.toString.call(r)&&(r=[r]),this.classes.classLocation=r,this.diff=k(x(n),x(i.value)),this.chunks=_(this.diff),this.diffOutOfDate=this.dealigned=!1,this.showDifferences=i.showDifferences!==!1},registerEvents:function(){this.forceUpdate=i(this),s(this,!0,!1),r(this)},setShowDifferences:function(e){e=e!==!1,e!=this.showDifferences&&(this.showDifferences=e,this.forceUpdate("full"))}};var G=!1,q=e.MergeView=function(n,i){if(!(this instanceof q))return new q(n,i);this.options=i;var r=i.origLeft,o=null==i.origRight?i.orig:i.origRight,a=null!=r,s=null!=o,l=1+(a?1:0)+(s?1:0),c=[],u=this.left=null,h=this.right=null,d=this;if(a){u=this.left=new t(this,"left");var p=R("div",null,"CodeMirror-merge-pane CodeMirror-merge-left");c.push(p),c.push(C(u))}var g=R("div",null,"CodeMirror-merge-pane CodeMirror-merge-editor");if(c.push(g),s){h=this.right=new t(this,"right"),c.push(C(h));var v=R("div",null,"CodeMirror-merge-pane CodeMirror-merge-right");c.push(v)}(s?v:g).className+=" CodeMirror-merge-pane-rightmost",c.push(R("div",null,null,"height: 0; clear: both;"));var y=this.wrap=n.appendChild(R("div",c,"CodeMirror-merge CodeMirror-merge-"+l+"pane"));this.edit=e(g,O(i)),u&&u.init(p,r,i),h&&h.init(v,o,i),i.collapseIdentical&&this.editor().operation(function(){P(d,i.collapseIdentical)}),"align"==i.connect&&(this.aligners=[],m(this.left||this.right,!0)),u&&u.registerEvents(),h&&h.registerEvents();var b=function(){u&&f(u),h&&f(h)};e.on(window,"resize",b);var w=setInterval(function(){for(var t=y.parentNode;t&&t!=document.body;t=t.parentNode);t||(clearInterval(w),e.off(window,"resize",b))},5e3)};q.prototype={constructor:q,editor:function(){return this.edit},rightOriginal:function(){return this.right&&this.right.orig},leftOriginal:function(){return this.left&&this.left.orig},setShowDifferences:function(e){this.right&&this.right.setShowDifferences(e),this.left&&this.left.setShowDifferences(e)},rightChunks:function(){return this.right?(n(this.right),this.right.chunks):void 0},leftChunks:function(){return this.left?(n(this.left),this.left.chunks):void 0}};var Y=new diff_match_patch;Y.Diff_Timeout=10,e.commands.goNextDiff=function(e){return B(e,1)},e.commands.goPrevDiff=function(e){return B(e,-1)}}),
// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(e){var t=e.search(r);return-1==t?0:t}function n(e,t,n){return/\bstring\b/.test(e.getTokenTypeAt(o(t.line,0)))&&!/^[\'\"`]/.test(n)}var i={},r=/[^\s\u00a0]/,o=e.Pos;e.commands.toggleComment=function(e){e.toggleComment()},e.defineExtension("toggleComment",function(e){e||(e=i);for(var t=this,n=1/0,r=this.listSelections(),a=null,s=r.length-1;s>=0;s--){var l=r[s].from(),c=r[s].to();l.line>=n||(c.line>=n&&(c=o(n,0)),n=l.line,null==a?t.uncomment(l,c,e)?a="un":(t.lineComment(l,c,e),a="line"):"un"==a?t.uncomment(l,c,e):t.lineComment(l,c,e))}}),e.defineExtension("lineComment",function(e,a,s){s||(s=i);var l=this,c=l.getModeAt(e),u=l.getLine(e.line);if(null!=u&&!n(l,e,u)){var h=s.lineComment||c.lineComment;if(!h)return void((s.blockCommentStart||c.blockCommentStart)&&(s.fullLines=!0,l.blockComment(e,a,s)));var d=Math.min(0!=a.ch||a.line==e.line?a.line+1:a.line,l.lastLine()+1),f=null==s.padding?" ":s.padding,p=s.commentBlankLines||e.line==a.line;l.operation(function(){if(s.indent){for(var n=null,i=e.line;d>i;++i){var a=l.getLine(i),c=a.slice(0,t(a));(null==n||n.length>c.length)&&(n=c)}for(var i=e.line;d>i;++i){var a=l.getLine(i),u=n.length;(p||r.test(a))&&(a.slice(0,u)!=n&&(u=t(a)),l.replaceRange(n+h+f,o(i,0),o(i,u)))}}else for(var i=e.line;d>i;++i)(p||r.test(l.getLine(i)))&&l.replaceRange(h+f,o(i,0))})}}),e.defineExtension("blockComment",function(e,t,n){n||(n=i);var a=this,s=a.getModeAt(e),l=n.blockCommentStart||s.blockCommentStart,c=n.blockCommentEnd||s.blockCommentEnd;if(!l||!c)return void((n.lineComment||s.lineComment)&&0!=n.fullLines&&a.lineComment(e,t,n));if(!/\bcomment\b/.test(a.getTokenTypeAt(o(e.line,0)))){var u=Math.min(t.line,a.lastLine());u!=e.line&&0==t.ch&&r.test(a.getLine(u))&&--u;var h=null==n.padding?" ":n.padding;e.line>u||a.operation(function(){if(0!=n.fullLines){var i=r.test(a.getLine(u));a.replaceRange(h+c,o(u)),a.replaceRange(l+h,o(e.line,0));var d=n.blockCommentLead||s.blockCommentLead;if(null!=d)for(var f=e.line+1;u>=f;++f)(f!=u||i)&&a.replaceRange(d+h,o(f,0))}else a.replaceRange(c,t),a.replaceRange(l,e)})}}),e.defineExtension("uncomment",function(e,t,n){n||(n=i);var a,s=this,l=s.getModeAt(e),c=Math.min(0!=t.ch||t.line==e.line?t.line:t.line-1,s.lastLine()),u=Math.min(e.line,c),h=n.lineComment||l.lineComment,d=[],f=null==n.padding?" ":n.padding;e:if(h){for(var p=u;c>=p;++p){var g=s.getLine(p),m=g.indexOf(h);if(m>-1&&!/comment/.test(s.getTokenTypeAt(o(p,m+1)))&&(m=-1),-1==m&&r.test(g))break e;if(m>-1&&r.test(g.slice(0,m)))break e;d.push(g)}if(s.operation(function(){for(var e=u;c>=e;++e){var t=d[e-u],n=t.indexOf(h),i=n+h.length;0>n||(t.slice(i,i+f.length)==f&&(i+=f.length),a=!0,s.replaceRange("",o(e,n),o(e,i)))}}),a)return!0}var v=n.blockCommentStart||l.blockCommentStart,y=n.blockCommentEnd||l.blockCommentEnd;if(!v||!y)return!1;var b=n.blockCommentLead||l.blockCommentLead,w=s.getLine(u),C=w.indexOf(v);if(-1==C)return!1;var x=c==u?w:s.getLine(c),k=x.indexOf(y,c==u?C+v.length:0);if(-1==k&&u!=c&&(x=s.getLine(--c),k=x.indexOf(y)),-1==k||!/comment/.test(s.getTokenTypeAt(o(u,C+1)))||!/comment/.test(s.getTokenTypeAt(o(c,k+1))))return!1;var _=w.lastIndexOf(v,e.ch),A=-1==_?-1:w.slice(0,e.ch).indexOf(y,_+v.length);if(-1!=_&&-1!=A&&A+y.length!=e.ch)return!1;A=x.indexOf(y,t.ch);var S=x.slice(t.ch).lastIndexOf(v,A-t.ch);return _=-1==A||-1==S?-1:t.ch+S,-1!=A&&-1!=_&&_!=t.ch?!1:(s.operation(function(){s.replaceRange("",o(c,k-(f&&x.slice(k-f.length,k)==f?f.length:0)),o(c,k+y.length));var e=C+v.length;if(f&&w.slice(e,e+f.length)==f&&(e+=f.length),s.replaceRange("",o(u,C),o(u,e)),b)for(var t=u+1;c>=t;++t){var n=s.getLine(t),i=n.indexOf(b);if(-1!=i&&!r.test(n.slice(0,i))){var a=i+b.length;f&&n.slice(a,a+f.length)==f&&(a+=f.length),s.replaceRange("",o(t,i),o(t,a))}}}),!0)})}),
// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){function t(e,t,n){var i,r=e.getWrapperElement();return i=r.appendChild(document.createElement("div")),n?i.className="CodeMirror-dialog CodeMirror-dialog-bottom":i.className="CodeMirror-dialog CodeMirror-dialog-top","string"==typeof t?i.innerHTML=t:i.appendChild(t),i}function n(e,t){e.state.currentNotificationClose&&e.state.currentNotificationClose(),e.state.currentNotificationClose=t}e.defineExtension("openDialog",function(i,r,o){function a(e){if("string"==typeof e)h.value=e;else{if(c)return;c=!0,l.parentNode.removeChild(l),u.focus(),o.onClose&&o.onClose(l)}}o||(o={}),n(this,null);var s,l=t(this,i,o.bottom),c=!1,u=this,h=l.getElementsByTagName("input")[0];return h?(h.focus(),o.value&&(h.value=o.value,o.selectValueOnOpen!==!1&&h.select()),o.onInput&&e.on(h,"input",function(e){o.onInput(e,h.value,a)}),o.onKeyUp&&e.on(h,"keyup",function(e){o.onKeyUp(e,h.value,a)}),e.on(h,"keydown",function(t){o&&o.onKeyDown&&o.onKeyDown(t,h.value,a)||((27==t.keyCode||o.closeOnEnter!==!1&&13==t.keyCode)&&(h.blur(),e.e_stop(t),a()),13==t.keyCode&&r(h.value,t))}),o.closeOnBlur!==!1&&e.on(h,"blur",a)):(s=l.getElementsByTagName("button")[0])&&(e.on(s,"click",function(){a(),u.focus()}),o.closeOnBlur!==!1&&e.on(s,"blur",a),s.focus()),a}),e.defineExtension("openConfirm",function(i,r,o){function a(){c||(c=!0,s.parentNode.removeChild(s),u.focus())}n(this,null);var s=t(this,i,o&&o.bottom),l=s.getElementsByTagName("button"),c=!1,u=this,h=1;l[0].focus();for(var d=0;d<l.length;++d){var f=l[d];!function(t){e.on(f,"click",function(n){e.e_preventDefault(n),a(),t&&t(u)})}(r[d]),e.on(f,"blur",function(){--h,setTimeout(function(){0>=h&&a()},200)}),e.on(f,"focus",function(){++h})}}),e.defineExtension("openNotification",function(i,r){function o(){l||(l=!0,clearTimeout(a),s.parentNode.removeChild(s))}n(this,o);var a,s=t(this,i,r&&r.bottom),l=!1,c=r&&"undefined"!=typeof r.duration?r.duration:5e3;return e.on(s,"click",function(t){e.e_preventDefault(t),o()}),c&&(a=setTimeout(o,c)),o})}),
// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(e,t,r,o){if(this.atOccurrence=!1,this.doc=e,null==o&&"string"==typeof t&&(o=!1),r=r?e.clipPos(r):i(0,0),this.pos={from:r,to:r},"string"!=typeof t)t.global||(t=new RegExp(t.source,t.ignoreCase?"ig":"g")),this.matches=function(n,r){if(n){t.lastIndex=0;for(var o,a,s=e.getLine(r.line).slice(0,r.ch),l=0;;){t.lastIndex=l;var c=t.exec(s);if(!c)break;if(o=c,a=o.index,l=o.index+(o[0].length||1),l==s.length)break}var u=o&&o[0].length||0;u||(0==a&&0==s.length?o=void 0:a!=e.getLine(r.line).length&&u++)}else{t.lastIndex=r.ch;var s=e.getLine(r.line),o=t.exec(s),u=o&&o[0].length||0,a=o&&o.index;a+u==s.length||u||(u=1)}return o&&u?{from:i(r.line,a),to:i(r.line,a+u),match:o}:void 0};else{var a=t;o&&(t=t.toLowerCase());var s=o?function(e){return e.toLowerCase()}:function(e){return e},l=t.split("\n");if(1==l.length)t.length?this.matches=function(r,o){if(r){var l=e.getLine(o.line).slice(0,o.ch),c=s(l),u=c.lastIndexOf(t);if(u>-1)return u=n(l,c,u),{from:i(o.line,u),to:i(o.line,u+a.length)}}else{var l=e.getLine(o.line).slice(o.ch),c=s(l),u=c.indexOf(t);if(u>-1)return u=n(l,c,u)+o.ch,{from:i(o.line,u),to:i(o.line,u+a.length)}}}:this.matches=function(){};else{var c=a.split("\n");this.matches=function(t,n){var r=l.length-1;if(t){if(n.line-(l.length-1)<e.firstLine())return;if(s(e.getLine(n.line).slice(0,c[r].length))!=l[l.length-1])return;for(var o=i(n.line,c[r].length),a=n.line-1,u=r-1;u>=1;--u,--a)if(l[u]!=s(e.getLine(a)))return;var h=e.getLine(a),d=h.length-c[0].length;if(s(h.slice(d))!=l[0])return;return{from:i(a,d),to:o}}if(!(n.line+(l.length-1)>e.lastLine())){var h=e.getLine(n.line),d=h.length-c[0].length;if(s(h.slice(d))==l[0]){for(var f=i(n.line,d),a=n.line+1,u=1;r>u;++u,++a)if(l[u]!=s(e.getLine(a)))return;if(s(e.getLine(a).slice(0,c[r].length))==l[r])return{from:f,to:i(a,c[r].length)}}}}}}}function n(e,t,n){if(e.length==t.length)return n;for(var i=Math.min(n,e.length);;){var r=e.slice(0,i).toLowerCase().length;if(n>r)++i;else{if(!(r>n))return i;--i}}}var i=e.Pos;t.prototype={findNext:function(){return this.find(!1)},findPrevious:function(){return this.find(!0)},find:function(e){function t(e){var t=i(e,0);return n.pos={from:t,to:t},n.atOccurrence=!1,!1}for(var n=this,r=this.doc.clipPos(e?this.pos.from:this.pos.to);;){if(this.pos=this.matches(e,r))return this.atOccurrence=!0,this.pos.match||!0;if(e){if(!r.line)return t(0);r=i(r.line-1,this.doc.getLine(r.line-1).length)}else{var o=this.doc.lineCount();if(r.line==o-1)return t(o);r=i(r.line+1,0)}}},from:function(){return this.atOccurrence?this.pos.from:void 0},to:function(){return this.atOccurrence?this.pos.to:void 0},replace:function(t,n){if(this.atOccurrence){var r=e.splitLines(t);this.doc.replaceRange(r,this.pos.from,this.pos.to,n),this.pos.to=i(this.pos.from.line+r.length-1,r[r.length-1].length+(1==r.length?this.pos.from.ch:0))}}},e.defineExtension("getSearchCursor",function(e,n,i){return new t(this.doc,e,n,i)}),e.defineDocExtension("getSearchCursor",function(e,n,i){return new t(this,e,n,i)}),e.defineExtension("selectMatches",function(t,n){for(var i=[],r=this.getSearchCursor(t,this.getCursor("from"),n);r.findNext()&&!(e.cmpPos(r.to(),this.getCursor("to"))>0);)i.push({anchor:r.from(),head:r.to()});i.length&&this.setSelections(i,0)})}),
// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("./searchcursor"),require("../dialog/dialog")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","./searchcursor","../dialog/dialog"],e):e(CodeMirror)}(function(e){"use strict";function t(e,t){return"string"==typeof e?e=new RegExp(e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),t?"gi":"g"):e.global||(e=new RegExp(e.source,e.ignoreCase?"gi":"g")),{token:function(t){e.lastIndex=t.pos;var n=e.exec(t.string);return n&&n.index==t.pos?(t.pos+=n[0].length||1,"searching"):void(n?t.pos=n.index:t.skipToEnd())}}}function n(){this.posFrom=this.posTo=this.lastQuery=this.query=null,this.overlay=null}function i(e){return e.state.search||(e.state.search=new n)}function r(e){return"string"==typeof e&&e==e.toLowerCase()}function o(e,t,n){return e.getSearchCursor(t,n,r(t))}function a(e,t,n,i,r){e.openDialog(t,i,{value:n,selectValueOnOpen:!0,closeOnEnter:!1,onClose:function(){f(e)},onKeyDown:r})}function s(e,t,n,i,r){e.openDialog?e.openDialog(t,r,{value:i,selectValueOnOpen:!0}):r(prompt(n,i))}function l(e,t,n,i){e.openConfirm?e.openConfirm(t,i):confirm(n)&&i[0]()}function c(e){var t=e.match(/^\/(.*)\/([a-z]*)$/);if(t)try{e=new RegExp(t[1],-1==t[2].indexOf("i")?"":"i")}catch(n){}return("string"==typeof e?""==e:e.test(""))&&(e=/x^/),e}function u(e,n,i){n.queryText=i,n.query=c(i),e.removeOverlay(n.overlay,r(n.query)),n.overlay=t(n.query,r(n.query)),e.addOverlay(n.overlay),e.showMatchesOnScrollbar&&(n.annotate&&(n.annotate.clear(),n.annotate=null),n.annotate=e.showMatchesOnScrollbar(n.query,r(n.query)))}function h(t,n,r,o){var l=i(t);if(l.query)return d(t,n);var c=t.getSelection()||l.lastQuery;if(r&&t.openDialog){var h=null,f=function(n,i){e.e_stop(i),n&&(n!=l.queryText&&(u(t,l,n),l.posFrom=l.posTo=t.getCursor()),h&&(h.style.opacity=1),d(t,i.shiftKey,function(e,n){var i;n.line<3&&document.querySelector&&(i=t.display.wrapper.querySelector(".CodeMirror-dialog"))&&i.getBoundingClientRect().bottom-4>t.cursorCoords(n,"window").top&&((h=i).style.opacity=.4)}))};a(t,m,c,f,function(n,r){var o=e.keyName(n),a=e.keyMap[t.getOption("keyMap")][o];a||(a=t.getOption("extraKeys")[o]),"findNext"==a||"findPrev"==a||"findPersistentNext"==a||"findPersistentPrev"==a?(e.e_stop(n),u(t,i(t),r),t.execCommand(a)):"find"!=a&&"findPersistent"!=a||(e.e_stop(n),f(r,n))}),o&&c&&(u(t,l,c),d(t,n))}else s(t,m,"Search for:",c,function(e){e&&!l.query&&t.operation(function(){u(t,l,e),l.posFrom=l.posTo=t.getCursor(),d(t,n)})})}function d(t,n,r){t.operation(function(){var a=i(t),s=o(t,a.query,n?a.posFrom:a.posTo);(s.find(n)||(s=o(t,a.query,n?e.Pos(t.lastLine()):e.Pos(t.firstLine(),0)),s.find(n)))&&(t.setSelection(s.from(),s.to()),t.scrollIntoView({from:s.from(),to:s.to()},20),a.posFrom=s.from(),a.posTo=s.to(),r&&r(s.from(),s.to()))})}function f(e){e.operation(function(){var t=i(e);t.lastQuery=t.query,t.query&&(t.query=t.queryText=null,e.removeOverlay(t.overlay),t.annotate&&(t.annotate.clear(),t.annotate=null))})}function p(e,t,n){e.operation(function(){for(var i=o(e,t);i.findNext();)if("string"!=typeof t){var r=e.getRange(i.from(),i.to()).match(t);i.replace(n.replace(/\$(\d)/g,function(e,t){return r[t]}))}else i.replace(n)})}function g(e,t){if(!e.getOption("readOnly")){var n=e.getSelection()||i(e).lastQuery,r=t?"Replace all:":"Replace:";s(e,r+v,r,n,function(n){n&&(n=c(n),s(e,y,"Replace with:","",function(i){if(t)p(e,n,i);else{f(e);var r=o(e,n,e.getCursor("from")),a=function(){var t,c=r.from();!(t=r.findNext())&&(r=o(e,n),!(t=r.findNext())||c&&r.from().line==c.line&&r.from().ch==c.ch)||(e.setSelection(r.from(),r.to()),e.scrollIntoView({from:r.from(),to:r.to()}),l(e,b,"Replace?",[function(){s(t)},a,function(){p(e,n,i)}]))},s=function(e){r.replace("string"==typeof n?i:i.replace(/\$(\d)/g,function(t,n){return e[n]})),a()};a()}}))})}}var m='Search: <input type="text" style="width: 10em" class="CodeMirror-search-field"/> <span style="color: #888" class="CodeMirror-search-hint">(Use /re/ syntax for regexp search)</span>',v=' <input type="text" style="width: 10em" class="CodeMirror-search-field"/> <span style="color: #888" class="CodeMirror-search-hint">(Use /re/ syntax for regexp search)</span>',y='With: <input type="text" style="width: 10em" class="CodeMirror-search-field"/>',b="Replace? <button>Yes</button> <button>No</button> <button>All</button> <button>Stop</button>";e.commands.find=function(e){f(e),h(e)},e.commands.findPersistent=function(e){f(e),h(e,!1,!0)},e.commands.findPersistentNext=function(e){h(e,!1,!0,!0)},e.commands.findPersistentPrev=function(e){h(e,!0,!0,!0)},e.commands.findNext=h,e.commands.findPrev=function(e){h(e,!0)},e.commands.clearSearch=f,e.commands.replace=g,e.commands.replaceAll=function(e){g(e,!0)}}),
// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(e){"object"==typeof exports&&"object"==typeof module?e(require("../lib/codemirror"),require("../addon/search/searchcursor"),require("../addon/dialog/dialog"),require("../addon/edit/matchbrackets.js")):"function"==typeof define&&define.amd?define(["../lib/codemirror","../addon/search/searchcursor","../addon/dialog/dialog","../addon/edit/matchbrackets"],e):e(CodeMirror)}(function(e){"use strict";var t=[{keys:"<Left>",type:"keyToKey",toKeys:"h"},{keys:"<Right>",type:"keyToKey",toKeys:"l"},{keys:"<Up>",type:"keyToKey",toKeys:"k"},{keys:"<Down>",type:"keyToKey",toKeys:"j"},{keys:"<Space>",type:"keyToKey",toKeys:"l"},{keys:"<BS>",type:"keyToKey",toKeys:"h",context:"normal"},{keys:"<C-Space>",type:"keyToKey",toKeys:"W"},{keys:"<C-BS>",type:"keyToKey",toKeys:"B",context:"normal"},{keys:"<S-Space>",type:"keyToKey",toKeys:"w"},{keys:"<S-BS>",type:"keyToKey",toKeys:"b",context:"normal"},{keys:"<C-n>",type:"keyToKey",toKeys:"j"},{keys:"<C-p>",type:"keyToKey",toKeys:"k"},{keys:"<C-[>",type:"keyToKey",toKeys:"<Esc>"},{keys:"<C-c>",type:"keyToKey",toKeys:"<Esc>"},{keys:"<C-[>",type:"keyToKey",toKeys:"<Esc>",context:"insert"},{keys:"<C-c>",type:"keyToKey",toKeys:"<Esc>",context:"insert"},{keys:"s",type:"keyToKey",toKeys:"cl",context:"normal"},{keys:"s",type:"keyToKey",toKeys:"c",context:"visual"},{keys:"S",type:"keyToKey",toKeys:"cc",context:"normal"},{keys:"S",type:"keyToKey",toKeys:"VdO",context:"visual"},{keys:"<Home>",type:"keyToKey",toKeys:"0"},{keys:"<End>",type:"keyToKey",toKeys:"$"},{keys:"<PageUp>",type:"keyToKey",toKeys:"<C-b>"},{keys:"<PageDown>",type:"keyToKey",toKeys:"<C-f>"},{keys:"<CR>",type:"keyToKey",toKeys:"j^",context:"normal"},{keys:"<Ins>",type:"action",action:"toggleOverwrite",context:"insert"},{keys:"H",type:"motion",motion:"moveToTopLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:"M",type:"motion",motion:"moveToMiddleLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:"L",type:"motion",motion:"moveToBottomLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:"h",type:"motion",motion:"moveByCharacters",motionArgs:{forward:!1}},{keys:"l",type:"motion",motion:"moveByCharacters",motionArgs:{forward:!0}},{keys:"j",type:"motion",motion:"moveByLines",motionArgs:{forward:!0,linewise:!0}},{keys:"k",type:"motion",motion:"moveByLines",motionArgs:{forward:!1,linewise:!0}},{keys:"gj",type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:!0}},{keys:"gk",type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:!1}},{keys:"w",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!1}},{keys:"W",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!1,bigWord:!0}},{keys:"e",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!0,inclusive:!0}},{keys:"E",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!0,bigWord:!0,inclusive:!0}},{keys:"b",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1}},{keys:"B",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1,bigWord:!0}},{keys:"ge",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!0,inclusive:!0}},{keys:"gE",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!0,bigWord:!0,inclusive:!0}},{keys:"{",type:"motion",motion:"moveByParagraph",motionArgs:{forward:!1,toJumplist:!0}},{keys:"}",type:"motion",motion:"moveByParagraph",motionArgs:{forward:!0,toJumplist:!0}},{keys:"<C-f>",type:"motion",motion:"moveByPage",motionArgs:{forward:!0}},{keys:"<C-b>",type:"motion",motion:"moveByPage",motionArgs:{forward:!1}},{keys:"<C-d>",type:"motion",motion:"moveByScroll",motionArgs:{forward:!0,explicitRepeat:!0}},{keys:"<C-u>",type:"motion",motion:"moveByScroll",motionArgs:{forward:!1,explicitRepeat:!0}},{keys:"gg",type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!1,explicitRepeat:!0,linewise:!0,toJumplist:!0}},{keys:"G",type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!0,explicitRepeat:!0,linewise:!0,toJumplist:!0}},{keys:"0",type:"motion",motion:"moveToStartOfLine"},{keys:"^",type:"motion",motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"+",type:"motion",motion:"moveByLines",motionArgs:{forward:!0,toFirstChar:!0}},{keys:"-",type:"motion",motion:"moveByLines",motionArgs:{forward:!1,toFirstChar:!0}},{keys:"_",type:"motion",motion:"moveByLines",motionArgs:{forward:!0,toFirstChar:!0,repeatOffset:-1}},{keys:"$",type:"motion",motion:"moveToEol",motionArgs:{inclusive:!0}},{keys:"%",type:"motion",motion:"moveToMatchedSymbol",motionArgs:{inclusive:!0,toJumplist:!0}},{keys:"f<character>",type:"motion",motion:"moveToCharacter",motionArgs:{forward:!0,inclusive:!0}},{keys:"F<character>",type:"motion",motion:"moveToCharacter",motionArgs:{forward:!1}},{keys:"t<character>",type:"motion",motion:"moveTillCharacter",motionArgs:{forward:!0,inclusive:!0}},{keys:"T<character>",type:"motion",motion:"moveTillCharacter",motionArgs:{forward:!1}},{keys:";",type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:!0}},{keys:",",type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:!1}},{keys:"'<character>",type:"motion",motion:"goToMark",motionArgs:{toJumplist:!0,linewise:!0}},{keys:"`<character>",type:"motion",motion:"goToMark",motionArgs:{toJumplist:!0}},{keys:"]`",type:"motion",motion:"jumpToMark",motionArgs:{forward:!0}},{keys:"[`",type:"motion",motion:"jumpToMark",motionArgs:{forward:!1}},{keys:"]'",type:"motion",motion:"jumpToMark",motionArgs:{forward:!0,linewise:!0}},{keys:"['",type:"motion",motion:"jumpToMark",motionArgs:{forward:!1,linewise:!0}},{keys:"]p",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!0,isEdit:!0,matchIndent:!0}},{keys:"[p",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!1,isEdit:!0,matchIndent:!0}},{keys:"]<character>",type:"motion",motion:"moveToSymbol",motionArgs:{forward:!0,toJumplist:!0}},{keys:"[<character>",type:"motion",motion:"moveToSymbol",motionArgs:{forward:!1,toJumplist:!0}},{keys:"|",type:"motion",motion:"moveToColumn"},{keys:"o",type:"motion",motion:"moveToOtherHighlightedEnd",context:"visual"},{keys:"O",type:"motion",motion:"moveToOtherHighlightedEnd",motionArgs:{sameLine:!0},context:"visual"},{keys:"d",type:"operator",operator:"delete"},{keys:"y",type:"operator",operator:"yank"},{keys:"c",type:"operator",operator:"change"},{keys:">",type:"operator",operator:"indent",operatorArgs:{indentRight:!0}},{keys:"<",type:"operator",operator:"indent",operatorArgs:{indentRight:!1}},{keys:"g~",type:"operator",operator:"changeCase"},{keys:"gu",type:"operator",operator:"changeCase",operatorArgs:{toLower:!0},isEdit:!0},{keys:"gU",type:"operator",operator:"changeCase",operatorArgs:{toLower:!1},isEdit:!0},{keys:"n",type:"motion",motion:"findNext",motionArgs:{forward:!0,toJumplist:!0}},{keys:"N",type:"motion",motion:"findNext",motionArgs:{forward:!1,toJumplist:!0}},{keys:"x",type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:!0},operatorMotionArgs:{visualLine:!1}},{keys:"X",type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:!1},operatorMotionArgs:{visualLine:!0}},{keys:"D",type:"operatorMotion",operator:"delete",motion:"moveToEol",motionArgs:{inclusive:!0},context:"normal"},{keys:"D",type:"operator",operator:"delete",operatorArgs:{linewise:!0},context:"visual"},{keys:"Y",type:"operatorMotion",operator:"yank",motion:"moveToEol",motionArgs:{inclusive:!0},context:"normal"},{keys:"Y",type:"operator",operator:"yank",operatorArgs:{linewise:!0},context:"visual"},{keys:"C",type:"operatorMotion",operator:"change",motion:"moveToEol",motionArgs:{inclusive:!0},context:"normal"},{keys:"C",type:"operator",operator:"change",operatorArgs:{linewise:!0},context:"visual"},{keys:"~",type:"operatorMotion",operator:"changeCase",motion:"moveByCharacters",motionArgs:{forward:!0},operatorArgs:{shouldMoveCursor:!0},context:"normal"},{keys:"~",type:"operator",operator:"changeCase",context:"visual"},{keys:"<C-w>",type:"operatorMotion",operator:"delete",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1},context:"insert"},{keys:"<C-i>",type:"action",action:"jumpListWalk",actionArgs:{forward:!0}},{keys:"<C-o>",type:"action",action:"jumpListWalk",actionArgs:{forward:!1}},{keys:"<C-e>",type:"action",action:"scroll",actionArgs:{forward:!0,linewise:!0}},{keys:"<C-y>",type:"action",action:"scroll",actionArgs:{forward:!1,linewise:!0}},{keys:"a",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"charAfter"},context:"normal"},{keys:"A",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"eol"},context:"normal"},{keys:"A",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"endOfSelectedArea"},context:"visual"},{keys:"i",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"inplace"},context:"normal"},{keys:"I",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"firstNonBlank"},context:"normal"},{keys:"I",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"startOfSelectedArea"},context:"visual"},{keys:"o",type:"action",action:"newLineAndEnterInsertMode",isEdit:!0,interlaceInsertRepeat:!0,actionArgs:{after:!0},context:"normal"},{keys:"O",type:"action",action:"newLineAndEnterInsertMode",isEdit:!0,interlaceInsertRepeat:!0,actionArgs:{after:!1},context:"normal"},{keys:"v",type:"action",action:"toggleVisualMode"},{keys:"V",type:"action",action:"toggleVisualMode",actionArgs:{linewise:!0}},{keys:"<C-v>",type:"action",action:"toggleVisualMode",actionArgs:{blockwise:!0}},{keys:"<C-q>",type:"action",action:"toggleVisualMode",actionArgs:{blockwise:!0}},{keys:"gv",type:"action",action:"reselectLastSelection"},{keys:"J",type:"action",action:"joinLines",isEdit:!0},{keys:"p",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!0,isEdit:!0}},{keys:"P",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!1,isEdit:!0}},{keys:"r<character>",type:"action",action:"replace",isEdit:!0},{keys:"@<character>",type:"action",action:"replayMacro"},{keys:"q<character>",type:"action",action:"enterMacroRecordMode"},{keys:"R",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{replace:!0}},{keys:"u",type:"action",action:"undo",context:"normal"},{keys:"u",type:"operator",operator:"changeCase",operatorArgs:{toLower:!0},context:"visual",isEdit:!0},{keys:"U",type:"operator",operator:"changeCase",operatorArgs:{toLower:!1},context:"visual",isEdit:!0},{keys:"<C-r>",type:"action",action:"redo"},{keys:"m<character>",type:"action",action:"setMark"},{keys:'"<character>',type:"action",action:"setRegister"},{keys:"zz",type:"action",action:"scrollToCursor",actionArgs:{position:"center"}},{keys:"z.",type:"action",action:"scrollToCursor",actionArgs:{position:"center"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"zt",type:"action",action:"scrollToCursor",actionArgs:{position:"top"}},{keys:"z<CR>",type:"action",action:"scrollToCursor",actionArgs:{position:"top"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"z-",type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"}},{keys:"zb",type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:".",type:"action",action:"repeatLastEdit"},{keys:"<C-a>",type:"action",action:"incrementNumberToken",isEdit:!0,actionArgs:{increase:!0,backtrack:!1}},{keys:"<C-x>",type:"action",action:"incrementNumberToken",isEdit:!0,actionArgs:{increase:!1,backtrack:!1}},{keys:"<C-t>",type:"action",action:"indent",actionArgs:{indentRight:!0},context:"insert"},{keys:"<C-d>",type:"action",action:"indent",actionArgs:{indentRight:!1},context:"insert"},{keys:"a<character>",type:"motion",motion:"textObjectManipulation"},{keys:"i<character>",type:"motion",motion:"textObjectManipulation",motionArgs:{textObjectInner:!0}},{keys:"/",type:"search",searchArgs:{forward:!0,querySrc:"prompt",toJumplist:!0}},{keys:"?",type:"search",searchArgs:{forward:!1,querySrc:"prompt",toJumplist:!0}},{keys:"*",type:"search",searchArgs:{forward:!0,querySrc:"wordUnderCursor",wholeWordOnly:!0,toJumplist:!0}},{keys:"#",type:"search",searchArgs:{forward:!1,querySrc:"wordUnderCursor",wholeWordOnly:!0,toJumplist:!0}},{keys:"g*",type:"search",searchArgs:{forward:!0,querySrc:"wordUnderCursor",toJumplist:!0}},{keys:"g#",type:"search",searchArgs:{forward:!1,querySrc:"wordUnderCursor",toJumplist:!0}},{keys:":",type:"ex"}],n=[{name:"colorscheme",shortName:"colo"},{name:"map"},{name:"imap",shortName:"im"},{name:"nmap",shortName:"nm"},{name:"vmap",shortName:"vm"},{name:"unmap"},{name:"write",shortName:"w"},{name:"undo",shortName:"u"},{name:"redo",shortName:"red"},{name:"set",shortName:"se"},{name:"set",shortName:"se"},{name:"setlocal",shortName:"setl"},{name:"setglobal",shortName:"setg"},{name:"sort",shortName:"sor"},{name:"substitute",shortName:"s",possiblyAsync:!0},{name:"nohlsearch",shortName:"noh"},{name:"yank",shortName:"y"},{name:"delmarks",shortName:"delm"},{name:"registers",shortName:"reg",excludeFromCommandHistory:!0},{name:"global",shortName:"g"}],i=e.Pos,r=function(){function r(t){t.setOption("disableInput",!0),t.setOption("showCursorWhenSelecting",!1),e.signal(t,"vim-mode-change",{mode:"normal"}),t.on("cursorActivity",et),k(t),e.on(t.getInputField(),"paste",u(t))}function o(t){t.setOption("disableInput",!1),t.off("cursorActivity",et),e.off(t.getInputField(),"paste",u(t)),t.state.vim=null}function a(t,n){this==e.keyMap.vim&&e.rmClass(t.getWrapperElement(),"cm-fat-cursor"),n&&n.attach==s||o(t,!1)}function s(t,n){this==e.keyMap.vim&&e.addClass(t.getWrapperElement(),"cm-fat-cursor"),n&&n.attach==s||r(t)}function l(t,n){if(n){if(this[t])return this[t];var i=c(t);if(!i)return!1;var r=e.Vim.findKey(n,i);return"function"==typeof r&&e.signal(n,"vim-keypress",i),r}}function c(e){if("'"==e.charAt(0))return e.charAt(1);var t=e.split(/-(?!$)/),n=t[t.length-1];if(1==t.length&&1==t[0].length)return!1;if(2==t.length&&"Shift"==t[0]&&1==n.length)return!1;for(var i=!1,r=0;r<t.length;r++){var o=t[r];o in st?t[r]=st[o]:i=!0,o in lt&&(t[r]=lt[o])}return i?(m(n)&&(t[t.length-1]=n.toLowerCase()),"<"+t.join("-")+">"):!1}function u(e){var t=e.state.vim;return t.onPasteFn||(t.onPasteFn=function(){t.insertMode||(e.setCursor(F(e.getCursor(),0,1)),St.enterInsertMode(e,{},t))}),t.onPasteFn}function h(e,t){for(var n=[],i=e;e+t>i;i++)n.push(String.fromCharCode(i));return n}function d(e,t){return t>=e.firstLine()&&t<=e.lastLine()}function f(e){return/^[a-z]$/.test(e)}function p(e){return-1!="()[]{}".indexOf(e)}function g(e){return ct.test(e)}function m(e){return/^[A-Z]$/.test(e)}function v(e){return/^\s*$/.test(e)}function y(e,t){for(var n=0;n<t.length;n++)if(t[n]==e)return!0;return!1}function b(e,t,n,i,r){if(void 0===t&&!r)throw Error("defaultValue is required unless callback is provided");if(n||(n="string"),vt[e]={type:n,defaultValue:t,callback:r},i)for(var o=0;o<i.length;o++)vt[i[o]]=vt[e];t&&w(e,t)}function w(e,t,n,i){var r=vt[e];i=i||{};var o=i.scope;if(!r)throw Error("Unknown option: "+e);if("boolean"==r.type){if(t&&t!==!0)throw Error("Invalid argument: "+e+"="+t);t!==!1&&(t=!0)}r.callback?("local"!==o&&r.callback(t,void 0),"global"!==o&&n&&r.callback(t,n)):("local"!==o&&(r.value="boolean"==r.type?!!t:t),"global"!==o&&n&&(n.state.vim.options[e]={value:t}))}function C(e,t,n){var i=vt[e];n=n||{};var r=n.scope;if(!i)throw Error("Unknown option: "+e);{if(!i.callback){var o="global"!==r&&t&&t.state.vim.options[e];return(o||"local"!==r&&i||{}).value}var o=t&&i.callback(void 0,t);if("global"!==r&&void 0!==o)return o;if("local"!==r)return i.callback()}}function x(){this.latestRegister=void 0,this.isPlaying=!1,this.isRecording=!1,this.replaySearchQueries=[],this.onRecordingDone=void 0,this.lastInsertModeChanges=bt()}function k(e){return e.state.vim||(e.state.vim={inputState:new A,lastEditInputState:void 0,lastEditActionCommand:void 0,lastHPos:-1,lastHSPos:-1,lastMotion:null,marks:{},fakeCursor:null,insertMode:!1,insertModeRepeat:void 0,visualMode:!1,visualLine:!1,visualBlock:!1,lastSelection:null,lastPastedText:null,sel:{},options:{}}),e.state.vim}function _(){wt={searchQuery:null,searchIsReversed:!1,lastSubstituteReplacePart:void 0,jumpList:yt(),macroModeState:new x,lastCharacterSearch:{increment:0,forward:!0,selectedCharacter:""},registerController:new E({}),searchHistoryController:new M({}),exCommandHistoryController:new M({})};for(var e in vt){var t=vt[e];t.value=t.defaultValue}}function A(){this.prefixRepeat=[],this.motionRepeat=[],this.operator=null,this.operatorArgs=null,this.motion=null,this.motionArgs=null,this.keyBuffer=[],this.registerName=null}function S(t,n){t.state.vim.inputState=new A,e.signal(t,"vim-command-done",n)}function T(e,t,n){this.clear(),this.keyBuffer=[e||""],this.insertModeChanges=[],this.searchQueries=[],this.linewise=!!t,this.blockwise=!!n}function L(e,t){var n=wt.registerController.registers[e];if(!e||1!=e.length)throw Error("Register name must be 1 character");if(n[e])throw Error("Register already defined "+e);n[e]=t,mt.push(e)}function E(e){this.registers=e,this.unnamedRegister=e['"']=new T,e["."]=new T,e[":"]=new T,e["/"]=new T}function M(){this.historyBuffer=[],this.iterator=0,this.initialPrefix=null}function P(e,t){_t[e]=t}function R(e,t){for(var n=[],i=0;t>i;i++)n.push(e);return n}function I(e,t){At[e]=t}function $(e,t){St[e]=t}function O(e,t,n){var r=Math.min(Math.max(e.firstLine(),t.line),e.lastLine()),o=V(e,r)-1;o=n?o+1:o;var a=Math.min(Math.max(0,t.ch),o);return i(r,a)}function D(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function F(e,t,n){return"object"==typeof t&&(n=t.ch,t=t.line),i(e.line+t,e.ch+n)}function N(e,t){return{line:t.line-e.line,ch:t.line-e.line}}function W(e,t,n,i){for(var r,o=[],a=[],s=0;s<t.length;s++){var l=t[s];"insert"==n&&"insert"!=l.context||l.context&&l.context!=n||i.operator&&"action"==l.type||!(r=j(e,l.keys))||("partial"==r&&o.push(l),"full"==r&&a.push(l))}return{partial:o.length&&o,full:a.length&&a}}function j(e,t){if("<character>"==t.slice(-11)){var n=t.length-11,i=e.slice(0,n),r=t.slice(0,n);return i==r&&e.length>n?"full":0==r.indexOf(i)?"partial":!1}return e==t?"full":0==t.indexOf(e)?"partial":!1}function H(e){var t=/^.*(<[\w\-]+>)$/.exec(e),n=t?t[1]:e.slice(-1);if(n.length>1)switch(n){case"<CR>":n="\n";break;case"<Space>":n=" "}return n}function B(e,t,n){return function(){for(var i=0;n>i;i++)t(e)}}function U(e){return i(e.line,e.ch)}function z(e,t){return e.ch==t.ch&&e.line==t.line}function G(e,t){return e.line<t.line?!0:e.line==t.line&&e.ch<t.ch}function q(e,t){return arguments.length>2&&(t=q.apply(void 0,Array.prototype.slice.call(arguments,1))),G(e,t)?e:t}function Y(e,t){return arguments.length>2&&(t=Y.apply(void 0,Array.prototype.slice.call(arguments,1))),G(e,t)?t:e}function K(e,t,n){var i=G(e,t),r=G(t,n);return i&&r}function V(e,t){return e.getLine(t).length}function X(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function J(e){return e.replace(/([.?*+$\[\]\/\\(){}|\-])/g,"\\$1")}function Q(e,t,n){var r=V(e,t),o=new Array(n-r+1).join(" ");e.setCursor(i(t,r)),e.replaceRange(o,e.getCursor())}function Z(e,t){var n=[],r=e.listSelections(),o=U(e.clipPos(t)),a=!z(t,o),s=e.getCursor("head"),l=te(r,s),c=z(r[l].head,r[l].anchor),u=r.length-1,h=u-l>l?u:0,d=r[h].anchor,f=Math.min(d.line,o.line),p=Math.max(d.line,o.line),g=d.ch,m=o.ch,v=r[h].head.ch-g,y=m-g;v>0&&0>=y?(g++,a||m--):0>v&&y>=0?(g--,c||m++):0>v&&-1==y&&(g--,m++);for(var b=f;p>=b;b++){var w={anchor:new i(b,g),head:new i(b,m)};n.push(w)}return l=o.line==p?n.length-1:0,e.setSelections(n),t.ch=m,d.ch=g,d}function ee(e,t,n){for(var i=[],r=0;n>r;r++){var o=F(t,r,0);i.push({anchor:o,head:o})}e.setSelections(i,0)}function te(e,t,n){for(var i=0;i<e.length;i++){var r="head"!=n&&z(e[i].anchor,t),o="anchor"!=n&&z(e[i].head,t);if(r||o)return i}return-1}function ne(e,t){var n=t.lastSelection,r=function(){var t=e.listSelections(),n=t[0],i=t[t.length-1],r=G(n.anchor,n.head)?n.anchor:n.head,o=G(i.anchor,i.head)?i.head:i.anchor;return[r,o]},o=function(){var t=e.getCursor(),r=e.getCursor(),o=n.visualBlock;if(o){var a=o.width,s=o.height;r=i(t.line+s,t.ch+a);for(var l=[],c=t.line;c<r.line;c++){var u=i(c,t.ch),h=i(c,r.ch),d={anchor:u,head:h};l.push(d)}e.setSelections(l)}else{var f=n.anchorMark.find(),p=n.headMark.find(),g=p.line-f.line,m=p.ch-f.ch;r={line:r.line+g,ch:g?r.ch:m+r.ch},n.visualLine&&(t=i(t.line,0),r=i(r.line,V(e,r.line))),e.setSelection(t,r)}return[t,r]};return t.visualMode?r():o()}function ie(e,t){var n=t.sel.anchor,i=t.sel.head;t.lastPastedText&&(i=e.posFromIndex(e.indexFromPos(n)+t.lastPastedText.length),t.lastPastedText=null),t.lastSelection={anchorMark:e.setBookmark(n),headMark:e.setBookmark(i),anchor:U(n),head:U(i),visualMode:t.visualMode,visualLine:t.visualLine,visualBlock:t.visualBlock}}function re(e,t,n){var r,o=e.state.vim.sel,a=o.head,s=o.anchor;return G(n,t)&&(r=n,n=t,t=r),G(a,s)?(a=q(t,a),s=Y(s,n)):(s=q(t,s),a=Y(a,n),a=F(a,0,-1),-1==a.ch&&a.line!=e.firstLine()&&(a=i(a.line-1,V(e,a.line-1)))),[s,a]}function oe(e,t,n){var i=e.state.vim;t=t||i.sel;var n=n||i.visualLine?"line":i.visualBlock?"block":"char",r=ae(e,t,n);e.setSelections(r.ranges,r.primary),tt(e)}function ae(e,t,n,r){var o=U(t.head),a=U(t.anchor);if("char"==n){var s=r||G(t.head,t.anchor)?0:1,l=G(t.head,t.anchor)?1:0;return o=F(t.head,0,s),a=F(t.anchor,0,l),{ranges:[{anchor:a,head:o}],primary:0}}if("line"==n){if(G(t.head,t.anchor))o.ch=0,a.ch=V(e,a.line);else{a.ch=0;var c=e.lastLine();o.line>c&&(o.line=c),o.ch=V(e,o.line)}return{ranges:[{anchor:a,head:o}],primary:0}}if("block"==n){for(var u=Math.min(a.line,o.line),h=Math.min(a.ch,o.ch),d=Math.max(a.line,o.line),f=Math.max(a.ch,o.ch)+1,p=d-u+1,g=o.line==u?0:p-1,m=[],v=0;p>v;v++)m.push({anchor:i(u+v,h),head:i(u+v,f)});return{ranges:m,primary:g}}}function se(e){var t=e.getCursor("head");return 1==e.getSelection().length&&(t=q(t,e.getCursor("anchor"))),t}function le(t,n){var i=t.state.vim;n!==!1&&t.setCursor(O(t,i.sel.head)),ie(t,i),i.visualMode=!1,i.visualLine=!1,i.visualBlock=!1,e.signal(t,"vim-mode-change",{mode:"normal"}),i.fakeCursor&&i.fakeCursor.clear()}function ce(e,t,n){var i=e.getRange(t,n);if(/\n\s*$/.test(i)){var r=i.split("\n");r.pop();for(var o,o=r.pop();r.length>0&&o&&v(o);o=r.pop())n.line--,n.ch=0;o?(n.line--,n.ch=V(e,n.line)):n.ch=0}}function ue(e,t,n){t.ch=0,n.ch=0,n.line++}function he(e){if(!e)return 0;var t=e.search(/\S/);return-1==t?e.length:t}function de(e,t,n,r,o){for(var a=se(e),s=e.getLine(a.line),l=a.ch,c=o?ut[0]:ht[0];!c(s.charAt(l));)if(l++,l>=s.length)return null;r?c=ht[0]:(c=ut[0],c(s.charAt(l))||(c=ut[1]));for(var u=l,h=l;c(s.charAt(u))&&u<s.length;)u++;for(;c(s.charAt(h))&&h>=0;)h--;if(h++,t){for(var d=u;/\s/.test(s.charAt(u))&&u<s.length;)u++;if(d==u){for(var f=h;/\s/.test(s.charAt(h-1))&&h>0;)h--;h||(h=f)}}return{start:i(a.line,h),end:i(a.line,u)}}function fe(e,t,n){z(t,n)||wt.jumpList.add(e,t,n)}function pe(e,t){wt.lastCharacterSearch.increment=e,wt.lastCharacterSearch.forward=t.forward,wt.lastCharacterSearch.selectedCharacter=t.selectedCharacter}function ge(e,t,n,r){var o=U(e.getCursor()),a=n?1:-1,s=n?e.lineCount():-1,l=o.ch,c=o.line,u=e.getLine(c),h={lineText:u,nextCh:u.charAt(l),lastCh:null,index:l,symb:r,reverseSymb:(n?{")":"(","}":"{"}:{"(":")","{":"}"})[r],forward:n,depth:0,curMoveThrough:!1},d=Tt[r];if(!d)return o;var f=Lt[d].init,p=Lt[d].isComplete;for(f&&f(h);c!==s&&t;){if(h.index+=a,h.nextCh=h.lineText.charAt(h.index),!h.nextCh){if(c+=a,h.lineText=e.getLine(c)||"",a>0)h.index=0;else{var g=h.lineText.length;h.index=g>0?g-1:0}h.nextCh=h.lineText.charAt(h.index)}p(h)&&(o.line=c,o.ch=h.index,t--)}return h.nextCh||h.curMoveThrough?i(c,h.index):o}function me(e,t,n,i,r){var o=t.line,a=t.ch,s=e.getLine(o),l=n?1:-1,c=i?ht:ut;if(r&&""==s){if(o+=l,s=e.getLine(o),!d(e,o))return null;a=n?0:s.length}for(;;){if(r&&""==s)return{from:0,to:0,line:o};for(var u=l>0?s.length:-1,h=u,f=u;a!=u;){for(var p=!1,g=0;g<c.length&&!p;++g)if(c[g](s.charAt(a))){for(h=a;a!=u&&c[g](s.charAt(a));)a+=l;if(f=a,p=h!=f,h==t.ch&&o==t.line&&f==h+l)continue;return{from:Math.min(h,f+1),to:Math.max(h,f),line:o}}p||(a+=l)}if(o+=l,!d(e,o))return null;s=e.getLine(o),a=l>0?0:s.length}}function ve(e,t,n,r,o,a){var s=U(t),l=[];(r&&!o||!r&&o)&&n++;for(var c=!(r&&o),u=0;n>u;u++){var h=me(e,t,r,a,c);if(!h){var d=V(e,e.lastLine());l.push(r?{line:e.lastLine(),from:d,to:d}:{line:0,from:0,to:0});break}l.push(h),t=i(h.line,r?h.to-1:h.from)}var f=l.length!=n,p=l[0],g=l.pop();return r&&!o?(f||p.from==s.ch&&p.line==s.line||(g=l.pop()),i(g.line,g.from)):r&&o?i(g.line,g.to-1):!r&&o?(f||p.to==s.ch&&p.line==s.line||(g=l.pop()),i(g.line,g.to)):i(g.line,g.from)}function ye(e,t,n,r){for(var o,a=e.getCursor(),s=a.ch,l=0;t>l;l++){var c=e.getLine(a.line);if(o=Ce(s,c,r,n,!0),-1==o)return null;s=o}return i(e.getCursor().line,o)}function be(e,t){var n=e.getCursor().line;return O(e,i(n,t-1))}function we(e,t,n,i){y(n,gt)&&(t.marks[n]&&t.marks[n].clear(),t.marks[n]=e.setBookmark(i))}function Ce(e,t,n,i,r){var o;return i?(o=t.indexOf(n,e+1),-1==o||r||(o-=1)):(o=t.lastIndexOf(n,e-1),-1==o||r||(o+=1)),o}function xe(e,t,n,r,o){function a(t){return!e.getLine(t)}function s(e,t,n){return n?a(e)!=a(e+t):!a(e)&&a(e+t)}var l,c,u=t.line,h=e.firstLine(),d=e.lastLine(),f=u;if(r){for(;f>=h&&d>=f&&n>0;)s(f,r)&&n--,f+=r;return new i(f,0)}var p=e.state.vim;if(p.visualLine&&s(u,1,!0)){var g=p.sel.anchor;s(g.line,-1,!0)&&(o&&g.line==u||(u+=1))}var m=a(u);for(f=u;d>=f&&n;f++)s(f,1,!0)&&(o&&a(f)==m||n--);for(c=new i(f,0),f>d&&!m?m=!0:o=!1,f=u;f>h&&(o&&a(f)!=m&&f!=u||!s(f,-1,!0));f--);return l=new i(f,0),{start:l,end:c}}function ke(e,t,n,r){var o,a,s=t,l={"(":/[()]/,")":/[()]/,"[":/[[\]]/,"]":/[[\]]/,"{":/[{}]/,"}":/[{}]/}[n],c={"(":"(",")":"(","[":"[","]":"[","{":"{","}":"{"}[n],u=e.getLine(s.line).charAt(s.ch),h=u===c?1:0;if(o=e.scanForBracket(i(s.line,s.ch+h),-1,null,{bracketRegex:l}),a=e.scanForBracket(i(s.line,s.ch+h),1,null,{bracketRegex:l}),!o||!a)return{start:s,end:s};if(o=o.pos,a=a.pos,o.line==a.line&&o.ch>a.ch||o.line>a.line){var d=o;o=a,a=d}return r?a.ch+=1:o.ch+=1,{start:o,end:a}}function _e(e,t,n,r){var o,a,s,l,c=U(t),u=e.getLine(c.line),h=u.split(""),d=h.indexOf(n);if(c.ch<d?c.ch=d:d<c.ch&&h[c.ch]==n&&(a=c.ch,--c.ch),h[c.ch]!=n||a)for(s=c.ch;s>-1&&!o;s--)h[s]==n&&(o=s+1);else o=c.ch+1;if(o&&!a)for(s=o,l=h.length;l>s&&!a;s++)h[s]==n&&(a=s);return o&&a?(r&&(--o,++a),{start:i(c.line,o),end:i(c.line,a)}):{start:c,end:c}}function Ae(){}function Se(e){var t=e.state.vim;return t.searchState_||(t.searchState_=new Ae)}function Te(e,t,n,i,r){e.openDialog?e.openDialog(t,i,{bottom:!0,value:r.value,onKeyDown:r.onKeyDown,onKeyUp:r.onKeyUp,selectValueOnOpen:!1}):i(prompt(n,""))}function Le(e){var t=Ee(e)||[];if(!t.length)return[];var n=[];if(0===t[0]){for(var i=0;i<t.length;i++)"number"==typeof t[i]&&n.push(e.substring(t[i]+1,t[i+1]));return n}}function Ee(e){for(var t=!1,n=[],i=0;i<e.length;i++){var r=e.charAt(i);t||"/"!=r||n.push(i),t=!t&&"\\"==r}return n}function Me(e){for(var t="|(){",n="}",i=!1,r=[],o=-1;o<e.length;o++){var a=e.charAt(o)||"",s=e.charAt(o+1)||"",l=s&&-1!=t.indexOf(s);i?("\\"===a&&l||r.push(a),i=!1):"\\"===a?(i=!0,s&&-1!=n.indexOf(s)&&(l=!0),l&&"\\"!==s||r.push(a)):(r.push(a),l&&"\\"!==s&&r.push("\\"))}return r.join("")}function Pe(e){for(var t=!1,n=[],i=-1;i<e.length;i++){var r=e.charAt(i)||"",o=e.charAt(i+1)||"";Et[r+o]?(n.push(Et[r+o]),i++):t?(n.push(r),t=!1):"\\"===r?(t=!0,g(o)||"$"===o?n.push("$"):"/"!==o&&"\\"!==o&&n.push("\\")):("$"===r&&n.push("$"),n.push(r),"/"===o&&n.push("\\"))}return n.join("")}function Re(t){for(var n=new e.StringStream(t),i=[];!n.eol();){for(;n.peek()&&"\\"!=n.peek();)i.push(n.next());var r=!1;for(var o in Mt)if(n.match(o,!0)){r=!0,i.push(Mt[o]);break}r||i.push(n.next())}return i.join("")}function Ie(e,t,n){var i=wt.registerController.getRegister("/");if(i.setText(e),e instanceof RegExp)return e;var r,o,a=Ee(e);if(a.length){r=e.substring(0,a[0]);var s=e.substring(a[0]);o=-1!=s.indexOf("i")}else r=e;if(!r)return null;C("pcre")||(r=Me(r)),n&&(t=/^[^A-Z]*$/.test(r));var l=new RegExp(r,t||o?"i":void 0);return l}function $e(e,t){e.openNotification?e.openNotification('<span style="color: red">'+t+"</span>",{bottom:!0,duration:5e3}):alert(t)}function Oe(e,t){var n='<span style="font-family: monospace; white-space: pre">'+(e||"")+'<input type="text"></span>';return t&&(n+=' <span style="color: #888">'+t+"</span>"),n}function De(e,t){var n=(t.prefix||"")+" "+(t.desc||""),i=Oe(t.prefix,t.desc);Te(e,i,n,t.onClose,t)}function Fe(e,t){if(e instanceof RegExp&&t instanceof RegExp){for(var n=["global","multiline","ignoreCase","source"],i=0;i<n.length;i++){var r=n[i];if(e[r]!==t[r])return!1}return!0}return!1}function Ne(e,t,n,i){if(t){var r=Se(e),o=Ie(t,!!n,!!i);if(o)return je(e,o),Fe(o,r.getQuery())?o:(r.setQuery(o),o)}}function We(e){if("^"==e.source.charAt(0))var t=!0;return{token:function(n){if(t&&!n.sol())return void n.skipToEnd();var i=n.match(e,!1);if(i)return 0==i[0].length?(n.next(),"searching"):n.sol()||(n.backUp(1),e.exec(n.next()+i[0]))?(n.match(e),"searching"):(n.next(),null);for(;!n.eol()&&(n.next(),!n.match(e,!1)););},query:e}}function je(e,t){var n=Se(e),i=n.getOverlay();i&&t==i.query||(i&&e.removeOverlay(i),i=We(t),e.addOverlay(i),e.showMatchesOnScrollbar&&(n.getScrollbarAnnotate()&&n.getScrollbarAnnotate().clear(),n.setScrollbarAnnotate(e.showMatchesOnScrollbar(t))),n.setOverlay(i))}function He(e,t,n,r){return void 0===r&&(r=1),e.operation(function(){for(var o=e.getCursor(),a=e.getSearchCursor(n,o),s=0;r>s;s++){var l=a.find(t);if(0==s&&l&&z(a.from(),o)&&(l=a.find(t)),!l&&(a=e.getSearchCursor(n,t?i(e.lastLine()):i(e.firstLine(),0)),!a.find(t)))return}return a.from()})}function Be(e){var t=Se(e);e.removeOverlay(Se(e).getOverlay()),t.setOverlay(null),t.getScrollbarAnnotate()&&(t.getScrollbarAnnotate().clear(),t.setScrollbarAnnotate(null))}function Ue(e,t,n){return"number"!=typeof e&&(e=e.line),t instanceof Array?y(e,t):n?e>=t&&n>=e:e==t}function ze(e){var t=e.getScrollInfo(),n=6,i=10,r=e.coordsChar({left:0,top:n+t.top},"local"),o=t.clientHeight-i+t.top,a=e.coordsChar({left:0,top:o},"local");return{top:r.line,bottom:a.line}}function Ge(t,n,i,r,o,a,s,l,c){function u(){t.operation(function(){for(;!g;)h(),d();f()})}function h(){var e=t.getRange(a.from(),a.to()),n=e.replace(s,l);a.replace(n)}function d(){for(;a.findNext()&&Ue(a.from(),r,o);)if(i||!m||a.from().line!=m.line)return t.scrollIntoView(a.from(),30),t.setSelection(a.from(),a.to()),m=a.from(),void(g=!1);g=!0}function f(e){if(e&&e(),t.focus(),m){t.setCursor(m);var n=t.state.vim;n.exMode=!1,n.lastHPos=n.lastHSPos=m.ch}c&&c()}function p(n,i,r){e.e_stop(n);var o=e.keyName(n);switch(o){case"Y":h(),d();break;case"N":d();break;case"A":var a=c;c=void 0,t.operation(u),c=a;break;case"L":h();case"Q":case"Esc":case"Ctrl-C":case"Ctrl-[":f(r)}return g&&f(r),!0}t.state.vim.exMode=!0;var g=!1,m=a.from();return d(),g?void $e(t,"No matches for "+s.source):n?void De(t,{prefix:"replace with <strong>"+l+"</strong> (y/n/a/q/l)",onKeyDown:p}):(u(),void(c&&c()))}function qe(t){var n=t.state.vim,i=wt.macroModeState,r=wt.registerController.getRegister("."),o=i.isPlaying,a=i.lastInsertModeChanges,s=[];if(!o){for(var l=a.inVisualBlock?n.lastSelection.visualBlock.height:1,c=a.changes,s=[],u=0;u<c.length;)s.push(c[u]),c[u]instanceof it?u++:u+=l;a.changes=s,t.off("change",Ze),e.off(t.getInputField(),"keydown",rt)}!o&&n.insertModeRepeat>1&&(ot(t,n,n.insertModeRepeat-1,!0),n.lastEditInputState.repeatOverride=n.insertModeRepeat),delete n.insertModeRepeat,n.insertMode=!1,t.setCursor(t.getCursor().line,t.getCursor().ch-1),t.setOption("keyMap","vim"),t.setOption("disableInput",!0),t.toggleOverwrite(!1),r.setText(a.changes.join("")),e.signal(t,"vim-mode-change",{mode:"normal"}),i.isRecording&&Je(i)}function Ye(e){t.unshift(e)}function Ke(e,t,n,i,r){var o={keys:e,type:t};o[t]=n,o[t+"Args"]=i;for(var a in r)o[a]=r[a];Ye(o)}function Ve(t,n,i,r){var o=wt.registerController.getRegister(r);if(":"==r)return o.keyBuffer[0]&&$t.processCommand(t,o.keyBuffer[0]),void(i.isPlaying=!1);var a=o.keyBuffer,s=0;i.isPlaying=!0,i.replaySearchQueries=o.searchQueries.slice(0);for(var l=0;l<a.length;l++)for(var c,u,h=a[l];h;)if(c=/<\w+-.+?>|<\w+>|./.exec(h),u=c[0],h=h.substring(c.index+u.length),e.Vim.handleKey(t,u,"macro"),n.insertMode){var d=o.insertModeChanges[s++].changes;wt.macroModeState.lastInsertModeChanges.changes=d,at(t,d,1),qe(t)}i.isPlaying=!1}function Xe(e,t){if(!e.isPlaying){var n=e.latestRegister,i=wt.registerController.getRegister(n);i&&i.pushText(t)}}function Je(e){if(!e.isPlaying){var t=e.latestRegister,n=wt.registerController.getRegister(t);n&&n.pushInsertModeChanges&&n.pushInsertModeChanges(e.lastInsertModeChanges)}}function Qe(e,t){if(!e.isPlaying){var n=e.latestRegister,i=wt.registerController.getRegister(n);i&&i.pushSearchQuery&&i.pushSearchQuery(t)}}function Ze(e,t){var n=wt.macroModeState,i=n.lastInsertModeChanges;
if(!n.isPlaying)for(;t;){if(i.expectCursorActivityForChange=!0,"+input"==t.origin||"paste"==t.origin||void 0===t.origin){var r=t.text.join("\n");i.maybeReset&&(i.changes=[],i.maybeReset=!1),i.changes.push(r)}t=t.next}}function et(e){var t=e.state.vim;if(t.insertMode){var n=wt.macroModeState;if(n.isPlaying)return;var i=n.lastInsertModeChanges;i.expectCursorActivityForChange?i.expectCursorActivityForChange=!1:i.maybeReset=!0}else e.curOp.isVimOp||nt(e,t);t.visualMode&&tt(e)}function tt(e){var t=e.state.vim,n=O(e,U(t.sel.head)),i=F(n,0,1);t.fakeCursor&&t.fakeCursor.clear(),t.fakeCursor=e.markText(n,i,{className:"cm-animate-fat-cursor"})}function nt(t,n){var i=t.getCursor("anchor"),r=t.getCursor("head");if(n.visualMode&&!t.somethingSelected()?le(t,!1):n.visualMode||n.insertMode||!t.somethingSelected()||(n.visualMode=!0,n.visualLine=!1,e.signal(t,"vim-mode-change",{mode:"visual"})),n.visualMode){var o=G(r,i)?0:-1,a=G(r,i)?-1:0;r=F(r,0,o),i=F(i,0,a),n.sel={anchor:i,head:r},we(t,n,"<",q(r,i)),we(t,n,">",Y(r,i))}else n.insertMode||(n.lastHPos=t.getCursor().ch)}function it(e){this.keyName=e}function rt(t){function n(){return r.maybeReset&&(r.changes=[],r.maybeReset=!1),r.changes.push(new it(o)),!0}var i=wt.macroModeState,r=i.lastInsertModeChanges,o=e.keyName(t);o&&(-1==o.indexOf("Delete")&&-1==o.indexOf("Backspace")||e.lookupKey(o,"vim-insert",n))}function ot(e,t,n,i){function r(){s?kt.processAction(e,t,t.lastEditActionCommand):kt.evalInput(e,t)}function o(n){if(a.lastInsertModeChanges.changes.length>0){n=t.lastEditActionCommand?n:1;var i=a.lastInsertModeChanges;at(e,i.changes,n)}}var a=wt.macroModeState;a.isPlaying=!0;var s=!!t.lastEditActionCommand,l=t.inputState;if(t.inputState=t.lastEditInputState,s&&t.lastEditActionCommand.interlaceInsertRepeat)for(var c=0;n>c;c++)r(),o(1);else i||r(),o(n);t.inputState=l,t.insertMode&&!i&&qe(e),a.isPlaying=!1}function at(t,n,i){function r(n){return"string"==typeof n?e.commands[n](t):n(t),!0}var o=t.getCursor("head"),a=wt.macroModeState.lastInsertModeChanges.inVisualBlock;if(a){var s=t.state.vim,l=s.lastSelection,c=N(l.anchor,l.head);ee(t,o,c.line+1),i=t.listSelections().length,t.setCursor(o)}for(var u=0;i>u;u++){a&&t.setCursor(F(o,u,0));for(var h=0;h<n.length;h++){var d=n[h];if(d instanceof it)e.lookupKey(d.keyName,"vim-insert",r);else{var f=t.getCursor();t.replaceRange(d,f,f)}}}a&&t.setCursor(F(o,0,1))}e.defineOption("vimMode",!1,function(t,n,i){n&&"vim"!=t.getOption("keyMap")?t.setOption("keyMap","vim"):!n&&i!=e.Init&&/^vim/.test(t.getOption("keyMap"))&&t.setOption("keyMap","default")});var st={Shift:"S",Ctrl:"C",Alt:"A",Cmd:"D",Mod:"A"},lt={Enter:"CR",Backspace:"BS",Delete:"Del",Insert:"Ins"},ct=/[\d]/,ut=[e.isWordChar,function(t){return t&&!e.isWordChar(t)&&!/\s/.test(t)}],ht=[function(e){return/\S/.test(e)}],dt=h(65,26),ft=h(97,26),pt=h(48,10),gt=[].concat(dt,ft,pt,["<",">"]),mt=[].concat(dt,ft,pt,["-",'"',".",":","/"]),vt={};b("filetype",void 0,"string",["ft"],function(e,t){if(void 0!==t){if(void 0===e){var n=t.getOption("mode");return"null"==n?"":n}var n=""==e?"null":e;t.setOption("mode",n)}});var yt=function(){function e(e,t,s){function l(t){var r=++i%n,o=a[r];o&&o.clear(),a[r]=e.setBookmark(t)}var c=i%n,u=a[c];if(u){var h=u.find();h&&!z(h,t)&&l(t)}else l(t);l(s),r=i,o=i-n+1,0>o&&(o=0)}function t(e,t){i+=t,i>r?i=r:o>i&&(i=o);var s=a[(n+i)%n];if(s&&!s.find()){var l,c=t>0?1:-1,u=e.getCursor();do if(i+=c,s=a[(n+i)%n],s&&(l=s.find())&&!z(u,l))break;while(r>i&&i>o)}return s}var n=100,i=-1,r=0,o=0,a=new Array(n);return{cachedCursor:void 0,add:e,move:t}},bt=function(e){return e?{changes:e.changes,expectCursorActivityForChange:e.expectCursorActivityForChange}:{changes:[],expectCursorActivityForChange:!1}};x.prototype={exitMacroRecordMode:function(){var e=wt.macroModeState;e.onRecordingDone&&e.onRecordingDone(),e.onRecordingDone=void 0,e.isRecording=!1},enterMacroRecordMode:function(e,t){var n=wt.registerController.getRegister(t);n&&(n.clear(),this.latestRegister=t,e.openDialog&&(this.onRecordingDone=e.openDialog("(recording)["+t+"]",null,{bottom:!0})),this.isRecording=!0)}};var wt,Ct,xt={buildKeyMap:function(){},getRegisterController:function(){return wt.registerController},resetVimGlobalState_:_,getVimGlobalState_:function(){return wt},maybeInitVimState_:k,suppressErrorLogging:!1,InsertModeKey:it,map:function(e,t,n){$t.map(e,t,n)},unmap:function(e,t){$t.unmap(e,t)},setOption:w,getOption:C,defineOption:b,defineEx:function(e,t,n){if(t){if(0!==e.indexOf(t))throw new Error('(Vim.defineEx) "'+t+'" is not a prefix of "'+e+'", command not registered')}else t=e;It[e]=n,$t.commandMap_[t]={name:e,shortName:t,type:"api"}},handleKey:function(e,t,n){var i=this.findKey(e,t,n);return"function"==typeof i?i():void 0},findKey:function(n,i,r){function o(){var e=wt.macroModeState;if(e.isRecording){if("q"==i)return e.exitMacroRecordMode(),S(n),!0;"mapping"!=r&&Xe(e,i)}}function a(){return"<Esc>"==i?(S(n),h.visualMode?le(n):h.insertMode&&qe(n),!0):void 0}function s(t){for(var r;t;)r=/<\w+-.+?>|<\w+>|./.exec(t),i=r[0],t=t.substring(r.index+i.length),e.Vim.handleKey(n,i,"mapping")}function l(){if(a())return!0;for(var e=h.inputState.keyBuffer=h.inputState.keyBuffer+i,r=1==i.length,o=kt.matchCommand(e,t,h.inputState,"insert");e.length>1&&"full"!=o.type;){var e=h.inputState.keyBuffer=e.slice(1),s=kt.matchCommand(e,t,h.inputState,"insert");"none"!=s.type&&(o=s)}if("none"==o.type)return S(n),!1;if("partial"==o.type)return Ct&&window.clearTimeout(Ct),Ct=window.setTimeout(function(){h.insertMode&&h.inputState.keyBuffer&&S(n)},C("insertModeEscKeysTimeout")),!r;if(Ct&&window.clearTimeout(Ct),r){for(var l=n.listSelections(),c=0;c<l.length;c++){var u=l[c].head;n.replaceRange("",F(u,0,-(e.length-1)),u,"+input")}wt.macroModeState.lastInsertModeChanges.changes.pop()}return S(n),o.command}function c(){if(o()||a())return!0;var e=h.inputState.keyBuffer=h.inputState.keyBuffer+i;if(/^[1-9]\d*$/.test(e))return!0;var r=/^(\d*)(.*)$/.exec(e);if(!r)return S(n),!1;var s=h.visualMode?"visual":"normal",l=kt.matchCommand(r[2]||r[1],t,h.inputState,s);if("none"==l.type)return S(n),!1;if("partial"==l.type)return!0;h.inputState.keyBuffer="";var r=/^(\d*)(.*)$/.exec(e);return r[1]&&"0"!=r[1]&&h.inputState.pushRepeatDigit(r[1]),l.command}var u,h=k(n);return u=h.insertMode?l():c(),u===!1?void 0:u===!0?function(){return!0}:function(){return n.operation(function(){n.curOp.isVimOp=!0;try{"keyToKey"==u.type?s(u.toKeys):kt.processCommand(n,h,u)}catch(t){throw n.state.vim=void 0,k(n),e.Vim.suppressErrorLogging||console.log(t),t}return!0})}},handleEx:function(e,t){$t.processCommand(e,t)},defineMotion:P,defineAction:$,defineOperator:I,mapCommand:Ke,_mapCommand:Ye,defineRegister:L,exitVisualMode:le,exitInsertMode:qe};A.prototype.pushRepeatDigit=function(e){this.operator?this.motionRepeat=this.motionRepeat.concat(e):this.prefixRepeat=this.prefixRepeat.concat(e)},A.prototype.getRepeat=function(){var e=0;return(this.prefixRepeat.length>0||this.motionRepeat.length>0)&&(e=1,this.prefixRepeat.length>0&&(e*=parseInt(this.prefixRepeat.join(""),10)),this.motionRepeat.length>0&&(e*=parseInt(this.motionRepeat.join(""),10))),e},T.prototype={setText:function(e,t,n){this.keyBuffer=[e||""],this.linewise=!!t,this.blockwise=!!n},pushText:function(e,t){t&&(this.linewise||this.keyBuffer.push("\n"),this.linewise=!0),this.keyBuffer.push(e)},pushInsertModeChanges:function(e){this.insertModeChanges.push(bt(e))},pushSearchQuery:function(e){this.searchQueries.push(e)},clear:function(){this.keyBuffer=[],this.insertModeChanges=[],this.searchQueries=[],this.linewise=!1},toString:function(){return this.keyBuffer.join("")}},E.prototype={pushText:function(e,t,n,i,r){i&&"\n"==n.charAt(0)&&(n=n.slice(1)+"\n"),i&&"\n"!==n.charAt(n.length-1)&&(n+="\n");var o=this.isValidRegister(e)?this.getRegister(e):null;if(!o){switch(t){case"yank":this.registers[0]=new T(n,i,r);break;case"delete":case"change":-1==n.indexOf("\n")?this.registers["-"]=new T(n,i):(this.shiftNumericRegisters_(),this.registers[1]=new T(n,i))}return void this.unnamedRegister.setText(n,i,r)}var a=m(e);a?o.pushText(n,i):o.setText(n,i,r),this.unnamedRegister.setText(o.toString(),i)},getRegister:function(e){return this.isValidRegister(e)?(e=e.toLowerCase(),this.registers[e]||(this.registers[e]=new T),this.registers[e]):this.unnamedRegister},isValidRegister:function(e){return e&&y(e,mt)},shiftNumericRegisters_:function(){for(var e=9;e>=2;e--)this.registers[e]=this.getRegister(""+(e-1))}},M.prototype={nextMatch:function(e,t){var n=this.historyBuffer,i=t?-1:1;null===this.initialPrefix&&(this.initialPrefix=e);for(var r=this.iterator+i;t?r>=0:r<n.length;r+=i)for(var o=n[r],a=0;a<=o.length;a++)if(this.initialPrefix==o.substring(0,a))return this.iterator=r,o;return r>=n.length?(this.iterator=n.length,this.initialPrefix):0>r?e:void 0},pushInput:function(e){var t=this.historyBuffer.indexOf(e);t>-1&&this.historyBuffer.splice(t,1),e.length&&this.historyBuffer.push(e)},reset:function(){this.initialPrefix=null,this.iterator=this.historyBuffer.length}};var kt={matchCommand:function(e,t,n,i){var r=W(e,t,i,n);if(!r.full&&!r.partial)return{type:"none"};if(!r.full&&r.partial)return{type:"partial"};for(var o,a=0;a<r.full.length;a++){var s=r.full[a];o||(o=s)}return"<character>"==o.keys.slice(-11)&&(n.selectedCharacter=H(e)),{type:"full",command:o}},processCommand:function(e,t,n){switch(t.inputState.repeatOverride=n.repeatOverride,n.type){case"motion":this.processMotion(e,t,n);break;case"operator":this.processOperator(e,t,n);break;case"operatorMotion":this.processOperatorMotion(e,t,n);break;case"action":this.processAction(e,t,n);break;case"search":this.processSearch(e,t,n);break;case"ex":case"keyToEx":this.processEx(e,t,n)}},processMotion:function(e,t,n){t.inputState.motion=n.motion,t.inputState.motionArgs=D(n.motionArgs),this.evalInput(e,t)},processOperator:function(e,t,n){var i=t.inputState;if(i.operator){if(i.operator==n.operator)return i.motion="expandToLine",i.motionArgs={linewise:!0},void this.evalInput(e,t);S(e)}i.operator=n.operator,i.operatorArgs=D(n.operatorArgs),t.visualMode&&this.evalInput(e,t)},processOperatorMotion:function(e,t,n){var i=t.visualMode,r=D(n.operatorMotionArgs);r&&i&&r.visualLine&&(t.visualLine=!0),this.processOperator(e,t,n),i||this.processMotion(e,t,n)},processAction:function(e,t,n){var i=t.inputState,r=i.getRepeat(),o=!!r,a=D(n.actionArgs)||{};i.selectedCharacter&&(a.selectedCharacter=i.selectedCharacter),n.operator&&this.processOperator(e,t,n),n.motion&&this.processMotion(e,t,n),(n.motion||n.operator)&&this.evalInput(e,t),a.repeat=r||1,a.repeatIsExplicit=o,a.registerName=i.registerName,S(e),t.lastMotion=null,n.isEdit&&this.recordLastEdit(t,i,n),St[n.action](e,a,t)},processSearch:function(t,n,i){function r(e,r,o){wt.searchHistoryController.pushInput(e),wt.searchHistoryController.reset();try{Ne(t,e,r,o)}catch(a){return $e(t,"Invalid regex: "+e),void S(t)}kt.processMotion(t,n,{type:"motion",motion:"findNext",motionArgs:{forward:!0,toJumplist:i.searchArgs.toJumplist}})}function o(e){t.scrollTo(d.left,d.top),r(e,!0,!0);var n=wt.macroModeState;n.isRecording&&Qe(n,e)}function a(n,i,r){var o,a=e.keyName(n);"Up"==a||"Down"==a?(o="Up"==a,i=wt.searchHistoryController.nextMatch(i,o)||"",r(i)):"Left"!=a&&"Right"!=a&&"Ctrl"!=a&&"Alt"!=a&&"Shift"!=a&&wt.searchHistoryController.reset();var s;try{s=Ne(t,i,!0,!0)}catch(n){}s?t.scrollIntoView(He(t,!l,s),30):(Be(t),t.scrollTo(d.left,d.top))}function s(n,i,r){var o=e.keyName(n);"Esc"==o||"Ctrl-C"==o||"Ctrl-["==o||"Backspace"==o&&""==i?(wt.searchHistoryController.pushInput(i),wt.searchHistoryController.reset(),Ne(t,h),Be(t),t.scrollTo(d.left,d.top),e.e_stop(n),S(t),r(),t.focus()):"Ctrl-U"==o&&(e.e_stop(n),r(""))}if(t.getSearchCursor){var l=i.searchArgs.forward,c=i.searchArgs.wholeWordOnly;Se(t).setReversed(!l);var u=l?"/":"?",h=Se(t).getQuery(),d=t.getScrollInfo();switch(i.searchArgs.querySrc){case"prompt":var f=wt.macroModeState;if(f.isPlaying){var p=f.replaySearchQueries.shift();r(p,!0,!1)}else De(t,{onClose:o,prefix:u,desc:Pt,onKeyUp:a,onKeyDown:s});break;case"wordUnderCursor":var g=de(t,!1,!0,!1,!0),m=!0;if(g||(g=de(t,!1,!0,!1,!1),m=!1),!g)return;var p=t.getLine(g.start.line).substring(g.start.ch,g.end.ch);p=m&&c?"\\b"+p+"\\b":J(p),wt.jumpList.cachedCursor=t.getCursor(),t.setCursor(g.start),r(p,!0,!1)}}},processEx:function(t,n,i){function r(e){wt.exCommandHistoryController.pushInput(e),wt.exCommandHistoryController.reset(),$t.processCommand(t,e)}function o(n,i,r){var o,a=e.keyName(n);("Esc"==a||"Ctrl-C"==a||"Ctrl-["==a||"Backspace"==a&&""==i)&&(wt.exCommandHistoryController.pushInput(i),wt.exCommandHistoryController.reset(),e.e_stop(n),S(t),r(),t.focus()),"Up"==a||"Down"==a?(o="Up"==a,i=wt.exCommandHistoryController.nextMatch(i,o)||"",r(i)):"Ctrl-U"==a?(e.e_stop(n),r("")):"Left"!=a&&"Right"!=a&&"Ctrl"!=a&&"Alt"!=a&&"Shift"!=a&&wt.exCommandHistoryController.reset()}"keyToEx"==i.type?$t.processCommand(t,i.exArgs.input):n.visualMode?De(t,{onClose:r,prefix:":",value:"'<,'>",onKeyDown:o}):De(t,{onClose:r,prefix:":",onKeyDown:o})},evalInput:function(e,t){var n,r,o,a=t.inputState,s=a.motion,l=a.motionArgs||{},c=a.operator,u=a.operatorArgs||{},h=a.registerName,d=t.sel,f=U(t.visualMode?O(e,d.head):e.getCursor("head")),p=U(t.visualMode?O(e,d.anchor):e.getCursor("anchor")),g=U(f),m=U(p);if(c&&this.recordLastEdit(t,a),o=void 0!==a.repeatOverride?a.repeatOverride:a.getRepeat(),o>0&&l.explicitRepeat?l.repeatIsExplicit=!0:(l.noRepeat||!l.explicitRepeat&&0===o)&&(o=1,l.repeatIsExplicit=!1),a.selectedCharacter&&(l.selectedCharacter=u.selectedCharacter=a.selectedCharacter),l.repeat=o,S(e),s){var v=_t[s](e,f,l,t);if(t.lastMotion=_t[s],!v)return;if(l.toJumplist){var y=wt.jumpList,b=y.cachedCursor;b?(fe(e,b,v),delete y.cachedCursor):fe(e,f,v)}v instanceof Array?(r=v[0],n=v[1]):n=v,n||(n=U(f)),t.visualMode?(t.visualBlock&&n.ch===1/0||(n=O(e,n,t.visualBlock)),r&&(r=O(e,r,!0)),r=r||m,d.anchor=r,d.head=n,oe(e),we(e,t,"<",G(r,n)?r:n),we(e,t,">",G(r,n)?n:r)):c||(n=O(e,n),e.setCursor(n.line,n.ch))}if(c){if(u.lastSel){r=m;var w=u.lastSel,C=Math.abs(w.head.line-w.anchor.line),x=Math.abs(w.head.ch-w.anchor.ch);n=w.visualLine?i(m.line+C,m.ch):w.visualBlock?i(m.line+C,m.ch+x):w.head.line==w.anchor.line?i(m.line,m.ch+x):i(m.line+C,m.ch),t.visualMode=!0,t.visualLine=w.visualLine,t.visualBlock=w.visualBlock,d=t.sel={anchor:r,head:n},oe(e)}else t.visualMode&&(u.lastSel={anchor:U(d.anchor),head:U(d.head),visualBlock:t.visualBlock,visualLine:t.visualLine});var k,_,A,T,L;if(t.visualMode){if(k=q(d.head,d.anchor),_=Y(d.head,d.anchor),A=t.visualLine||u.linewise,T=t.visualBlock?"block":A?"line":"char",L=ae(e,{anchor:k,head:_},T),A){var E=L.ranges;if("block"==T)for(var M=0;M<E.length;M++)E[M].head.ch=V(e,E[M].head.line);else"line"==T&&(E[0].head=i(E[0].head.line+1,0))}}else{if(k=U(r||m),_=U(n||g),G(_,k)){var P=k;k=_,_=P}A=l.linewise||u.linewise,A?ue(e,k,_):l.forward&&ce(e,k,_),T="char";var R=!l.inclusive||A;L=ae(e,{anchor:k,head:_},T,R)}e.setSelections(L.ranges,L.primary),t.lastMotion=null,u.repeat=o,u.registerName=h,u.linewise=A;var I=At[c](e,u,L.ranges,m,n);t.visualMode&&le(e,null!=I),I&&e.setCursor(I)}},recordLastEdit:function(e,t,n){var i=wt.macroModeState;i.isPlaying||(e.lastEditInputState=t,e.lastEditActionCommand=n,i.lastInsertModeChanges.changes=[],i.lastInsertModeChanges.expectCursorActivityForChange=!1)}},_t={moveToTopLine:function(e,t,n){var r=ze(e).top+n.repeat-1;return i(r,he(e.getLine(r)))},moveToMiddleLine:function(e){var t=ze(e),n=Math.floor(.5*(t.top+t.bottom));return i(n,he(e.getLine(n)))},moveToBottomLine:function(e,t,n){var r=ze(e).bottom-n.repeat+1;return i(r,he(e.getLine(r)))},expandToLine:function(e,t,n){var r=t;return i(r.line+n.repeat-1,1/0)},findNext:function(e,t,n){var i=Se(e),r=i.getQuery();if(r){var o=!n.forward;return o=i.isReversed()?!o:o,je(e,r),He(e,o,r,n.repeat)}},goToMark:function(e,t,n,i){var r=i.marks[n.selectedCharacter];if(r){var o=r.find();return n.linewise?{line:o.line,ch:he(e.getLine(o.line))}:o}return null},moveToOtherHighlightedEnd:function(e,t,n,r){if(r.visualBlock&&n.sameLine){var o=r.sel;return[O(e,i(o.anchor.line,o.head.ch)),O(e,i(o.head.line,o.anchor.ch))]}return[r.sel.head,r.sel.anchor]},jumpToMark:function(e,t,n,r){for(var o=t,a=0;a<n.repeat;a++){var s=o;for(var l in r.marks)if(f(l)){var c=r.marks[l].find(),u=n.forward?G(c,s):G(s,c);if(!(u||n.linewise&&c.line==s.line)){var h=z(s,o),d=n.forward?K(s,c,o):K(o,c,s);(h||d)&&(o=c)}}}return n.linewise&&(o=i(o.line,he(e.getLine(o.line)))),o},moveByCharacters:function(e,t,n){var r=t,o=n.repeat,a=n.forward?r.ch+o:r.ch-o;return i(r.line,a)},moveByLines:function(e,t,n,r){var o=t,a=o.ch;switch(r.lastMotion){case this.moveByLines:case this.moveByDisplayLines:case this.moveByScroll:case this.moveToColumn:case this.moveToEol:a=r.lastHPos;break;default:r.lastHPos=a}var s=n.repeat+(n.repeatOffset||0),l=n.forward?o.line+s:o.line-s,c=e.firstLine(),u=e.lastLine();return c>l&&o.line==c?this.moveToStartOfLine(e,t,n,r):l>u&&o.line==u?this.moveToEol(e,t,n,r):(n.toFirstChar&&(a=he(e.getLine(l)),r.lastHPos=a),r.lastHSPos=e.charCoords(i(l,a),"div").left,i(l,a))},moveByDisplayLines:function(e,t,n,r){var o=t;switch(r.lastMotion){case this.moveByDisplayLines:case this.moveByScroll:case this.moveByLines:case this.moveToColumn:case this.moveToEol:break;default:r.lastHSPos=e.charCoords(o,"div").left}var a=n.repeat,s=e.findPosV(o,n.forward?a:-a,"line",r.lastHSPos);if(s.hitSide)if(n.forward)var l=e.charCoords(s,"div"),c={top:l.top+8,left:r.lastHSPos},s=e.coordsChar(c,"div");else{var u=e.charCoords(i(e.firstLine(),0),"div");u.left=r.lastHSPos,s=e.coordsChar(u,"div")}return r.lastHPos=s.ch,s},moveByPage:function(e,t,n){var i=t,r=n.repeat;return e.findPosV(i,n.forward?r:-r,"page")},moveByParagraph:function(e,t,n){var i=n.forward?1:-1;return xe(e,t,n.repeat,i)},moveByScroll:function(e,t,n,i){var r=e.getScrollInfo(),o=null,a=n.repeat;a||(a=r.clientHeight/(2*e.defaultTextHeight()));var s=e.charCoords(t,"local");n.repeat=a;var o=_t.moveByDisplayLines(e,t,n,i);if(!o)return null;var l=e.charCoords(o,"local");return e.scrollTo(null,r.top+l.top-s.top),o},moveByWords:function(e,t,n){return ve(e,t,n.repeat,!!n.forward,!!n.wordEnd,!!n.bigWord)},moveTillCharacter:function(e,t,n){var i=n.repeat,r=ye(e,i,n.forward,n.selectedCharacter),o=n.forward?-1:1;return pe(o,n),r?(r.ch+=o,r):null},moveToCharacter:function(e,t,n){var i=n.repeat;return pe(0,n),ye(e,i,n.forward,n.selectedCharacter)||t},moveToSymbol:function(e,t,n){var i=n.repeat;return ge(e,i,n.forward,n.selectedCharacter)||t},moveToColumn:function(e,t,n,i){var r=n.repeat;return i.lastHPos=r-1,i.lastHSPos=e.charCoords(t,"div").left,be(e,r)},moveToEol:function(e,t,n,r){var o=t;r.lastHPos=1/0;var a=i(o.line+n.repeat-1,1/0),s=e.clipPos(a);return s.ch--,r.lastHSPos=e.charCoords(s,"div").left,a},moveToFirstNonWhiteSpaceCharacter:function(e,t){var n=t;return i(n.line,he(e.getLine(n.line)))},moveToMatchedSymbol:function(e,t){var n,r=t,o=r.line,a=r.ch,s=e.getLine(o);do if(n=s.charAt(a++),n&&p(n)){var l=e.getTokenTypeAt(i(o,a));if("string"!==l&&"comment"!==l)break}while(n);if(n){var c=e.findMatchingBracket(i(o,a));return c.to}return r},moveToStartOfLine:function(e,t){return i(t.line,0)},moveToLineOrEdgeOfDocument:function(e,t,n){var r=n.forward?e.lastLine():e.firstLine();return n.repeatIsExplicit&&(r=n.repeat-e.getOption("firstLineNumber")),i(r,he(e.getLine(r)))},textObjectManipulation:function(e,t,n,i){var r={"(":")",")":"(","{":"}","}":"{","[":"]","]":"["},o={"'":!0,'"':!0},a=n.selectedCharacter;"b"==a?a="(":"B"==a&&(a="{");var s,l=!n.textObjectInner;if(r[a])s=ke(e,t,a,l);else if(o[a])s=_e(e,t,a,l);else if("W"===a)s=de(e,l,!0,!0);else if("w"===a)s=de(e,l,!0,!1);else{if("p"!==a)return null;if(s=xe(e,t,n.repeat,0,l),n.linewise=!0,i.visualMode)i.visualLine||(i.visualLine=!0);else{var c=i.inputState.operatorArgs;c&&(c.linewise=!0),s.end.line--}}return e.state.vim.visualMode?re(e,s.start,s.end):[s.start,s.end]},repeatLastCharacterSearch:function(e,t,n){var i=wt.lastCharacterSearch,r=n.repeat,o=n.forward===i.forward,a=(i.increment?1:0)*(o?-1:1);e.moveH(-a,"char"),n.inclusive=!!o;var s=ye(e,r,o,i.selectedCharacter);return s?(s.ch+=a,s):(e.moveH(a,"char"),t)}},At={change:function(t,n,r){var o,a,s=t.state.vim;if(wt.macroModeState.lastInsertModeChanges.inVisualBlock=s.visualBlock,s.visualMode){a=t.getSelection();var l=R("",r.length);t.replaceSelections(l),o=q(r[0].head,r[0].anchor)}else{var c=r[0].anchor,u=r[0].head;a=t.getRange(c,u);var h=s.lastEditInputState||{};if("moveByWords"==h.motion&&!v(a)){var d=/\s+$/.exec(a);d&&h.motionArgs&&h.motionArgs.forward&&(u=F(u,0,-d[0].length),a=a.slice(0,-d[0].length))}var f=new i(c.line-1,Number.MAX_VALUE),p=t.firstLine()==t.lastLine();u.line>t.lastLine()&&n.linewise&&!p?t.replaceRange("",f,u):t.replaceRange("",c,u),n.linewise&&(p||(t.setCursor(f),e.commands.newlineAndIndent(t)),c.ch=Number.MAX_VALUE),o=c}wt.registerController.pushText(n.registerName,"change",a,n.linewise,r.length>1),St.enterInsertMode(t,{head:o},t.state.vim)},"delete":function(e,t,n){var r,o,a=e.state.vim;if(a.visualBlock){o=e.getSelection();var s=R("",n.length);e.replaceSelections(s),r=n[0].anchor}else{var l=n[0].anchor,c=n[0].head;t.linewise&&c.line!=e.firstLine()&&l.line==e.lastLine()&&l.line==c.line-1&&(l.line==e.firstLine()?l.ch=0:l=i(l.line-1,V(e,l.line-1))),o=e.getRange(l,c),e.replaceRange("",l,c),r=l,t.linewise&&(r=_t.moveToFirstNonWhiteSpaceCharacter(e,l))}return wt.registerController.pushText(t.registerName,"delete",o,t.linewise,a.visualBlock),O(e,r)},indent:function(e,t,n){var i=e.state.vim,r=n[0].anchor.line,o=i.visualBlock?n[n.length-1].anchor.line:n[0].head.line,a=i.visualMode?t.repeat:1;t.linewise&&o--;for(var s=r;o>=s;s++)for(var l=0;a>l;l++)e.indentLine(s,t.indentRight);return _t.moveToFirstNonWhiteSpaceCharacter(e,n[0].anchor)},changeCase:function(e,t,n,i,r){for(var o=e.getSelections(),a=[],s=t.toLower,l=0;l<o.length;l++){var c=o[l],u="";if(s===!0)u=c.toLowerCase();else if(s===!1)u=c.toUpperCase();else for(var h=0;h<c.length;h++){var d=c.charAt(h);u+=m(d)?d.toLowerCase():d.toUpperCase()}a.push(u)}return e.replaceSelections(a),t.shouldMoveCursor?r:!e.state.vim.visualMode&&t.linewise&&n[0].anchor.line+1==n[0].head.line?_t.moveToFirstNonWhiteSpaceCharacter(e,i):t.linewise?i:q(n[0].anchor,n[0].head)},yank:function(e,t,n,i){var r=e.state.vim,o=e.getSelection(),a=r.visualMode?q(r.sel.anchor,r.sel.head,n[0].head,n[0].anchor):i;return wt.registerController.pushText(t.registerName,"yank",o,t.linewise,r.visualBlock),a}},St={jumpListWalk:function(e,t,n){if(!n.visualMode){var i=t.repeat,r=t.forward,o=wt.jumpList,a=o.move(e,r?i:-i),s=a?a.find():void 0;s=s?s:e.getCursor(),e.setCursor(s)}},scroll:function(e,t,n){if(!n.visualMode){var i=t.repeat||1,r=e.defaultTextHeight(),o=e.getScrollInfo().top,a=r*i,s=t.forward?o+a:o-a,l=U(e.getCursor()),c=e.charCoords(l,"local");if(t.forward)s>c.top?(l.line+=(s-c.top)/r,l.line=Math.ceil(l.line),e.setCursor(l),c=e.charCoords(l,"local"),e.scrollTo(null,c.top)):e.scrollTo(null,s);else{var u=s+e.getScrollInfo().clientHeight;u<c.bottom?(l.line-=(c.bottom-u)/r,l.line=Math.floor(l.line),e.setCursor(l),c=e.charCoords(l,"local"),e.scrollTo(null,c.bottom-e.getScrollInfo().clientHeight)):e.scrollTo(null,s)}}},scrollToCursor:function(e,t){var n=e.getCursor().line,r=e.charCoords(i(n,0),"local"),o=e.getScrollInfo().clientHeight,a=r.top,s=r.bottom-a;switch(t.position){case"center":a=a-o/2+s;break;case"bottom":a=a-o+s}e.scrollTo(null,a)},replayMacro:function(e,t,n){var i=t.selectedCharacter,r=t.repeat,o=wt.macroModeState;for("@"==i&&(i=o.latestRegister);r--;)Ve(e,n,o,i)},enterMacroRecordMode:function(e,t){var n=wt.macroModeState,i=t.selectedCharacter;n.enterMacroRecordMode(e,i)},toggleOverwrite:function(t){t.state.overwrite?(t.toggleOverwrite(!1),t.setOption("keyMap","vim-insert"),e.signal(t,"vim-mode-change",{mode:"insert"})):(t.toggleOverwrite(!0),t.setOption("keyMap","vim-replace"),e.signal(t,"vim-mode-change",{mode:"replace"}))},enterInsertMode:function(t,n,r){if(!t.getOption("readOnly")){r.insertMode=!0,r.insertModeRepeat=n&&n.repeat||1;var o=n?n.insertAt:null,a=r.sel,s=n.head||t.getCursor("head"),l=t.listSelections().length;if("eol"==o)s=i(s.line,V(t,s.line));else if("charAfter"==o)s=F(s,0,1);else if("firstNonBlank"==o)s=_t.moveToFirstNonWhiteSpaceCharacter(t,s);else if("startOfSelectedArea"==o)r.visualBlock?(s=i(Math.min(a.head.line,a.anchor.line),Math.min(a.head.ch,a.anchor.ch)),l=Math.abs(a.head.line-a.anchor.line)+1):s=a.head.line<a.anchor.line?a.head:i(a.anchor.line,0);else if("endOfSelectedArea"==o)r.visualBlock?(s=i(Math.min(a.head.line,a.anchor.line),Math.max(a.head.ch+1,a.anchor.ch)),l=Math.abs(a.head.line-a.anchor.line)+1):s=a.head.line>=a.anchor.line?F(a.head,0,1):i(a.anchor.line,0);else if("inplace"==o&&r.visualMode)return;t.setOption("disableInput",!1),n&&n.replace?(t.toggleOverwrite(!0),t.setOption("keyMap","vim-replace"),e.signal(t,"vim-mode-change",{mode:"replace"})):(t.toggleOverwrite(!1),t.setOption("keyMap","vim-insert"),e.signal(t,"vim-mode-change",{mode:"insert"})),wt.macroModeState.isPlaying||(t.on("change",Ze),e.on(t.getInputField(),"keydown",rt)),r.visualMode&&le(t),ee(t,s,l)}},toggleVisualMode:function(t,n,r){var o,a=n.repeat,s=t.getCursor();r.visualMode?r.visualLine^n.linewise||r.visualBlock^n.blockwise?(r.visualLine=!!n.linewise,r.visualBlock=!!n.blockwise,e.signal(t,"vim-mode-change",{mode:"visual",subMode:r.visualLine?"linewise":r.visualBlock?"blockwise":""}),oe(t)):le(t):(r.visualMode=!0,r.visualLine=!!n.linewise,r.visualBlock=!!n.blockwise,o=O(t,i(s.line,s.ch+a-1),!0),r.sel={anchor:s,head:o},e.signal(t,"vim-mode-change",{mode:"visual",subMode:r.visualLine?"linewise":r.visualBlock?"blockwise":""}),oe(t),we(t,r,"<",q(s,o)),we(t,r,">",Y(s,o)))},reselectLastSelection:function(t,n,i){var r=i.lastSelection;if(i.visualMode&&ie(t,i),r){var o=r.anchorMark.find(),a=r.headMark.find();if(!o||!a)return;i.sel={anchor:o,head:a},i.visualMode=!0,i.visualLine=r.visualLine,i.visualBlock=r.visualBlock,oe(t),we(t,i,"<",q(o,a)),we(t,i,">",Y(o,a)),e.signal(t,"vim-mode-change",{mode:"visual",subMode:i.visualLine?"linewise":i.visualBlock?"blockwise":""})}},joinLines:function(e,t,n){var r,o;if(n.visualMode){if(r=e.getCursor("anchor"),o=e.getCursor("head"),G(o,r)){var a=o;o=r,r=a}o.ch=V(e,o.line)-1}else{var s=Math.max(t.repeat,2);r=e.getCursor(),o=O(e,i(r.line+s-1,1/0))}for(var l=0,c=r.line;c<o.line;c++){l=V(e,r.line);var a=i(r.line+1,V(e,r.line+1)),u=e.getRange(r,a);u=u.replace(/\n\s*/g," "),e.replaceRange(u,r,a)}var h=i(r.line,l);n.visualMode&&le(e,!1),e.setCursor(h)},newLineAndEnterInsertMode:function(t,n,r){r.insertMode=!0;var o=U(t.getCursor());if(o.line!==t.firstLine()||n.after){o.line=n.after?o.line:o.line-1,o.ch=V(t,o.line),t.setCursor(o);var a=e.commands.newlineAndIndentContinueComment||e.commands.newlineAndIndent;a(t)}else t.replaceRange("\n",i(t.firstLine(),0)),t.setCursor(t.firstLine(),0);this.enterInsertMode(t,{repeat:n.repeat},r)},paste:function(e,t,n){var r=U(e.getCursor()),o=wt.registerController.getRegister(t.registerName),a=o.toString();if(a){if(t.matchIndent){var s=e.getOption("tabSize"),l=function(e){var t=e.split("	").length-1,n=e.split(" ").length-1;return t*s+1*n},c=e.getLine(e.getCursor().line),u=l(c.match(/^\s*/)[0]),h=a.replace(/\n$/,""),d=a!==h,f=l(a.match(/^\s*/)[0]),a=h.replace(/^\s*/gm,function(t){var n=u+(l(t)-f);if(0>n)return"";if(e.getOption("indentWithTabs")){var i=Math.floor(n/s);return Array(i+1).join("	")}return Array(n+1).join(" ")});a+=d?"\n":""}if(t.repeat>1)var a=Array(t.repeat+1).join(a);var p=o.linewise,g=o.blockwise;if(p)n.visualMode?a=n.visualLine?a.slice(0,-1):"\n"+a.slice(0,a.length-1)+"\n":t.after?(a="\n"+a.slice(0,a.length-1),r.ch=V(e,r.line)):r.ch=0;else{if(g){a=a.split("\n");for(var m=0;m<a.length;m++)a[m]=""==a[m]?" ":a[m]}r.ch+=t.after?1:0}var v,y;if(n.visualMode){n.lastPastedText=a;var b,w=ne(e,n),C=w[0],x=w[1],k=e.getSelection(),_=e.listSelections(),A=new Array(_.length).join("1").split("1");n.lastSelection&&(b=n.lastSelection.headMark.find()),wt.registerController.unnamedRegister.setText(k),g?(e.replaceSelections(A),x=i(C.line+a.length-1,C.ch),e.setCursor(C),Z(e,x),e.replaceSelections(a),v=C):n.visualBlock?(e.replaceSelections(A),e.setCursor(C),e.replaceRange(a,C,C),v=C):(e.replaceRange(a,C,x),v=e.posFromIndex(e.indexFromPos(C)+a.length-1)),b&&(n.lastSelection.headMark=e.setBookmark(b)),p&&(v.ch=0)}else if(g){e.setCursor(r);for(var m=0;m<a.length;m++){var S=r.line+m;S>e.lastLine()&&e.replaceRange("\n",i(S,0));var T=V(e,S);T<r.ch&&Q(e,S,r.ch)}e.setCursor(r),Z(e,i(r.line+a.length-1,r.ch)),e.replaceSelections(a),v=r}else e.replaceRange(a,r),p&&t.after?v=i(r.line+1,he(e.getLine(r.line+1))):p&&!t.after?v=i(r.line,he(e.getLine(r.line))):!p&&t.after?(y=e.indexFromPos(r),v=e.posFromIndex(y+a.length-1)):(y=e.indexFromPos(r),v=e.posFromIndex(y+a.length));n.visualMode&&le(e,!1),e.setCursor(v)}},undo:function(t,n){t.operation(function(){B(t,e.commands.undo,n.repeat)(),t.setCursor(t.getCursor("anchor"))})},redo:function(t,n){B(t,e.commands.redo,n.repeat)()},setRegister:function(e,t,n){n.inputState.registerName=t.selectedCharacter},setMark:function(e,t,n){var i=t.selectedCharacter;we(e,n,i,e.getCursor())},replace:function(t,n,r){var o,a,s=n.selectedCharacter,l=t.getCursor(),c=t.listSelections();if(r.visualMode)l=t.getCursor("start"),a=t.getCursor("end");else{var u=t.getLine(l.line);o=l.ch+n.repeat,o>u.length&&(o=u.length),a=i(l.line,o)}if("\n"==s)r.visualMode||t.replaceRange("",l,a),(e.commands.newlineAndIndentContinueComment||e.commands.newlineAndIndent)(t);else{var h=t.getRange(l,a);if(h=h.replace(/[^\n]/g,s),r.visualBlock){var d=new Array(t.getOption("tabSize")+1).join(" ");h=t.getSelection(),h=h.replace(/\t/g,d).replace(/[^\n]/g,s).split("\n"),t.replaceSelections(h)}else t.replaceRange(h,l,a);r.visualMode?(l=G(c[0].anchor,c[0].head)?c[0].anchor:c[0].head,t.setCursor(l),le(t,!1)):t.setCursor(F(a,0,-1))}},incrementNumberToken:function(e,t){for(var n,r,o,a,s,l=e.getCursor(),c=e.getLine(l.line),u=/-?\d+/g;null!==(n=u.exec(c))&&(s=n[0],r=n.index,o=r+s.length,!(l.ch<o)););if((t.backtrack||!(o<=l.ch))&&s){var h=t.increase?1:-1,d=parseInt(s)+h*t.repeat,f=i(l.line,r),p=i(l.line,o);a=d.toString(),e.replaceRange(a,f,p),e.setCursor(i(l.line,r+a.length-1))}},repeatLastEdit:function(e,t,n){var i=n.lastEditInputState;if(i){var r=t.repeat;r&&t.repeatIsExplicit?n.lastEditInputState.repeatOverride=r:r=n.lastEditInputState.repeatOverride||r,ot(e,n,r,!1)}},indent:function(e,t){e.indentLine(e.getCursor().line,t.indentRight)},exitInsertMode:qe},Tt={"(":"bracket",")":"bracket","{":"bracket","}":"bracket","[":"section","]":"section","*":"comment","/":"comment",m:"method",M:"method","#":"preprocess"},Lt={bracket:{isComplete:function(e){if(e.nextCh===e.symb){if(e.depth++,e.depth>=1)return!0}else e.nextCh===e.reverseSymb&&e.depth--;return!1}},section:{init:function(e){e.curMoveThrough=!0,e.symb=(e.forward?"]":"[")===e.symb?"{":"}"},isComplete:function(e){return 0===e.index&&e.nextCh===e.symb}},comment:{isComplete:function(e){var t="*"===e.lastCh&&"/"===e.nextCh;return e.lastCh=e.nextCh,t}},method:{init:function(e){e.symb="m"===e.symb?"{":"}",e.reverseSymb="{"===e.symb?"}":"{"},isComplete:function(e){return e.nextCh===e.symb}},preprocess:{init:function(e){e.index=0},isComplete:function(e){if("#"===e.nextCh){var t=e.lineText.match(/#(\w+)/)[1];if("endif"===t){if(e.forward&&0===e.depth)return!0;e.depth++}else if("if"===t){if(!e.forward&&0===e.depth)return!0;e.depth--}if("else"===t&&0===e.depth)return!0}return!1}}};b("pcre",!0,"boolean"),Ae.prototype={getQuery:function(){return wt.query},setQuery:function(e){wt.query=e},getOverlay:function(){return this.searchOverlay},setOverlay:function(e){this.searchOverlay=e},isReversed:function(){return wt.isReversed},setReversed:function(e){wt.isReversed=e},getScrollbarAnnotate:function(){return this.annotate},setScrollbarAnnotate:function(e){this.annotate=e}};var Et={"\\n":"\n","\\r":"\r","\\t":"	"},Mt={"\\/":"/","\\\\":"\\","\\n":"\n","\\r":"\r","\\t":"	"},Pt="(Javascript regexp)",Rt=function(){this.buildCommandMap_()};Rt.prototype={processCommand:function(e,t,n){var i=this;e.operation(function(){e.curOp.isVimOp=!0,i._processCommand(e,t,n)})},_processCommand:function(t,n,i){var r=t.state.vim,o=wt.registerController.getRegister(":"),a=o.toString();r.visualMode&&le(t);var s=new e.StringStream(n);o.setText(n);var l=i||{};l.input=n;try{this.parseInput_(t,s,l)}catch(c){throw $e(t,c),c}var u,h;if(l.commandName){if(u=this.matchCommand_(l.commandName)){if(h=u.name,u.excludeFromCommandHistory&&o.setText(a),this.parseCommandArgs_(s,l,u),"exToKey"==u.type){for(var d=0;d<u.toKeys.length;d++)e.Vim.handleKey(t,u.toKeys[d],"mapping");return}if("exToEx"==u.type)return void this.processCommand(t,u.toInput)}}else void 0!==l.line&&(h="move");if(!h)return void $e(t,'Not an editor command ":'+n+'"');
try{It[h](t,l),u&&u.possiblyAsync||!l.callback||l.callback()}catch(c){throw $e(t,c),c}},parseInput_:function(e,t,n){t.eatWhile(":"),t.eat("%")?(n.line=e.firstLine(),n.lineEnd=e.lastLine()):(n.line=this.parseLineSpec_(e,t),void 0!==n.line&&t.eat(",")&&(n.lineEnd=this.parseLineSpec_(e,t)));var i=t.match(/^(\w+)/);return i?n.commandName=i[1]:n.commandName=t.match(/.*/)[0],n},parseLineSpec_:function(e,t){var n=t.match(/^(\d+)/);if(n)return parseInt(n[1],10)-1;switch(t.next()){case".":return e.getCursor().line;case"$":return e.lastLine();case"'":var i=e.state.vim.marks[t.next()];if(i&&i.find())return i.find().line;throw new Error("Mark not set");default:return void t.backUp(1)}},parseCommandArgs_:function(e,t,n){if(!e.eol()){t.argString=e.match(/.*/)[0];var i=n.argDelimiter||/\s+/,r=X(t.argString).split(i);r.length&&r[0]&&(t.args=r)}},matchCommand_:function(e){for(var t=e.length;t>0;t--){var n=e.substring(0,t);if(this.commandMap_[n]){var i=this.commandMap_[n];if(0===i.name.indexOf(e))return i}}return null},buildCommandMap_:function(){this.commandMap_={};for(var e=0;e<n.length;e++){var t=n[e],i=t.shortName||t.name;this.commandMap_[i]=t}},map:function(e,n,i){if(":"!=e&&":"==e.charAt(0)){if(i)throw Error("Mode not supported for ex mappings");var r=e.substring(1);":"!=n&&":"==n.charAt(0)?this.commandMap_[r]={name:r,type:"exToEx",toInput:n.substring(1),user:!0}:this.commandMap_[r]={name:r,type:"exToKey",toKeys:n,user:!0}}else if(":"!=n&&":"==n.charAt(0)){var o={keys:e,type:"keyToEx",exArgs:{input:n.substring(1)},user:!0};i&&(o.context=i),t.unshift(o)}else{var o={keys:e,type:"keyToKey",toKeys:n,user:!0};i&&(o.context=i),t.unshift(o)}},unmap:function(e,n){if(":"!=e&&":"==e.charAt(0)){if(n)throw Error("Mode not supported for ex mappings");var i=e.substring(1);if(this.commandMap_[i]&&this.commandMap_[i].user)return void delete this.commandMap_[i]}else for(var r=e,o=0;o<t.length;o++)if(r==t[o].keys&&t[o].context===n&&t[o].user)return void t.splice(o,1);throw Error("No such mapping.")}};var It={colorscheme:function(e,t){return!t.args||t.args.length<1?void $e(e,e.getOption("theme")):void e.setOption("theme",t.args[0])},map:function(e,t,n){var i=t.args;return!i||i.length<2?void(e&&$e(e,"Invalid mapping: "+t.input)):void $t.map(i[0],i[1],n)},imap:function(e,t){this.map(e,t,"insert")},nmap:function(e,t){this.map(e,t,"normal")},vmap:function(e,t){this.map(e,t,"visual")},unmap:function(e,t,n){var i=t.args;return!i||i.length<1?void(e&&$e(e,"No such mapping: "+t.input)):void $t.unmap(i[0],n)},move:function(e,t){kt.processCommand(e,e.state.vim,{type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!1,explicitRepeat:!0,linewise:!0},repeatOverride:t.line+1})},set:function(e,t){var n=t.args,i=t.setCfg||{};if(!n||n.length<1)return void(e&&$e(e,"Invalid mapping: "+t.input));var r=n[0].split("="),o=r[0],a=r[1],s=!1;if("?"==o.charAt(o.length-1)){if(a)throw Error("Trailing characters: "+t.argString);o=o.substring(0,o.length-1),s=!0}void 0===a&&"no"==o.substring(0,2)&&(o=o.substring(2),a=!1);var l=vt[o]&&"boolean"==vt[o].type;if(l&&void 0==a&&(a=!0),!l&&void 0===a||s){var c=C(o,e,i);c===!0||c===!1?$e(e," "+(c?"":"no")+o):$e(e,"  "+o+"="+c)}else w(o,a,e,i)},setlocal:function(e,t){t.setCfg={scope:"local"},this.set(e,t)},setglobal:function(e,t){t.setCfg={scope:"global"},this.set(e,t)},registers:function(e,t){var n=t.args,i=wt.registerController.registers,r="----------Registers----------<br><br>";if(n){var o;n=n.join("");for(var a=0;a<n.length;a++)if(o=n.charAt(a),wt.registerController.isValidRegister(o)){var s=i[o]||new T;r+='"'+o+"    "+s.toString()+"<br>"}}else for(var o in i){var l=i[o].toString();l.length&&(r+='"'+o+"    "+l+"<br>")}$e(e,r)},sort:function(t,n){function r(){if(n.argString){var t=new e.StringStream(n.argString);if(t.eat("!")&&(a=!0),t.eol())return;if(!t.eatSpace())return"Invalid arguments";var i=t.match(/[a-z]+/);if(i){i=i[0],s=-1!=i.indexOf("i"),l=-1!=i.indexOf("u");var r=-1!=i.indexOf("d")&&1,o=-1!=i.indexOf("x")&&1,u=-1!=i.indexOf("o")&&1;if(r+o+u>1)return"Invalid arguments";c=r&&"decimal"||o&&"hex"||u&&"octal"}if(t.match(/\/.*\//))return"patterns not supported"}}function o(e,t){if(a){var n;n=e,e=t,t=n}s&&(e=e.toLowerCase(),t=t.toLowerCase());var i=c&&m.exec(e),r=c&&m.exec(t);return i?(i=parseInt((i[1]+i[2]).toLowerCase(),v),r=parseInt((r[1]+r[2]).toLowerCase(),v),i-r):t>e?-1:1}var a,s,l,c,u=r();if(u)return void $e(t,u+": "+n.argString);var h=n.line||t.firstLine(),d=n.lineEnd||n.line||t.lastLine();if(h!=d){var f=i(h,0),p=i(d,V(t,d)),g=t.getRange(f,p).split("\n"),m="decimal"==c?/(-?)([\d]+)/:"hex"==c?/(-?)(?:0x)?([0-9a-f]+)/i:"octal"==c?/([0-7]+)/:null,v="decimal"==c?10:"hex"==c?16:"octal"==c?8:null,y=[],b=[];if(c)for(var w=0;w<g.length;w++)m.exec(g[w])?y.push(g[w]):b.push(g[w]);else b=g;if(y.sort(o),b.sort(o),g=a?y.concat(b):b.concat(y),l){var C,x=g;g=[];for(var w=0;w<x.length;w++)x[w]!=C&&g.push(x[w]),C=x[w]}t.replaceRange(g.join("\n"),f,p)}},global:function(e,t){var n=t.argString;if(!n)return void $e(e,"Regular Expression missing from global");var i,r=void 0!==t.line?t.line:e.firstLine(),o=t.lineEnd||t.line||e.lastLine(),a=Le(n),s=n;if(a.length&&(s=a[0],i=a.slice(1,a.length).join("/")),s)try{Ne(e,s,!0,!0)}catch(l){return void $e(e,"Invalid regex: "+s)}for(var c=Se(e).getQuery(),u=[],h="",d=r;o>=d;d++){var f=c.test(e.getLine(d));f&&(u.push(d+1),h+=e.getLine(d)+"<br>")}if(!i)return void $e(e,h);var p=0,g=function(){if(p<u.length){var t=u[p]+i;$t.processCommand(e,t,{callback:g})}p++};g()},substitute:function(e,t){if(!e.getSearchCursor)throw new Error("Search feature not available. Requires searchcursor.js or any other getSearchCursor implementation.");var n,r,o,a,s=t.argString,l=s?Le(s):[],c="",u=!1,h=!1;if(l.length)n=l[0],c=l[1],void 0!==c&&(c=C("pcre")?Re(c):Pe(c),wt.lastSubstituteReplacePart=c),r=l[2]?l[2].split(" "):[];else if(s&&s.length)return void $e(e,"Substitutions should be of the form :s/pattern/replace/");if(r&&(o=r[0],a=parseInt(r[1]),o&&(-1!=o.indexOf("c")&&(u=!0,o.replace("c","")),-1!=o.indexOf("g")&&(h=!0,o.replace("g","")),n=n+"/"+o)),n)try{Ne(e,n,!0,!0)}catch(d){return void $e(e,"Invalid regex: "+n)}if(c=c||wt.lastSubstituteReplacePart,void 0===c)return void $e(e,"No previous substitute regular expression");var f=Se(e),p=f.getQuery(),g=void 0!==t.line?t.line:e.getCursor().line,m=t.lineEnd||g;g==e.firstLine()&&m==e.lastLine()&&(m=1/0),a&&(g=m,m=g+a-1);var v=O(e,i(g,0)),y=e.getSearchCursor(p,v);Ge(e,u,h,g,m,y,p,c,t.callback)},redo:e.commands.redo,undo:e.commands.undo,write:function(t){e.commands.save?e.commands.save(t):t.save&&t.save()},nohlsearch:function(e){Be(e)},yank:function(e){var t=U(e.getCursor()),n=t.line,i=e.getLine(n);wt.registerController.pushText("0","yank",i,!0,!0)},delmarks:function(t,n){if(!n.argString||!X(n.argString))return void $e(t,"Argument required");for(var i=t.state.vim,r=new e.StringStream(X(n.argString));!r.eol();){r.eatSpace();var o=r.pos;if(!r.match(/[a-zA-Z]/,!1))return void $e(t,"Invalid argument: "+n.argString.substring(o));var a=r.next();if(r.match("-",!0)){if(!r.match(/[a-zA-Z]/,!1))return void $e(t,"Invalid argument: "+n.argString.substring(o));var s=a,l=r.next();if(!(f(s)&&f(l)||m(s)&&m(l)))return void $e(t,"Invalid argument: "+s+"-");var c=s.charCodeAt(0),u=l.charCodeAt(0);if(c>=u)return void $e(t,"Invalid argument: "+n.argString.substring(o));for(var h=0;u-c>=h;h++){var d=String.fromCharCode(c+h);delete i.marks[d]}}else delete i.marks[a]}}},$t=new Rt;return e.keyMap.vim={attach:s,detach:a,call:l},b("insertModeEscKeysTimeout",200,"number"),e.keyMap["vim-insert"]={fallthrough:["default"],attach:s,detach:a,call:l},e.keyMap["vim-replace"]={Backspace:"goCharLeft",fallthrough:["vim-insert"],attach:s,detach:a,call:l},_(),xt};e.Vim=r()}),
// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(e){"object"==typeof exports&&"object"==typeof module?e(require("../lib/codemirror")):"function"==typeof define&&define.amd?define(["../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(e,t){return e.line==t.line&&e.ch==t.ch}function n(e){$.push(e),$.length>50&&$.shift()}function i(e){return $.length?void($[$.length-1]+=e):n(e)}function r(e){return $[$.length-(e?Math.min(e,1):1)]||""}function o(){return $.length>1&&$.pop(),r()}function a(e,r,o,a,s){null==s&&(s=e.getRange(r,o)),a&&O&&O.cm==e&&t(r,O.pos)&&e.isClean(O.gen)?i(s):n(s),e.replaceRange("",r,o,"+delete"),O=a?{cm:e,pos:r,gen:e.changeGeneration()}:null}function s(e,t,n){return e.findPosH(t,n,"char",!0)}function l(e,t,n){return e.findPosH(t,n,"word",!0)}function c(e,t,n){return e.findPosV(t,n,"line",e.doc.sel.goalColumn)}function u(e,t,n){return e.findPosV(t,n,"page",e.doc.sel.goalColumn)}function h(e,t,n){for(var i=t.line,r=e.getLine(i),o=/\S/.test(0>n?r.slice(0,t.ch):r.slice(t.ch)),a=e.firstLine(),s=e.lastLine();;){if(i+=n,a>i||i>s)return e.clipPos(I(i-n,0>n?0:null));r=e.getLine(i);var l=/\S/.test(r);if(l)o=!0;else if(o)return I(i,0)}}function d(e,t,n){for(var i=t.line,r=t.ch,o=e.getLine(t.line),a=!1;;){var s=o.charAt(r+(0>n?-1:0));if(s){if(a&&/[!?.]/.test(s))return I(i,r+(n>0?1:0));a||(a=/\w/.test(s)),r+=n}else{if(i==(0>n?e.firstLine():e.lastLine()))return I(i,r);if(o=e.getLine(i+n),!/\S/.test(o))return I(i,r);i+=n,r=0>n?o.length:0}}}function f(e,n,i){var r;if(e.findMatchingBracket&&(r=e.findMatchingBracket(n,!0))&&r.match&&(r.forward?1:-1)==i)return i>0?I(r.to.line,r.to.ch+1):r.to;for(var o=!0;;o=!1){var a=e.getTokenAt(n),s=I(n.line,0>i?a.start:a.end);if(!(o&&i>0&&a.end==n.ch)&&/\w/.test(a.string))return s;var l=e.findPosH(s,i,"char");if(t(s,l))return n;n=l}}function p(e,t){var n=e.state.emacsPrefix;return n?(x(e),"-"==n?-1:Number(n)):t?null:1}function g(e){var t="string"==typeof e?function(t){t.execCommand(e)}:e;return function(e){var n=p(e);t(e);for(var i=1;n>i;++i)t(e)}}function m(e,n,i,r){var o=p(e);0>o&&(r=-r,o=-o);for(var a=0;o>a;++a){var s=i(e,n,r);if(t(s,n))break;n=s}return n}function v(e,t){var n=function(n){n.extendSelection(m(n,n.getCursor(),e,t))};return n.motion=!0,n}function y(e,t,n){for(var i,r=e.listSelections(),o=r.length;o--;)i=r[o].head,a(e,i,m(e,i,t,n),!0)}function b(e){if(e.somethingSelected()){for(var t,n=e.listSelections(),i=n.length;i--;)t=n[i],a(e,t.anchor,t.head);return!0}}function w(e,t){return e.state.emacsPrefix?void("-"!=t&&(e.state.emacsPrefix+=t)):(e.state.emacsPrefix=t,e.on("keyHandled",C),void e.on("inputRead",k))}function C(e,t){e.state.emacsPrefixMap||D.hasOwnProperty(t)||x(e)}function x(e){e.state.emacsPrefix=null,e.off("keyHandled",C),e.off("inputRead",k)}function k(e,t){var n=p(e);if(n>1&&"+input"==t.origin){for(var i=t.text.join("\n"),r="",o=1;n>o;++o)r+=i;e.replaceSelection(r)}}function _(e){e.state.emacsPrefixMap=!0,e.addKeyMap(N),e.on("keyHandled",A),e.on("inputRead",A)}function A(e,t){("string"!=typeof t||!/^\d$/.test(t)&&"Ctrl-U"!=t)&&(e.removeKeyMap(N),e.state.emacsPrefixMap=!1,e.off("keyHandled",A),e.off("inputRead",A))}function S(e){e.setCursor(e.getCursor()),e.setExtending(!e.getExtending()),e.on("change",function(){e.setExtending(!1)})}function T(e){e.setExtending(!1),e.setCursor(e.getCursor())}function L(e,t,n){e.openDialog?e.openDialog(t+': <input type="text" style="width: 10em"/>',n,{bottom:!0}):n(prompt(t,""))}function E(e,t){var n=e.getCursor(),i=e.findPosH(n,1,"word");e.replaceRange(t(e.getRange(n,i)),n,i),e.setCursor(i)}function M(e){for(var t=e.getCursor(),n=t.line,i=t.ch,r=[];n>=e.firstLine();){for(var o=e.getLine(n),a=null==i?o.length:i;a>0;){var i=o.charAt(--a);if(")"==i)r.push("(");else if("]"==i)r.push("[");else if("}"==i)r.push("{");else if(/[\(\{\[]/.test(i)&&(!r.length||r.pop()!=i))return e.extendSelection(I(n,a))}--n,i=null}}function P(e){e.execCommand("clearSearch"),T(e)}function R(e){N[e]=function(t){w(t,e)},F["Ctrl-"+e]=function(t){w(t,e)},D["Ctrl-"+e]=!0}for(var I=e.Pos,$=[],O=null,D={"Alt-G":!0,"Ctrl-X":!0,"Ctrl-Q":!0,"Ctrl-U":!0},F=e.keyMap.emacs=e.normalizeKeyMap({"Ctrl-W":function(e){a(e,e.getCursor("start"),e.getCursor("end"))},"Ctrl-K":g(function(e){var t=e.getCursor(),n=e.clipPos(I(t.line)),i=e.getRange(t,n);/\S/.test(i)||(i+="\n",n=I(t.line+1,0)),a(e,t,n,!0,i)}),"Alt-W":function(e){n(e.getSelection()),T(e)},"Ctrl-Y":function(e){var t=e.getCursor();e.replaceRange(r(p(e)),t,t,"paste"),e.setSelection(t,e.getCursor())},"Alt-Y":function(e){e.replaceSelection(o(),"around","paste")},"Ctrl-Space":S,"Ctrl-Shift-2":S,"Ctrl-F":v(s,1),"Ctrl-B":v(s,-1),Right:v(s,1),Left:v(s,-1),"Ctrl-D":function(e){y(e,s,1)},Delete:function(e){b(e)||y(e,s,1)},"Ctrl-H":function(e){y(e,s,-1)},Backspace:function(e){b(e)||y(e,s,-1)},"Alt-F":v(l,1),"Alt-B":v(l,-1),"Alt-D":function(e){y(e,l,1)},"Alt-Backspace":function(e){y(e,l,-1)},"Ctrl-N":v(c,1),"Ctrl-P":v(c,-1),Down:v(c,1),Up:v(c,-1),"Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd",End:"goLineEnd",Home:"goLineStart","Alt-V":v(u,-1),"Ctrl-V":v(u,1),PageUp:v(u,-1),PageDown:v(u,1),"Ctrl-Up":v(h,-1),"Ctrl-Down":v(h,1),"Alt-A":v(d,-1),"Alt-E":v(d,1),"Alt-K":function(e){y(e,d,1)},"Ctrl-Alt-K":function(e){y(e,f,1)},"Ctrl-Alt-Backspace":function(e){y(e,f,-1)},"Ctrl-Alt-F":v(f,1),"Ctrl-Alt-B":v(f,-1),"Shift-Ctrl-Alt-2":function(e){var t=e.getCursor();e.setSelection(m(e,t,f,1),t)},"Ctrl-Alt-T":function(e){var t=f(e,e.getCursor(),-1),n=f(e,t,1),i=f(e,n,1),r=f(e,i,-1);e.replaceRange(e.getRange(r,i)+e.getRange(n,r)+e.getRange(t,n),t,i)},"Ctrl-Alt-U":g(M),"Alt-Space":function(e){for(var t=e.getCursor(),n=t.ch,i=t.ch,r=e.getLine(t.line);n&&/\s/.test(r.charAt(n-1));)--n;for(;i<r.length&&/\s/.test(r.charAt(i));)++i;e.replaceRange(" ",I(t.line,n),I(t.line,i))},"Ctrl-O":g(function(e){e.replaceSelection("\n","start")}),"Ctrl-T":g(function(e){e.execCommand("transposeChars")}),"Alt-C":g(function(e){E(e,function(e){var t=e.search(/\w/);return-1==t?e:e.slice(0,t)+e.charAt(t).toUpperCase()+e.slice(t+1).toLowerCase()})}),"Alt-U":g(function(e){E(e,function(e){return e.toUpperCase()})}),"Alt-L":g(function(e){E(e,function(e){return e.toLowerCase()})}),"Alt-;":"toggleComment","Ctrl-/":g("undo"),"Shift-Ctrl--":g("undo"),"Ctrl-Z":g("undo"),"Cmd-Z":g("undo"),"Shift-Alt-,":"goDocStart","Shift-Alt-.":"goDocEnd","Ctrl-S":"findNext","Ctrl-R":"findPrev","Ctrl-G":P,"Shift-Alt-5":"replace","Alt-/":"autocomplete","Ctrl-J":"newlineAndIndent",Enter:!1,Tab:"indentAuto","Alt-G G":function(e){var t=p(e,!0);return null!=t&&t>0?e.setCursor(t-1):void L(e,"Goto line",function(t){var n;t&&!isNaN(n=Number(t))&&n==(0|n)&&n>0&&e.setCursor(n-1)})},"Ctrl-X Tab":function(e){e.indentSelection(p(e,!0)||e.getOption("indentUnit"))},"Ctrl-X Ctrl-X":function(e){e.setSelection(e.getCursor("head"),e.getCursor("anchor"))},"Ctrl-X Ctrl-S":"save","Ctrl-X Ctrl-W":"save","Ctrl-X S":"saveAll","Ctrl-X F":"open","Ctrl-X U":g("undo"),"Ctrl-X K":"close","Ctrl-X Delete":function(e){a(e,e.getCursor(),d(e,e.getCursor(),1),!0)},"Ctrl-X H":"selectAll","Ctrl-Q Tab":g("insertTab"),"Ctrl-U":_}),N={"Ctrl-G":x},W=0;10>W;++W)R(String(W));R("-")}),WL.Hunspell=function(e){function t(t,n){var i=e+".aff",r=e+".dic";s.FS_createDataFile("/",i,t,!0,!0),s.FS_createDataFile("/",r,n,!0,!0),l(i,r)}function n(){d.aff&&d.dic&&(t(d.aff,d.dic),p.ready=!0,f(),d={})}function i(e){o(e,3).send(null)}function r(){i("dic"),i("aff")}function o(t,i){var r=new XMLHttpRequest,s="/dictionaries/utf8/"+e+"."+t;return r.open("GET",s,!0),r.responseType="arraybuffer",r.onload=function(){var e=i-1;if(200==r.status){var l=r.response;l&&(d[t]=new Uint8Array(l),n())}else WL.reportAjaxError(r,s),e>0?setTimeout(function(){o(t,e).send(null)},3e3):a()},r}function a(){$("#error-alert").trigger("summon").find("p").html("Sorry, we've disabled the Spell Check functionality because there was a problem loading dictionary files. This is likely a temporary problem, please refresh the page to try again. If the problem continues, please feel free to contact us, and we'll try to help.")}var s,l,c,u,h=4,d={},f=null,p=this;if("function"!=typeof window.initHunspellModule)throw new Error("Hunspell wrapper is not loaded");this.ready=!1,this.suggest=function(e){var t=[],n=c(e);n=Math.min(n,h);for(var i=0;n>i;++i)t.push(u(i));return t},this.load=function(){return new Promise(function(e){s=window.initHunspellModule(),s.onRuntimeInitialized=function(){l=s.cwrap("create",null,["string","string"]),c=s.cwrap("suggest","number",["string"]),u=s.cwrap("get_suggestion","string",["number"]),p.spell=s.cwrap("spell","number",["string"]),p.getDicEncoding=s.cwrap("get_dic_encoding","string",[]),r()},f=e})}},/**
 * @license
 * Fuse - Lightweight fuzzy-search
 *
 * Copyright (c) 2012 Kirollos Risk <kirollos@gmail.com>.
 * All Rights Reserved. Apache Software License 2.0
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(e){function t(e,n){this.list=e,this.options=n=n||{};var i,r,o,a;for(i=0,a=["sort","includeScore","shouldSort"],r=a.length;r>i;i++)o=a[i],this.options[o]=o in n?n[o]:t.defaultOptions[o];for(i=0,a=["searchFn","sortFn","keys","getFn"],r=a.length;r>i;i++)o=a[i],this.options[o]=n[o]||t.defaultOptions[o]}var n=function(e,t){if(t=t||{},this.options=t,this.options.location=t.location||n.defaultOptions.location,this.options.distance="distance"in t?t.distance:n.defaultOptions.distance,this.options.threshold="threshold"in t?t.threshold:n.defaultOptions.threshold,this.options.maxPatternLength=t.maxPatternLength||n.defaultOptions.maxPatternLength,this.pattern=t.caseSensitive?e:e.toLowerCase(),this.patternLen=e.length,this.patternLen>this.options.maxPatternLength)throw new Error("Pattern length is too long");this.matchmask=1<<this.patternLen-1,this.patternAlphabet=this._calculatePatternAlphabet()};n.defaultOptions={location:0,distance:100,threshold:.6,maxPatternLength:32},n.prototype._calculatePatternAlphabet=function(){var e={},t=0;for(t=0;t<this.patternLen;t++)e[this.pattern.charAt(t)]=0;for(t=0;t<this.patternLen;t++)e[this.pattern.charAt(t)]|=1<<this.pattern.length-t-1;return e},n.prototype._bitapScore=function(e,t){var n=e/this.patternLen,i=Math.abs(this.options.location-t);return this.options.distance?n+i/this.options.distance:i?1:n},n.prototype.search=function(e){if(e=this.options.caseSensitive?e:e.toLowerCase(),this.pattern===e)return{isMatch:!0,score:0};var t,n,i,r,o,a,s,l,c,u=e.length,h=this.options.location,d=this.options.threshold,f=e.indexOf(this.pattern,h),p=this.patternLen+u,g=1,m=[];for(-1!=f&&(d=Math.min(this._bitapScore(0,f),d),f=e.lastIndexOf(this.pattern,h+this.patternLen),-1!=f&&(d=Math.min(this._bitapScore(0,f),d))),f=-1,t=0;t<this.patternLen;t++){for(i=0,r=p;r>i;)this._bitapScore(t,h+r)<=d?i=r:p=r,r=Math.floor((p-i)/2+i);for(p=r,o=Math.max(1,h-r+1),a=Math.min(h+r,u)+this.patternLen,s=Array(a+2),s[a+1]=(1<<t)-1,n=a;n>=o;n--)if(c=this.patternAlphabet[e.charAt(n-1)],0===t?s[n]=(s[n+1]<<1|1)&c:s[n]=(s[n+1]<<1|1)&c|((l[n+1]|l[n])<<1|1)|l[n+1],s[n]&this.matchmask&&(g=this._bitapScore(t,n-1),d>=g)){if(d=g,f=n-1,m.push(f),!(f>h))break;o=Math.max(1,2*h-f)}if(this._bitapScore(t+1,h)>d)break;l=s}return{isMatch:f>=0,score:g}};var i=function(e,t,n){var o,a,s;if(t){s=t.indexOf("."),-1!==s?(o=t.slice(0,s),a=t.slice(s+1)):o=t;var l=e[o];if(l)if(a||"string"!=typeof l&&"number"!=typeof l)if(r.isArray(l))for(var c=0,u=l.length;u>c;c++)i(l[c],a,n);else a&&i(l,a,n);else n.push(l)}else n.push(e);return n},r={deepValue:function(e,t){return i(e,t,[])},isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)}};t.defaultOptions={id:null,caseSensitive:!1,includeScore:!1,shouldSort:!0,searchFn:n,sortFn:function(e,t){return e.score-t.score},getFn:r.deepValue,keys:[]},t.prototype.search=function(e){var t,n,i,o,a=new this.options.searchFn(e,this.options),s=this.list,l=s.length,c=this.options,u=this.options.keys,h=u.length,d=[],f={},p=[],g=function(e,t,n){if(void 0!==e&&null!==e)if("string"==typeof e)i=a.search(e),i.isMatch&&(o=f[n],o?o.score=Math.min(o.score,i.score):(f[n]={item:t,score:i.score},d.push(f[n])));else if(r.isArray(e))for(var s=0;s<e.length;s++)g(e[s],t,n)};if("string"==typeof s[0])for(var m=0;l>m;m++)g(s[m],m,m);else for(var m=0;l>m;m++)for(n=s[m],t=0;h>t;t++)g(c.getFn(n,u[t]),n,m);c.shouldSort&&d.sort(c.sortFn);for(var v=c.includeScore?function(e){return d[e]}:function(e){return d[e].item},y=c.id?function(e){d[e].item=c.getFn(d[e].item,c.id)[0]}:function(){},m=0,b=d.length;b>m;m++)y(m),p.push(v(m));return p},"object"==typeof exports?module.exports=t:"function"==typeof define&&define.amd?define(function(){return t}):e.Fuse=t}(this),WL.lcsTable=function(e,t){var n,i,r=e.length,o=t.length,a=[];for(n=0;r>=n;++n)a[n]=[],a[n][0]=0;for(i=0;o>=i;++i)a[0][i]=0;for(n=0;r>n;++n)for(i=0;o>i;++i)a[n+1][i+1]=e.charAt(n)==t.charAt(i)?a[n][i]+1:Math.max(a[n+1][i],a[n][i+1]);return a},WL.lcsTableToOps=function(e,t,n,i){function r(s,l){s>=0&&l>=0&&t.charAt(s)==n.charAt(l)?(r(s-1,l-1),a=null,++i):l>=0&&(0>s||e[s+1][l]>=e[s][l+1])?(r(s,l-1),a&&"i"==a.op?a.extend(n.charAt(l)):(a=new WL.Ins(i,n.charAt(l)),o.push(a)),++i):s>=0&&(0>l||e[s+1][l]<e[s][l+1])&&(r(s-1,l),a&&"d"==a.op?a.extend(1):(a=new WL.Del(i,1),o.push(a)))}var o=[],a=null;return r(t.length-1,n.length-1),o},WL.MAX_DIFF=1e3,WL.diffOps=function(e,t){var n,i,r,o=Math.min(e.length,t.length);for(n=0;o>n&&e.charAt(n)==t.charAt(n);++n);for(i=e.length-1,r=t.length-1;i>=n&&r>=n&&e.charAt(i)==t.charAt(r);--i,--r);var a=e.slice(n,i+1),s=t.slice(n,r+1);return a.length>WL.MAX_DIFF||s.length>WL.MAX_DIFF?[new WL.Del(n,a.length),new WL.Ins(n,s)]:WL.lcsTableToOps(WL.lcsTable(a,s),a,s,n)},WL.Op=function(){this.shiftLeft=function(e){return this.pos-=e,this},this.shiftRight=function(e){return this.pos+=e,this}},WL.Ins=function(e,t){this.pos=e,this.size=t.length,this.text=t},WL.Ins.prototype=new WL.Op,WL.Ins.prototype.op="i",WL.Ins.prototype.applyTo=function(e){if(!this.isValidFor(e))throw"ins "+this.size+" at "+this.pos+" invalid on "+e;return e.substring(0,this.pos)+this.text+e.substring(this.pos)},WL.Ins.prototype.applyToEditor=function(e){var t=e.posFromIndex(this.pos);e.replaceRange(this.text,t)},WL.Ins.prototype.applyToPos=function(e){return this.pos>e?e:e+this.size},WL.Ins.prototype.extend=function(e){this.size+=e.length,this.text+=e},WL.Ins.prototype.isValidFor=function(e){return 0<=this.pos&&this.pos<=e.length},WL.Ins.prototype.transform=function(e){switch(e.op){case"i":this.pos>=e.pos?this.shiftRight(e.size):e.shiftRight(this.size);break;case"d":this.pos<=e.pos?e.shiftRight(this.size):this.pos<e.pos+e.size?(e.size+=this.size,this.pos=0,this.size=0,this.text=""):this.shiftLeft(e.size);break;default:throw"bug: bad op code"}},WL.Del=function(e,t){this.pos=e,this.size=t},WL.Del.prototype=new WL.Op,WL.Del.prototype.op="d",WL.Del.prototype.applyTo=function(e){if(!this.isValidFor(e))throw"del "+this.size+" at "+this.pos+" invalid on "+e;return e.substring(0,this.pos)+e.substring(this.pos+this.size)},WL.Del.prototype.applyToEditor=function(e){var t=e.posFromIndex(this.pos),n=e.posFromIndex(this.pos+this.size);e.replaceRange("",t,n)},WL.Del.prototype.applyToPos=function(e){return this.pos>=e?e:this.pos>=e-this.size?this.pos:e-this.size},WL.Del.prototype.extend=function(e){this.size+=e},WL.Del.prototype.isValidFor=function(e){return 0<=this.pos&&this.pos+this.size<=e.length},WL.Del.prototype.transform=function(e){switch(e.op){case"i":this.pos>=e.pos?this.shiftRight(e.size):this.pos+this.size<=e.pos?e.shiftLeft(this.size):(this.size+=e.size,e.pos=0,e.text="",e.size=0);break;case"d":this.pos>e.pos?e.transform(this):this.pos+this.size<=e.pos?e.shiftLeft(this.size):this.pos+this.size<=e.pos+e.size?(e.size=e.pos+e.size-this.pos-this.size,this.size=e.pos-this.pos,e.pos=this.pos):(this.size=this.size-e.size,e.pos=0,e.size=0);break;default:throw"bug: bad op code"}},WL.DIFF_STRING_RX=/^((?:(?:i|d)\d+:\d+)*)#([\s\S]*)$/,WL.DIFF_STRING_OP_RX=/(i|d)(\d+):(\d+)/g,WL.diffStringToOps=function(e){var t=WL.DIFF_STRING_RX.exec(e);if(!t||3!=t.length)throw"bad diff string: "+e;var n=t[1],i=t[2],r=0,o=[];if(n.replace(WL.DIFF_STRING_OP_RX,function(e,t,n,a){switch(n=parseInt(n,10),a=parseInt(a,10),t){case"i":o.push(new WL.Ins(n,i.substr(r,a))),r+=a;break;case"d":o.push(new WL.Del(n,a));break;default:throw"bug: diff matched but got bad op code: "+e}}),r!=i.length)throw"need "+r+" chars of data: "+e;return o},WL.opsToDiffString=function(e){var t=[],n=e.map(function(e){switch(e.op){case"i":return t.push(e.text),"i"+e.pos+":"+e.size;case"d":return"d"+e.pos+":"+e.size;default:throw'bug: unsupported operation: "'+e.op+'"'}}).join("");return n+"#"+t.join("")},WL.applyServerOps=function(e,t,n,i){for(var r=WL.diffOps(t,n.getValue()),o=0;o<e.length;++o)t=e[o].applyTo(t);return n.operation(function(){var t,o,a;for(t=0;t<e.length;++t){for(a=e[t],o=0;o<r.length;++o)a.transform(r[o]);for(a.applyToEditor(n),o=0;o<i.length;++o)i[o]=a.applyToPos(i[o])}}),t},WL.applyClientOps=function(e,t){for(var n=0;n<t.length;++n)e=t[n].applyTo(e);return e},WL.AsyncModal=function(e){this.$div=$(e),this.remote=this.$div.data("modal-remote"),this.$loading=this.$div.find(".async-modal-loading"),this.$content=this.$div.find(".async-modal-content"),this.$div.one("show.bs.modal",this.reloadModal.bind(this))},WL.AsyncModal.prototype.reloadModal=function(){this.$loading.show(),this.$content.hide(),$.getScript(this.remote)},WL.AsyncModal.prototype.showContent=function(e,t){this.$loading.hide(),this.$content.html(e).fadeIn("fast",t)},WL.AsyncModal.prototype.onShow=function(e){this.$div.on("show.bs.modal",e)},WL.AsyncRequester=function(e,t){function n(e){r+=1,t.maxTries&&r>t.maxTries?i.stop():(o=setTimeout(n,t.retryTimeoutInterval||3e4,e),t.start(e))}var i=this,r=0,o=null;this.start=function(e){null===o&&n(e)},this.stop=function(e){null!==o&&(clearTimeout(o),o=null,r=0,t.stop(e))},t.pusherEvent&&$(e).bind("initPusher",function(){e.docChannel().bind(t.pusherEvent,i.stop)})},WL.Connection=function(e,t,n,i,r,o){var a=this,s=3e4,l=5e3,c={STOPPED:"stopped",CONNECTING_TO_PUSHER:"connecting_to_pusher",GETTING_LATEST:"getting_latest",RETRYING_GET_LATEST:"retrying_get_latest",READY:"ready",READY_WITH_DELETED_FILE:"ready_deleted_file",POLLING:"polling"},u=c.STOPPED,h=[],d=null,f=null,p=null,g=null,m=null,v=null,y=0,b=null;if("undefined"==typeof Pusher)throw u=c.STOPPED,"no pusher";var w=function(e){u=e,h.push(e),h.length>50&&h.shift()},C=function(e,t){-1==$.inArray(u,t)&&WL.flunk("state "+u+"; valid "+t+"; "+e+"; log: "+h)};this.start=function(){C("start",[c.STOPPED]),w(c.CONNECTING_TO_PUSHER),d=new Pusher(r,{encrypted:!0,auth:{params:{docKey:n},headers:{"X-CSRF-Token":$('meta[name="csrf-token"]').attr("content")}}}),d.connection.bind("disconnected",function(){e.makeSafeOnError(k)}),f=d.subscribe(o),f.bind("pusher:subscription_succeeded",function(){e.makeSafeOnError(x)}),f.bind("pusher:subscription_error",function(t){$("#error-alert").trigger("summon").find("p").html("Sorry, we couldn't connect you to our real time update service. Please refresh this project. If this problem persists, please contact us. (Status: "+t+")"),e.makeSafe("failed_to_load")}),$(a).trigger("initPusher")},this.openFile=function(e){u!=c.STOPPED&&(u==c.GETTING_LATEST||u==c.POLLING||u==c.READY||u==c.READY_WITH_DELETED_FILE?(v&&v.abort(),i=e,p=null,g=null,$(a).trigger("disconnected"),A()):u==c.CONNECTING_TO_PUSHER||u==c.RETRYING_GET_LATEST?(i=e,p=null,g=null):WL.flunk("unexpected state "+u))},this.srcId=function(){return i},this.srcFile=function(){return p},this.srcMimeType=function(){return g};var x=function(){u==c.CONNECTING_TO_PUSHER&&A()},k=function(){u!=c.STOPPED&&(u==c.GETTING_LATEST&&v?v.abort():u==c.RETRYING_GET_LATEST?window.clearTimeout(b):u==c.POLLING&&v&&v.abort(),w(c.CONNECTING_TO_PUSHER),$(a).trigger("disconnected"))},A=function(){C("getLatest",[c.CONNECTING_TO_PUSHER,c.RETRYING_GET_LATEST,c.POLLING,c.GETTING_LATEST,c.READY,c.READY_WITH_DELETED_FILE]),w(c.GETTING_LATEST);var r=i;y+=1;var o=y;v=$.ajax({url:"/docs/"+n+"/srcs/"+i+"/latest.json",timeout:s,type:"POST",data:{protocolVersion:t,saved_ver_id:m},success:function(t){e.makeSafeOnError(function(){if(o==y&&u==c.GETTING_LATEST){if(t&&t.reload)return void e.reload(!0);S(t,function(t){w(c.READY),p=t.file,g=t.mime,$(a).trigger("connected",[t.verId,t.content]),e.hashUrl.setSrc(r)},function(){if(w(c.READY_WITH_DELETED_FILE),p=g=null,$(a).trigger("connected",[null,null]),m)e.hashUrl.setSrc(r);else{if(i==e.defaultSrc)return void e.reload(!1);e.hashUrl.clear(),e.openSrc(e.defaultSrc)}}),m&&S(t.counterpart,function(t){e.editorView.setMergeValue(t.content,t.mime,t.file)},function(){e.editorView.setMergeValue(null,null,null)})}})},error:function(t,n){e.makeSafeOnError(function(){return o==y&&u==c.GETTING_LATEST?404===t.status?void WL.errorHandler.makeSafe("latest-not-found"):void T(n):void 0})}})},S=function(e,t,n){return e?void(e.deleted?n():e.verId&&"undefined"!=typeof e.content?t(e):T("bad response: "+e)):void T("no src returned")};this.startMergeMode=function(e){m=e,this.openFile(i)},this.stopMergeMode=function(){m=null};var T=function(){C("handleGetLatestError",[c.GETTING_LATEST]),w(c.RETRYING_GET_LATEST),b=window.setTimeout(function(){e.makeSafeOnError(function(){u==c.RETRYING_GET_LATEST&&A()})},l)},L=6e4,E=_.debounce(function(){WL.ignoreErrors(function(){analytics.track("edits",WL.ui.richText.isEnabled()?"rt":"source")})},L,{maxWait:L,leading:!0});this.poll=function(r,o,l){if(u!=c.READY_WITH_DELETED_FILE){C("poll",[c.READY]),w(c.POLLING),o||E(),r.protocolVersion=t,y+=1;var h=y;v=$.ajax({url:"/docs/"+n+"/srcs/"+i+"/poll.json",type:"POST",data:r,timeout:s,success:function(t){e.makeSafeOnError(function(){if(h==y&&u==c.POLLING)if(t){if(t.reload)return void e.reload(!0);if(t.deleted)return w(c.READY_WITH_DELETED_FILE),p=g=null,void $(a).trigger("connected",[null,null]);if(t.tooLong)return $("#error-alert").trigger("summon").find("p").html("Sorry, with your changes, the file would be too long for our web editor; the limit is currently 1MB. You can still edit the file offline and upload it to the project, but you will not be able to edit it online. We apologise for the inconvenience."),void e.reload(!1);l(t),w(c.READY)}else M(null,"null response",l,o)})},error:function(t,n){e.makeSafeOnError(function(){h==y&&u==c.POLLING&&M(t,n,l,o)})}})}};var M=function(e,t,n,i){C("handlePollError",[c.POLLING]),i?analytics.track("poll error"):analytics.track("poll disconnection"),i?(n(null),w(c.READY)):e&&e.responseJSON&&e.responseJSON.badHistory?WL.errorHandler.makeSafe("bad-history"):($(a).trigger("disconnected"),A())};this.pusher=function(){return d},this.docChannel=function(){return f},this.isReady=function(){return u==c.READY},this.isStopped=function(){return u==c.STOPPED},this.mightHaveUnsavedContent=function(){var e=[c.STOPPED,c.CONNECTING_TO_PUSHER,c.READY_WITH_DELETED_FILE];return!_.include(e,u)},this.stop=function(){u!=c.STOPPED&&(u==c.GETTING_LATEST&&v?v.abort():u==c.RETRYING_GET_LATEST?window.clearTimeout(b):u==c.POLLING&&v&&v.abort(),w(c.STOPPED),d&&(d.disconnect(),d=null),f=null,$(a).trigger("disconnected"))}},WL.Listener=function(e,t,n,i,r){var o=800,a=null,s=!1,l=null,c=null,u=function(){return(new Date).valueOf()},h=function(){clearTimeout(l),l=window.setTimeout(function(){l=null,e.makeSafeOnError(f)},o)};t.on("change",function(){e.makeSafeOnError(function(){!i.updating()&&a&&h()})}),t.on("cursorActivity",function(){e.makeSafeOnError(function(){i.updating()||null===l||h()})}),$(n).bind("initPusher",function(){n.docChannel().bind("new-ver",function(){e.makeSafeOnError(function(){f()})}),n.docChannel().bind("reload",function(){e.makeSafeOnError(function(){e.reload(!1)})})}),$(i).bind("connected",function(){d()}),$(i).bind("retryPoll",function(){s=!0,d()}),$(i).bind("polled",function(){d()}),$(n).bind("disconnected",function(){a=null,clearTimeout(l),l=null});var d=function(){a=u(),s&&(s=!1,f())},f=function(){if(n.isReady()&&a){if(c)return;var t=u()-a;t>=r?i.poll():c=window.setTimeout(function(){c=null,e.makeSafeOnError(f)},r-t)}else s=!0};this.requestPoll=f},WL.Client=function(e,t,n,i){function r(e,t){0===t.line&&0===t.ch?$.removeCookie(o(e)):$.cookie(o(e),JSON.stringify(t),{expires:7})}function o(e){return"wl_cm_cursor_"+e}var a,s=this;this.verId=function(){return a};var l;this.serverText=function(){return l};var c;this.opsSentOnLastPoll=function(){return c};var u=!1;this.updating=function(){return u},$(n).bind("connected",function(i,r,h){if(u=!0,e.editorView.setEditValue(h,n.srcMimeType(),n.srcFile()),u=!1,null===h)return a=r,l="",c=null,void $(s).trigger("connected");a=r,l=h,c=null;var d=$.cookie(o(n.srcId()));d&&p(JSON.parse(d)),t.clearHistory(),e.keymap.updateUndoRedoActions(),WL.ignoreErrors(function(){WL.ios||t.focus()}),$(s).trigger("connected")}),$(n).bind("disconnected",function(){t.setOption("readOnly",!0)}),t.on("cursorActivity",function(){u||WL.ignoreErrors(function(){r(n.srcId(),t.getCursor())})}),this.lastDiffSentWasEmpty=function(){return!c||0===c.length};var h=function(){var e="This Project is out of date";$("#notice").trigger("summon").find("p").html(e)};this.poll=function(){if(i)return void h();var e=WL.diffOps(l,t.getValue()),r={verId:a,diff:WL.opsToDiffString(e),socketId:n.pusher().connection.socket_id};$(s).trigger("polling",r),n.poll(r,0===e.length,function(e){e?(WL.assert(a<=e.latestVerId,"client version "+a+" is ahead of server version "+e.latestVerId),e.diffs?(u=!0,e.diffs.forEach(function(e){var t=WL.diffStringToOps(e);t.length>0&&d(t)}),u=!1):l=WL.applyClientOps(l,c),a=e.latestVerId,c=null,$(s).trigger("polled",e)):$(s).trigger("retryPoll",e)}),c=e};var d=function(e){var n,i=t.getCursor(),r=t.getScrollInfo(),o=t.lineAtHeight(r.top,"local"),a=t.lineAtHeight(r.top+r.clientHeight,"local");n=i.line>=o&&i.line<=a?i:{line:o,ch:0};var s=t.charCoords(n,"local"),c=t.indexFromPos(n),u=[c],h=t.getScrollerElement().scrollTop;l=WL.applyServerOps(e,l,t,u);var d=u[0],f=t.posFromIndex(d),p=t.charCoords(f,"local"),g=p.top-s.top;t.scrollTo(null,h+g),t.clearHistory()};this.upToDate=function(){return l==t.getValue()},this.openFile=function(i){var r=1e3;$("#loading").trigger("summon"),t.setOption("readOnly","true"),s.upToDate()?n.openFile(i):window.setTimeout(function(){e.makeSafeOnError(function(){s.openFile(i)})},r)},this.openFileByNameAtPosition=function(e,i){var o=null;$(".file_src").each(function(){return $(this).data("path")===e?(o=parseInt($(this).data("fileId")),!1):void 0}),o&&(i.highlight=!0,n.srcId()==o?(p(i),WL.ignoreErrors(function(){t.focus()})):(r(o,i),this.openFile(o)))},this.srcId=function(){return n.srcId()};var f="CodeMirror-activeline-background",p=function(e){if(e.line=Math.min(e.line,t.lineCount()-1),t.setCursor(e),t.scrollIntoView(e,parseInt($("#wl_editor .CodeMirror:first").height()/3)),e.highlight===!0){var n=t.getLineHandleVisualStart(e.line);t.addLineClass(n,"background",f),$(".CodeMirror-activeline-background").delay(1e3).fadeTo(300,0,function(){t.removeLineClass(n,"background",f)})}};window.onbeforeunload=function(){return e.forcingReload||!n.mightHaveUnsavedContent()||s.upToDate()||i?void 0:"We haven't finished saving your latest changes yet. If you leave this page now, you may lose your latest changes. Please wait a few seconds and try again."}},"undefined"==typeof PDFJS&&(("undefined"!=typeof window?window:this).PDFJS={}),function(){function e(e,t){return new n(this.slice(e,t))}function t(e,t){arguments.length<2&&(t=0);for(var n=0,i=e.length;i>n;++n,++t)this[t]=255&e[n]}function n(n){var i,r,o;if("number"==typeof n)for(i=[],r=0;n>r;++r)i[r]=0;else if("slice"in n)i=n.slice(0);else for(i=[],r=0,o=n.length;o>r;++r)i[r]=n[r];return i.subarray=e,i.buffer=i,i.byteLength=i.length,i.set=t,"object"==typeof n&&n.buffer&&(i.buffer=n.buffer),i}return"undefined"!=typeof Uint8Array?("undefined"==typeof Uint8Array.prototype.subarray&&(Uint8Array.prototype.subarray=function(e,t){return new Uint8Array(this.slice(e,t))},Float32Array.prototype.subarray=function(e,t){return new Float32Array(this.slice(e,t))}),void("undefined"==typeof Float64Array&&(window.Float64Array=Float32Array))):(window.Uint8Array=n,window.Int8Array=n,window.Uint32Array=n,window.Int32Array=n,window.Uint16Array=n,window.Float32Array=n,void(window.Float64Array=n))}(),function(){window.URL||(window.URL=window.webkitURL)}(),function(){if("undefined"!=typeof Object.defineProperty){var e=!0;try{Object.defineProperty(new Image,"id",{value:"test"});var t=function(){};t.prototype={get id(){}},Object.defineProperty(new t,"id",{value:"",configurable:!0,enumerable:!0,writable:!1})}catch(n){e=!1}if(e)return}Object.defineProperty=function(e,t,n){delete e[t],"get"in n&&e.__defineGetter__(t,n.get),"set"in n&&e.__defineSetter__(t,n.set),"value"in n&&(e.__defineSetter__(t,function(e){return this.__defineGetter__(t,function(){return e}),e}),e[t]=n.value)}}(),function(){var e=XMLHttpRequest.prototype,t=new XMLHttpRequest;return"overrideMimeType"in t||Object.defineProperty(e,"overrideMimeType",{value:function(){}}),"responseType"in t?void 0:(PDFJS.disableWorker=!0,Object.defineProperty(e,"responseType",{get:function(){return this._responseType||"text"},set:function(e){"text"!==e&&"arraybuffer"!==e||(this._responseType=e,"arraybuffer"===e&&"function"==typeof this.overrideMimeType&&this.overrideMimeType("text/plain; charset=x-user-defined"))}}),"undefined"!=typeof VBArray?void Object.defineProperty(e,"response",{get:function(){return"arraybuffer"===this.responseType?new Uint8Array(new VBArray(this.responseBody).toArray()):this.responseText}}):void Object.defineProperty(e,"response",{get:function(){if("arraybuffer"!==this.responseType)return this.responseText;var e,t=this.responseText,n=t.length,i=new Uint8Array(n);for(e=0;n>e;++e)i[e]=255&t.charCodeAt(e);return i.buffer}}))}(),function(){if(!("btoa"in window)){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";window.btoa=function(t){var n,i,r="";for(n=0,i=t.length;i>n;n+=3){var o=255&t.charCodeAt(n),a=255&t.charCodeAt(n+1),s=255&t.charCodeAt(n+2),l=o>>2,c=(3&o)<<4|a>>4,u=i>n+1?(15&a)<<2|s>>6:64,h=i>n+2?63&s:64;r+=e.charAt(l)+e.charAt(c)+e.charAt(u)+e.charAt(h)}return r}}}(),function(){if(!("atob"in window)){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";window.atob=function(t){if(t=t.replace(/=+$/,""),t.length%4===1)throw new Error("bad atob input");for(var n,i,r=0,o=0,a="";i=t.charAt(o++);~i&&(n=r%4?64*n+i:i,r++%4)?a+=String.fromCharCode(255&n>>(-2*r&6)):0)i=e.indexOf(i);return a}}}(),function(){"undefined"==typeof Function.prototype.bind&&(Function.prototype.bind=function(e){var t=this,n=Array.prototype.slice.call(arguments,1),i=function(){var i=n.concat(Array.prototype.slice.call(arguments));return t.apply(e,i)};return i})}(),function(){var e=document.createElement("div");"dataset"in e||Object.defineProperty(HTMLElement.prototype,"dataset",{get:function(){if(this._dataset)return this._dataset;for(var e={},t=0,n=this.attributes.length;n>t;t++){var i=this.attributes[t];if("data-"===i.name.substring(0,5)){var r=i.name.substring(5).replace(/\-([a-z])/g,function(e,t){return t.toUpperCase()});e[r]=i.value}}return Object.defineProperty(this,"_dataset",{value:e,writable:!1,enumerable:!1}),e},enumerable:!0})}(),function(){function e(e,t,n,i){var r=e.className||"",o=r.split(/\s+/g);""===o[0]&&o.shift();var a=o.indexOf(t);return 0>a&&n&&o.push(t),a>=0&&i&&o.splice(a,1),e.className=o.join(" "),a>=0}var t=document.createElement("div");if(!("classList"in t)){var n={add:function(t){e(this.element,t,!0,!1)},contains:function(t){return e(this.element,t,!1,!1)},remove:function(t){e(this.element,t,!1,!0)},toggle:function(t){e(this.element,t,!0,!0)}};Object.defineProperty(HTMLElement.prototype,"classList",{get:function(){if(this._classList)return this._classList;var e=Object.create(n,{element:{value:this,writable:!1,enumerable:!0}});return Object.defineProperty(this,"_classList",{value:e,writable:!1,enumerable:!1}),e},enumerable:!0})}}(),function(){"console"in window?"bind"in console.log||(console.log=function(e){return function(t){return e(t)}}(console.log),console.error=function(e){return function(t){return e(t)}}(console.error),console.warn=function(e){return function(t){return e(t)}}(console.warn)):window.console={log:function(){},error:function(){},warn:function(){}}}(),function(){function e(e){t(e.target)&&e.stopPropagation()}function t(e){return e.disabled||e.parentNode&&t(e.parentNode)}-1!==navigator.userAgent.indexOf("Opera")&&document.addEventListener("click",e,!0)}(),function(){navigator.userAgent.indexOf("Trident")>=0&&(PDFJS.disableCreateObjectURL=!0)}(),function(){function e(e){var t=e.split(/[-_]/);return t[0]=t[0].toLowerCase(),t.length>1&&(t[1]=t[1].toUpperCase()),t.join("-")}if(!("language"in navigator&&/^[a-z]+(-[A-Z]+)?$/.test(navigator.language))){var t=navigator.language||navigator.userLanguage||"en-US";PDFJS.locale=e(t)}}(),function(){var e=Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0,t=/Android\s[0-2][^\d]/,n=t.test(navigator.userAgent);(e||n)&&(PDFJS.disableRange=!0,PDFJS.disableStream=!0)}(),function(){(!history.pushState||navigator.userAgent.indexOf("Android 2.")>=0)&&(PDFJS.disableHistory=!0)}(),function(){if(window.CanvasPixelArray)"function"!=typeof window.CanvasPixelArray.prototype.set&&(window.CanvasPixelArray.prototype.set=function(e){for(var t=0,n=this.length;n>t;t++)this[t]=e[t]});else{var e,t=!1;if(navigator.userAgent.indexOf("Chrom")>=0?(e=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./),t=e&&parseInt(e[2])<21):navigator.userAgent.indexOf("Android")>=0?t=/Android\s[0-4][^\d]/g.test(navigator.userAgent):navigator.userAgent.indexOf("Safari")>=0&&(e=navigator.userAgent.match(/Version\/([0-9]+)\.([0-9]+)\.([0-9]+) Safari\//),t=e&&parseInt(e[1])<6),t){var n=window.CanvasRenderingContext2D.prototype;n._createImageData=n.createImageData,n.createImageData=function(e,t){var n=this._createImageData(e,t);return n.data.set=function(e){for(var t=0,n=this.length;n>t;t++)this[t]=e[t]},n}}}}(),function(){function e(e){window.setTimeout(e,20)}var t=/(iPad|iPhone|iPod)/g.test(navigator.userAgent);return t?void(window.requestAnimationFrame=e):void("requestAnimationFrame"in window||(window.requestAnimationFrame=window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||e))}(),function(){var e=/(iPad|iPhone|iPod)/g.test(navigator.userAgent),t=/Android/g.test(navigator.userAgent);(e||t)&&(PDFJS.maxCanvasPixels=5242880)}(),/* Copyright 2012 Mozilla Foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(e,t){"use strict";"function"==typeof define&&define.amd?define("pdfjs-dist/build/pdf",["exports"],t):t("undefined"!=typeof exports?exports:e.pdfjsDistBuildPdf={})}(this,function(e){"use strict";var t="1.4.20",n="b15f335",i="undefined"!=typeof document&&document.currentScript?document.currentScript.src:null,r={};(function(){!function(e,t){t(e.pdfjsSharedGlobal={})}(this,function(e){var i="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,r="undefined"==typeof window;i.PDFJS||(i.PDFJS={}),"undefined"!=typeof t&&(i.PDFJS.version=t),"undefined"!=typeof t&&(i.PDFJS.build=n),i.PDFJS.pdfBug=!1,e.globalScope=i,e.isWorker=r,e.PDFJS=i.PDFJS}),function(e,t){t(e.pdfjsDisplayDOMUtils={},e.pdfjsSharedGlobal)}(this,function(e,t){var n=t.PDFJS,i=function(){function e(){}var t=["ms","Moz","Webkit","O"],n={};return e.getProp=function(e,i){if(1===arguments.length&&"string"==typeof n[e])return n[e];i=i||document.documentElement;var r,o,a=i.style;if("string"==typeof a[e])return n[e]=e;o=e.charAt(0).toUpperCase()+e.slice(1);for(var s=0,l=t.length;l>s;s++)if(r=t[s]+o,"string"==typeof a[r])return n[e]=r;return n[e]="undefined"},e.setProp=function(e,t,n){var i=this.getProp(e);"undefined"!==i&&(t.style[i]=n)},e}();n.CustomStyle=i,e.CustomStyle=i}),function(e,t){t(e.pdfjsSharedUtil={},e.pdfjsSharedGlobal)}(this,function(e,t){function n(e){D.verbosity>=D.VERBOSITY_LEVELS.infos&&console.log("Info: "+e)}function i(e){D.verbosity>=D.VERBOSITY_LEVELS.warnings&&console.log("Warning: "+e)}function r(e){i("Deprecated API usage: "+e)}function o(e){throw D.verbosity>=D.VERBOSITY_LEVELS.errors&&(console.log("Error: "+e),console.log(a())),new Error(e)}function a(){try{throw new Error}catch(e){return e.stack?e.stack.split("\n").slice(2).join("\n"):""}}function s(e,t){e||o(t)}function l(e,t){return t?new URL(t,e).href:e}function c(e,t){if(!e)return!1;var n=/^[a-z][a-z0-9+\-.]*(?=:)/i.exec(e);if(!n)return t;switch(n=n[0].toLowerCase()){case"http":case"https":case"ftp":case"mailto":case"tel":return!0;default:return!1}}function u(e,t){var n=t&&t.url;e.href=e.title=n?f(n):"",n&&(d()&&(e.target=V[D.externalLinkTarget]),e.rel=D.externalLinkRel)}function h(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!1}),n}function d(){switch(D.openExternalLinksInNewWindow&&(r('PDFJS.openExternalLinksInNewWindow, please use "PDFJS.externalLinkTarget = PDFJS.LinkTarget.BLANK" instead.'),D.externalLinkTarget===K.NONE&&(D.externalLinkTarget=K.BLANK),D.openExternalLinksInNewWindow=!1),D.externalLinkTarget){case K.NONE:return!1;case K.SELF:case K.BLANK:case K.PARENT:case K.TOP:return!0}return i("PDFJS.externalLinkTarget is invalid: "+D.externalLinkTarget),D.externalLinkTarget=K.NONE,!1}function f(e){return"string"!=typeof e?(i("The argument for removeNullCharacters must be a string."),e):e.replace(oe,"")}function p(e){s(null!==e&&"object"==typeof e&&void 0!==e.length,"Invalid argument for bytesToString");var t=e.length,n=8192;if(n>t)return String.fromCharCode.apply(null,e);for(var i=[],r=0;t>r;r+=n){var o=Math.min(r+n,t),a=e.subarray(r,o);i.push(String.fromCharCode.apply(null,a))}return i.join("")}function g(e){s("string"==typeof e,"Invalid argument for stringToBytes");for(var t=e.length,n=new Uint8Array(t),i=0;t>i;++i)n[i]=255&e.charCodeAt(i);return n}function m(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,255&e)}function v(e){for(var t=1,n=0;e>t;)t<<=1,n++;return n}function y(e,t){return e[t]<<24>>24}function b(e,t){return e[t]<<8|e[t+1]}function w(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}function C(){var e=new Uint8Array(2);e[0]=1;var t=new Uint16Array(e.buffer);return 1===t[0]}function x(){var e=document.createElement("canvas");e.width=e.height=1;var t=e.getContext("2d"),n=t.createImageData(1,1);return"undefined"!=typeof n.data.buffer}function k(e){var t,n=e.length,i=[];if("\xfe"===e[0]&&"\xff"===e[1])for(t=2;n>t;t+=2)i.push(String.fromCharCode(e.charCodeAt(t)<<8|e.charCodeAt(t+1)));else for(t=0;n>t;++t){var r=ce[e.charCodeAt(t)];i.push(r?String.fromCharCode(r):e.charAt(t))}return i.join("")}function _(e){return decodeURIComponent(escape(e))}function A(e){return unescape(encodeURIComponent(e))}function S(e){for(var t in e)return!1;return!0}function T(e){return"boolean"==typeof e}function L(e){return"number"==typeof e&&(0|e)===e}function E(e){return"number"==typeof e}function M(e){return"string"==typeof e}function P(e){return e instanceof Array}function R(e){return"object"==typeof e&&null!==e&&void 0!==e.byteLength}function I(){var e={};return e.promise=new Promise(function(t,n){e.resolve=t,e.reject=n}),e}function $(e,t,n){this.sourceName=e,this.targetName=t,this.comObj=n,this.callbackIndex=1,this.postMessageTransfers=!0;var i=this.callbacksCapabilities={},r=this.actionHandler={};this._onComObjOnMessage=function(e){var t=e.data;if(t.targetName===this.sourceName)if(t.isReply){var a=t.callbackId;if(t.callbackId in i){var s=i[a];delete i[a],"error"in t?s.reject(t.error):s.resolve(t.data)}else o("Cannot resolve callback "+a)}else if(t.action in r){var l=r[t.action];if(t.callbackId){var c=this.sourceName,u=t.sourceName;Promise.resolve().then(function(){return l[0].call(l[1],t.data)}).then(function(e){n.postMessage({sourceName:c,targetName:u,isReply:!0,callbackId:t.callbackId,data:e})},function(e){e instanceof Error&&(e+=""),n.postMessage({sourceName:c,targetName:u,isReply:!0,callbackId:t.callbackId,error:e})})}else l[0].call(l[1],t.data)}else o("Unknown action from worker: "+t.action)}.bind(this),n.addEventListener("message",this._onComObjOnMessage)}function O(e,t,n){var r=new Image;r.onload=function(){n.resolve(e,r)},r.onerror=function(){n.resolve(e,null),i("Error during JPEG image loading")},r.src=t}var D=t.PDFJS,F=t.globalScope,N=[.001,0,0,.001,0,0],W={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},j={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},H={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},B={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512},U={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},z={UNKNOWN:0,FLATE:1,LZW:2,DCT:3,JPX:4,JBIG:5,A85:6,AHX:7,CCF:8,RL:9},G={UNKNOWN:0,TYPE1:1,TYPE1C:2,CIDFONTTYPE0:3,CIDFONTTYPE0C:4,TRUETYPE:5,CIDFONTTYPE2:6,TYPE3:7,OPENTYPE:8,TYPE0:9,MMTYPE1:10};D.VERBOSITY_LEVELS={errors:0,warnings:1,infos:5};var q=D.OPS={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotations:78,endAnnotations:79,beginAnnotation:80,endAnnotation:81,paintJpegXObject:82,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91},Y=D.UNSUPPORTED_FEATURES={unknown:"unknown",forms:"forms",javaScript:"javaScript",smask:"smask",shadingPattern:"shadingPattern",font:"font"};D.isValidUrl=c,D.addLinkAttributes=u,D.shadow=h;var K=D.LinkTarget={NONE:0,SELF:1,BLANK:2,PARENT:3,TOP:4},V=["","_self","_blank","_parent","_top"];D.isExternalLinkTargetSet=d;var X=D.PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},J=function(){function e(e,t){this.name="PasswordException",this.message=e,this.code=t}return e.prototype=new Error,e.constructor=e,e}();D.PasswordException=J;var Q=function(){function e(e,t){this.name="UnknownErrorException",this.message=e,this.details=t}return e.prototype=new Error,e.constructor=e,e}();D.UnknownErrorException=Q;var Z=function(){function e(e){this.name="InvalidPDFException",this.message=e}return e.prototype=new Error,e.constructor=e,e}();D.InvalidPDFException=Z;var ee=function(){function e(e){this.name="MissingPDFException",this.message=e}return e.prototype=new Error,e.constructor=e,e}();D.MissingPDFException=ee;var te=function(){function e(e,t){this.name="UnexpectedResponseException",this.message=e,this.status=t}return e.prototype=new Error,e.constructor=e,e}();D.UnexpectedResponseException=te;var ne=function(){function e(e){this.message=e}return e.prototype=new Error,e.prototype.name="NotImplementedException",e.constructor=e,e}(),ie=function(){function e(e,t){this.begin=e,this.end=t,this.message="Missing data ["+e+", "+t+")"}return e.prototype=new Error,e.prototype.name="MissingDataException",e.constructor=e,e}(),re=function(){function e(e){this.message=e}return e.prototype=new Error,e.prototype.name="XRefParseException",e.constructor=e,e}(),oe=/\x00/g;D.removeNullCharacters=f,Object.defineProperty(D,"isLittleEndian",{configurable:!0,get:function(){return h(D,"isLittleEndian",C())}}),Object.defineProperty(D,"hasCanvasTypedArrays",{configurable:!0,get:function(){return h(D,"hasCanvasTypedArrays",x())}});var ae=function(){function e(e,t){this.buffer=e,this.byteLength=e.length,this.length=void 0===t?this.byteLength>>2:t,n(this.length)}function t(e){return{get:function(){var t=this.buffer,n=e<<2;return(t[n]|t[n+1]<<8|t[n+2]<<16|t[n+3]<<24)>>>0},set:function(t){var n=this.buffer,i=e<<2;n[i]=255&t,n[i+1]=t>>8&255,n[i+2]=t>>16&255,n[i+3]=t>>>24&255}}}function n(n){for(;n>i;)Object.defineProperty(e.prototype,i,t(i)),i++}e.prototype=Object.create(null);var i=0;return e}();e.Uint32ArrayView=ae;var se=[1,0,0,1,0,0],le=D.Util=function(){function e(){}var t=["rgb(",0,",",0,",",0,")"];e.makeCssRgb=function(e,n,i){return t[1]=e,t[3]=n,t[5]=i,t.join("")},e.transform=function(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]},e.applyTransform=function(e,t){var n=e[0]*t[0]+e[1]*t[2]+t[4],i=e[0]*t[1]+e[1]*t[3]+t[5];return[n,i]},e.applyInverseTransform=function(e,t){var n=t[0]*t[3]-t[1]*t[2],i=(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/n,r=(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/n;return[i,r]},e.getAxialAlignedBoundingBox=function(t,n){var i=e.applyTransform(t,n),r=e.applyTransform(t.slice(2,4),n),o=e.applyTransform([t[0],t[3]],n),a=e.applyTransform([t[2],t[1]],n);return[Math.min(i[0],r[0],o[0],a[0]),Math.min(i[1],r[1],o[1],a[1]),Math.max(i[0],r[0],o[0],a[0]),Math.max(i[1],r[1],o[1],a[1])]},e.inverseTransform=function(e){var t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]},e.apply3dTransform=function(e,t){return[e[0]*t[0]+e[1]*t[1]+e[2]*t[2],e[3]*t[0]+e[4]*t[1]+e[5]*t[2],e[6]*t[0]+e[7]*t[1]+e[8]*t[2]]},e.singularValueDecompose2dScale=function(e){var t=[e[0],e[2],e[1],e[3]],n=e[0]*t[0]+e[1]*t[2],i=e[0]*t[1]+e[1]*t[3],r=e[2]*t[0]+e[3]*t[2],o=e[2]*t[1]+e[3]*t[3],a=(n+o)/2,s=Math.sqrt((n+o)*(n+o)-4*(n*o-r*i))/2,l=a+s||1,c=a-s||1;return[Math.sqrt(l),Math.sqrt(c)]},e.normalizeRect=function(e){var t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t},e.intersect=function(t,n){function i(e,t){return e-t}var r=[t[0],t[2],n[0],n[2]].sort(i),o=[t[1],t[3],n[1],n[3]].sort(i),a=[];return t=e.normalizeRect(t),n=e.normalizeRect(n),r[0]===t[0]&&r[1]===n[0]||r[0]===n[0]&&r[1]===t[0]?(a[0]=r[1],a[2]=r[2],o[0]===t[1]&&o[1]===n[1]||o[0]===n[1]&&o[1]===t[1]?(a[1]=o[1],a[3]=o[2],a):!1):!1},e.sign=function(e){return 0>e?-1:1};var n=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];return e.toRoman=function(e,t){s(L(e)&&e>0,"The number should be a positive integer.");for(var i,r=[];e>=1e3;)e-=1e3,r.push("M");i=e/100|0,e%=100,r.push(n[i]),i=e/10|0,e%=10,r.push(n[10+i]),r.push(n[20+e]);var o=r.join("");return t?o.toLowerCase():o},e.appendToArray=function(e,t){Array.prototype.push.apply(e,t)},e.prependToArray=function(e,t){Array.prototype.unshift.apply(e,t)},e.extendObj=function(e,t){for(var n in t)e[n]=t[n]},e.getInheritableProperty=function(e,t){for(;e&&!e.has(t);)e=e.get("Parent");return e?e.get(t):null},e.inherit=function(e,t,n){e.prototype=Object.create(t.prototype),e.prototype.constructor=e;for(var i in n)e.prototype[i]=n[i]},e.loadScript=function(e,t){var n=document.createElement("script"),i=!1;n.setAttribute("src",e),t&&(n.onload=function(){i||t(),i=!0}),document.getElementsByTagName("head")[0].appendChild(n)},e}(),ce=(D.PageViewport=function(){function e(e,t,n,i,r,o){this.viewBox=e,this.scale=t,this.rotation=n,this.offsetX=i,this.offsetY=r;var a,s,l,c,u=(e[2]+e[0])/2,h=(e[3]+e[1])/2;switch(n%=360,n=0>n?n+360:n){case 180:a=-1,s=0,l=0,c=1;break;case 90:a=0,s=1,l=1,c=0;break;case 270:a=0,s=-1,l=-1,c=0;break;default:a=1,s=0,l=0,c=-1}o&&(l=-l,c=-c);var d,f,p,g;0===a?(d=Math.abs(h-e[1])*t+i,f=Math.abs(u-e[0])*t+r,p=Math.abs(e[3]-e[1])*t,g=Math.abs(e[2]-e[0])*t):(d=Math.abs(u-e[0])*t+i,f=Math.abs(h-e[1])*t+r,p=Math.abs(e[2]-e[0])*t,g=Math.abs(e[3]-e[1])*t),this.transform=[a*t,s*t,l*t,c*t,d-a*t*u-l*t*h,f-s*t*u-c*t*h],this.width=p,this.height=g,this.fontScale=t}return e.prototype={clone:function(t){t=t||{};var n="scale"in t?t.scale:this.scale,i="rotation"in t?t.rotation:this.rotation;return new e(this.viewBox.slice(),n,i,this.offsetX,this.offsetY,t.dontFlip)},convertToViewportPoint:function(e,t){return le.applyTransform([e,t],this.transform)},convertToViewportRectangle:function(e){var t=le.applyTransform([e[0],e[1]],this.transform),n=le.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],n[0],n[1]]},convertToPdfPoint:function(e,t){return le.applyInverseTransform([e,t],this.transform)}},e}(),[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364]);D.createPromiseCapability=I,function(){function e(e){this._status=t,this._handlers=[];try{e.call(this,this._resolve.bind(this),this._reject.bind(this))}catch(n){this._reject(n)}}if(F.Promise)return"function"!=typeof F.Promise.all&&(F.Promise.all=function(e){var t,n,i=0,r=[],o=new F.Promise(function(e,i){t=e,n=i});return e.forEach(function(e,o){i++,e.then(function(e){r[o]=e,i--,0===i&&t(r)},n)}),0===i&&t(r),o}),"function"!=typeof F.Promise.resolve&&(F.Promise.resolve=function(e){return new F.Promise(function(t){t(e)})}),"function"!=typeof F.Promise.reject&&(F.Promise.reject=function(e){return new F.Promise(function(t,n){n(e)})}),void("function"!=typeof F.Promise.prototype["catch"]&&(F.Promise.prototype["catch"]=function(e){return F.Promise.prototype.then(void 0,e)}));var t=0,n=1,r=2,o=500,a={handlers:[],running:!1,unhandledRejections:[],pendingRejectionCheck:!1,scheduleHandlers:function(e){e._status!==t&&(this.handlers=this.handlers.concat(e._handlers),e._handlers=[],this.running||(this.running=!0,setTimeout(this.runHandlers.bind(this),0)))},runHandlers:function(){for(var e=1,t=Date.now()+e;this.handlers.length>0;){var i=this.handlers.shift(),o=i.thisPromise._status,a=i.thisPromise._value;try{o===n?"function"==typeof i.onResolve&&(a=i.onResolve(a)):"function"==typeof i.onReject&&(a=i.onReject(a),o=n,i.thisPromise._unhandledRejection&&this.removeUnhandeledRejection(i.thisPromise))}catch(s){o=r,a=s}if(i.nextPromise._updateStatus(o,a),Date.now()>=t)break}return this.handlers.length>0?void setTimeout(this.runHandlers.bind(this),0):void(this.running=!1)},addUnhandledRejection:function(e){this.unhandledRejections.push({promise:e,time:Date.now()}),this.scheduleRejectionCheck()},removeUnhandeledRejection:function(e){e._unhandledRejection=!1;for(var t=0;t<this.unhandledRejections.length;t++)this.unhandledRejections[t].promise===e&&(this.unhandledRejections.splice(t),t--)},scheduleRejectionCheck:function(){this.pendingRejectionCheck||(this.pendingRejectionCheck=!0,setTimeout(function(){this.pendingRejectionCheck=!1;for(var e=Date.now(),t=0;t<this.unhandledRejections.length;t++)if(e-this.unhandledRejections[t].time>o){var n=this.unhandledRejections[t].promise._value,r="Unhandled rejection: "+n;n.stack&&(r+="\n"+n.stack),i(r),this.unhandledRejections.splice(t),t--}this.unhandledRejections.length&&this.scheduleRejectionCheck()}.bind(this),o))}};e.all=function(t){function n(e){a._status!==r&&(l=[],o(e))}var i,o,a=new e(function(e,t){i=e,o=t}),s=t.length,l=[];if(0===s)return i(l),a;for(var c=0,u=t.length;u>c;++c){var h=t[c],d=function(e){return function(t){a._status!==r&&(l[e]=t,s--,0===s&&i(l))}}(c);e.isPromise(h)?h.then(d,n):d(h)}return a},e.isPromise=function(e){return e&&"function"==typeof e.then},e.resolve=function(t){return new e(function(e){e(t)})},e.reject=function(t){return new e(function(e,n){n(t)})},e.prototype={_status:null,_value:null,_handlers:null,_unhandledRejection:null,_updateStatus:function(t,i){if(this._status!==n&&this._status!==r){if(t===n&&e.isPromise(i))return void i.then(this._updateStatus.bind(this,n),this._updateStatus.bind(this,r));this._status=t,this._value=i,t===r&&0===this._handlers.length&&(this._unhandledRejection=!0,a.addUnhandledRejection(this)),a.scheduleHandlers(this)}},_resolve:function(e){this._updateStatus(n,e)},_reject:function(e){this._updateStatus(r,e)},then:function(t,n){var i=new e(function(e,t){this.resolve=e,this.reject=t});return this._handlers.push({thisPromise:this,onResolve:t,onReject:n,nextPromise:i}),a.scheduleHandlers(this),i},"catch":function(e){return this.then(void 0,e)}},F.Promise=e}();var ue=function(){function e(e,t,n){for(;e.length<n;)e+=t;return e}function t(){this.started={},this.times=[],this.enabled=!0}return t.prototype={time:function(e){this.enabled&&(e in this.started&&i("Timer is already running for "+e),this.started[e]=Date.now())},timeEnd:function(e){this.enabled&&(e in this.started||i("Timer has not been started for "+e),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e])},toString:function(){var t,n,i=this.times,r="",o=0;for(t=0,n=i.length;n>t;++t){var a=i[t].name;a.length>o&&(o=a.length)}for(t=0,n=i.length;n>t;++t){var s=i[t],l=s.end-s.start;r+=e(s.name," ",o)+" "+l+"ms\n"}return r}},t}();D.createBlob=function(e,t){if("undefined"!=typeof Blob)return new Blob([e],{type:t});var n=new MozBlobBuilder;return n.append(e),n.getBlob(t)},D.createObjectURL=function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return function(t,n){if(!D.disableCreateObjectURL&&"undefined"!=typeof URL&&URL.createObjectURL){var i=D.createBlob(t,n);return URL.createObjectURL(i)}for(var r="data:"+n+";base64,",o=0,a=t.length;a>o;o+=3){var s=255&t[o],l=255&t[o+1],c=255&t[o+2],u=s>>2,h=(3&s)<<4|l>>4,d=a>o+1?(15&l)<<2|c>>6:64,f=a>o+2?63&c:64;r+=e[u]+e[h]+e[d]+e[f]}return r}}(),$.prototype={on:function(e,t,n){var i=this.actionHandler;i[e]&&o('There is already an actionName called "'+e+'"'),i[e]=[t,n]},send:function(e,t,n){var i={sourceName:this.sourceName,targetName:this.targetName,action:e,data:t};this.postMessage(i,n)},sendWithPromise:function(e,t,n){var i=this.callbackIndex++,r={sourceName:this.sourceName,targetName:this.targetName,action:e,data:t,callbackId:i},o=I();this.callbacksCapabilities[i]=o;try{this.postMessage(r,n)}catch(a){o.reject(a)}return o.promise},postMessage:function(e,t){t&&this.postMessageTransfers?this.comObj.postMessage(e,t):this.comObj.postMessage(e)},destroy:function(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}},/* Any copyright is dedicated to the Public Domain.
 * http://creativecommons.org/publicdomain/zero/1.0/ */
function(e){function t(e){return void 0!==d[e]}function n(){s.call(this),this._isInvalid=!0}function i(e){return""==e&&n.call(this),e.toLowerCase()}function r(e){var t=e.charCodeAt(0);return t>32&&127>t&&-1==[34,35,60,62,63,96].indexOf(t)?e:encodeURIComponent(e)}function o(e){var t=e.charCodeAt(0);return t>32&&127>t&&-1==[34,35,60,62,96].indexOf(t)?e:encodeURIComponent(e)}function a(e,a,s){function l(e){b.push(e)}var c=a||"scheme start",u=0,h="",v=!1,y=!1,b=[];e:for(;(e[u-1]!=p||0==u)&&!this._isInvalid;){var w=e[u];switch(c){case"scheme start":if(!w||!g.test(w)){if(a){l("Invalid scheme.");break e}h="",c="no scheme";continue}h+=w.toLowerCase(),c="scheme";break;case"scheme":if(w&&m.test(w))h+=w.toLowerCase();else{if(":"!=w){if(a){if(p==w)break e;l("Code point not allowed in scheme: "+w);break e}h="",u=0,c="no scheme";continue}if(this._scheme=h,h="",a)break e;t(this._scheme)&&(this._isRelative=!0),c="file"==this._scheme?"relative":this._isRelative&&s&&s._scheme==this._scheme?"relative or authority":this._isRelative?"authority first slash":"scheme data"}break;case"scheme data":"?"==w?(this._query="?",c="query"):"#"==w?(this._fragment="#",c="fragment"):p!=w&&"	"!=w&&"\n"!=w&&"\r"!=w&&(this._schemeData+=r(w));break;case"no scheme":if(s&&t(s._scheme)){c="relative";continue}l("Missing scheme."),n.call(this);break;case"relative or authority":if("/"!=w||"/"!=e[u+1]){l("Expected /, got: "+w),c="relative";continue}c="authority ignore slashes";break;case"relative":if(this._isRelative=!0,"file"!=this._scheme&&(this._scheme=s._scheme),p==w){this._host=s._host,this._port=s._port,this._path=s._path.slice(),this._query=s._query,this._username=s._username,this._password=s._password;break e}if("/"==w||"\\"==w)"\\"==w&&l("\\ is an invalid code point."),c="relative slash";else if("?"==w)this._host=s._host,this._port=s._port,this._path=s._path.slice(),this._query="?",this._username=s._username,this._password=s._password,c="query";else{if("#"!=w){var C=e[u+1],x=e[u+2];("file"!=this._scheme||!g.test(w)||":"!=C&&"|"!=C||p!=x&&"/"!=x&&"\\"!=x&&"?"!=x&&"#"!=x)&&(this._host=s._host,this._port=s._port,this._username=s._username,this._password=s._password,this._path=s._path.slice(),this._path.pop()),c="relative path";continue}this._host=s._host,this._port=s._port,this._path=s._path.slice(),this._query=s._query,this._fragment="#",this._username=s._username,this._password=s._password,c="fragment"}break;case"relative slash":if("/"!=w&&"\\"!=w){"file"!=this._scheme&&(this._host=s._host,this._port=s._port,this._username=s._username,this._password=s._password),c="relative path";continue}"\\"==w&&l("\\ is an invalid code point."),c="file"==this._scheme?"file host":"authority ignore slashes";break;case"authority first slash":if("/"!=w){l("Expected '/', got: "+w),c="authority ignore slashes";continue}c="authority second slash";break;case"authority second slash":if(c="authority ignore slashes","/"!=w){l("Expected '/', got: "+w);continue}break;case"authority ignore slashes":if("/"!=w&&"\\"!=w){c="authority";continue}l("Expected authority, got: "+w);break;case"authority":if("@"==w){v&&(l("@ already seen."),h+="%40"),v=!0;for(var k=0;k<h.length;k++){var _=h[k];if("	"!=_&&"\n"!=_&&"\r"!=_)if(":"!=_||null!==this._password){var A=r(_);null!==this._password?this._password+=A:this._username+=A}else this._password="";else l("Invalid whitespace in authority.")}h=""}else{if(p==w||"/"==w||"\\"==w||"?"==w||"#"==w){u-=h.length,h="",c="host";continue}h+=w}break;case"file host":if(p==w||"/"==w||"\\"==w||"?"==w||"#"==w){2!=h.length||!g.test(h[0])||":"!=h[1]&&"|"!=h[1]?0==h.length?c="relative path start":(this._host=i.call(this,h),h="",c="relative path start"):c="relative path";continue}"	"==w||"\n"==w||"\r"==w?l("Invalid whitespace in file host."):h+=w;break;case"host":case"hostname":if(":"!=w||y){if(p==w||"/"==w||"\\"==w||"?"==w||"#"==w){if(this._host=i.call(this,h),h="",c="relative path start",a)break e;continue}"	"!=w&&"\n"!=w&&"\r"!=w?("["==w?y=!0:"]"==w&&(y=!1),h+=w):l("Invalid code point in host/hostname: "+w)}else if(this._host=i.call(this,h),h="",c="port","hostname"==a)break e;break;case"port":if(/[0-9]/.test(w))h+=w;else{if(p==w||"/"==w||"\\"==w||"?"==w||"#"==w||a){if(""!=h){var S=parseInt(h,10);S!=d[this._scheme]&&(this._port=S+""),h=""}if(a)break e;c="relative path start";continue}"	"==w||"\n"==w||"\r"==w?l("Invalid code point in port: "+w):n.call(this)}break;case"relative path start":if("\\"==w&&l("'\\' not allowed in path."),c="relative path","/"!=w&&"\\"!=w)continue;break;case"relative path":if(p!=w&&"/"!=w&&"\\"!=w&&(a||"?"!=w&&"#"!=w))"	"!=w&&"\n"!=w&&"\r"!=w&&(h+=r(w));else{"\\"==w&&l("\\ not allowed in relative path.");var T;(T=f[h.toLowerCase()])&&(h=T),".."==h?(this._path.pop(),"/"!=w&&"\\"!=w&&this._path.push("")):"."==h&&"/"!=w&&"\\"!=w?this._path.push(""):"."!=h&&("file"==this._scheme&&0==this._path.length&&2==h.length&&g.test(h[0])&&"|"==h[1]&&(h=h[0]+":"),this._path.push(h)),h="","?"==w?(this._query="?",c="query"):"#"==w&&(this._fragment="#",c="fragment")}break;case"query":a||"#"!=w?p!=w&&"	"!=w&&"\n"!=w&&"\r"!=w&&(this._query+=o(w)):(this._fragment="#",c="fragment");break;case"fragment":p!=w&&"	"!=w&&"\n"!=w&&"\r"!=w&&(this._fragment+=w)}u++}}function s(){this._scheme="",this._schemeData="",this._username="",this._password=null,this._host="",this._port="",this._path=[],this._query="",this._fragment="",this._isInvalid=!1,this._isRelative=!1}function l(e,t){void 0===t||t instanceof l||(t=new l(String(t))),this._url=e,s.call(this);var n=e.replace(/^[ \t\r\n\f]+|[ \t\r\n\f]+$/g,"");a.call(this,n,null,t)}var c=!1;try{if("function"==typeof URL&&"object"==typeof URL.prototype&&"origin"in URL.prototype){var u=new URL("b","http://a");u.pathname="c%20d",c="http://a/c%20d"===u.href}}catch(h){}if(!c){var d=Object.create(null);d.ftp=21,d.file=0,d.gopher=70,d.http=80,d.https=443,d.ws=80,d.wss=443;var f=Object.create(null);f["%2e"]=".",f[".%2e"]="..",f["%2e."]="..",f["%2e%2e"]="..";var p=void 0,g=/[a-zA-Z]/,m=/[a-zA-Z0-9\+\-\.]/;l.prototype={toString:function(){return this.href},get href(){if(this._isInvalid)return this._url;var e="";return""==this._username&&null==this._password||(e=this._username+(null!=this._password?":"+this._password:"")+"@"),this.protocol+(this._isRelative?"//"+e+this.host:"")+this.pathname+this._query+this._fragment},set href(e){s.call(this),a.call(this,e)},get protocol(){return this._scheme+":"},set protocol(e){this._isInvalid||a.call(this,e+":","scheme start")},get host(){return this._isInvalid?"":this._port?this._host+":"+this._port:this._host},set host(e){!this._isInvalid&&this._isRelative&&a.call(this,e,"host")},get hostname(){return this._host},set hostname(e){!this._isInvalid&&this._isRelative&&a.call(this,e,"hostname")},get port(){return this._port},set port(e){!this._isInvalid&&this._isRelative&&a.call(this,e,"port")},get pathname(){return this._isInvalid?"":this._isRelative?"/"+this._path.join("/"):this._schemeData},set pathname(e){!this._isInvalid&&this._isRelative&&(this._path=[],a.call(this,e,"relative path start"))},get search(){return this._isInvalid||!this._query||"?"==this._query?"":this._query},set search(e){!this._isInvalid&&this._isRelative&&(this._query="?","?"==e[0]&&(e=e.slice(1)),a.call(this,e,"query"))},get hash(){return this._isInvalid||!this._fragment||"#"==this._fragment?"":this._fragment},set hash(e){this._isInvalid||(this._fragment="#","#"==e[0]&&(e=e.slice(1)),a.call(this,e,"fragment"))},get origin(){var e;if(this._isInvalid||!this._scheme)return"";switch(this._scheme){case"data":case"file":case"javascript":case"mailto":return"null"}return e=this.host,e?this._scheme+"://"+e:""}};var v=e.URL;v&&(l.createObjectURL=function(){return v.createObjectURL.apply(v,arguments)},l.revokeObjectURL=function(e){v.revokeObjectURL(e)}),e.URL=l}}(F),e.FONT_IDENTITY_MATRIX=N,e.IDENTITY_MATRIX=se,e.OPS=q,e.UNSUPPORTED_FEATURES=Y,e.AnnotationBorderStyleType=U,e.AnnotationFlag=B,e.AnnotationType=H,e.FontType=G,e.ImageKind=j,e.InvalidPDFException=Z,e.LinkTarget=K,e.LinkTargetStringMap=V,e.MessageHandler=$,e.MissingDataException=ie,e.MissingPDFException=ee,e.NotImplementedException=ne,e.PasswordException=J,e.PasswordResponses=X,e.StatTimer=ue,e.StreamType=z,e.TextRenderingMode=W,e.UnexpectedResponseException=te,e.UnknownErrorException=Q,e.Util=le,e.XRefParseException=re,e.assert=s,e.bytesToString=p,e.combineUrl=l,e.createPromiseCapability=I,e.deprecated=r,e.error=o,e.info=n,e.isArray=P,e.isArrayBuffer=R,e.isBool=T,e.isEmptyObj=S,e.isExternalLinkTargetSet=d,e.isInt=L,e.isNum=E,e.isString=M,e.isValidUrl=c,e.addLinkAttributes=u,e.loadJpegStream=O,e.log2=v,e.readInt8=y,e.readUint16=b,e.readUint32=w,e.removeNullCharacters=f,e.shadow=h,e.string32=m,e.stringToBytes=g,e.stringToPDFString=k,e.stringToUTF8String=_,e.utf8StringToString=A,e.warn=i}),function(e,t){t(e.pdfjsDisplayAnnotationLayer={},e.pdfjsSharedUtil,e.pdfjsDisplayDOMUtils)}(this,function(e,t,n){function i(){}var r=t.AnnotationBorderStyleType,o=t.AnnotationType,a=t.Util,s=t.addLinkAttributes,l=t.warn,c=n.CustomStyle;i.prototype={create:function(e){var t=e.data.annotationType;switch(t){case o.LINK:return new h(e);case o.TEXT:return new d(e);case o.WIDGET:return new f(e);case o.POPUP:return new p(e);case o.HIGHLIGHT:return new m(e);case o.UNDERLINE:return new v(e);case o.SQUIGGLY:return new y(e);case o.STRIKEOUT:return new b(e);default:throw new Error('Unimplemented annotation type "'+t+'"')}}};var u=function(){function e(e){this.data=e.data,this.layer=e.layer,this.page=e.page,this.viewport=e.viewport,this.linkService=e.linkService,this.container=this._createContainer()}return e.prototype={_createContainer:function(){var e=this.data,t=this.page,n=this.viewport,i=document.createElement("section"),o=e.rect[2]-e.rect[0],s=e.rect[3]-e.rect[1];i.setAttribute("data-annotation-id",e.id);var u=a.normalizeRect([e.rect[0],t.view[3]-e.rect[1]+t.view[1],e.rect[2],t.view[3]-e.rect[3]+t.view[1]]);if(c.setProp("transform",i,"matrix("+n.transform.join(",")+")"),c.setProp("transformOrigin",i,-u[0]+"px "+-u[1]+"px"),e.borderStyle.width>0){i.style.borderWidth=e.borderStyle.width+"px",e.borderStyle.style!==r.UNDERLINE&&(o-=2*e.borderStyle.width,s-=2*e.borderStyle.width);var h=e.borderStyle.horizontalCornerRadius,d=e.borderStyle.verticalCornerRadius;if(h>0||d>0){var f=h+"px / "+d+"px";c.setProp("borderRadius",i,f)}switch(e.borderStyle.style){case r.SOLID:i.style.borderStyle="solid";break;case r.DASHED:i.style.borderStyle="dashed";break;case r.BEVELED:l("Unimplemented border style: beveled");break;case r.INSET:l("Unimplemented border style: inset");break;case r.UNDERLINE:i.style.borderBottomStyle="solid"}e.color?i.style.borderColor=a.makeCssRgb(0|e.color[0],0|e.color[1],0|e.color[2]):i.style.borderWidth=0}return i.style.left=u[0]+"px",i.style.top=u[1]+"px",i.style.width=o+"px",i.style.height=s+"px",i},render:function(){throw new Error("Abstract method AnnotationElement.render called")}},e}(),h=function(){function e(e){u.call(this,e)}return a.inherit(e,u,{render:function(){this.container.className="linkAnnotation";var e=document.createElement("a");return s(e,{url:this.data.url}),this.data.url||(this.data.action?this._bindNamedAction(e,this.data.action):this._bindLink(e,"dest"in this.data?this.data.dest:null)),this.container.appendChild(e),this.container},_bindLink:function(e,t){var n=this;e.href=this.linkService.getDestinationHash(t),e.onclick=function(){return t&&n.linkService.navigateTo(t),!1},t&&(e.className="internalLink")},_bindNamedAction:function(e,t){var n=this;e.href=this.linkService.getAnchorUrl(""),e.onclick=function(){return n.linkService.executeNamedAction(t),!1},e.className="internalLink"}}),e}(),d=function(){function e(e){u.call(this,e)}return a.inherit(e,u,{render:function(){this.container.className="textAnnotation";var e=document.createElement("img");if(e.style.height=this.container.style.height,e.style.width=this.container.style.width,e.src=PDFJS.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.alt="[{{type}} Annotation]",e.dataset.l10nId="text_annotation_type",e.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.hasPopup){var t=new g({container:this.container,trigger:e,color:this.data.color,title:this.data.title,contents:this.data.contents,hideWrapper:!0}),n=t.render();n.style.left=e.style.width,this.container.appendChild(n)}return this.container.appendChild(e),this.container}}),e}(),f=function(){function e(e){u.call(this,e)}return a.inherit(e,u,{render:function(){var e=document.createElement("div");e.textContent=this.data.fieldValue;var t=this.data.textAlignment;e.style.textAlign=["left","center","right"][t],e.style.verticalAlign="middle",e.style.display="table-cell";var n=this.data.fontRefName?this.page.commonObjs.getData(this.data.fontRefName):null;return this._setTextStyle(e,n),this.container.appendChild(e),this.container},_setTextStyle:function(e,t){var n=e.style;if(n.fontSize=this.data.fontSize+"px",n.direction=this.data.fontDirection<0?"rtl":"ltr",t){n.fontWeight=t.black?t.bold?"900":"bold":t.bold?"bold":"normal",n.fontStyle=t.italic?"italic":"normal";var i=t.loadedName?'"'+t.loadedName+'", ':"",r=t.fallbackName||"Helvetica, sans-serif";n.fontFamily=i+r}}}),e}(),p=function(){function e(e){u.call(this,e)}return a.inherit(e,u,{render:function(){this.container.className="popupAnnotation";var e='[data-annotation-id="'+this.data.parentId+'"]',t=this.layer.querySelector(e);if(!t)return this.container;var n=new g({container:this.container,trigger:t,color:this.data.color,title:this.data.title,contents:this.data.contents}),i=parseFloat(t.style.left),r=parseFloat(t.style.width);return c.setProp("transformOrigin",this.container,-(i+r)+"px -"+t.style.top),this.container.style.left=i+r+"px",this.container.appendChild(n.render()),this.container}}),e}(),g=function(){function e(e){this.container=e.container,this.trigger=e.trigger,this.color=e.color,this.title=e.title,this.contents=e.contents,this.hideWrapper=e.hideWrapper||!1,this.pinned=!1}var t=.7;return e.prototype={render:function(){var e=document.createElement("div");e.className="popupWrapper",this.hideElement=this.hideWrapper?e:this.container,this.hideElement.setAttribute("hidden",!0);var n=document.createElement("div");n.className="popup";var i=this.color;if(i){var r=t*(255-i[0])+i[0],o=t*(255-i[1])+i[1],s=t*(255-i[2])+i[2];n.style.backgroundColor=a.makeCssRgb(0|r,0|o,0|s)}var l=this._formatContents(this.contents),c=document.createElement("h1");return c.textContent=this.title,this.trigger.addEventListener("click",this._toggle.bind(this)),this.trigger.addEventListener("mouseover",this._show.bind(this,!1)),this.trigger.addEventListener("mouseout",this._hide.bind(this,!1)),n.addEventListener("click",this._hide.bind(this,!0)),n.appendChild(c),n.appendChild(l),e.appendChild(n),e},_formatContents:function(e){for(var t=document.createElement("p"),n=e.split(/(?:\r\n?|\n)/),i=0,r=n.length;r>i;++i){var o=n[i];t.appendChild(document.createTextNode(o)),r-1>i&&t.appendChild(document.createElement("br"))}return t},_toggle:function(){this.pinned?this._hide(!0):this._show(!0)},_show:function(e){e&&(this.pinned=!0),this.hideElement.hasAttribute("hidden")&&(this.hideElement.removeAttribute("hidden"),this.container.style.zIndex+=1)},_hide:function(e){e&&(this.pinned=!1),this.hideElement.hasAttribute("hidden")||this.pinned||(this.hideElement.setAttribute("hidden",!0),this.container.style.zIndex-=1)}},e}(),m=function(){function e(e){u.call(this,e)}return a.inherit(e,u,{render:function(){return this.container.className="highlightAnnotation",this.container}}),e}(),v=function(){function e(e){u.call(this,e)}return a.inherit(e,u,{render:function(){return this.container.className="underlineAnnotation",this.container}}),e}(),y=function(){function e(e){u.call(this,e)}return a.inherit(e,u,{render:function(){return this.container.className="squigglyAnnotation",this.container}}),e}(),b=function(){function e(e){u.call(this,e)}return a.inherit(e,u,{render:function(){return this.container.className="strikeoutAnnotation",this.container}}),e}(),w=function(){return{render:function(e){for(var t=new i,n=0,r=e.annotations.length;r>n;n++){var o=e.annotations[n];if(o&&o.hasHtml){var a={data:o,layer:e.div,page:e.page,viewport:e.viewport,linkService:e.linkService},s=t.create(a);e.div.appendChild(s.render())}}},update:function(e){for(var t=0,n=e.annotations.length;n>t;t++){var i=e.annotations[t],r=e.div.querySelector('[data-annotation-id="'+i.id+'"]');r&&c.setProp("transform",r,"matrix("+e.viewport.transform.join(",")+")")}e.div.removeAttribute("hidden")}}}();PDFJS.AnnotationLayer=w,e.AnnotationLayer=w}),function(e,t){t(e.pdfjsDisplayFontLoader={},e.pdfjsSharedUtil,e.pdfjsSharedGlobal)}(this,function(e,t,n){function i(e){this.docId=e,this.styleElement=null,this.nativeFontFaces=[],this.loadTestFontId=0,this.loadingContext={requests:[],nextRequestId:0}}var r=t.assert,o=t.bytesToString,a=t.string32,s=t.shadow,l=t.warn,c=n.PDFJS,u=n.globalScope,h=n.isWorker;i.prototype={insertRule:function(e){var t=this.styleElement;t||(t=this.styleElement=document.createElement("style"),t.id="PDFJS_FONT_STYLE_TAG_"+this.docId,document.documentElement.getElementsByTagName("head")[0].appendChild(t));var n=t.sheet;n.insertRule(e,n.cssRules.length)},clear:function(){var e=this.styleElement;e&&(e.parentNode.removeChild(e),e=this.styleElement=null),this.nativeFontFaces.forEach(function(e){document.fonts["delete"](e)}),this.nativeFontFaces.length=0},get loadTestFont(){return s(this,"loadTestFont",atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA=="))},addNativeFontFace:function(e){this.nativeFontFaces.push(e),document.fonts.add(e)},bind:function(e,t){r(!h,"bind() shall be called from main thread");for(var n=[],o=[],a=[],s=function(e){return e.loaded["catch"](function(t){l('Failed to load font "'+e.family+'": '+t)})},c=0,u=e.length;u>c;c++){var d=e[c];if(!d.attached&&d.loading!==!1)if(d.attached=!0,i.isFontLoadingAPISupported){var f=d.createNativeFontFace();f&&(this.addNativeFontFace(f),a.push(s(f)))}else{var p=d.createFontFaceRule();p&&(this.insertRule(p),n.push(p),o.push(d))}}var g=this.queueLoadingCallback(t);i.isFontLoadingAPISupported?Promise.all(a).then(function(){g.complete()}):n.length>0&&!i.isSyncFontLoadingSupported?this.prepareFontLoadEvent(n,o,g):g.complete()},queueLoadingCallback:function(e){function t(){for(r(!o.end,"completeRequest() cannot be called twice"),o.end=Date.now();n.requests.length>0&&n.requests[0].end;){var e=n.requests.shift();setTimeout(e.callback,0)}}var n=this.loadingContext,i="pdfjs-font-loading-"+n.nextRequestId++,o={id:i,complete:t,callback:e,started:Date.now()};return n.requests.push(o),o},prepareFontLoadEvent:function(e,t,n){function i(e,t){return e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|255&e.charCodeAt(t+3)}function r(e,t,n,i){var r=e.substr(0,t),o=e.substr(t+n);return r+i+o}function o(e,t){if(d++,d>30)return l("Load test font never loaded."),void t();h.font="30px "+e,h.fillText(".",0,20);var n=h.getImageData(0,0,1,1);return n.data[3]>0?void t():void setTimeout(o.bind(null,e,t))}var s,c,u=document.createElement("canvas");u.width=1,u.height=1;var h=u.getContext("2d"),d=0,f="lt"+Date.now()+this.loadTestFontId++,p=this.loadTestFont,g=976;p=r(p,g,f.length,f);var m=16,v=1482184792,y=i(p,m);for(s=0,c=f.length-3;c>s;s+=4)y=y-v+i(f,s)|0;s<f.length&&(y=y-v+i(f+"XXX",s)|0),p=r(p,m,4,a(y));var b="url(data:font/opentype;base64,"+btoa(p)+");",w='@font-face { font-family:"'+f+'";src:'+b+"}";this.insertRule(w);var C=[];for(s=0,c=t.length;c>s;s++)C.push(t[s].loadedName);C.push(f);var x=document.createElement("div");for(x.setAttribute("style","visibility: hidden;width: 10px; height: 10px;position: absolute; top: 0px; left: 0px;"),s=0,c=C.length;c>s;++s){var k=document.createElement("span");k.textContent="Hi",k.style.fontFamily=C[s],x.appendChild(k)}document.body.appendChild(x),o(f,function(){document.body.removeChild(x),n.complete()})}},i.isFontLoadingAPISupported=!h&&"undefined"!=typeof document&&!!document.fonts,Object.defineProperty(i,"isSyncFontLoadingSupported",{get:function(){var e=!1,t=window.navigator.userAgent,n=/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(t);return n&&n[1]>=14&&(e=!0),"node"===t&&(e=!0),s(i,"isSyncFontLoadingSupported",e)},enumerable:!0,configurable:!0});var d=function(){function e(e){this.compiledGlyphs={};for(var t in e)this[t]=e[t]}return Object.defineProperty(e,"isEvalSupported",{get:function(){var e=!1;if(c.isEvalSupported)try{new Function(""),e=!0}catch(t){}return s(this,"isEvalSupported",e)},enumerable:!0,configurable:!0}),e.prototype={createNativeFontFace:function(){if(!this.data)return null;if(c.disableFontFace)return this.disableFontFace=!0,null;var e=new FontFace(this.loadedName,this.data,{});return c.pdfBug&&"FontInspector"in u&&u.FontInspector.enabled&&u.FontInspector.fontAdded(this),e},createFontFaceRule:function(){if(!this.data)return null;if(c.disableFontFace)return this.disableFontFace=!0,null;var e=o(new Uint8Array(this.data)),t=this.loadedName,n="url(data:"+this.mimetype+";base64,"+window.btoa(e)+");",i='@font-face { font-family:"'+t+'";src:'+n+"}";return c.pdfBug&&"FontInspector"in u&&u.FontInspector.enabled&&u.FontInspector.fontAdded(this,n),i},getPathGenerator:function(t,n){if(!(n in this.compiledGlyphs)){var i,r,o,a=t.get(this.loadedName+"_path_"+n);if(e.isEvalSupported){var s,l="";for(r=0,o=a.length;o>r;r++)i=a[r],s=void 0!==i.args?i.args.join(","):"",l+="c."+i.cmd+"("+s+");\n";this.compiledGlyphs[n]=new Function("c","size",l)}else this.compiledGlyphs[n]=function(e,t){for(r=0,o=a.length;o>r;r++)i=a[r],"scale"===i.cmd&&(i.args=[t,-t]),e[i.cmd].apply(e,i.args)}}return this.compiledGlyphs[n]}},e}();e.FontFaceObject=d,e.FontLoader=i}),function(e,t){t(e.pdfjsDisplayMetadata={},e.pdfjsSharedUtil)}(this,function(e,t){var n=t.error,i=PDFJS.Metadata=function(){function e(e){return e.replace(/>\\376\\377([^<]+)/g,function(e,t){for(var n=t.replace(/\\([0-3])([0-7])([0-7])/g,function(e,t,n,i){return String.fromCharCode(64*t+8*n+1*i)}),i="",r=0;r<n.length;r+=2){var o=256*n.charCodeAt(r)+n.charCodeAt(r+1);i+="&#x"+(65536+o).toString(16).substring(1)+";"}return">"+i})}function t(t){if("string"==typeof t){t=e(t);var i=new DOMParser;t=i.parseFromString(t,"application/xml")}else t instanceof Document||n("Metadata: Invalid metadata object");this.metaDocument=t,this.metadata={},this.parse()}return t.prototype={parse:function(){var e=this.metaDocument,t=e.documentElement;if("rdf:rdf"!==t.nodeName.toLowerCase())for(t=t.firstChild;t&&"rdf:rdf"!==t.nodeName.toLowerCase();)t=t.nextSibling;var n=t?t.nodeName.toLowerCase():null;if(t&&"rdf:rdf"===n&&t.hasChildNodes()){var i,r,o,a,s,l,c,u=t.childNodes;for(a=0,l=u.length;l>a;a++)if(i=u[a],"rdf:description"===i.nodeName.toLowerCase())for(s=0,c=i.childNodes.length;c>s;s++)"#text"!==i.childNodes[s].nodeName.toLowerCase()&&(r=i.childNodes[s],o=r.nodeName.toLowerCase(),this.metadata[o]=r.textContent.trim())}},get:function(e){return this.metadata[e]||null},has:function(e){return"undefined"!=typeof this.metadata[e]}},t}();e.Metadata=i}),function(e,t){t(e.pdfjsDisplaySVG={},e.pdfjsSharedUtil)}(this,function(e,t){var n=t.FONT_IDENTITY_MATRIX,i=t.IDENTITY_MATRIX,r=t.ImageKind,o=t.OPS,a=t.Util,s=t.isNum,l=t.isArray,c=t.warn,u={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},h=function(){function e(e,t,n){for(var i=-1,r=t;n>r;r++){var o=255&(i^e[r]),a=s[o];i=i>>>8^a}return-1^i}function t(t,n,i,r){var o=r,a=n.length;i[o]=a>>24&255,i[o+1]=a>>16&255,i[o+2]=a>>8&255,i[o+3]=255&a,o+=4,i[o]=255&t.charCodeAt(0),i[o+1]=255&t.charCodeAt(1),i[o+2]=255&t.charCodeAt(2),i[o+3]=255&t.charCodeAt(3),o+=4,i.set(n,o),o+=n.length;var s=e(i,r+4,o);i[o]=s>>24&255,i[o+1]=s>>16&255,i[o+2]=s>>8&255,i[o+3]=255&s}function n(e,t,n){for(var i=1,r=0,o=t;n>o;++o)i=(i+(255&e[o]))%65521,r=(r+i)%65521;return r<<16|i}function i(e,i){var s,l,c,u=e.width,h=e.height,d=e.data;switch(i){case r.GRAYSCALE_1BPP:l=0,s=1,c=u+7>>3;break;case r.RGB_24BPP:l=2,s=8,c=3*u;break;case r.RGBA_32BPP:l=6,s=8,c=4*u;break;default:throw new Error("invalid format")}var f,p,g=new Uint8Array((1+c)*h),m=0,v=0;for(f=0;h>f;++f)g[m++]=0,g.set(d.subarray(v,v+c),m),v+=c,m+=c;if(i===r.GRAYSCALE_1BPP)for(m=0,f=0;h>f;f++)for(m++,p=0;c>p;p++)g[m++]^=255;var y=new Uint8Array([u>>24&255,u>>16&255,u>>8&255,255&u,h>>24&255,h>>16&255,h>>8&255,255&h,s,l,0,0,0]),b=g.length,w=65535,C=Math.ceil(b/w),x=new Uint8Array(2+b+5*C+4),k=0;x[k++]=120,x[k++]=156;for(var _=0;b>w;)x[k++]=0,x[k++]=255,x[k++]=255,x[k++]=0,x[k++]=0,x.set(g.subarray(_,_+w),k),k+=w,_+=w,b-=w;x[k++]=1,x[k++]=255&b,x[k++]=b>>8&255,x[k++]=65535&~b&255,x[k++]=(65535&~b)>>8&255,x.set(g.subarray(_),k),k+=g.length-_;var A=n(g,0,g.length);x[k++]=A>>24&255,x[k++]=A>>16&255,x[k++]=A>>8&255,x[k++]=255&A;var S=o.length+3*a+y.length+x.length,T=new Uint8Array(S),L=0;return T.set(o,L),L+=o.length,t("IHDR",y,T,L),L+=a+y.length,t("IDATA",x,T,L),L+=a+x.length,t("IEND",new Uint8Array(0),T,L),PDFJS.createObjectURL(T,"image/png")}for(var o=new Uint8Array([137,80,78,71,13,10,26,10]),a=12,s=new Int32Array(256),l=0;256>l;l++){for(var c=l,u=0;8>u;u++)c=1&c?3988292384^c>>1&2147483647:c>>1&2147483647;s[l]=c}return function(e){var t=void 0===e.kind?r.GRAYSCALE_1BPP:e.kind;return i(e,t)}}(),d=function(){function e(){this.fontSizeScale=1,this.fontWeight=u.fontWeight,this.fontSize=0,this.textMatrix=i,this.fontMatrix=n,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=u.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.clipId="",this.pendingClip=!1,this.maskId=""}return e.prototype={clone:function(){return Object.create(this)},setCurrentPoint:function(e,t){this.x=e,this.y=t}},e}(),f=function(){function e(e,t){var n="http://www.w3.org/2000/svg",i=document.createElementNS(n,"svg:svg");return i.setAttributeNS(null,"version","1.1"),i.setAttributeNS(null,"width",e+"px"),i.setAttributeNS(null,"height",t+"px"),i.setAttributeNS(null,"viewBox","0 0 "+e+" "+t),i}function t(e){for(var t=[],n=[],i=e.length,r=0;i>r;r++)"save"!==e[r].fn?"restore"===e[r].fn?t=n.pop():t.push(e[r]):(t.push({fnId:92,fn:"group",items:[]}),n.push(t),t=t[t.length-1].items);return t}function r(e){if(e===(0|e))return e.toString();var t=e.toFixed(10),n=t.length-1;if("0"!==t[n])return t;do n--;while("0"===t[n]);return t.substr(0,"."===t[n]?n:n+1)}function f(e){if(0===e[4]&&0===e[5]){if(0===e[1]&&0===e[2])return 1===e[0]&&1===e[3]?"":"scale("+r(e[0])+" "+r(e[3])+")";if(e[0]===e[3]&&e[1]===-e[2]){var t=180*Math.acos(e[0])/Math.PI;return"rotate("+r(t)+")"}}else if(1===e[0]&&0===e[1]&&0===e[2]&&1===e[3])return"translate("+r(e[4])+" "+r(e[5])+")";return"matrix("+r(e[0])+" "+r(e[1])+" "+r(e[2])+" "+r(e[3])+" "+r(e[4])+" "+r(e[5])+")"}function p(e,t){this.current=new d,this.transformMatrix=i,this.transformStack=[],this.extraStack=[],this.commonObjs=e,this.objs=t,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts={},this.cssStyle=null}var g="http://www.w3.org/2000/svg",m="http://www.w3.org/XML/1998/namespace",v="http://www.w3.org/1999/xlink",y=["butt","round","square"],b=["miter","round","bevel"],w=0,C=0;return p.prototype={save:function(){this.transformStack.push(this.transformMatrix);var e=this.current;this.extraStack.push(e),this.current=e.clone()},restore:function(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.tgrp=document.createElementNS(g,"svg:g"),this.tgrp.setAttributeNS(null,"transform",f(this.transformMatrix)),this.pgrp.appendChild(this.tgrp)},group:function(e){this.save(),this.executeOpTree(e),this.restore()},loadDependencies:function(e){for(var t=e.fnArray,n=t.length,i=e.argsArray,r=this,a=0;n>a;a++)if(o.dependency===t[a])for(var s=i[a],l=0,c=s.length;c>l;l++){var u,h=s[l],d="g_"===h.substring(0,2);u=d?new Promise(function(e){r.commonObjs.get(h,e)}):new Promise(function(e){r.objs.get(h,e)}),this.current.dependencies.push(u)}return Promise.all(this.current.dependencies)},transform:function(e,t,n,i,r,o){var a=[e,t,n,i,r,o];this.transformMatrix=PDFJS.Util.transform(this.transformMatrix,a),this.tgrp=document.createElementNS(g,"svg:g"),this.tgrp.setAttributeNS(null,"transform",f(this.transformMatrix))},getSVG:function(t,n){return this.svg=e(n.width,n.height),this.viewport=n,this.loadDependencies(t).then(function(){this.transformMatrix=i,this.pgrp=document.createElementNS(g,"svg:g"),this.pgrp.setAttributeNS(null,"transform",f(n.transform)),this.tgrp=document.createElementNS(g,"svg:g"),this.tgrp.setAttributeNS(null,"transform",f(this.transformMatrix)),this.defs=document.createElementNS(g,"svg:defs"),this.pgrp.appendChild(this.defs),this.pgrp.appendChild(this.tgrp),this.svg.appendChild(this.pgrp);var e=this.convertOpList(t);return this.executeOpTree(e),this.svg}.bind(this))},convertOpList:function(e){var n=e.argsArray,i=e.fnArray,r=i.length,a=[],s=[];for(var l in o)a[o[l]]=l;for(var c=0;r>c;c++){var u=i[c];s.push({fnId:u,fn:a[u],args:n[c]})}return t(s)},executeOpTree:function(e){for(var t=e.length,n=0;t>n;n++){var i=e[n].fn,r=e[n].fnId,a=e[n].args;switch(0|r){case o.beginText:this.beginText();break;case o.setLeading:this.setLeading(a);break;case o.setLeadingMoveText:this.setLeadingMoveText(a[0],a[1]);break;case o.setFont:this.setFont(a);break;case o.showText:this.showText(a[0]);break;case o.showSpacedText:this.showText(a[0]);break;case o.endText:this.endText();break;case o.moveText:this.moveText(a[0],a[1]);break;case o.setCharSpacing:this.setCharSpacing(a[0]);break;case o.setWordSpacing:this.setWordSpacing(a[0]);break;case o.setHScale:this.setHScale(a[0]);break;case o.setTextMatrix:this.setTextMatrix(a[0],a[1],a[2],a[3],a[4],a[5]);break;case o.setLineWidth:this.setLineWidth(a[0]);break;case o.setLineJoin:this.setLineJoin(a[0]);break;case o.setLineCap:this.setLineCap(a[0]);break;case o.setMiterLimit:this.setMiterLimit(a[0]);break;case o.setFillRGBColor:this.setFillRGBColor(a[0],a[1],a[2]);break;case o.setStrokeRGBColor:this.setStrokeRGBColor(a[0],a[1],a[2]);break;case o.setDash:this.setDash(a[0],a[1]);break;case o.setGState:this.setGState(a[0]);break;case o.fill:this.fill();break;case o.eoFill:this.eoFill();break;case o.stroke:this.stroke();break;case o.fillStroke:this.fillStroke();break;case o.eoFillStroke:this.eoFillStroke();break;case o.clip:this.clip("nonzero");break;case o.eoClip:this.clip("evenodd");break;case o.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case o.paintJpegXObject:this.paintJpegXObject(a[0],a[1],a[2]);break;case o.paintImageXObject:this.paintImageXObject(a[0]);break;case o.paintInlineImageXObject:this.paintInlineImageXObject(a[0]);break;case o.paintImageMaskXObject:this.paintImageMaskXObject(a[0]);break;case o.paintFormXObjectBegin:this.paintFormXObjectBegin(a[0],a[1]);break;case o.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case o.closePath:this.closePath();break;case o.closeStroke:this.closeStroke();break;case o.closeFillStroke:this.closeFillStroke();break;case o.nextLine:this.nextLine();break;case o.transform:this.transform(a[0],a[1],a[2],a[3],a[4],a[5]);break;case o.constructPath:this.constructPath(a[0],a[1]);break;case o.endPath:this.endPath();break;case 92:this.group(e[n].items);break;default:c("Unimplemented method "+i);
}}},setWordSpacing:function(e){this.current.wordSpacing=e},setCharSpacing:function(e){this.current.charSpacing=e},nextLine:function(){this.moveText(0,this.current.leading)},setTextMatrix:function(e,t,n,i,o,a){var s=this.current;this.current.textMatrix=this.current.lineMatrix=[e,t,n,i,o,a],this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,s.xcoords=[],s.tspan=document.createElementNS(g,"svg:tspan"),s.tspan.setAttributeNS(null,"font-family",s.fontFamily),s.tspan.setAttributeNS(null,"font-size",r(s.fontSize)+"px"),s.tspan.setAttributeNS(null,"y",r(-s.y)),s.txtElement=document.createElementNS(g,"svg:text"),s.txtElement.appendChild(s.tspan)},beginText:function(){this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.current.textMatrix=i,this.current.lineMatrix=i,this.current.tspan=document.createElementNS(g,"svg:tspan"),this.current.txtElement=document.createElementNS(g,"svg:text"),this.current.txtgrp=document.createElementNS(g,"svg:g"),this.current.xcoords=[]},moveText:function(e,t){var n=this.current;this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t,n.xcoords=[],n.tspan=document.createElementNS(g,"svg:tspan"),n.tspan.setAttributeNS(null,"font-family",n.fontFamily),n.tspan.setAttributeNS(null,"font-size",r(n.fontSize)+"px"),n.tspan.setAttributeNS(null,"y",r(-n.y))},showText:function(e){var t=this.current,n=t.font,i=t.fontSize;if(0!==i){var o,a=t.charSpacing,l=t.wordSpacing,c=t.fontDirection,h=t.textHScale*c,d=e.length,p=n.vertical,g=i*t.fontMatrix[0],v=0;for(o=0;d>o;++o){var y=e[o];if(null!==y)if(s(y))v+=-y*i*.001;else{t.xcoords.push(t.x+v*h);var b=y.width,w=y.fontChar,C=b*g+a*c;v+=C,t.tspan.textContent+=w}else v+=c*l}p?t.y-=v*h:t.x+=v*h,t.tspan.setAttributeNS(null,"x",t.xcoords.map(r).join(" ")),t.tspan.setAttributeNS(null,"y",r(-t.y)),t.tspan.setAttributeNS(null,"font-family",t.fontFamily),t.tspan.setAttributeNS(null,"font-size",r(t.fontSize)+"px"),t.fontStyle!==u.fontStyle&&t.tspan.setAttributeNS(null,"font-style",t.fontStyle),t.fontWeight!==u.fontWeight&&t.tspan.setAttributeNS(null,"font-weight",t.fontWeight),t.fillColor!==u.fillColor&&t.tspan.setAttributeNS(null,"fill",t.fillColor),t.txtElement.setAttributeNS(null,"transform",f(t.textMatrix)+" scale(1, -1)"),t.txtElement.setAttributeNS(m,"xml:space","preserve"),t.txtElement.appendChild(t.tspan),t.txtgrp.appendChild(t.txtElement),this.tgrp.appendChild(t.txtElement)}},setLeadingMoveText:function(e,t){this.setLeading(-t),this.moveText(e,t)},addFontStyle:function(e){this.cssStyle||(this.cssStyle=document.createElementNS(g,"svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.appendChild(this.cssStyle));var t=PDFJS.createObjectURL(e.data,e.mimetype);this.cssStyle.textContent+='@font-face { font-family: "'+e.loadedName+'"; src: url('+t+"); }\n"},setFont:function(e){var t=this.current,i=this.commonObjs.get(e[0]),o=e[1];this.current.font=i,this.embedFonts&&i.data&&!this.embeddedFonts[i.loadedName]&&(this.addFontStyle(i),this.embeddedFonts[i.loadedName]=i),t.fontMatrix=i.fontMatrix?i.fontMatrix:n;var a=i.black?i.bold?"bolder":"bold":i.bold?"bold":"normal",s=i.italic?"italic":"normal";0>o?(o=-o,t.fontDirection=-1):t.fontDirection=1,t.fontSize=o,t.fontFamily=i.loadedName,t.fontWeight=a,t.fontStyle=s,t.tspan=document.createElementNS(g,"svg:tspan"),t.tspan.setAttributeNS(null,"y",r(-t.y)),t.xcoords=[]},endText:function(){this.current.pendingClip?(this.cgrp.appendChild(this.tgrp),this.pgrp.appendChild(this.cgrp)):this.pgrp.appendChild(this.tgrp),this.tgrp=document.createElementNS(g,"svg:g"),this.tgrp.setAttributeNS(null,"transform",f(this.transformMatrix))},setLineWidth:function(e){this.current.lineWidth=e},setLineCap:function(e){this.current.lineCap=y[e]},setLineJoin:function(e){this.current.lineJoin=b[e]},setMiterLimit:function(e){this.current.miterLimit=e},setStrokeRGBColor:function(e,t,n){var i=a.makeCssRgb(e,t,n);this.current.strokeColor=i},setFillRGBColor:function(e,t,n){var i=a.makeCssRgb(e,t,n);this.current.fillColor=i,this.current.tspan=document.createElementNS(g,"svg:tspan"),this.current.xcoords=[]},setDash:function(e,t){this.current.dashArray=e,this.current.dashPhase=t},constructPath:function(e,t){var n=this.current,i=n.x,a=n.y;n.path=document.createElementNS(g,"svg:path");for(var s=[],l=e.length,c=0,u=0;l>c;c++)switch(0|e[c]){case o.rectangle:i=t[u++],a=t[u++];var h=t[u++],d=t[u++],f=i+h,p=a+d;s.push("M",r(i),r(a),"L",r(f),r(a),"L",r(f),r(p),"L",r(i),r(p),"Z");break;case o.moveTo:i=t[u++],a=t[u++],s.push("M",r(i),r(a));break;case o.lineTo:i=t[u++],a=t[u++],s.push("L",r(i),r(a));break;case o.curveTo:i=t[u+4],a=t[u+5],s.push("C",r(t[u]),r(t[u+1]),r(t[u+2]),r(t[u+3]),r(i),r(a)),u+=6;break;case o.curveTo2:i=t[u+2],a=t[u+3],s.push("C",r(i),r(a),r(t[u]),r(t[u+1]),r(t[u+2]),r(t[u+3])),u+=4;break;case o.curveTo3:i=t[u+2],a=t[u+3],s.push("C",r(t[u]),r(t[u+1]),r(i),r(a),r(i),r(a)),u+=4;break;case o.closePath:s.push("Z")}n.path.setAttributeNS(null,"d",s.join(" ")),n.path.setAttributeNS(null,"stroke-miterlimit",r(n.miterLimit)),n.path.setAttributeNS(null,"stroke-linecap",n.lineCap),n.path.setAttributeNS(null,"stroke-linejoin",n.lineJoin),n.path.setAttributeNS(null,"stroke-width",r(n.lineWidth)+"px"),n.path.setAttributeNS(null,"stroke-dasharray",n.dashArray.map(r).join(" ")),n.path.setAttributeNS(null,"stroke-dashoffset",r(n.dashPhase)+"px"),n.path.setAttributeNS(null,"fill","none"),this.tgrp.appendChild(n.path),n.pendingClip?(this.cgrp.appendChild(this.tgrp),this.pgrp.appendChild(this.cgrp)):this.pgrp.appendChild(this.tgrp),n.element=n.path,n.setCurrentPoint(i,a)},endPath:function(){var e=this.current;e.pendingClip?(this.cgrp.appendChild(this.tgrp),this.pgrp.appendChild(this.cgrp)):this.pgrp.appendChild(this.tgrp),this.tgrp=document.createElementNS(g,"svg:g"),this.tgrp.setAttributeNS(null,"transform",f(this.transformMatrix))},clip:function(e){var t=this.current;t.clipId="clippath"+w,w++,this.clippath=document.createElementNS(g,"svg:clipPath"),this.clippath.setAttributeNS(null,"id",t.clipId);var n=t.element.cloneNode();"evenodd"===e?n.setAttributeNS(null,"clip-rule","evenodd"):n.setAttributeNS(null,"clip-rule","nonzero"),this.clippath.setAttributeNS(null,"transform",f(this.transformMatrix)),this.clippath.appendChild(n),this.defs.appendChild(this.clippath),t.pendingClip=!0,this.cgrp=document.createElementNS(g,"svg:g"),this.cgrp.setAttributeNS(null,"clip-path","url(#"+t.clipId+")"),this.pgrp.appendChild(this.cgrp)},closePath:function(){var e=this.current,t=e.path.getAttributeNS(null,"d");t+="Z",e.path.setAttributeNS(null,"d",t)},setLeading:function(e){this.current.leading=-e},setTextRise:function(e){this.current.textRise=e},setHScale:function(e){this.current.textHScale=e/100},setGState:function(e){for(var t=0,n=e.length;n>t;t++){var i=e[t],r=i[0],o=i[1];switch(r){case"LW":this.setLineWidth(o);break;case"LC":this.setLineCap(o);break;case"LJ":this.setLineJoin(o);break;case"ML":this.setMiterLimit(o);break;case"D":this.setDash(o[0],o[1]);break;case"RI":break;case"FL":break;case"Font":this.setFont(o);break;case"CA":break;case"ca":break;case"BM":break;case"SMask":}}},fill:function(){var e=this.current;e.element.setAttributeNS(null,"fill",e.fillColor)},stroke:function(){var e=this.current;e.element.setAttributeNS(null,"stroke",e.strokeColor),e.element.setAttributeNS(null,"fill","none")},eoFill:function(){var e=this.current;e.element.setAttributeNS(null,"fill",e.fillColor),e.element.setAttributeNS(null,"fill-rule","evenodd")},fillStroke:function(){this.stroke(),this.fill()},eoFillStroke:function(){this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()},closeStroke:function(){this.closePath(),this.stroke()},closeFillStroke:function(){this.closePath(),this.fillStroke()},paintSolidColorImageMask:function(){var e=this.current,t=document.createElementNS(g,"svg:rect");t.setAttributeNS(null,"x","0"),t.setAttributeNS(null,"y","0"),t.setAttributeNS(null,"width","1px"),t.setAttributeNS(null,"height","1px"),t.setAttributeNS(null,"fill",e.fillColor),this.tgrp.appendChild(t)},paintJpegXObject:function(e,t,n){var i=this.current,o=this.objs.get(e),a=document.createElementNS(g,"svg:image");a.setAttributeNS(v,"xlink:href",o.src),a.setAttributeNS(null,"width",o.width+"px"),a.setAttributeNS(null,"height",o.height+"px"),a.setAttributeNS(null,"x","0"),a.setAttributeNS(null,"y",r(-n)),a.setAttributeNS(null,"transform","scale("+r(1/t)+" "+r(-1/n)+")"),this.tgrp.appendChild(a),i.pendingClip?(this.cgrp.appendChild(this.tgrp),this.pgrp.appendChild(this.cgrp)):this.pgrp.appendChild(this.tgrp)},paintImageXObject:function(e){var t=this.objs.get(e);return t?void this.paintInlineImageXObject(t):void c("Dependent image isn't ready yet")},paintInlineImageXObject:function(e,t){var n=this.current,i=e.width,o=e.height,a=h(e),s=document.createElementNS(g,"svg:rect");s.setAttributeNS(null,"x","0"),s.setAttributeNS(null,"y","0"),s.setAttributeNS(null,"width",r(i)),s.setAttributeNS(null,"height",r(o)),n.element=s,this.clip("nonzero");var l=document.createElementNS(g,"svg:image");l.setAttributeNS(v,"xlink:href",a),l.setAttributeNS(null,"x","0"),l.setAttributeNS(null,"y",r(-o)),l.setAttributeNS(null,"width",r(i)+"px"),l.setAttributeNS(null,"height",r(o)+"px"),l.setAttributeNS(null,"transform","scale("+r(1/i)+" "+r(-1/o)+")"),t?t.appendChild(l):this.tgrp.appendChild(l),n.pendingClip?(this.cgrp.appendChild(this.tgrp),this.pgrp.appendChild(this.cgrp)):this.pgrp.appendChild(this.tgrp)},paintImageMaskXObject:function(e){var t=this.current,n=e.width,i=e.height,o=t.fillColor;t.maskId="mask"+C++;var a=document.createElementNS(g,"svg:mask");a.setAttributeNS(null,"id",t.maskId);var s=document.createElementNS(g,"svg:rect");s.setAttributeNS(null,"x","0"),s.setAttributeNS(null,"y","0"),s.setAttributeNS(null,"width",r(n)),s.setAttributeNS(null,"height",r(i)),s.setAttributeNS(null,"fill",o),s.setAttributeNS(null,"mask","url(#"+t.maskId+")"),this.defs.appendChild(a),this.tgrp.appendChild(s),this.paintInlineImageXObject(e,a)},paintFormXObjectBegin:function(e,t){if(this.save(),l(e)&&6===e.length&&this.transform(e[0],e[1],e[2],e[3],e[4],e[5]),l(t)&&4===t.length){var n=t[2]-t[0],i=t[3]-t[1],o=document.createElementNS(g,"svg:rect");o.setAttributeNS(null,"x",t[0]),o.setAttributeNS(null,"y",t[1]),o.setAttributeNS(null,"width",r(n)),o.setAttributeNS(null,"height",r(i)),this.current.element=o,this.clip("nonzero"),this.endPath()}},paintFormXObjectEnd:function(){this.restore()}},p}();PDFJS.SVGGraphics=f,e.SVGGraphics=f}),function(e,t){t(e.pdfjsDisplayTextLayer={},e.pdfjsSharedUtil,e.pdfjsDisplayDOMUtils,e.pdfjsSharedGlobal)}(this,function(e,t,n,i){var r=t.Util,o=t.createPromiseCapability,a=n.CustomStyle,s=i.PDFJS,l=function(){function e(e){return!u.test(e)}function t(t,n,i,o){var a=o[i.fontName],l=document.createElement("div");if(t.push(l),e(i.str))return void(l.dataset.isWhitespace=!0);var c=r.transform(n.transform,i.transform),u=Math.atan2(c[1],c[0]);a.vertical&&(u+=Math.PI/2);var h=Math.sqrt(c[2]*c[2]+c[3]*c[3]),d=h;a.ascent?d=a.ascent*d:a.descent&&(d=(1+a.descent)*d);var f,p;0===u?(f=c[4],p=c[5]-d):(f=c[4]+d*Math.sin(u),p=c[5]-d*Math.cos(u)),l.style.left=f+"px",l.style.top=p+"px",l.style.fontSize=h+"px",l.style.fontFamily=a.fontFamily,l.textContent=i.str,s.pdfBug&&(l.dataset.fontName=i.fontName),0!==u&&(l.dataset.angle=u*(180/Math.PI)),i.str.length>1&&(a.vertical?l.dataset.canvasWidth=i.height*n.scale:l.dataset.canvasWidth=i.width*n.scale)}function n(e){if(!e._canceled){var t=e._container,n=e._textDivs,i=e._capability,r=n.length;if(r>c)return void i.resolve();var o=document.createElement("canvas");o.mozOpaque=!0;for(var s,l,u=o.getContext("2d",{alpha:!1}),h=0;r>h;h++){var d=n[h];if(void 0===d.dataset.isWhitespace){var f=d.style.fontSize,p=d.style.fontFamily;f===s&&p===l||(u.font=f+" "+p,s=f,l=p);var g=u.measureText(d.textContent).width;if(g>0){t.appendChild(d);var m;if(void 0!==d.dataset.canvasWidth){var v=d.dataset.canvasWidth/g;m="scaleX("+v+")"}else m="";var y=d.dataset.angle;y&&(m="rotate("+y+"deg) "+m),m&&a.setProp("transform",d,m)}}}i.resolve()}}function i(e,t,n,i){this._textContent=e,this._container=t,this._viewport=n,i=i||[],this._textDivs=i,this._canceled=!1,this._capability=o(),this._renderTimer=null}function l(e){var t=new i(e.textContent,e.container,e.viewport,e.textDivs);return t._render(e.timeout),t}var c=1e5,u=/\S/;return i.prototype={get promise(){return this._capability.promise},cancel:function(){this._canceled=!0,null!==this._renderTimer&&(clearTimeout(this._renderTimer),this._renderTimer=null),this._capability.reject("canceled")},_render:function(e){for(var i=this._textContent.items,r=this._textContent.styles,o=this._textDivs,a=this._viewport,s=0,l=i.length;l>s;s++)t(o,a,i[s],r);if(e){var c=this;this._renderTimer=setTimeout(function(){n(c),c._renderTimer=null},e)}else n(this)}},l}();s.renderTextLayer=l,e.renderTextLayer=l}),function(e,t){t(e.pdfjsDisplayWebGL={},e.pdfjsSharedUtil)}(this,function(e,t){var n=t.shadow,i=function(){function e(e,t,n){var i=e.createShader(n);e.shaderSource(i,t),e.compileShader(i);var r=e.getShaderParameter(i,e.COMPILE_STATUS);if(!r){var o=e.getShaderInfoLog(i);throw new Error("Error during shader compilation: "+o)}return i}function t(t,n){return e(t,n,t.VERTEX_SHADER)}function i(t,n){return e(t,n,t.FRAGMENT_SHADER)}function r(e,t){for(var n=e.createProgram(),i=0,r=t.length;r>i;++i)e.attachShader(n,t[i]);e.linkProgram(n);var o=e.getProgramParameter(n,e.LINK_STATUS);if(!o){var a=e.getProgramInfoLog(n);throw new Error("Error during program linking: "+a)}return n}function o(e,t,n){e.activeTexture(n);var i=e.createTexture();return e.bindTexture(e.TEXTURE_2D,i),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),i}function a(){d||(f=document.createElement("canvas"),d=f.getContext("webgl",{premultipliedalpha:!1}))}function s(){var e,n;a(),e=f,f=null,n=d,d=null;var o=t(n,p),s=i(n,g),l=r(n,[o,s]);n.useProgram(l);var c={};c.gl=n,c.canvas=e,c.resolutionLocation=n.getUniformLocation(l,"u_resolution"),c.positionLocation=n.getAttribLocation(l,"a_position"),c.backdropLocation=n.getUniformLocation(l,"u_backdrop"),c.subtypeLocation=n.getUniformLocation(l,"u_subtype");var u=n.getAttribLocation(l,"a_texCoord"),h=n.getUniformLocation(l,"u_image"),v=n.getUniformLocation(l,"u_mask"),y=n.createBuffer();n.bindBuffer(n.ARRAY_BUFFER,y),n.bufferData(n.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),n.STATIC_DRAW),n.enableVertexAttribArray(u),n.vertexAttribPointer(u,2,n.FLOAT,!1,0,0),n.uniform1i(h,0),n.uniform1i(v,1),m=c}function l(e,t,n){var i=e.width,r=e.height;m||s();var a=m,l=a.canvas,c=a.gl;l.width=i,l.height=r,c.viewport(0,0,c.drawingBufferWidth,c.drawingBufferHeight),c.uniform2f(a.resolutionLocation,i,r),n.backdrop?c.uniform4f(a.resolutionLocation,n.backdrop[0],n.backdrop[1],n.backdrop[2],1):c.uniform4f(a.resolutionLocation,0,0,0,0),c.uniform1i(a.subtypeLocation,"Luminosity"===n.subtype?1:0);var u=o(c,e,c.TEXTURE0),h=o(c,t,c.TEXTURE1),d=c.createBuffer();return c.bindBuffer(c.ARRAY_BUFFER,d),c.bufferData(c.ARRAY_BUFFER,new Float32Array([0,0,i,0,0,r,0,r,i,0,i,r]),c.STATIC_DRAW),c.enableVertexAttribArray(a.positionLocation),c.vertexAttribPointer(a.positionLocation,2,c.FLOAT,!1,0,0),c.clearColor(0,0,0,0),c.enable(c.BLEND),c.blendFunc(c.ONE,c.ONE_MINUS_SRC_ALPHA),c.clear(c.COLOR_BUFFER_BIT),c.drawArrays(c.TRIANGLES,0,6),c.flush(),c.deleteTexture(u),c.deleteTexture(h),c.deleteBuffer(d),l}function c(){var e,n;a(),e=f,f=null,n=d,d=null;var o=t(n,v),s=i(n,y),l=r(n,[o,s]);n.useProgram(l);var c={};c.gl=n,c.canvas=e,c.resolutionLocation=n.getUniformLocation(l,"u_resolution"),c.scaleLocation=n.getUniformLocation(l,"u_scale"),c.offsetLocation=n.getUniformLocation(l,"u_offset"),c.positionLocation=n.getAttribLocation(l,"a_position"),c.colorLocation=n.getAttribLocation(l,"a_color"),b=c}function u(e,t,n,i,r){b||c();var o=b,a=o.canvas,s=o.gl;a.width=e,a.height=t,s.viewport(0,0,s.drawingBufferWidth,s.drawingBufferHeight),s.uniform2f(o.resolutionLocation,e,t);var l,u,h,d=0;for(l=0,u=i.length;u>l;l++)switch(i[l].type){case"lattice":h=i[l].coords.length/i[l].verticesPerRow|0,d+=(h-1)*(i[l].verticesPerRow-1)*6;break;case"triangles":d+=i[l].coords.length}var f=new Float32Array(2*d),p=new Uint8Array(3*d),g=r.coords,m=r.colors,v=0,y=0;for(l=0,u=i.length;u>l;l++){var w=i[l],C=w.coords,x=w.colors;switch(w.type){case"lattice":var k=w.verticesPerRow;h=C.length/k|0;for(var _=1;h>_;_++)for(var A=_*k+1,S=1;k>S;S++,A++)f[v]=g[C[A-k-1]],f[v+1]=g[C[A-k-1]+1],f[v+2]=g[C[A-k]],f[v+3]=g[C[A-k]+1],f[v+4]=g[C[A-1]],f[v+5]=g[C[A-1]+1],p[y]=m[x[A-k-1]],p[y+1]=m[x[A-k-1]+1],p[y+2]=m[x[A-k-1]+2],p[y+3]=m[x[A-k]],p[y+4]=m[x[A-k]+1],p[y+5]=m[x[A-k]+2],p[y+6]=m[x[A-1]],p[y+7]=m[x[A-1]+1],p[y+8]=m[x[A-1]+2],f[v+6]=f[v+2],f[v+7]=f[v+3],f[v+8]=f[v+4],f[v+9]=f[v+5],f[v+10]=g[C[A]],f[v+11]=g[C[A]+1],p[y+9]=p[y+3],p[y+10]=p[y+4],p[y+11]=p[y+5],p[y+12]=p[y+6],p[y+13]=p[y+7],p[y+14]=p[y+8],p[y+15]=m[x[A]],p[y+16]=m[x[A]+1],p[y+17]=m[x[A]+2],v+=12,y+=18;break;case"triangles":for(var T=0,L=C.length;L>T;T++)f[v]=g[C[T]],f[v+1]=g[C[T]+1],p[y]=m[x[T]],p[y+1]=m[x[T]+1],p[y+2]=m[x[T]+2],v+=2,y+=3}}n?s.clearColor(n[0]/255,n[1]/255,n[2]/255,1):s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT);var E=s.createBuffer();s.bindBuffer(s.ARRAY_BUFFER,E),s.bufferData(s.ARRAY_BUFFER,f,s.STATIC_DRAW),s.enableVertexAttribArray(o.positionLocation),s.vertexAttribPointer(o.positionLocation,2,s.FLOAT,!1,0,0);var M=s.createBuffer();return s.bindBuffer(s.ARRAY_BUFFER,M),s.bufferData(s.ARRAY_BUFFER,p,s.STATIC_DRAW),s.enableVertexAttribArray(o.colorLocation),s.vertexAttribPointer(o.colorLocation,3,s.UNSIGNED_BYTE,!1,0,0),s.uniform2f(o.scaleLocation,r.scaleX,r.scaleY),s.uniform2f(o.offsetLocation,r.offsetX,r.offsetY),s.drawArrays(s.TRIANGLES,0,d),s.flush(),s.deleteBuffer(E),s.deleteBuffer(M),a}function h(){m&&m.canvas&&(m.canvas.width=0,m.canvas.height=0),b&&b.canvas&&(b.canvas.width=0,b.canvas.height=0),m=null,b=null}var d,f,p="  attribute vec2 a_position;                                      attribute vec2 a_texCoord;                                                                                                      uniform vec2 u_resolution;                                                                                                      varying vec2 v_texCoord;                                                                                                        void main() {                                                     vec2 clipSpace = (a_position / u_resolution) * 2.0 - 1.0;       gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);                                                                              v_texCoord = a_texCoord;                                      }                                                             ",g="  precision mediump float;                                                                                                        uniform vec4 u_backdrop;                                        uniform int u_subtype;                                          uniform sampler2D u_image;                                      uniform sampler2D u_mask;                                                                                                       varying vec2 v_texCoord;                                                                                                        void main() {                                                     vec4 imageColor = texture2D(u_image, v_texCoord);               vec4 maskColor = texture2D(u_mask, v_texCoord);                 if (u_backdrop.a > 0.0) {                                         maskColor.rgb = maskColor.rgb * maskColor.a +                                   u_backdrop.rgb * (1.0 - maskColor.a);         }                                                               float lum;                                                      if (u_subtype == 0) {                                             lum = maskColor.a;                                            } else {                                                          lum = maskColor.r * 0.3 + maskColor.g * 0.59 +                        maskColor.b * 0.11;                                     }                                                               imageColor.a *= lum;                                            imageColor.rgb *= imageColor.a;                                 gl_FragColor = imageColor;                                    }                                                             ",m=null,v="  attribute vec2 a_position;                                      attribute vec3 a_color;                                                                                                         uniform vec2 u_resolution;                                      uniform vec2 u_scale;                                           uniform vec2 u_offset;                                                                                                          varying vec4 v_color;                                                                                                           void main() {                                                     vec2 position = (a_position + u_offset) * u_scale;              vec2 clipSpace = (position / u_resolution) * 2.0 - 1.0;         gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);                                                                              v_color = vec4(a_color / 255.0, 1.0);                         }                                                             ",y="  precision mediump float;                                                                                                        varying vec4 v_color;                                                                                                           void main() {                                                     gl_FragColor = v_color;                                       }                                                             ",b=null;return{get isEnabled(){if(PDFJS.disableWebGL)return!1;var e=!1;try{a(),e=!!d}catch(t){}return n(this,"isEnabled",e)},composeSMask:l,drawFigures:u,clear:h}}();e.WebGLUtils=i}),function(e,t){t(e.pdfjsDisplayPatternHelper={},e.pdfjsSharedUtil,e.pdfjsDisplayWebGL)}(this,function(e,t,n){function i(e){var t=c[e[0]];return t||s("Unknown IR type: "+e[0]),t.fromIR(e)}var r=t.Util,o=t.info,a=t.isArray,s=t.error,l=n.WebGLUtils,c={};c.RadialAxial={fromIR:function(e){var t=e[1],n=e[2],i=e[3],r=e[4],o=e[5],a=e[6];return{type:"Pattern",getPattern:function(e){var s;"axial"===t?s=e.createLinearGradient(i[0],i[1],r[0],r[1]):"radial"===t&&(s=e.createRadialGradient(i[0],i[1],o,r[0],r[1],a));for(var l=0,c=n.length;c>l;++l){var u=n[l];s.addColorStop(u[0],u[1])}return s}}}};var u=function(){function e(e,t,n,i,r,o,a,s){var l,c=t.coords,u=t.colors,h=e.data,d=4*e.width;c[n+1]>c[i+1]&&(l=n,n=i,i=l,l=o,o=a,a=l),c[i+1]>c[r+1]&&(l=i,i=r,r=l,l=a,a=s,s=l),c[n+1]>c[i+1]&&(l=n,n=i,i=l,l=o,o=a,a=l);var f=(c[n]+t.offsetX)*t.scaleX,p=(c[n+1]+t.offsetY)*t.scaleY,g=(c[i]+t.offsetX)*t.scaleX,m=(c[i+1]+t.offsetY)*t.scaleY,v=(c[r]+t.offsetX)*t.scaleX,y=(c[r+1]+t.offsetY)*t.scaleY;if(!(p>=y))for(var b,w,C,x,k,_,A,S,T,L=u[o],E=u[o+1],M=u[o+2],P=u[a],R=u[a+1],I=u[a+2],$=u[s],O=u[s+1],D=u[s+2],F=Math.round(p),N=Math.round(y),W=F;N>=W;W++){m>W?(T=p>W?0:p===m?1:(p-W)/(p-m),b=f-(f-g)*T,w=L-(L-P)*T,C=E-(E-R)*T,x=M-(M-I)*T):(T=W>y?1:m===y?0:(m-W)/(m-y),b=g-(g-v)*T,w=P-(P-$)*T,C=R-(R-O)*T,x=I-(I-D)*T),T=p>W?0:W>y?1:(p-W)/(p-y),k=f-(f-v)*T,_=L-(L-$)*T,A=E-(E-O)*T,S=M-(M-D)*T;for(var j=Math.round(Math.min(b,k)),H=Math.round(Math.max(b,k)),B=d*W+4*j,U=j;H>=U;U++)T=(b-U)/(b-k),T=0>T?0:T>1?1:T,h[B++]=w-(w-_)*T|0,h[B++]=C-(C-A)*T|0,h[B++]=x-(x-S)*T|0,h[B++]=255}}function t(t,n,i){var r,o,a=n.coords,l=n.colors;switch(n.type){case"lattice":var c=n.verticesPerRow,u=Math.floor(a.length/c)-1,h=c-1;for(r=0;u>r;r++)for(var d=r*c,f=0;h>f;f++,d++)e(t,i,a[d],a[d+1],a[d+c],l[d],l[d+1],l[d+c]),e(t,i,a[d+c+1],a[d+1],a[d+c],l[d+c+1],l[d+1],l[d+c]);break;case"triangles":for(r=0,o=a.length;o>r;r+=3)e(t,i,a[r],a[r+1],a[r+2],l[r],l[r+1],l[r+2]);break;default:s("illigal figure")}}function n(e,n,i,r,o,a,s){var c,u,h,d,f=1.1,p=3e3,g=Math.floor(e[0]),m=Math.floor(e[1]),v=Math.ceil(e[2])-g,y=Math.ceil(e[3])-m,b=Math.min(Math.ceil(Math.abs(v*n[0]*f)),p),w=Math.min(Math.ceil(Math.abs(y*n[1]*f)),p),C=v/b,x=y/w,k={coords:i,colors:r,offsetX:-g,offsetY:-m,scaleX:1/C,scaleY:1/x};if(l.isEnabled)c=l.drawFigures(b,w,a,o,k),u=s.getCanvas("mesh",b,w,!1),u.context.drawImage(c,0,0),c=u.canvas;else{u=s.getCanvas("mesh",b,w,!1);var _=u.context,A=_.createImageData(b,w);if(a){var S=A.data;for(h=0,d=S.length;d>h;h+=4)S[h]=a[0],S[h+1]=a[1],S[h+2]=a[2],S[h+3]=255}for(h=0;h<o.length;h++)t(A,o[h],k);_.putImageData(A,0,0),c=u.canvas}return{canvas:c,offsetX:g,offsetY:m,scaleX:C,scaleY:x}}return n}();c.Mesh={fromIR:function(e){var t=e[2],n=e[3],i=e[4],o=e[5],a=e[6],s=e[8];return{type:"Pattern",getPattern:function(e,l,c){var h;if(c)h=r.singularValueDecompose2dScale(e.mozCurrentTransform);else if(h=r.singularValueDecompose2dScale(l.baseTransform),a){var d=r.singularValueDecompose2dScale(a);h=[h[0]*d[0],h[1]*d[1]]}var f=u(o,h,t,n,i,c?null:s,l.cachedCanvases);return c||(e.setTransform.apply(e,l.baseTransform),a&&e.transform.apply(e,a)),e.translate(f.offsetX,f.offsetY),e.scale(f.scaleX,f.scaleY),e.createPattern(f.canvas,"no-repeat")}}}},c.Dummy={fromIR:function(){return{type:"Pattern",getPattern:function(){return"hotpink"}}}};var h=function(){function e(e,t,n,i,r){this.operatorList=e[2],this.matrix=e[3]||[1,0,0,1,0,0],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.color=t,this.canvasGraphicsFactory=i,this.baseTransform=r,this.type="Pattern",this.ctx=n}var t={COLORED:1,UNCOLORED:2},n=3e3;return e.prototype={createPatternCanvas:function(e){var t=this.operatorList,i=this.bbox,a=this.xstep,s=this.ystep,l=this.paintType,c=this.tilingType,u=this.color,h=this.canvasGraphicsFactory;o("TilingType: "+c);var d=i[0],f=i[1],p=i[2],g=i[3],m=[d,f],v=[d+a,f+s],y=v[0]-m[0],b=v[1]-m[1],w=r.singularValueDecompose2dScale(this.matrix),C=r.singularValueDecompose2dScale(this.baseTransform),x=[w[0]*C[0],w[1]*C[1]];y=Math.min(Math.ceil(Math.abs(y*x[0])),n),b=Math.min(Math.ceil(Math.abs(b*x[1])),n);var k=e.cachedCanvases.getCanvas("pattern",y,b,!0),_=k.context,A=h.createCanvasGraphics(_);A.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(_,l,u),this.setScale(y,b,a,s),this.transformToScale(A);var S=[1,0,0,1,-m[0],-m[1]];return A.transform.apply(A,S),this.clipBbox(A,i,d,f,p,g),A.executeOperatorList(t),k.canvas},setScale:function(e,t,n,i){this.scale=[e/n,t/i]},transformToScale:function(e){var t=this.scale,n=[t[0],0,0,t[1],0,0];e.transform.apply(e,n)},scaleToContext:function(){var e=this.scale;this.ctx.scale(1/e[0],1/e[1])},clipBbox:function(e,t,n,i,r,o){if(t&&a(t)&&4===t.length){var s=r-n,l=o-i;e.ctx.rect(n,i,s,l),e.clip(),e.endPath()}},setFillAndStrokeStyleToContext:function(e,n,i){switch(n){case t.COLORED:var o=this.ctx;e.fillStyle=o.fillStyle,e.strokeStyle=o.strokeStyle;break;case t.UNCOLORED:var a=r.makeCssRgb(i[0],i[1],i[2]);e.fillStyle=a,e.strokeStyle=a;break;default:s("Unsupported paint type: "+n)}},getPattern:function(e,t){var n=this.createPatternCanvas(t);return e=this.ctx,e.setTransform.apply(e,this.baseTransform),e.transform.apply(e,this.matrix),this.scaleToContext(),e.createPattern(n,"repeat")}},e}();e.getShadingPatternFromIR=i,e.TilingPattern=h}),function(e,t){t(e.pdfjsDisplayCanvas={},e.pdfjsSharedUtil,e.pdfjsDisplayPatternHelper,e.pdfjsDisplayWebGL)}(this,function(e,t,n,i){function r(e,t){var n=document.createElement("canvas");return n.width=e,n.height=t,n}function o(e){e.mozCurrentTransform||(e._originalSave=e.save,e._originalRestore=e.restore,e._originalRotate=e.rotate,e._originalScale=e.scale,e._originalTranslate=e.translate,e._originalTransform=e.transform,e._originalSetTransform=e.setTransform,e._transformMatrix=e._transformMatrix||[1,0,0,1,0,0],e._transformStack=[],Object.defineProperty(e,"mozCurrentTransform",{get:function(){return this._transformMatrix}}),Object.defineProperty(e,"mozCurrentTransformInverse",{get:function(){var e=this._transformMatrix,t=e[0],n=e[1],i=e[2],r=e[3],o=e[4],a=e[5],s=t*r-n*i,l=n*i-t*r;return[r/s,n/l,i/l,t/s,(r*o-i*a)/l,(n*o-t*a)/s]}}),e.save=function(){var e=this._transformMatrix;this._transformStack.push(e),this._transformMatrix=e.slice(0,6),this._originalSave()},e.restore=function(){var e=this._transformStack.pop();e&&(this._transformMatrix=e,this._originalRestore())},e.translate=function(e,t){var n=this._transformMatrix;n[4]=n[0]*e+n[2]*t+n[4],n[5]=n[1]*e+n[3]*t+n[5],this._originalTranslate(e,t)},e.scale=function(e,t){var n=this._transformMatrix;n[0]=n[0]*e,n[1]=n[1]*e,n[2]=n[2]*t,n[3]=n[3]*t,this._originalScale(e,t)},e.transform=function(t,n,i,r,o,a){var s=this._transformMatrix;this._transformMatrix=[s[0]*t+s[2]*n,s[1]*t+s[3]*n,s[0]*i+s[2]*r,s[1]*i+s[3]*r,s[0]*o+s[2]*a+s[4],s[1]*o+s[3]*a+s[5]],e._originalTransform(t,n,i,r,o,a)},e.setTransform=function(t,n,i,r,o,a){this._transformMatrix=[t,n,i,r,o,a],e._originalSetTransform(t,n,i,r,o,a)},e.rotate=function(e){var t=Math.cos(e),n=Math.sin(e),i=this._transformMatrix;this._transformMatrix=[i[0]*t+i[2]*n,i[1]*t+i[3]*n,i[0]*-n+i[2]*t,i[1]*-n+i[3]*t,i[4],i[5]],this._originalRotate(e)})}function a(e){var t,n,i,r,o=1e3,a=e.width,s=e.height,l=a+1,c=new Uint8Array(l*(s+1)),u=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),h=a+7&-8,d=e.data,f=new Uint8Array(h*s),p=0;for(t=0,r=d.length;r>t;t++)for(var g=128,m=d[t];g>0;)f[p++]=m&g?0:255,g>>=1;var v=0;for(p=0,0!==f[p]&&(c[0]=1,++v),n=1;a>n;n++)f[p]!==f[p+1]&&(c[n]=f[p]?2:1,++v),p++;for(0!==f[p]&&(c[n]=2,++v),t=1;s>t;t++){p=t*h,i=t*l,f[p-h]!==f[p]&&(c[i]=f[p]?1:8,++v);var y=(f[p]?4:0)+(f[p-h]?8:0);for(n=1;a>n;n++)y=(y>>2)+(f[p+1]?4:0)+(f[p-h+1]?8:0),u[y]&&(c[i+n]=u[y],++v),p++;if(f[p-h]!==f[p]&&(c[i+n]=f[p]?2:4,++v),v>o)return null}for(p=h*(s-1),i=t*l,0!==f[p]&&(c[i]=8,++v),n=1;a>n;n++)f[p]!==f[p+1]&&(c[i+n]=f[p]?4:8,++v),p++;if(0!==f[p]&&(c[i+n]=4,++v),v>o)return null;var b=new Int32Array([0,l,-1,0,-l,0,0,0,1]),w=[];for(t=0;v&&s>=t;t++){for(var C=t*l,x=C+a;x>C&&!c[C];)C++;if(C!==x){var k,_=[C%l,t],A=c[C],S=C;do{var T=b[A];do C+=T;while(!c[C]);k=c[C],5!==k&&10!==k?(A=k,c[C]=0):(A=k&51*A>>4,c[C]&=A>>2|A<<2),_.push(C%l),_.push(C/l|0),--v}while(S!==C);w.push(_),--t}}var L=function(e){e.save(),e.scale(1/a,-1/s),e.translate(0,-s),e.beginPath();for(var t=0,n=w.length;n>t;t++){var i=w[t];e.moveTo(i[0],i[1]);for(var r=2,o=i.length;o>r;r+=2)e.lineTo(i[r],i[r+1])}e.fill(),e.beginPath(),e.restore()};return L}var s=t.FONT_IDENTITY_MATRIX,l=t.IDENTITY_MATRIX,c=t.ImageKind,u=t.OPS,h=t.TextRenderingMode,d=t.Uint32ArrayView,f=t.Util,p=t.assert,g=t.info,m=t.isNum,v=t.isArray,y=t.error,b=t.shadow,w=t.warn,C=n.TilingPattern,x=n.getShadingPatternFromIR,k=i.WebGLUtils,_=16,A=100,S=4096,T=.65,L=!0,E=1e3,M=16,P=function(){function e(){this.cache=Object.create(null)}return e.prototype={getCanvas:function(e,t,n,i){var a;if(void 0!==this.cache[e])a=this.cache[e],a.canvas.width=t,a.canvas.height=n,a.context.setTransform(1,0,0,1,0,0);else{var s=r(t,n),l=s.getContext("2d");i&&o(l),this.cache[e]=a={canvas:s,context:l}}return a},clear:function(){for(var e in this.cache){var t=this.cache[e];t.canvas.width=0,t.canvas.height=0,delete this.cache[e]}}},e}(),R=function(){function e(e){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=l,this.textMatrixScale=1,this.fontMatrix=s,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=h.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.old=e}return e.prototype={clone:function(){return Object.create(this)},setCurrentPoint:function(e,t){this.x=e,this.y=t}},e}(),I=function(){function e(e,t,n,i){this.ctx=e,this.current=new R,this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=n,this.imageLayer=i,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.cachedCanvases=new P,e&&o(e),this.cachedGetSinglePixelWidth=null}function t(e,t){if("undefined"!=typeof ImageData&&t instanceof ImageData)return void e.putImageData(t,0,0);var n,i,r,o,a,s=t.height,l=t.width,u=s%M,h=(s-u)/M,f=0===u?h:h+1,p=e.createImageData(l,M),g=0,m=t.data,v=p.data;
if(t.kind===c.GRAYSCALE_1BPP){var b=m.byteLength,w=PDFJS.hasCanvasTypedArrays?new Uint32Array(v.buffer):new d(v),C=w.length,x=l+7>>3,k=4294967295,_=PDFJS.isLittleEndian||!PDFJS.hasCanvasTypedArrays?4278190080:255;for(i=0;f>i;i++){for(o=h>i?M:u,n=0,r=0;o>r;r++){for(var A=b-g,S=0,T=A>x?l:8*A-7,L=-8&T,E=0,P=0;L>S;S+=8)P=m[g++],w[n++]=128&P?k:_,w[n++]=64&P?k:_,w[n++]=32&P?k:_,w[n++]=16&P?k:_,w[n++]=8&P?k:_,w[n++]=4&P?k:_,w[n++]=2&P?k:_,w[n++]=1&P?k:_;for(;T>S;S++)0===E&&(P=m[g++],E=128),w[n++]=P&E?k:_,E>>=1}for(;C>n;)w[n++]=0;e.putImageData(p,0,i*M)}}else if(t.kind===c.RGBA_32BPP){for(r=0,a=l*M*4,i=0;h>i;i++)v.set(m.subarray(g,g+a)),g+=a,e.putImageData(p,0,r),r+=M;f>i&&(a=l*u*4,v.set(m.subarray(g,g+a)),e.putImageData(p,0,r))}else if(t.kind===c.RGB_24BPP)for(o=M,a=l*o,i=0;f>i;i++){for(i>=h&&(o=u,a=l*o),n=0,r=a;r--;)v[n++]=m[g++],v[n++]=m[g++],v[n++]=m[g++],v[n++]=255;e.putImageData(p,0,i*M)}else y("bad image kind: "+t.kind)}function n(e,t){for(var n=t.height,i=t.width,r=n%M,o=(n-r)/M,a=0===r?o:o+1,s=e.createImageData(i,M),l=0,c=t.data,u=s.data,h=0;a>h;h++){for(var d=o>h?M:r,f=3,p=0;d>p;p++)for(var g=0,m=0;i>m;m++){if(!g){var v=c[l++];g=128}u[f]=v&g?0:255,f+=4,g>>=1}e.putImageData(s,0,h*M)}}function i(e,t){for(var n=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"],i=0,r=n.length;r>i;i++){var o=n[i];void 0!==e[o]&&(t[o]=e[o])}void 0!==e.setLineDash?(t.setLineDash(e.getLineDash()),t.lineDashOffset=e.lineDashOffset):void 0!==e.mozDashOffset&&(t.mozDash=e.mozDash,t.mozDashOffset=e.mozDashOffset)}function r(e,t,n,i){for(var r=e.length,o=3;r>o;o+=4){var a=e[o];if(0===a)e[o-3]=t,e[o-2]=n,e[o-1]=i;else if(255>a){var s=255-a;e[o-3]=e[o-3]*a+t*s>>8,e[o-2]=e[o-2]*a+n*s>>8,e[o-1]=e[o-1]*a+i*s>>8}}}function I(e,t,n){for(var i=e.length,r=1/255,o=3;i>o;o+=4){var a=n?n[e[o]]:e[o];t[o]=t[o]*a*r|0}}function $(e,t,n){for(var i=e.length,r=3;i>r;r+=4){var o=77*e[r-3]+152*e[r-2]+28*e[r-1];t[r]=n?t[r]*n[o>>8]>>8:t[r]*o>>16}}function O(e,t,n,i,o,a,s){var l,c=!!a,u=c?a[0]:0,h=c?a[1]:0,d=c?a[2]:0;l="Luminosity"===o?$:I;for(var f=1048576,p=Math.min(i,Math.ceil(f/n)),g=0;i>g;g+=p){var m=Math.min(p,i-g),v=e.getImageData(0,g,n,m),y=t.getImageData(0,g,n,m);c&&r(v.data,u,h,d),l(v.data,y.data,s),e.putImageData(y,0,g)}}function D(e,t,n){var i=t.canvas,r=t.context;e.setTransform(t.scaleX,0,0,t.scaleY,t.offsetX,t.offsetY);var o=t.backdrop||null;if(!t.transferMap&&k.isEnabled){var a=k.composeSMask(n.canvas,i,{subtype:t.subtype,backdrop:o});return e.setTransform(1,0,0,1,0,0),void e.drawImage(a,t.offsetX,t.offsetY)}O(r,n,i.width,i.height,t.subtype,o,t.transferMap),e.drawImage(i,0,0)}var F=15,N=10,W=["butt","round","square"],j=["miter","round","bevel"],H={},B={};e.prototype={beginDrawing:function(e,t,n){var i=this.ctx.canvas.width,r=this.ctx.canvas.height;if(this.ctx.save(),this.ctx.fillStyle="rgb(255, 255, 255)",this.ctx.fillRect(0,0,i,r),this.ctx.restore(),n){var o=this.cachedCanvases.getCanvas("transparent",i,r,!0);this.compositeCtx=this.ctx,this.transparentCanvas=o.canvas,this.ctx=o.context,this.ctx.save(),this.ctx.transform.apply(this.ctx,this.compositeCtx.mozCurrentTransform)}this.ctx.save(),e&&this.ctx.transform.apply(this.ctx,e),this.ctx.transform.apply(this.ctx,t.transform),this.baseTransform=this.ctx.mozCurrentTransform.slice(),this.imageLayer&&this.imageLayer.beginLayout()},executeOperatorList:function(e,t,n,i){var r=e.argsArray,o=e.fnArray,a=t||0,s=r.length;if(s===a)return a;for(var l,c=s-a>N&&"function"==typeof n,h=c?Date.now()+F:0,d=0,f=this.commonObjs,p=this.objs;;){if(void 0!==i&&a===i.nextBreakPoint)return i.breakIt(a,n),a;if(l=o[a],l!==u.dependency)this[l].apply(this,r[a]);else for(var g=r[a],m=0,v=g.length;v>m;m++){var y=g[m],b="g"===y[0]&&"_"===y[1],w=b?f:p;if(!w.isResolved(y))return w.get(y,n),a}if(a++,a===s)return a;if(c&&++d>N){if(Date.now()>h)return n(),a;d=0}}},endDrawing:function(){this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.drawImage(this.transparentCanvas,0,0),this.transparentCanvas=null),this.cachedCanvases.clear(),k.clear(),this.imageLayer&&this.imageLayer.endLayout()},setLineWidth:function(e){this.current.lineWidth=e,this.ctx.lineWidth=e},setLineCap:function(e){this.ctx.lineCap=W[e]},setLineJoin:function(e){this.ctx.lineJoin=j[e]},setMiterLimit:function(e){this.ctx.miterLimit=e},setDash:function(e,t){var n=this.ctx;void 0!==n.setLineDash?(n.setLineDash(e),n.lineDashOffset=t):(n.mozDash=e,n.mozDashOffset=t)},setRenderingIntent:function(){},setFlatness:function(){},setGState:function(e){for(var t=0,n=e.length;n>t;t++){var i=e[t],r=i[0],o=i[1];switch(r){case"LW":this.setLineWidth(o);break;case"LC":this.setLineCap(o);break;case"LJ":this.setLineJoin(o);break;case"ML":this.setMiterLimit(o);break;case"D":this.setDash(o[0],o[1]);break;case"RI":this.setRenderingIntent(o);break;case"FL":this.setFlatness(o);break;case"Font":this.setFont(o[0],o[1]);break;case"CA":this.current.strokeAlpha=i[1];break;case"ca":this.current.fillAlpha=i[1],this.ctx.globalAlpha=i[1];break;case"BM":if(o&&o.name&&"Normal"!==o.name){var a=o.name.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()}).substring(1);this.ctx.globalCompositeOperation=a,this.ctx.globalCompositeOperation!==a&&w('globalCompositeOperation "'+a+'" is not supported')}else this.ctx.globalCompositeOperation="source-over";break;case"SMask":this.current.activeSMask&&this.endSMaskGroup(),this.current.activeSMask=o?this.tempSMask:null,this.current.activeSMask&&this.beginSMaskGroup(),this.tempSMask=null}}},beginSMaskGroup:function(){var e=this.current.activeSMask,t=e.canvas.width,n=e.canvas.height,r="smaskGroupAt"+this.groupLevel,o=this.cachedCanvases.getCanvas(r,t,n,!0),a=this.ctx,s=a.mozCurrentTransform;this.ctx.save();var l=o.context;l.scale(1/e.scaleX,1/e.scaleY),l.translate(-e.offsetX,-e.offsetY),l.transform.apply(l,s),i(a,l),this.ctx=l,this.setGState([["BM","Normal"],["ca",1],["CA",1]]),this.groupStack.push(a),this.groupLevel++},endSMaskGroup:function(){var e=this.ctx;this.groupLevel--,this.ctx=this.groupStack.pop(),D(this.ctx,this.current.activeSMask,e),this.ctx.restore(),i(e,this.ctx)},save:function(){this.ctx.save();var e=this.current;this.stateStack.push(e),this.current=e.clone(),this.current.activeSMask=null},restore:function(){0!==this.stateStack.length&&(null!==this.current.activeSMask&&this.endSMaskGroup(),this.current=this.stateStack.pop(),this.ctx.restore(),this.pendingClip=null,this.cachedGetSinglePixelWidth=null)},transform:function(e,t,n,i,r,o){this.ctx.transform(e,t,n,i,r,o),this.cachedGetSinglePixelWidth=null},constructPath:function(e,t){for(var n=this.ctx,i=this.current,r=i.x,o=i.y,a=0,s=0,l=e.length;l>a;a++)switch(0|e[a]){case u.rectangle:r=t[s++],o=t[s++];var c=t[s++],h=t[s++];0===c&&(c=this.getSinglePixelWidth()),0===h&&(h=this.getSinglePixelWidth());var d=r+c,f=o+h;this.ctx.moveTo(r,o),this.ctx.lineTo(d,o),this.ctx.lineTo(d,f),this.ctx.lineTo(r,f),this.ctx.lineTo(r,o),this.ctx.closePath();break;case u.moveTo:r=t[s++],o=t[s++],n.moveTo(r,o);break;case u.lineTo:r=t[s++],o=t[s++],n.lineTo(r,o);break;case u.curveTo:r=t[s+4],o=t[s+5],n.bezierCurveTo(t[s],t[s+1],t[s+2],t[s+3],r,o),s+=6;break;case u.curveTo2:n.bezierCurveTo(r,o,t[s],t[s+1],t[s+2],t[s+3]),r=t[s+2],o=t[s+3],s+=4;break;case u.curveTo3:r=t[s+2],o=t[s+3],n.bezierCurveTo(t[s],t[s+1],r,o,r,o),s+=4;break;case u.closePath:n.closePath()}i.setCurrentPoint(r,o)},closePath:function(){this.ctx.closePath()},stroke:function(e){e="undefined"!=typeof e?e:!0;var t=this.ctx,n=this.current.strokeColor;t.lineWidth=Math.max(this.getSinglePixelWidth()*T,this.current.lineWidth),t.globalAlpha=this.current.strokeAlpha,n&&n.hasOwnProperty("type")&&"Pattern"===n.type?(t.save(),t.strokeStyle=n.getPattern(t,this),t.stroke(),t.restore()):t.stroke(),e&&this.consumePath(),t.globalAlpha=this.current.fillAlpha},closeStroke:function(){this.closePath(),this.stroke()},fill:function(e){e="undefined"!=typeof e?e:!0;var t=this.ctx,n=this.current.fillColor,i=this.current.patternFill,r=!1;i&&(t.save(),this.baseTransform&&t.setTransform.apply(t,this.baseTransform),t.fillStyle=n.getPattern(t,this),r=!0),this.pendingEOFill?(void 0!==t.mozFillRule?(t.mozFillRule="evenodd",t.fill(),t.mozFillRule="nonzero"):t.fill("evenodd"),this.pendingEOFill=!1):t.fill(),r&&t.restore(),e&&this.consumePath()},eoFill:function(){this.pendingEOFill=!0,this.fill()},fillStroke:function(){this.fill(!1),this.stroke(!1),this.consumePath()},eoFillStroke:function(){this.pendingEOFill=!0,this.fillStroke()},closeFillStroke:function(){this.closePath(),this.fillStroke()},closeEOFillStroke:function(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()},endPath:function(){this.consumePath()},clip:function(){this.pendingClip=H},eoClip:function(){this.pendingClip=B},beginText:function(){this.current.textMatrix=l,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0},endText:function(){var e=this.pendingTextPaths,t=this.ctx;if(void 0===e)return void t.beginPath();t.save(),t.beginPath();for(var n=0;n<e.length;n++){var i=e[n];t.setTransform.apply(t,i.transform),t.translate(i.x,i.y),i.addToPath(t,i.fontSize)}t.restore(),t.clip(),t.beginPath(),delete this.pendingTextPaths},setCharSpacing:function(e){this.current.charSpacing=e},setWordSpacing:function(e){this.current.wordSpacing=e},setHScale:function(e){this.current.textHScale=e/100},setLeading:function(e){this.current.leading=-e},setFont:function(e,t){var n=this.commonObjs.get(e),i=this.current;if(n||y("Can't find font for "+e),i.fontMatrix=n.fontMatrix?n.fontMatrix:s,0!==i.fontMatrix[0]&&0!==i.fontMatrix[3]||w("Invalid font matrix for font "+e),0>t?(t=-t,i.fontDirection=-1):i.fontDirection=1,this.current.font=n,this.current.fontSize=t,!n.isType3Font){var r=n.loadedName||"sans-serif",o=n.black?n.bold?"900":"bold":n.bold?"bold":"normal",a=n.italic?"italic":"normal",l='"'+r+'", '+n.fallbackName,c=_>t?_:t>A?A:t;this.current.fontSizeScale=t/c;var u=a+" "+o+" "+c+"px "+l;this.ctx.font=u}},setTextRenderingMode:function(e){this.current.textRenderingMode=e},setTextRise:function(e){this.current.textRise=e},moveText:function(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t},setLeadingMoveText:function(e,t){this.setLeading(-t),this.moveText(e,t)},setTextMatrix:function(e,t,n,i,r,o){this.current.textMatrix=[e,t,n,i,r,o],this.current.textMatrixScale=Math.sqrt(e*e+t*t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0},nextLine:function(){this.moveText(0,this.current.leading)},paintChar:function(e,t,n){var i,r=this.ctx,o=this.current,a=o.font,s=o.textRenderingMode,l=o.fontSize/o.fontSizeScale,c=s&h.FILL_STROKE_MASK,u=!!(s&h.ADD_TO_PATH_FLAG);if((a.disableFontFace||u)&&(i=a.getPathGenerator(this.commonObjs,e)),a.disableFontFace?(r.save(),r.translate(t,n),r.beginPath(),i(r,l),c!==h.FILL&&c!==h.FILL_STROKE||r.fill(),c!==h.STROKE&&c!==h.FILL_STROKE||r.stroke(),r.restore()):(c!==h.FILL&&c!==h.FILL_STROKE||r.fillText(e,t,n),c!==h.STROKE&&c!==h.FILL_STROKE||r.strokeText(e,t,n)),u){var d=this.pendingTextPaths||(this.pendingTextPaths=[]);d.push({transform:r.mozCurrentTransform,x:t,y:n,fontSize:l,addToPath:i})}},get isFontSubpixelAAEnabled(){var e=document.createElement("canvas").getContext("2d");e.scale(1.5,1),e.fillText("I",0,10);for(var t=e.getImageData(0,0,10,10).data,n=!1,i=3;i<t.length;i+=4)if(t[i]>0&&t[i]<255){n=!0;break}return b(this,"isFontSubpixelAAEnabled",n)},showText:function(e){var t=this.current,n=t.font;if(n.isType3Font)return this.showType3Text(e);var i=t.fontSize;if(0!==i){var r=this.ctx,o=t.fontSizeScale,a=t.charSpacing,s=t.wordSpacing,l=t.fontDirection,c=t.textHScale*l,u=e.length,d=n.vertical,f=d?1:-1,p=n.defaultVMetrics,g=i*t.fontMatrix[0],v=t.textRenderingMode===h.FILL&&!n.disableFontFace;r.save(),r.transform.apply(r,t.textMatrix),r.translate(t.x,t.y+t.textRise),t.patternFill&&(r.fillStyle=t.fillColor.getPattern(r,this)),l>0?r.scale(c,-1):r.scale(c,1);var y=t.lineWidth,b=t.textMatrixScale;if(0===b||0===y){var w=t.textRenderingMode&h.FILL_STROKE_MASK;w!==h.STROKE&&w!==h.FILL_STROKE||(this.cachedGetSinglePixelWidth=null,y=this.getSinglePixelWidth()*T)}else y/=b;1!==o&&(r.scale(o,o),y/=o),r.lineWidth=y;var C,x=0;for(C=0;u>C;++C){var k=e[C];if(m(k))x+=f*k*i/1e3;else{var _,A,S,L,E=!1,M=(k.isSpace?s:0)+a,P=k.fontChar,R=k.accent,I=k.width;if(d){var $,O,D;$=k.vmetric||p,O=k.vmetric?$[1]:.5*I,O=-O*g,D=$[2]*g,I=$?-$[0]:I,_=O/o,A=(x+D)/o}else _=x/o,A=0;if(n.remeasure&&I>0){var F=1e3*r.measureText(P).width/i*o;if(F>I&&this.isFontSubpixelAAEnabled){var N=I/F;E=!0,r.save(),r.scale(N,1),_/=N}else I!==F&&(_+=(I-F)/2e3*i/o)}v&&!R?r.fillText(P,_,A):(this.paintChar(P,_,A),R&&(S=_+R.offset.x/o,L=A-R.offset.y/o,this.paintChar(R.fontChar,S,L)));var W=I*g+M*l;x+=W,E&&r.restore()}}d?t.y-=x*c:t.x+=x*c,r.restore()}},showType3Text:function(e){var t,n,i,r,o=this.ctx,a=this.current,l=a.font,c=a.fontSize,u=a.fontDirection,d=l.vertical?1:-1,p=a.charSpacing,g=a.wordSpacing,v=a.textHScale*u,y=a.fontMatrix||s,b=e.length,C=a.textRenderingMode===h.INVISIBLE;if(!C&&0!==c){for(this.cachedGetSinglePixelWidth=null,o.save(),o.transform.apply(o,a.textMatrix),o.translate(a.x,a.y),o.scale(v,u),t=0;b>t;++t)if(n=e[t],m(n))r=d*n*c/1e3,this.ctx.translate(r,0),a.x+=r*v;else{var x=(n.isSpace?g:0)+p,k=l.charProcOperatorList[n.operatorListId];if(k){this.processingType3=n,this.save(),o.scale(c,c),o.transform.apply(o,y),this.executeOperatorList(k),this.restore();var _=f.applyTransform([n.width,0],y);i=_[0]*c+x,o.translate(i,0),a.x+=i*v}else w('Type3 character "'+n.operatorListId+'" is not available')}o.restore(),this.processingType3=null}},setCharWidth:function(){},setCharWidthAndBounds:function(e,t,n,i,r,o){this.ctx.rect(n,i,r-n,o-i),this.clip(),this.endPath()},getColorN_Pattern:function(t){var n;if("TilingPattern"===t[0]){var i=t[1],r=this.baseTransform||this.ctx.mozCurrentTransform.slice(),o=this,a={createCanvasGraphics:function(t){return new e(t,o.commonObjs,o.objs)}};n=new C(t,i,this.ctx,a,r)}else n=x(t);return n},setStrokeColorN:function(){this.current.strokeColor=this.getColorN_Pattern(arguments)},setFillColorN:function(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0},setStrokeRGBColor:function(e,t,n){var i=f.makeCssRgb(e,t,n);this.ctx.strokeStyle=i,this.current.strokeColor=i},setFillRGBColor:function(e,t,n){var i=f.makeCssRgb(e,t,n);this.ctx.fillStyle=i,this.current.fillColor=i,this.current.patternFill=!1},shadingFill:function(e){var t=this.ctx;this.save();var n=x(e);t.fillStyle=n.getPattern(t,this,!0);var i=t.mozCurrentTransformInverse;if(i){var r=t.canvas,o=r.width,a=r.height,s=f.applyTransform([0,0],i),l=f.applyTransform([0,a],i),c=f.applyTransform([o,0],i),u=f.applyTransform([o,a],i),h=Math.min(s[0],l[0],c[0],u[0]),d=Math.min(s[1],l[1],c[1],u[1]),p=Math.max(s[0],l[0],c[0],u[0]),g=Math.max(s[1],l[1],c[1],u[1]);this.ctx.fillRect(h,d,p-h,g-d)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.restore()},beginInlineImage:function(){y("Should not call beginInlineImage")},beginImageData:function(){y("Should not call beginImageData")},paintFormXObjectBegin:function(e,t){if(this.save(),this.baseTransformStack.push(this.baseTransform),v(e)&&6===e.length&&this.transform.apply(this,e),this.baseTransform=this.ctx.mozCurrentTransform,v(t)&&4===t.length){var n=t[2]-t[0],i=t[3]-t[1];this.ctx.rect(t[0],t[1],n,i),this.clip(),this.endPath()}},paintFormXObjectEnd:function(){this.restore(),this.baseTransform=this.baseTransformStack.pop()},beginGroup:function(e){this.save();var t=this.ctx;e.isolated||g("TODO: Support non-isolated groups."),e.knockout&&w("Knockout groups not supported.");var n=t.mozCurrentTransform;e.matrix&&t.transform.apply(t,e.matrix),p(e.bbox,"Bounding box is required.");var r=f.getAxialAlignedBoundingBox(e.bbox,t.mozCurrentTransform),o=[0,0,t.canvas.width,t.canvas.height];r=f.intersect(r,o)||[0,0,0,0];var a=Math.floor(r[0]),s=Math.floor(r[1]),l=Math.max(Math.ceil(r[2])-a,1),c=Math.max(Math.ceil(r[3])-s,1),u=1,h=1;l>S&&(u=l/S,l=S),c>S&&(h=c/S,c=S);var d="groupAt"+this.groupLevel;e.smask&&(d+="_smask_"+this.smaskCounter++%2);var m=this.cachedCanvases.getCanvas(d,l,c,!0),v=m.context;v.scale(1/u,1/h),v.translate(-a,-s),v.transform.apply(v,n),e.smask?this.smaskStack.push({canvas:m.canvas,context:v,offsetX:a,offsetY:s,scaleX:u,scaleY:h,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null}):(t.setTransform(1,0,0,1,0,0),t.translate(a,s),t.scale(u,h)),i(t,v),this.ctx=v,this.setGState([["BM","Normal"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++},endGroup:function(e){this.groupLevel--;var t=this.ctx;this.ctx=this.groupStack.pop(),void 0!==this.ctx.imageSmoothingEnabled?this.ctx.imageSmoothingEnabled=!1:this.ctx.mozImageSmoothingEnabled=!1,e.smask?this.tempSMask=this.smaskStack.pop():this.ctx.drawImage(t.canvas,0,0),this.restore()},beginAnnotations:function(){this.save(),this.current=new R,this.baseTransform&&this.ctx.setTransform.apply(this.ctx,this.baseTransform)},endAnnotations:function(){this.restore()},beginAnnotation:function(e,t,n){if(this.save(),v(e)&&4===e.length){var i=e[2]-e[0],r=e[3]-e[1];this.ctx.rect(e[0],e[1],i,r),this.clip(),this.endPath()}this.transform.apply(this,t),this.transform.apply(this,n)},endAnnotation:function(){this.restore()},paintJpegXObject:function(e,t,n){var i=this.objs.get(e);if(!i)return void w("Dependent image isn't ready yet");this.save();var r=this.ctx;if(r.scale(1/t,-1/n),r.drawImage(i,0,0,i.width,i.height,0,-n,t,n),this.imageLayer){var o=r.mozCurrentTransformInverse,a=this.getCanvasPosition(0,0);this.imageLayer.appendImage({objId:e,left:a[0],top:a[1],width:t/o[0],height:n/o[3]})}this.restore()},paintImageMaskXObject:function(e){var t=this.ctx,i=e.width,r=e.height,o=this.current.fillColor,s=this.current.patternFill,l=this.processingType3;if(L&&l&&void 0===l.compiled&&(E>=i&&E>=r?l.compiled=a({data:e.data,width:i,height:r}):l.compiled=null),l&&l.compiled)return void l.compiled(t);var c=this.cachedCanvases.getCanvas("maskCanvas",i,r),u=c.context;u.save(),n(u,e),u.globalCompositeOperation="source-in",u.fillStyle=s?o.getPattern(u,this):o,u.fillRect(0,0,i,r),u.restore(),this.paintInlineImageXObject(c.canvas)},paintImageMaskXObjectRepeat:function(e,t,i,r){var o=e.width,a=e.height,s=this.current.fillColor,l=this.current.patternFill,c=this.cachedCanvases.getCanvas("maskCanvas",o,a),u=c.context;u.save(),n(u,e),u.globalCompositeOperation="source-in",u.fillStyle=l?s.getPattern(u,this):s,u.fillRect(0,0,o,a),u.restore();for(var h=this.ctx,d=0,f=r.length;f>d;d+=2)h.save(),h.transform(t,0,0,i,r[d],r[d+1]),h.scale(1,-1),h.drawImage(c.canvas,0,0,o,a,0,-1,1,1),h.restore()},paintImageMaskXObjectGroup:function(e){for(var t=this.ctx,i=this.current.fillColor,r=this.current.patternFill,o=0,a=e.length;a>o;o++){var s=e[o],l=s.width,c=s.height,u=this.cachedCanvases.getCanvas("maskCanvas",l,c),h=u.context;h.save(),n(h,s),h.globalCompositeOperation="source-in",h.fillStyle=r?i.getPattern(h,this):i,h.fillRect(0,0,l,c),h.restore(),t.save(),t.transform.apply(t,s.transform),t.scale(1,-1),t.drawImage(u.canvas,0,0,l,c,0,-1,1,1),t.restore()}},paintImageXObject:function(e){var t=this.objs.get(e);return t?void this.paintInlineImageXObject(t):void w("Dependent image isn't ready yet")},paintImageXObjectRepeat:function(e,t,n,i){var r=this.objs.get(e);if(!r)return void w("Dependent image isn't ready yet");for(var o=r.width,a=r.height,s=[],l=0,c=i.length;c>l;l+=2)s.push({transform:[t,0,0,n,i[l],i[l+1]],x:0,y:0,w:o,h:a});this.paintInlineImageXObjectGroup(r,s)},paintInlineImageXObject:function(e){var n=e.width,i=e.height,r=this.ctx;this.save(),r.scale(1/n,-1/i);var o,a,s=r.mozCurrentTransformInverse,l=s[0],c=s[1],u=Math.max(Math.sqrt(l*l+c*c),1),h=s[2],d=s[3],f=Math.max(Math.sqrt(h*h+d*d),1);if(e instanceof HTMLElement||!e.data)o=e;else{a=this.cachedCanvases.getCanvas("inlineImage",n,i);var p=a.context;t(p,e),o=a.canvas}for(var g=n,m=i,v="prescale1";u>2&&g>1||f>2&&m>1;){var y=g,b=m;u>2&&g>1&&(y=Math.ceil(g/2),u/=g/y),f>2&&m>1&&(b=Math.ceil(m/2),f/=m/b),a=this.cachedCanvases.getCanvas(v,y,b),p=a.context,p.clearRect(0,0,y,b),p.drawImage(o,0,0,g,m,0,0,y,b),o=a.canvas,g=y,m=b,v="prescale1"===v?"prescale2":"prescale1"}if(r.drawImage(o,0,0,g,m,0,-i,n,i),this.imageLayer){var w=this.getCanvasPosition(0,-i);this.imageLayer.appendImage({imgData:e,left:w[0],top:w[1],width:n/s[0],height:i/s[3]})}this.restore()},paintInlineImageXObjectGroup:function(e,n){var i=this.ctx,r=e.width,o=e.height,a=this.cachedCanvases.getCanvas("inlineImage",r,o),s=a.context;t(s,e);for(var l=0,c=n.length;c>l;l++){var u=n[l];if(i.save(),i.transform.apply(i,u.transform),i.scale(1,-1),i.drawImage(a.canvas,u.x,u.y,u.w,u.h,0,-1,1,1),this.imageLayer){var h=this.getCanvasPosition(u.x,u.y);this.imageLayer.appendImage({imgData:e,left:h[0],top:h[1],width:r,height:o})}i.restore()}},paintSolidColorImageMask:function(){this.ctx.fillRect(0,0,1,1)},paintXObject:function(){w("Unsupported 'paintXObject' command.")},markPoint:function(){},markPointProps:function(){},beginMarkedContent:function(){},beginMarkedContentProps:function(){},endMarkedContent:function(){},beginCompat:function(){},endCompat:function(){},consumePath:function(){var e=this.ctx;this.pendingClip&&(this.pendingClip===B?void 0!==e.mozFillRule?(e.mozFillRule="evenodd",e.clip(),e.mozFillRule="nonzero"):e.clip("evenodd"):e.clip(),this.pendingClip=null),e.beginPath()},getSinglePixelWidth:function(){if(null===this.cachedGetSinglePixelWidth){var e=this.ctx.mozCurrentTransformInverse;this.cachedGetSinglePixelWidth=Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1],e[2]*e[2]+e[3]*e[3]))}return this.cachedGetSinglePixelWidth},getCanvasPosition:function(e,t){var n=this.ctx.mozCurrentTransform;return[n[0]*e+n[2]*t+n[4],n[1]*e+n[3]*t+n[5]]}};for(var U in u)e.prototype[u[U]]=e.prototype[U];return e}();e.CanvasGraphics=I,e.createScratchCanvas=r}),function(e,t){t(e.pdfjsDisplayAPI={},e.pdfjsSharedUtil,e.pdfjsDisplayFontLoader,e.pdfjsDisplayCanvas,e.pdfjsDisplayMetadata,e.pdfjsSharedGlobal)}(this,function(e,t,n,r,o,a){function s(e,t,n,i){return e.destroyed?Promise.reject(new Error("Worker was destroyed")):(t.disableAutoFetch=P.disableAutoFetch,t.disableStream=P.disableStream,t.chunkedViewerLoading=!!n,n&&(t.length=n.length,t.initialData=n.initialData),e.messageHandler.sendWithPromise("GetDocRequest",{docId:i,source:t,disableRange:P.disableRange,maxImageSize:P.maxImageSize,cMapUrl:P.cMapUrl,cMapPacked:P.cMapPacked,disableFontFace:P.disableFontFace,disableCreateObjectURL:P.disableCreateObjectURL,verbosity:P.verbosity}).then(function(t){if(e.destroyed)throw new Error("Worker was destroyed");return t}))}var l=t.InvalidPDFException,c=t.MessageHandler,u=t.MissingPDFException,h=t.PasswordResponses,d=t.PasswordException,f=t.StatTimer,p=t.UnexpectedResponseException,g=t.UnknownErrorException,m=t.Util,v=t.createPromiseCapability,y=t.combineUrl,b=t.error,w=t.deprecated,C=t.info,x=t.isArrayBuffer,k=t.loadJpegStream,_=t.stringToBytes,A=t.warn,S=n.FontFaceObject,T=n.FontLoader,L=r.CanvasGraphics,E=r.createScratchCanvas,M=o.Metadata,P=a.PDFJS,R=a.globalScope,I=65536,$=!1;"undefined"!=typeof module&&module.require&&(P.disableWorker=!0,"undefined"==typeof require.ensure&&(require.ensure=require("node-ensure")),$=!0),"undefined"!=typeof __webpack_require__&&(P.workerSrc=require("entry?name=[hash]-worker.js!./pdf.worker.js"),$=!0),"undefined"!=typeof requirejs&&requirejs.toUrl&&(P.workerSrc=requirejs.toUrl("pdfjs-dist/build/pdf.worker.js"));var O=$?function(e){require.ensure([],function(){require("./pdf.worker.js"),e()})}:"undefined"!=typeof requirejs?function(e){requirejs(["pdfjs-dist/build/pdf.worker"],function(){e()})}:null;P.maxImageSize=void 0===P.maxImageSize?-1:P.maxImageSize,P.cMapUrl=void 0===P.cMapUrl?null:P.cMapUrl,P.cMapPacked=void 0===P.cMapPacked?!1:P.cMapPacked,P.disableFontFace=void 0===P.disableFontFace?!1:P.disableFontFace,P.imageResourcesPath=void 0===P.imageResourcesPath?"":P.imageResourcesPath,P.disableWorker=void 0===P.disableWorker?!1:P.disableWorker,P.workerSrc=void 0===P.workerSrc?null:P.workerSrc,P.disableRange=void 0===P.disableRange?!1:P.disableRange,P.disableStream=void 0===P.disableStream?!1:P.disableStream,P.disableAutoFetch=void 0===P.disableAutoFetch?!1:P.disableAutoFetch,P.pdfBug=void 0===P.pdfBug?!1:P.pdfBug,P.postMessageTransfers=void 0===P.postMessageTransfers?!0:P.postMessageTransfers,P.disableCreateObjectURL=void 0===P.disableCreateObjectURL?!1:P.disableCreateObjectURL,P.disableWebGL=void 0===P.disableWebGL?!0:P.disableWebGL,P.disableFullscreen=void 0===P.disableFullscreen?!1:P.disableFullscreen,P.useOnlyCssZoom=void 0===P.useOnlyCssZoom?!1:P.useOnlyCssZoom,P.verbosity=void 0===P.verbosity?P.VERBOSITY_LEVELS.warnings:P.verbosity,P.maxCanvasPixels=void 0===P.maxCanvasPixels?16777216:P.maxCanvasPixels,P.openExternalLinksInNewWindow=void 0===P.openExternalLinksInNewWindow?!1:P.openExternalLinksInNewWindow,P.externalLinkTarget=void 0===P.externalLinkTarget?P.LinkTarget.NONE:P.externalLinkTarget,P.externalLinkRel=void 0===P.externalLinkRel?"noreferrer":P.externalLinkRel,P.isEvalSupported=void 0===P.isEvalSupported?!0:P.isEvalSupported,P.getDocument=function(e,t,n,i){var r=new D;arguments.length>1&&w("getDocument is called with pdfDataRangeTransport, passwordCallback or progressCallback argument"),t&&(t instanceof F||(t=Object.create(t),t.length=e.length,t.initialData=e.initialData,t.abort||(t.abort=function(){})),e=Object.create(e),e.range=t),r.onPassword=n||null,r.onProgress=i||null;var o;"string"==typeof e?o={url:e}:x(e)?o={data:e}:e instanceof F?o={range:e}:("object"!=typeof e&&b("Invalid parameter in getDocument, need either Uint8Array, string or a parameter object"),e.url||e.data||e.range||b("Invalid parameter object: need either .data, .range or .url"),o=e);var a={},l=null,u=null;for(var h in o)if("url"!==h||"undefined"==typeof window)if("range"!==h)if("worker"!==h)if("data"!==h||o[h]instanceof Uint8Array)a[h]=o[h];else{var d=o[h];"string"==typeof d?a[h]=_(d):"object"!=typeof d||null===d||isNaN(d.length)?x(d)?a[h]=new Uint8Array(d):b("Invalid PDF binary data: either typed array, string or array-like object is expected in the data property."):a[h]=new Uint8Array(d)}else u=o[h];else l=o[h];else a[h]=y(window.location.href,o[h]);a.rangeChunkSize=a.rangeChunkSize||I,u||(u=new j,r._worker=u);var f=r.docId;return u.promise.then(function(){if(r.destroyed)throw new Error("Loading aborted");return s(u,a,l,f).then(function(e){if(r.destroyed)throw new Error("Loading aborted");var t=new c(f,e,u.port);t.send("Ready",null);var n=new H(t,r,l);r._transport=n})})["catch"](r._capability.reject),r};var D=function(){function e(){this._capability=v(),this._transport=null,this._worker=null,this.docId="d"+t++,this.destroyed=!1,this.onPassword=null,this.onProgress=null,this.onUnsupportedFeature=null}var t=0;return e.prototype={get promise(){return this._capability.promise},destroy:function(){this.destroyed=!0;var e=this._transport?this._transport.destroy():Promise.resolve();return e.then(function(){this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}.bind(this))},then:function(){return this.promise.then.apply(this.promise,arguments)}},e}(),F=function(){function e(e,t){this.length=e,this.initialData=t,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._readyCapability=v()}return e.prototype={addRangeListener:function(e){this._rangeListeners.push(e)},addProgressListener:function(e){this._progressListeners.push(e)},addProgressiveReadListener:function(e){this._progressiveReadListeners.push(e)},onDataRange:function(e,t){for(var n=this._rangeListeners,i=0,r=n.length;r>i;++i)n[i](e,t)},onDataProgress:function(e){this._readyCapability.promise.then(function(){for(var t=this._progressListeners,n=0,i=t.length;i>n;++n)t[n](e)}.bind(this))},onDataProgressiveRead:function(e){this._readyCapability.promise.then(function(){for(var t=this._progressiveReadListeners,n=0,i=t.length;i>n;++n)t[n](e)}.bind(this))},transportReady:function(){this._readyCapability.resolve()},requestDataRange:function(){throw new Error("Abstract method PDFDataRangeTransport.requestDataRange")},abort:function(){}},e}();P.PDFDataRangeTransport=F;var N=function(){function e(e,t,n){this.pdfInfo=e,this.transport=t,this.loadingTask=n}return e.prototype={get numPages(){return this.pdfInfo.numPages},get fingerprint(){return this.pdfInfo.fingerprint},getPage:function(e){return this.transport.getPage(e)},getPageIndex:function(e){return this.transport.getPageIndex(e)},getDestinations:function(){return this.transport.getDestinations()},getDestination:function(e){return this.transport.getDestination(e)},getPageLabels:function(){return this.transport.getPageLabels()},getAttachments:function(){return this.transport.getAttachments()},getJavaScript:function(){return this.transport.getJavaScript()},getOutline:function(){return this.transport.getOutline()},getMetadata:function(){return this.transport.getMetadata()},getData:function(){return this.transport.getData()},getDownloadInfo:function(){return this.transport.downloadInfoCapability.promise},getStats:function(){return this.transport.getStats()},cleanup:function(){this.transport.startCleanup()},destroy:function(){return this.loadingTask.destroy()}},e}(),W=function(){function e(e,t,n){this.pageIndex=e,this.pageInfo=t,this.transport=n,this.stats=new f,this.stats.enabled=!!R.PDFJS.enableStats,this.commonObjs=n.commonObjs,this.objs=new B,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this.intentStates={},this.destroyed=!1}return e.prototype={get pageNumber(){return this.pageIndex+1},get rotate(){return this.pageInfo.rotate},get ref(){return this.pageInfo.ref},get view(){return this.pageInfo.view},getViewport:function(e,t){return arguments.length<2&&(t=this.rotate),new P.PageViewport(this.view,e,t,0,0)},getAnnotations:function(e){var t=e&&e.intent||null;return this.annotationsPromise&&this.annotationsIntent===t||(this.annotationsPromise=this.transport.getAnnotations(this.pageIndex,t),this.annotationsIntent=t),this.annotationsPromise},render:function(e){function t(e){var t=r.renderTasks.indexOf(o);t>=0&&r.renderTasks.splice(t,1),s.cleanupAfterRender&&(s.pendingCleanup=!0),s._tryCleanup(),e?o.capability.reject(e):o.capability.resolve(),n.timeEnd("Rendering"),n.timeEnd("Overall")}var n=this.stats;n.time("Overall"),this.pendingCleanup=!1;var i="print"===e.intent?"print":"display";this.intentStates[i]||(this.intentStates[i]={});var r=this.intentStates[i];r.displayReadyCapability||(r.receivingOperatorList=!0,r.displayReadyCapability=v(),r.operatorList={fnArray:[],argsArray:[],lastChunk:!1},this.stats.time("Page Request"),this.transport.messageHandler.send("RenderPageRequest",{pageIndex:this.pageNumber-1,intent:i}));var o=new z(t,e,this.objs,this.commonObjs,r.operatorList,this.pageNumber);o.useRequestAnimationFrame="print"!==i,r.renderTasks||(r.renderTasks=[]),r.renderTasks.push(o);var a=o.task;e.continueCallback&&(w("render is used with continueCallback parameter"),a.onContinue=e.continueCallback);var s=this;return r.displayReadyCapability.promise.then(function(e){return s.pendingCleanup?void t():(n.time("Rendering"),o.initalizeGraphics(e),void o.operatorListChanged())},function(e){t(e)}),a},getOperatorList:function(){function e(){n.operatorList.lastChunk&&n.opListReadCapability.resolve(n.operatorList)}var t="oplist";this.intentStates[t]||(this.intentStates[t]={});var n=this.intentStates[t];if(!n.opListReadCapability){var i={};i.operatorListChanged=e,n.receivingOperatorList=!0,n.opListReadCapability=v(),n.renderTasks=[],n.renderTasks.push(i),n.operatorList={fnArray:[],argsArray:[],lastChunk:!1},this.transport.messageHandler.send("RenderPageRequest",{pageIndex:this.pageIndex,intent:t})}return n.opListReadCapability.promise},getTextContent:function(e){var t=e&&e.normalizeWhitespace||!1;return this.transport.messageHandler.sendWithPromise("GetTextContent",{pageIndex:this.pageNumber-1,normalizeWhitespace:t})},_destroy:function(){this.destroyed=!0,this.transport.pageCache[this.pageIndex]=null;var e=[];return Object.keys(this.intentStates).forEach(function(t){var n=this.intentStates[t];n.renderTasks.forEach(function(t){var n=t.capability.promise["catch"](function(){});e.push(n),t.cancel()})},this),this.objs.clear(),this.annotationsPromise=null,this.pendingCleanup=!1,Promise.all(e)},destroy:function(){w("page destroy method, use cleanup() instead"),this.cleanup()},cleanup:function(){this.pendingCleanup=!0,this._tryCleanup()},_tryCleanup:function(){this.pendingCleanup&&!Object.keys(this.intentStates).some(function(e){var t=this.intentStates[e];return 0!==t.renderTasks.length||t.receivingOperatorList},this)&&(Object.keys(this.intentStates).forEach(function(e){delete this.intentStates[e]},this),this.objs.clear(),
this.annotationsPromise=null,this.pendingCleanup=!1)},_startRenderPage:function(e,t){var n=this.intentStates[t];n.displayReadyCapability&&n.displayReadyCapability.resolve(e)},_renderPageChunk:function(e,t){var n,i,r=this.intentStates[t];for(n=0,i=e.length;i>n;n++)r.operatorList.fnArray.push(e.fnArray[n]),r.operatorList.argsArray.push(e.argsArray[n]);for(r.operatorList.lastChunk=e.lastChunk,n=0;n<r.renderTasks.length;n++)r.renderTasks[n].operatorListChanged();e.lastChunk&&(r.receivingOperatorList=!1,this._tryCleanup())}},e}(),j=function(){function e(){return P.workerSrc?P.workerSrc:i?i.replace(/\.js$/i,".worker.js"):void b("No PDFJS.workerSrc specified")}function t(){if(!P.fakeWorkerFilesLoadedCapability){P.fakeWorkerFilesLoadedCapability=v();var t=O||function(t){m.loadScript(e(),t)};t(function(){P.fakeWorkerFilesLoadedCapability.resolve()})}return P.fakeWorkerFilesLoadedCapability.promise}function n(e){this.name=e,this.destroyed=!1,this._readyCapability=v(),this._port=null,this._webWorker=null,this._messageHandler=null,this._initialize()}var r=0;return n.prototype={get promise(){return this._readyCapability.promise},get port(){return this._port},get messageHandler(){return this._messageHandler},_initialize:function(){if(!R.PDFJS.disableWorker&&"undefined"!=typeof Worker){var t=e();try{var n=new Worker(t),i=new c("main","worker",n);i.on("test",function(e){if(this.destroyed)return this._readyCapability.reject(new Error("Worker was destroyed")),i.destroy(),void n.terminate();var t=e&&e.supportTypedArray;t?(this._messageHandler=i,this._port=n,this._webWorker=n,e.supportTransfers||(P.postMessageTransfers=!1),this._readyCapability.resolve()):(this._setupFakeWorker(),i.destroy(),n.terminate())}.bind(this)),i.on("console_log",function(e){console.log.apply(console,e)}),i.on("console_error",function(e){console.error.apply(console,e)}),i.on("ready",function(){if(this.destroyed)return this._readyCapability.reject(new Error("Worker was destroyed")),i.destroy(),void n.terminate();try{r()}catch(e){this._setupFakeWorker()}}.bind(this));var r=function(){var e=new Uint8Array([P.postMessageTransfers?255:0]);try{i.send("test",e,[e.buffer])}catch(t){C("Cannot use postMessage transfers"),e[0]=0,i.send("test",e)}};return void r()}catch(o){C("The worker has been disabled.")}}this._setupFakeWorker()},_setupFakeWorker:function(){R.PDFJS.disableWorker||(A("Setting up fake worker."),R.PDFJS.disableWorker=!0),t().then(function(){if(this.destroyed)return void this._readyCapability.reject(new Error("Worker was destroyed"));var e={_listeners:[],postMessage:function(e){var t={data:e};this._listeners.forEach(function(e){e.call(this,t)},this)},addEventListener:function(e,t){this._listeners.push(t)},removeEventListener:function(e,t){var n=this._listeners.indexOf(t);this._listeners.splice(n,1)},terminate:function(){}};this._port=e;var t="fake"+r++,n=new c(t+"_worker",t,e);P.WorkerMessageHandler.setup(n,e);var i=new c(t,t+"_worker",e);this._messageHandler=i,this._readyCapability.resolve()}.bind(this))},destroy:function(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}},n}();P.PDFWorker=j;var H=function(){function e(e,t,n){this.messageHandler=e,this.loadingTask=t,this.pdfDataRangeTransport=n,this.commonObjs=new B,this.fontLoader=new T(t.docId),this.destroyed=!1,this.destroyCapability=null,this.pageCache=[],this.pagePromises=[],this.downloadInfoCapability=v(),this.setupMessageHandler()}return e.prototype={destroy:function(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=v();var e=[];this.pageCache.forEach(function(t){t&&e.push(t._destroy())}),this.pageCache=[],this.pagePromises=[];var t=this,n=this.messageHandler.sendWithPromise("Terminate",null);return e.push(n),Promise.all(e).then(function(){t.fontLoader.clear(),t.pdfDataRangeTransport&&(t.pdfDataRangeTransport.abort(),t.pdfDataRangeTransport=null),t.messageHandler&&(t.messageHandler.destroy(),t.messageHandler=null),t.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise},setupMessageHandler:function(){function e(e){t.send("UpdatePassword",e)}var t=this.messageHandler,n=this.pdfDataRangeTransport;n&&(n.addRangeListener(function(e,n){t.send("OnDataRange",{begin:e,chunk:n})}),n.addProgressListener(function(e){t.send("OnDataProgress",{loaded:e})}),n.addProgressiveReadListener(function(e){t.send("OnDataRange",{chunk:e})}),t.on("RequestDataRange",function(e){n.requestDataRange(e.begin,e.end)},this)),t.on("GetDoc",function(e){var t=e.pdfInfo;this.numPages=e.pdfInfo.numPages;var n=this.loadingTask,i=new N(t,this,n);this.pdfDocument=i,n._capability.resolve(i)},this),t.on("NeedPassword",function(t){var n=this.loadingTask;return n.onPassword?n.onPassword(e,h.NEED_PASSWORD):void n._capability.reject(new d(t.message,t.code))},this),t.on("IncorrectPassword",function(t){var n=this.loadingTask;return n.onPassword?n.onPassword(e,h.INCORRECT_PASSWORD):void n._capability.reject(new d(t.message,t.code))},this),t.on("InvalidPDF",function(e){this.loadingTask._capability.reject(new l(e.message))},this),t.on("MissingPDF",function(e){this.loadingTask._capability.reject(new u(e.message))},this),t.on("UnexpectedResponse",function(e){this.loadingTask._capability.reject(new p(e.message,e.status))},this),t.on("UnknownError",function(e){this.loadingTask._capability.reject(new g(e.message,e.details))},this),t.on("DataLoaded",function(e){this.downloadInfoCapability.resolve(e)},this),t.on("PDFManagerReady",function(){this.pdfDataRangeTransport&&this.pdfDataRangeTransport.transportReady()},this),t.on("StartRenderPage",function(e){if(!this.destroyed){var t=this.pageCache[e.pageIndex];t.stats.timeEnd("Page Request"),t._startRenderPage(e.transparency,e.intent)}},this),t.on("RenderPageChunk",function(e){if(!this.destroyed){var t=this.pageCache[e.pageIndex];t._renderPageChunk(e.operatorList,e.intent)}},this),t.on("commonobj",function(e){if(!this.destroyed){var t=e[0],n=e[1];if(!this.commonObjs.hasData(t))switch(n){case"Font":var i,r=e[2];if("error"in r){var o=r.error;A("Error during font loading: "+o),this.commonObjs.resolve(t,o);break}i=new S(r),this.fontLoader.bind([i],function(){this.commonObjs.resolve(t,i)}.bind(this));break;case"FontPath":this.commonObjs.resolve(t,e[2]);break;default:o("Got unknown common object type "+n)}}},this),t.on("obj",function(e){if(!this.destroyed){var t,n=e[0],i=e[1],r=e[2],o=this.pageCache[i];if(!o.objs.hasData(n))switch(r){case"JpegStream":t=e[3],k(n,t,o.objs);break;case"Image":t=e[3],o.objs.resolve(n,t);var a=8e6;t&&"data"in t&&t.data.length>a&&(o.cleanupAfterRender=!0);break;default:b("Got unknown object type "+r)}}},this),t.on("DocProgress",function(e){if(!this.destroyed){var t=this.loadingTask;t.onProgress&&t.onProgress({loaded:e.loaded,total:e.total})}},this),t.on("PageError",function(e){if(!this.destroyed){var t=this.pageCache[e.pageNum-1],n=t.intentStates[e.intent];n.displayReadyCapability?n.displayReadyCapability.reject(e.error):b(e.error)}},this),t.on("UnsupportedFeature",function(e){if(!this.destroyed){var t=e.featureId,n=this.loadingTask;n.onUnsupportedFeature&&n.onUnsupportedFeature(t),P.UnsupportedManager.notify(t)}},this),t.on("JpegDecode",function(e){if(this.destroyed)return Promise.reject("Worker was terminated");var t=e[0],n=e[1];return 3!==n&&1!==n?Promise.reject(new Error("Only 3 components or 1 component can be returned")):new Promise(function(e,i){var r=new Image;r.onload=function(){var t=r.width,i=r.height,o=t*i,a=4*o,s=new Uint8Array(o*n),l=E(t,i),c=l.getContext("2d");c.drawImage(r,0,0);var u,h,d=c.getImageData(0,0,t,i).data;if(3===n)for(u=0,h=0;a>u;u+=4,h+=3)s[h]=d[u],s[h+1]=d[u+1],s[h+2]=d[u+2];else if(1===n)for(u=0,h=0;a>u;u+=4,h++)s[h]=d[u];e({data:s,width:t,height:i})},r.onerror=function(){i(new Error("JpegDecode failed to load image"))},r.src=t})},this)},getData:function(){return this.messageHandler.sendWithPromise("GetData",null)},getPage:function(e){if(0>=e||e>this.numPages||(0|e)!==e)return Promise.reject(new Error("Invalid page request"));var t=e-1;if(t in this.pagePromises)return this.pagePromises[t];var n=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(function(e){if(this.destroyed)throw new Error("Transport destroyed");var n=new W(t,e,this);return this.pageCache[t]=n,n}.bind(this));return this.pagePromises[t]=n,n},getPageIndex:function(e){return this.messageHandler.sendWithPromise("GetPageIndex",{ref:e})},getAnnotations:function(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})},getDestinations:function(){return this.messageHandler.sendWithPromise("GetDestinations",null)},getDestination:function(e){return this.messageHandler.sendWithPromise("GetDestination",{id:e})},getPageLabels:function(){return this.messageHandler.sendWithPromise("GetPageLabels",null)},getAttachments:function(){return this.messageHandler.sendWithPromise("GetAttachments",null)},getJavaScript:function(){return this.messageHandler.sendWithPromise("GetJavaScript",null)},getOutline:function(){return this.messageHandler.sendWithPromise("GetOutline",null)},getMetadata:function(){return this.messageHandler.sendWithPromise("GetMetadata",null).then(function(e){return{info:e[0],metadata:e[1]?new M(e[1]):null}})},getStats:function(){return this.messageHandler.sendWithPromise("GetStats",null)},startCleanup:function(){this.messageHandler.sendWithPromise("Cleanup",null).then(function(){for(var e=0,t=this.pageCache.length;t>e;e++){var n=this.pageCache[e];n&&n.cleanup()}this.commonObjs.clear(),this.fontLoader.clear()}.bind(this))}},e}(),B=function(){function e(){this.objs={}}return e.prototype={ensureObj:function(e){if(this.objs[e])return this.objs[e];var t={capability:v(),data:null,resolved:!1};return this.objs[e]=t,t},get:function(e,t){if(t)return this.ensureObj(e).capability.promise.then(t),null;var n=this.objs[e];return n&&n.resolved||b("Requesting object that isn't resolved yet "+e),n.data},resolve:function(e,t){var n=this.ensureObj(e);n.resolved=!0,n.data=t,n.capability.resolve(t)},isResolved:function(e){var t=this.objs;return t[e]?t[e].resolved:!1},hasData:function(e){return this.isResolved(e)},getData:function(e){var t=this.objs;return t[e]&&t[e].resolved?t[e].data:null},clear:function(){this.objs={}}},e}(),U=function(){function e(e){this._internalRenderTask=e,this.onContinue=null}return e.prototype={get promise(){return this._internalRenderTask.capability.promise},cancel:function(){this._internalRenderTask.cancel()},then:function(){return this.promise.then.apply(this.promise,arguments)}},e}(),z=function(){function e(e,t,n,i,r,o){this.callback=e,this.params=t,this.objs=n,this.commonObjs=i,this.operatorListIdx=null,this.operatorList=r,this.pageNumber=o,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this.useRequestAnimationFrame=!1,this.cancelled=!1,this.capability=v(),this.task=new U(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this)}return e.prototype={initalizeGraphics:function(e){if(!this.cancelled){P.pdfBug&&"StepperManager"in R&&R.StepperManager.enabled&&(this.stepper=R.StepperManager.create(this.pageNumber-1),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());var t=this.params;this.gfx=new L(t.canvasContext,this.commonObjs,this.objs,t.imageLayer),this.gfx.beginDrawing(t.transform,t.viewport,e),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback&&this.graphicsReadyCallback()}},cancel:function(){this.running=!1,this.cancelled=!0,this.callback("cancelled")},operatorListChanged:function(){return this.graphicsReady?(this.stepper&&this.stepper.updateOperatorList(this.operatorList),void(this.running||this._continue())):void(this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound))},_continue:function(){this.running=!0,this.cancelled||(this.task.onContinue?this.task.onContinue.call(this.task,this._scheduleNextBound):this._scheduleNext())},_scheduleNext:function(){this.useRequestAnimationFrame?window.requestAnimationFrame(this._nextBound):Promise.resolve(void 0).then(this._nextBound)},_next:function(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),this.callback())))}},e}();P.UnsupportedManager=function(){var e=[];return{listen:function(t){w("Global UnsupportedManager.listen is used:  use PDFDocumentLoadingTask.onUnsupportedFeature instead"),e.push(t)},notify:function(t){for(var n=0,i=e.length;i>n;n++)e[n](t)}}}(),e.getDocument=P.getDocument,e.PDFDataRangeTransport=F,e.PDFDocumentProxy=N,e.PDFPageProxy=W})}).call(r),e.PDFJS=r.pdfjsSharedGlobal.PDFJS,e.getDocument=r.pdfjsDisplayAPI.getDocument,e.PDFDataRangeTransport=r.pdfjsDisplayAPI.PDFDataRangeTransport,e.renderTextLayer=r.pdfjsDisplayTextLayer.renderTextLayer,e.AnnotationLayer=r.pdfjsDisplayAnnotationLayer.AnnotationLayer,e.CustomStyle=r.pdfjsDisplayDOMUtils.CustomStyle,e.PasswordResponses=r.pdfjsSharedUtil.PasswordResponses,e.InvalidPDFException=r.pdfjsSharedUtil.InvalidPDFException,e.MissingPDFException=r.pdfjsSharedUtil.MissingPDFException,e.UnexpectedResponseException=r.pdfjsSharedUtil.UnexpectedResponseException}),PDFJS.workerSrc="/assets/pdfjs/pdf.worker-897b16440ed121cb8697f758fe49c64f9dca1eb07d8f00909a442170a8f68bce.js",WL.PendingPromise=function(){"use strict";function e(){function e(e,i){t=e,n=i}var t,n;this.resolve=function(n){t&&t(n),e(null,null)},this.reject=function(t){n&&n(t),e(null,null)},this.renew=function(t){return this.resolve(t),new Promise(e)}}return e}(),WL.PdfLinkService=function(){"use strict";function e(){}return e.prototype={get page(){return 0},set page(e){},navigateTo:function(){},getDestinationHash:function(){return"#"},getAnchorUrl:function(){return"#"},setHash:function(){},executeNamedAction:function(){},cachePageRef:function(){}},e}(),WL.PdfPageViewer=function(){"use strict";function e(e,t,n){return t.getAnnotations({intent:"display"}).then(function(i){PDFJS.AnnotationLayer.render({viewport:n.clone({dontFlip:!0}),div:e[0],annotations:i,page:t,linkService:r}),e.find("a[href]").attr("target","_blank")})}function t(e){if(Math.floor(e)===e)return[e,1];var t=1/e,n=8;if(t>n)return[1,n];if(Math.floor(t)===t)return[1,t];for(var i=e>1?t:e,r=0,o=1,a=1,s=1;;){var l=r+a,c=o+s;if(c>n)break;l/c>=i?(a=l,s=c):(r=l,o=c)}return a/s-i>i-r/o?i===e?[r,o]:[o,r]:i===e?[a,s]:[s,a]}function n(e,t){var n=e%t;return 0===n?e:Math.round(e-n+t)}function i(i,r,c){function u(){r.height=0,r.width=0,c.empty(),i.height(0)}function h(e){var t=e.getViewport(1),n=i.width()/t.width;return e.getViewport(n)}function d(e){var o=h(e),a=window.devicePixelRatio||1,s=t(a);return r.height=n(o.height*a,s[0]),r.width=n(o.width*a,s[0]),r.style.width=n(o.width,s[1])+"px",i.height(o.height),{canvasContext:r.getContext("2d"),transform:[a,0,0,a,0,0],viewport:o}}function f(e){b.reject(e)}function p(){y=a,C.then(m)["catch"](f)}function g(){switch(y){case s:y=o,b.resolve(!0);break;case l:p();break;default:WL.flunk("rendered in bad state: "+y)}}function m(e){switch(y){case a:y=s,x(e).then(g)["catch"](f);break;case l:p();break;default:WL.flunk("loaded in bad state: "+y)}}function v(){switch(y){case o:p();break;case l:case a:case s:y=l;break;default:WL.flunk("render/update in invalid state: "+y)}}var y=o,b=new WL.PendingPromise,w=null,C=Promise.resolve(null),x=Promise.method(function(t){if(w=t,!t)return u(),null;c.empty();var n=d(t);return t.render(n).then(function(){return e(c,t,n.viewport)})});this.update=function(e){return C=e,this.render()},this.render=function(){var e=b.renew(!1);return v(),e},i.on("click",function(e){if(w&&e.originalEvent){var t=h(w).clone({dontFlip:!0}),n=i.offset(),r=t.convertToPdfPoint(e.pageX-n.left,e.pageY-n.top);e.originalEvent.wlPageClick={x:r[0],y:r[1]}}}),this.markPosition=function(e,t){if(!w)return null;var n=h(w).clone({dontFlip:!0}),r=n.convertToViewportPoint(e,t);return{element:i[0],x:r[0],y:r[1]}}}var r=new WL.PdfLinkService,o=0,a=1,s=2,l=3;return i.KEY="wl-pdf-page-viewer",i.PAGE_CLASS="wl-pdf-page",i.ANNOTATION_CLASS="annotationLayer",i.make=function(){var e=$("<div>").addClass(this.PAGE_CLASS),t=$("<div>").addClass(this.ANNOTATION_CLASS),n=document.createElement("canvas");return e.data(this.KEY,new WL.PdfPageViewer(e,n,t)),e.append(t),e.append(n),e},i}(),WL.PdfViewer=function(){"use strict";function e(e){return _.range(1,e.numPages+1)}function t(t){return e(t).map(function(e){return t.getPage(e)})}function n(e){return e.getPage(1)}function i(t,n){return _.map(e(n),function(e){return t+"#"+e})}function r(e){return $(e).data(WL.PdfPageViewer.KEY)}function o(e){return $(e).data(l)}function a(e,t){return $(e).data(l,t)}function s(e){function s(){return e.find(c)}function l(t,n){function i(e,i){a(e,t[l]),u.push(r(e).update(n(i)))}var l,c=s(),u=[];for(l=0;l<t.length&&l<c.length;++l)t[l]!==o(c[l])&&i(c[l],l);for(;l<t.length;++l){var h=WL.PdfPageViewer.make();e.append(h),i(h,l)}for(;l<c.length;++l)$(c[l]).remove();return u}function m(e){var t=s().get(e-1);return t?r(t):null}function v(e){A.reject(e)}function y(){var e=S.pdfUrl,t=S.pageUrls;PDFJS.getDocument(e).then(function(n){x(n,t||i(e,n))})["catch"](v)}function b(e,n){function i(e){function t(t){return e[t]}return Promise.all(l(n,t))}Promise.resolve(t(e)).then(i).then(k)["catch"](v)}function w(){function e(e){return PDFJS.getDocument(t[e]).then(n)}var t=S.pageUrls;return Promise.all(l(t,e)).then(k)["catch"](v)}function C(e){switch(S=e,_){case u:_=h,y();break;case h:_=d;break;case d:case p:break;case f:_=p;break;case g:_=f,w();break;default:WL.flunk("bug: update in bad state: "+_)}}function x(e,t){switch(_){case h:_=f,b(e,t);break;case d:_=p,b(e,t);break;default:WL.flunk("bug: downloaded in bad state: "+_)}}function k(){switch(PDFJS.disableWorker=!0,_){case p:_=f,w();break;case f:_=g,A.resolve(!0);break;default:WL.flunk("bug: updated in bad state: "+_)}}var _=u,A=new WL.PendingPromise,S=null;e.on("click",c,function(e){if(e.originalEvent){var t=e.originalEvent.wlPageClick;t&&(t.page=s().index(this)+1)}}),this.markPosition=function(e,t,n){var i=m(e);return i?i.markPosition(t,n):null},this.load=function(e){return this.update({pdfUrl:e})},this.update=function(e){var t=A.renew(!1);return C(e),t},this.refresh=function(){return Promise.resolve(s().get()).map(r).map(function(e){return e.render()})}}var l="wl-page-url",c="div."+WL.PdfPageViewer.PAGE_CLASS,u=0,h=1,d=2,f=3,p=4,g=5;return s}(),WL.Preview=function(e,t,n,i,r,o,a){function s(t){return t.verId<=d||t.verId<f&&"success"!=t.status||t.verId==f?void F():void(t.manifestUrl?$.ajax({dataType:"json",url:t.manifestUrl,timeout:_,cache:0===W,success:function(n,i){e.makeSafeOnError(function(){n?(n.pageUrls&&(d=t.verId,k.update(n)),n.synctexFileUrl&&($("#synctex-edit-file-url").val(n.synctexFileUrl),$("#synctex-view-file-url").val(n.synctexFileUrl)),n.pdfUrl&&$("#synctex-edit-file").val(n.pdfUrl),t.verId>f&&(f=t.verId,p=t.status,m=n.markers,g=n.latexLogUrl),F(),WL.assert(f>=d,"preview <= status"),W=0,$("#preview-load-warning").trigger("dismiss")):j(t,"blank manifest",i,{manifest:n,previewFailCount:previewFailCount})})},error:function(n,i,r){e.makeSafeOnError(function(){var e=r+": "+i+";",o=n&&n.status;j(t,e,o,{manifestUrl:t.manifestUrl})})}}):t.verId>f&&(f=t.verId,p=t.status,m=[],g=null,F(),WL.assert(f>=d,"preview <= status")))}function l(){WL.ignoreErrors(function(){y=setTimeout(function(){},H)})}function c(){WL.ignoreErrors(function(){y&&(clearTimeout(y),y=null)})}function u(e){if(!q&&(q=!0,"error"===e||"timeout"===e||"failed"===e)){var t=$("#renderer-upgrade-notice");0!==t.length&&(t.trigger("summon"),analytics.track("renderer upgrade notice"))}}var h=this;h.autoRender=o;var d=0,f=0,p="loading",g=null,m=[],v="",y=null,b=$("<div>");b.addClass("marker_float"),b.hide(),$("body").append(b);var w=$("#preview_status_loading"),C=$("#preview_status_label"),x=$("#preview"),k=new WL.Pages(x),_=2e4;C.hide(),this.goToFirstMarker=function(){for(var e=n.lineCount(),t=0;e>t;++t){var i=n.getLineHandle(t);if(i.latexMarker)return n.setCursor({line:t,ch:0}),void n.focus()}m&&m.length&&!A()&&$("#preview_status").addClass("hover")},$(".preview_first_marker_link").bind("click",h.goToFirstMarker),$(".preview_with_popover").popover({placement:"bottom",html:!0,content:function(){return $("#wl_preview_status_popover_container").removeClass().addClass($(this).attr("id")),$("#preview_status_content").clone(!0)},container:"#wl_preview_status_popover_container"}).bind({"shown.bs.popover":function(){$("#wl_doc").trigger("twoUpResize")}}),$("#refresh-toggle").bind("click",function(e){return"INPUT"===e.target.tagName.toUpperCase()?void e.preventDefault():($(this).addClass("switch-wait"),void $("#preview_toggle_autorender > a").click())}),$("#wl_doc").bind("twoUpResize",function(e){if(e.target===this){var t=$("#refresh-toggle"),n=t.parent().siblings(".switch-title"),i=$("#preview_status"),r=$("#wl_preview_status_popover_container .popover"),o=$(".synctex-status:visible"),a=$("#wl_preview_menu .menu-resizable").width()-10,s=t.outerWidth(),l=n.outerWidth(),c=i.outerWidth(),u=o.outerWidth();s+l+c+u>=a&&o.hide(),s+l+c>=a?a>s+c?(n.hide(),i.removeClass("outside-menu"),r.removeClass("lower-popover")):(i.addClass("outside-menu"),r.addClass("lower-popover"),s+l>=a?n.hide():n.show()):(n.show(),i.removeClass("outside-menu"),r.removeClass("lower-popover"))}});var A=function(){return r.verId()>f||!r.upToDate()};this.outOfDate=function(){return A()};var S=function(){for(var e=n.lineCount(),t=0;e>t;++t)if(n.getLineHandle(t).latexMarker)return!0;return!1},T=function(){var e;if(e=A()?h.autoRender?"loading":"dirty":p,e!=v){if(v=e,$("#preview_status").stop(!0,!0).removeClass().show(1).css("overflow","visible"),$(".preview_first_marker").hide(),$(".preview_log").hide(),$(".wl-preview-clean").hide(),$(".wl-preview-timeout-help").hide(),$("#preview_status_error, #preview_status_warning, #preview_status_timeout").popover("hide"),C.show().children().hide(),$("#wl_preview_menu").removeClass("background-stripe-animate"),"loading"==e)l(),$("#preview_status_loading").show(),$("#wl_preview_menu").addClass("background-stripe-animate");else{switch(c(),g&&($(".preview_log").show(),$(".preview_log_link").attr("href",g)),$(".wl-preview-clean").show(),u(e),e){case"dirty":$("#preview_status").addClass("preview_status_dirty"),$("#preview_status_dirty").show();break;case"success":m&&m.length?($("#preview_status_warning").show(),$("#preview_status").addClass("preview_status_warning"),S()&&$(".preview_first_marker").show()):($("#preview_status_success").show(),$("#preview_status").addClass("preview_status_success"));break;case"error":$("#preview_status_error").show(),setTimeout(function(){$("#preview_status_error").popover("show")},300),$("#preview_status").addClass("preview_status_error"),!A()&&S()&&$(".preview_first_marker").show();break;case"timeout":$("#preview_status_timeout").show(),setTimeout(function(){$("#preview_status_error").popover("show")},300),$("#preview_status").addClass("preview_status_error"),$(".wl-preview-timeout-help").show(),analytics.track("preview timeout");break;case"failed":$("#preview_status_failed").show(),analytics.track("preview failed")}$(".preview_markers").children().size()>0?$(".preview_markers").show():$(".preview_markers").hide()}$("#wl_doc").trigger("twoUpResize")}};this.updateStatusIndicator=T,$("#preview_status_container").hover(function(){$("#preview_status").hasClass("preview_status_success")&&$("#preview_status").stop(!0,!0).show(1)},function(){$("#preview_status").hasClass("preview_status_success")&&$("#preview_status").delay(3e3).fadeOut("fast")}),$(".wl-preview-clean-link").on("click",function(){return h.manualRender("clean"),$(".preview_with_popover").popover("hide"),!1});var L=null;this.manualRender=function(e){C.show().children().hide(),$("#preview_status_loading").show(),$("#wl_preview_menu").addClass("background-stripe-animate"),$("#preview_status").removeClass(),$(".preview_log").hide(),$(".wl-preview-clean").hide(),v="loading";var t;switch(e){case"bump":t=$("#preview_manual_render_bumped");break;case"clean":t=$("#preview_manual_render_clean");break;default:t=$("#preview_manual_render")}var n=function(){r.upToDate()?(l(),U(),t.click()):null===L&&(L=window.setTimeout(function(){L=null,n()},500))};n()},this.manualRenderEnabled=function(){return A()&&!h.autoRender},this.markPosition=function(e,t,n){return k.markPosition(e,t,n)};var E=function(){for(var e=n.lineCount(),t=0;e>t;++t){var i=n.getLineHandle(t);i.latexMarker&&(n.setGutterMarker(i,"CodeMirror-linenumbers",null),n.removeLineClass(i,"background",M),n.removeLineClass(i,"background",P),delete i.latexMarker)}$(".preview_markers").empty()},M="CodeMirror-marker-error-background",P="CodeMirror-marker-warning-background",R=function(){m.forEach(function(e){if(e.file=="./"+i.srcFile()&&e.line){var t=n.setGutterMarker(e.line-1,"CodeMirror-linenumbers",$("<div>").text(e.line).attr("class","CodeMirror-linenumber "+("error"==e.kind?"marker_error":"marker_warning"))[0]);t.latexMarker=e,n.addLineClass(t,"background","error"==e.kind?M:P)}else{var r=$("<div>");r.addClass("marker_message"),r.addClass("error"==e.kind?"marker_message_error":"marker_message_warning"),e.file?e.line?r.text(e.file+":"+e.line+":\n"+e.message):r.text(e.file+":\n"+e.message):r.text("(no line number):\n"+e.message),$(".preview_markers").append(r)}})},I=function(e){var t=n.getLineHandle(e),i=t.latexMarker;if(i){var r=n.charCoords({line:e,ch:0});b.text(i.message),b.css("left",r.left+"px");var o=b.outerHeight(),a=r.top+t.height;a+o>n.getScrollInfo().clientHeight&&(a=r.top-o),b.css("top",a+"px"),"error"==i.kind?(b.addClass("marker_message_error"),b.removeClass("marker_message_warning")):(b.addClass("marker_message_warning"),b.removeClass("marker_message_error")),b.show()}else b.hide()},O=function(){$.ajax({url:"/docs/"+t+"/preview.js",type:"POST",timeout:_,success:function(t){e.makeSafeOnError(function(){if(t){if(t.reload)return void e.reload(!1);if(t.previewRender&&(s(t.previewRender),t.statusRender&&t.statusRender.verId===t.previewRender.verId))return;t.statusRender&&s(t.statusRender)}else D("bad response: "+t)})},error:function(t,n){e.makeSafeOnError(function(){D(n)})}})},D=function(){window.setTimeout(function(){e.makeSafeOnError(function(){O()})},_)},F=function(){E(),m&&!A()&&R(),I(n.getCursor().line),T(),window.setTimeout(function(){$("#wl_preview_status_popover_container .popover-content").is(":empty")&&WL.reportError("Preview status is empty. _outOfDate():"+A()+"/_renderStatus:"+p+"/_lastState:"+v+"/markers:"+(m&&m.length))},1e3)},N=function(){w.is(":visible")||F()},W=0,j=function(t,n,i,r){if(W++,1===W){if(404===i)return void h.manualRender("bump");WL.reportError("manifest download error (status="+i+"):"+n,r)}else if(W>3)return void $("#preview-load-warning").trigger("summon");window.setTimeout(function(){e.makeSafeOnError(function(){s(t)})},_)},H=5e4,B=null,U=function(){B=(new Date).getTime()},z=function(){B&&(G({done:!0}),B=null)},G=function(e){B&&(e.elapsed_time=(new Date).getTime()-B),$.ajax({type:"POST",url:"/docs/"+t+"/render_metrics",timeout:_,data:e})},q=!1;$(i).bind("initPusher",function(){i.docChannel().bind("preview-change",function(t){e.makeSafeOnError(function(){s(t),z()})}),i.docChannel().bind("auto-render-change",function(){WL.ignoreErrors(function(){a||$("#preview_refresh_auto_render").click()})})}),$(r).bind("connected",O),$(r).bind("polled",N),n.on("cursorActivity",function(){e.makeSafeOnError(function(){I(n.getCursor().line)})}),n.on("gutterClick",function(e,t){I(t)}),n.on("scroll",function(){I(n.getCursor().line)}),n.on("change",function(){e.makeSafeOnError(function(){w.is(":visible")&&!h.autoRender||(T(),E(),b.hide())})}),$("#preview_status").show()},WL.ImagePreview=function(){"use strict";function e(e){function o(n,r){var o=$("<div>");o.addClass(t);var a=$("<img>");a.addClass(i),a.attr("src",n),a.data("pageNumber",r),o.append(a),e.append(o)}this.update=function(t){function n(e){return s[e]?s[e]:"/assets/resources/page_timeout.png"}var i,a=e.find(r),s=t.pageUrls;for(i=0;i<s.length&&i<a.length;++i)a[i].src=n(i);for(;i<s.length;++i)o(n(i),i+1);for(;i<a.length;++i)$(a[i]).parent().remove();return s},e.on("click",r,function(e){if(e.originalEvent){var t=$(e.target),n=t.offset(),i=t.naturalWidth(),r=t.naturalHeight(),o=(e.clientX-n.left)*i/t.width(),a=(e.clientY-n.top)*r/t.height();e.originalEvent.wlPageClick={src:t.attr("src"),page:t.data("pageNumber"),x:o,y:a,imHeight:r,imWidth:i}}}),this.markPosition=function(t){var i=e.find(n),r=i.get(t-1);return r?{element:r}:null}}var t="preview_page_container",n="div."+t,i="preview_page",r="img."+i;return e}(),WL.Synctex=function(e,t,n){var i=$("#wl_preview"),r=$("#wl_preview_menu"),o=3e4,a=null,s=function(e){return WL.reportError("Synctex Client Error: "+e),$("#error-alert").trigger("summon").find("p").html("Sorry, we could not find the position you requested. If the preview is out of date, it may help to refresh it and try again. Otherwise, we know it's there somewhere, but you may have to find it manually.")},l=function(e){if(i.hasClass("synctex-ongoing")&&!e.rejected){if(h(!1),e.message)return s(e.message);e.line=e.line?e.line-1:0,e.ch=e.column&&e.column>0?e.column-1:0;var t=e.input,r={line:e.line,ch:e.ch};n.openFileByNameAtPosition(t,r)}};$(t).bind("initPusher",function(){t.docChannel().bind("synctex",function(t){e.makeSafeOnError(function(){"edit"===t.action?l(t):"view"===t.action?u(t):t.no_synctex_data?c():(h(!1),s("Wrong pusher message: "+JSON.stringify(t)))})})}),i.on("click",function(e){if(!i.hasClass("synctex-clicked")&&e.originalEvent){var t=e.originalEvent.wlPageClick;if(t){h(!0,!0);var n={},r=$("#synctex-edit-form");r.serializeArray().forEach(function(e){n[e.name]=e.value}),_.merge(n,t),$.ajax({type:"POST",url:r.attr("action"),data:n,success:function(e){return e&&e.no_synctex_data?c():void 0},error:function(e,t){h(!1),s(t)},dataType:"json"})}}});var c=function(){$("#notice").trigger("summon").find("p").html("This document is currently being rendered. Please try synctex again shortly."),$("#wl_preview").removeClass("synctex-ongoing"),$("#wl_preview_menu").removeClass("background-stripe-animate"),$(".synctex-status").hide(),WL.ui.preview.manualRender("bump"),f()},u=function(e){if(i.hasClass("synctex-ongoing")&&!e.rejected){if(h(!1),e.message||!e.hasOwnProperty("page"))return void s(e.message||JSON.stringify(e));var t=WL.ui.preview.markPosition(e.page,e.x,e.y);if(!t)return void s("no marker data after markPosition");var n;_.has(t,"x")&&_.has(t,"y")?(n=$("<div>"),n.addClass("synctex-marker"),n.css({left:t.x,top:t.y})):n=$('<div class="preview_overlay">'),$(t.element).append(n),n.delay(3e3).fadeTo(300,0,function(){$(this).remove()}),t.element.scrollIntoView(!0)}};CodeMirror.commands.synctexView=function(t){e.makeSafeOnError(function(){h(!0,!1);var n=t.getCursor(),i={line:(n.line||0)+1,column:(n.ch||0)+1,input:e.connection.srcFile()},r=$("#synctex-view-form");r.serializeArray().forEach(function(e){i[e.name]=e.value}),$.ajax({type:"POST",url:r.attr("action"),data:i,success:function(e){return e&&e.no_synctex_data?c():void 0},error:function(e,t){h(!1),s(t)},dataType:"json"})})};var h=function(e,t){i.toggleClass("synctex-ongoing",e),r.toggleClass("background-stripe-animate",e),e?(t?(i.addClass("synctex-clicked"),$("#synctex-status-edit").show()):$("#synctex-status-view").show(),$("#wl_doc").trigger("twoUpResize"),d()):(f(),$(".synctex-status").hide(),$(".preview_overlay").remove())},d=function(){f(),a=window.setTimeout(function(){h(!1),s("timeout")},o)},f=function(){window.clearTimeout(a)};i.bind("mousemove",function(){$(this).removeClass("synctex-clicked")})},WL.TeXcount=function(e,t,n){var i=this,r=3e4,o=$("#modal-texcount");this.requester=new WL.AsyncRequester(t,{start:function(){e.makeSafeOnError(function(){$.ajax({url:"/docs/"+n+"/texcount.js",timeout:r,type:"POST"}),i.showModal()})},stop:function(t){e.makeSafeOnError(function(){if(t){if(t&&t.texcount)return i.displayResult(t.texcount);if(t.code&&"ProjectNotFound"==t.code)return i.triggerRender()}return i.showOnly(".unhandled-error")})},pusherEvent:"texcount",retryTimeoutInterval:5e3,maxTries:5}),this.showModal=function(){o.modal("show"),i.showOnly(".loading")},this.showOnly=function(e){o.find(".texcount-content").hide(),o.find(e).show()},this.triggerRender=function(){i.showOnly(".render-missing"),WL.ui.preview.manualRender("bump")},this.displayResult=function(e){i.showOnly(".message"),
WL.ui.preview.outOfDate()&&o.find(".outdated").show();var t=e.output;e.errors&&e.errors.length>0&&(t+="\n"+e.errors.join("\n")),o.find(".message pre").text(t)},$(document).on("click","#modal-texcount .refresh-and-close",function(){return WL.ui.preview.manualRender("bump"),o.modal("hide"),!1}),$(document).on("click","#request-texcount",function(){return i.requester.start(),!1})},WL.Pages=function(e){function t(){d&&d.remove(),d=$("<div>"),e.append(d),u=null}function n(){p&&p.remove(),p=$("<div>"),e.append(p),f=null}function i(e){g!==e&&(g=e,p.toggle("pdf"===e),d.toggle("pdf"!==e))}function r(){return"pdf"===g?p.find(".wl-pdf-page"):d.find(".preview_page_container")}function o(){var t,n,i=1/0;m={},r().each(function(r){return n=Math.abs($(this).offset().top-e.offset().top),i>=n?(i=n,t=$(this),m.num=r,void 0):!1}),m.num>=0&&(m.offset=t.offset().top/t.outerHeight(),m.offset*=-1)}function a(){if(m.num>=0&&"undefined"!=typeof m.offset){var t=e.offset().top;r().each(function(e){return e===m.num?(t+=$(this).outerHeight()*m.offset,!1):void(t+=$(this).outerHeight())}),t=Math.round(t),Math.abs(e.scrollTop()-t)>1&&e.scrollTop(t)}}function s(e){i("image"),u||(u=new WL.ImagePreview(d),$(window).on("twoUpResize",a)),u.update(e)}function l(e){WL.reportError(e),WL.errorHandler.makeSafe("pdf-preview-error")}function c(e){i("pdf"),f||(f=new WL.PdfViewer(p),$(window).on("twoUpResize",_.debounce(function(){f.refresh().then(a)["catch"](l)},h))),f.update(e)["catch"](PDFJS.MissingPDFException,function(){n(),WL.ui&&WL.ui.preview.manualRender("bump")})["catch"](l)}var u,h=200,d=null;t();var f,p=null;n();var g,m={};e.scroll(_.debounce(o,h)),this.update=function(e){"pdf"===e.pageFormat?c(e):s(e)},this.markPosition=function(e,t,n){return"pdf"===g?f.markPosition(e,t,n):u.markPosition(e,t,n)}},WL.twoUps=function(e,t){t&&($(".wl_divider_collapse_mobile").addClass("wl_divider_collapse"),$(".wl_divider_collapse_mobile_left").addClass("wl_divider_collapse_left"),$(".wl_divider_collapse_mobile_right").addClass("wl_divider_collapse_right"),$("#wl_editor").is(":visible")&&$(".wl_divider_collapse_mobile_left").show(),$("#wl_preview").is(":visible")&&$(".wl_divider_collapse_mobile_right").show()),this.twoUp=new WL.TwoUp(e,$("#wl_pinned"),$("#wl_pin_divider"),$("#wl_doc"),$("#wl_main_container"),100,500,!1),this.twoUpInner=new WL.TwoUp(e,$("#wl_editor"),$("#wl_divider"),$("#wl_preview"),$("#wl_doc"),315,150,!0),this.twoUpEditor=new WL.TwoUp(e,$("#wl_editor_content .CodeMirror-merge-pane:first"),$("#wl_editor_content .CodeMirror-merge-gap"),$("#wl_editor_content .CodeMirror-merge-pane:last"),$("#wl_editor_content"),100,100,!1),$(".pannel-bar:not(.pannel-merge-bar), #wl_pin_divider, #wl_divider").show(),$(window).resize(function(){$("#wl_main_container").trigger("twoUpResize");var t=0;$(".editor-bar-left:visible").each(function(){t+=$(this).outerHeight()}),$("#wl_editor .CodeMirror").height($("#wl_editor").height()-t),e.refresh()}),$("#wl_main_container").bind("twoUpResize",function(e){e.target===this&&($("#wl_doc").trigger("twoUpResize"),$("#modal-att").trigger("twoUpResize"))}),$("#wl_doc").bind("twoUpResize",function(e){e.target===this&&$("#wl_editor_content").trigger("twoUpResize")}),$("#wl_editor_content").bind("twoUpResize",function(t){t.target===this&&(e.refresh(),$("#wl_editor_menu .dropdown.open").removeClass("open"))}),$("#modal-att").bind("twoUpResize",function(e){if(e.target===this){$("#modal-att").css("left",$("#wl_doc").css("left")),$("#modal-att").css("width",$("#wl_doc").css("width"));var t=$("#modal-att .modal-body-content").height(),n=$("#img-att").outerHeight();if(n>0){var i=parseInt((t-n)/2);$("#img-att").css("margin-top",i+"px")}}}),new WL.viewportFix,$(window).trigger("resize")},WL.TwoUp=function(e,t,n,i,r,o,a,s){var l=this,c=n.children(".wl_divider_collapse_left"),u=n.children(".wl_divider_collapse_right"),h=null;this.leftPanelVisible=function(){return t.is(":visible")},this.rightPanelVisible=function(){return i.is(":visible")};var d=function(e,t){return t>0?e/t*100+"%":e},f=function(e,s,c){var u=s?s.position:n.position(),h=u.left,f=n.outerWidth(),p=r.width();if(l.leftPanelVisible())if(l.rightPanelVisible()){var g=p-(h+f);a>=g&&(h=p-(a+f),g=a),o>h&&(h=o,g=p-(h+f)),i.width(d(g,p)),t.width(d(h,p)),n.css({left:d(h,p)})}else n.css({right:0}),t.width(d(p-f,p));else n.css({left:0}),i.width(d(p-f,p));c&&$(r).trigger("twoUpResize")};r.bind("twoUpResize",function(e){e.target===this&&f(null,null,!1)}),n.draggable({axis:"x",containment:"parent",scroll:!1,drag:function(e,t){if(!l.twoUp())return!1;var n=$(t.helper).outerWidth(),i=$(t.helper).parent().width(),r=o,s=i-a-n;t.position.left<r?t.position.left=d(r,i):t.position.left>s?t.position.left=d(r,i):f(e,t,!0)},stop:function(e,t){var n=$(t.helper).parent().width();$(this).css("left",d($(this).position().left,n)),g()}});var p=function(){var e=0;return function(t,n){clearTimeout(e),e=setTimeout(t,n)}}();$(window).resize(function(){p(function(){g()},500)}),this.collapseTwoUp=function(e){h=n.position().left,o>h&&(h=o),h=d(h,n.parent().width()),"left"==e?(l.rightPanelVisible()||l.restoreTwoUp(),c.hide(),u.show(),n.css({left:0}),t.hide()):"right"==e&&(l.leftPanelVisible()||l.restoreTwoUp(),u.hide(),n.css({right:0}),n.css({left:"auto"}),i.hide(),s&&$("#wl_preview_status_popover_container").hide()),n.css({cursor:"inherit"}),f(null,null,!0)},this.restoreTwoUp=function(){n.css({left:h,cursor:"col-resize"}),n.css({right:"auto"}),c.show(),i.show(),t.show(),u.show(),f(null,null,!0),s&&$("#wl_preview_status_popover_container").show()},c.click(function(){return l.rightPanelVisible()?l.collapseTwoUp("left"):l.restoreTwoUp(),g(),!1}),u.click(function(){return l.leftPanelVisible()?l.collapseTwoUp("right"):l.restoreTwoUp(),g(),!1});var g=function(){if(s){var e=null;l.leftPanelVisible()?l.rightPanelVisible()?($.removeCookie("wl_editor_collapse"),e=d(n.position().left,n.parent().width())):($.cookie("wl_editor_collapse","right",{expires:14,path:"/"}),e=h):($.cookie("wl_editor_collapse","left",{expires:14,path:"/"}),e=h),$.cookie("wl_editor_position",encodeURIComponent(e),{expires:14,path:"/"})}},m=function(){if(!$.cookie("wl_editor_position"))return void n.css({left:"60%"});var e=decodeURIComponent($.cookie("wl_editor_position"));n.css({left:e}),$.cookie("wl_editor_collapse")&&l.collapseTwoUp($.cookie("wl_editor_collapse"))};s&&m(),this.twoUp=function(){return l.leftPanelVisible()&&l.rightPanelVisible()}},WL.viewportFix=function(){$(window).resize(function(){var e="1.0",t="user-scalable=no, ";window.screen.width<500?(t+="width=500",e=window.screen.width/500):t+="width=device-width, initial-scale=1",WL.ios_9&&(t+=", maximum-scale="+e),$("meta[name='viewport']").attr("content",t)})},WL.Files=function(e,t,n,i,r,o,a,s,l,c,u){function h(){return $("#new_folder .file_label").text()}function d(e,t,n,i){var r=t.find("td.file_label");i.oldPath=e,i.label=r.text(),r.empty();var o=$("<input>",{type:"text",val:e,"class":n+" form-control",maxlength:255}).data(i).appendTo(r);f(e,o)}function f(e,t){var n,i=e.lastIndexOf("/")+1;n=e.indexOf(".")>0?e.lastIndexOf("."):e.length+1,t.focus().setSelection(i,n)}function p(e,i){$.ajax({url:"/docs/"+t+"/files/rename_folder.js",type:"POST",timeout:k,data:{old_path:e,new_path:i,socket_id:n.pusher().connection.socket_id},error:function(){$("#error-alert").trigger("summon").find("p").html("Sorry, the rename failed. Please refresh the page and try again. If this problem persists, please contact us.")}})}function g(e,i){$.ajax({url:"/docs/"+t+"/"+i.kind+"s/"+i.fileId+"/rename.js",type:"POST",timeout:k,data:{new_name:e,socket_id:n.pusher().connection.socket_id},error:function(){$("#error-alert").trigger("summon").find("p").html("Sorry, the rename failed. Please refresh the page and try again. If this problem persists, please contact us.")}})}function m(e){e.parent().siblings(".file_controls").find("a.rename").show(),e.val(e.data("oldPath")),e.parent().text(e.data("label"))}var v=this,y="undefined"!=typeof filepicker;y&&filepicker.setKey(r),$.browser.msie&&parseInt($.browser.version)<=9&&(c=!1);var b=$("#upload_refresh"),w=$("#files_refresh"),C=1e4,x=9,k=3e4,_=null,A=($("#upload_working")[0],null),S=null;b.hide(),w.hide(),$(n).bind("initPusher",function(){n.docChannel().bind("att-change",function(){e.makeSafeOnError(v.refresh)}),n.docChannel().bind("new-ver",function(e){$("#files").trigger("new-version",e)}),n.docChannel().bind("upload-done",function(t){e.makeSafeOnError(function(){R(t.uploadId)})})}),$(n).bind("connected",function(){v.updateAfterRefresh()}),$(i).bind("polled",function(){WL.makeDropboxSaver&&WL.makeDropboxSaver(i.verId())}),$(document).on("ajax:before","a.file_destroy",function(e){WL.ignoreErrors(function(){var t=e.currentTarget.id.replace("file_destroy","#file_label");$(t).css("text-decoration","line-through")})}),$(document).on("ajax:beforeSend","a.file_destroy",function(e,t,i){t.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),i.data="file_socket_id="+n.pusher().connection.socket_id}),$(document).on("click","li.file",function(t){$(t.target).parents(".file_controls").length>0&&!$(t.target).is(".src_edit")&&!$(t.target).is(".att_preview")||$(t.target).is(":input")||e.makeSafeOnError(function(){var e=$(t.currentTarget).children("table").data("fileId");if(e){v.closeAtts();var n=$(t.currentTarget).children(".file_table").data("kind");switch(n){case"src":v.openSrc(e);break;case"att":v.openAtt(e);break;case"ext":v.openAtt(e);break;default:var i="Unknown file kind: "+n;$("#error-alert").trigger("summon").find("p").html(i),Wl.reportError(i)}}})}),this.startMergeMode=function(e){S=e,this.refresh()},this.stopMergeMode=function(){S=null,this.refresh()},this.refresh=function(){var e="/docs/"+t+"/files/tree.js";$.ajax({url:e,type:"POST",timeout:k,data:{saved_ver_id:S},error:function(t){WL.reportAjaxError(t,e),$("#error-alert").trigger("summon").find("p").html("Sorry, we couldn't get the files list. Please refresh the page and try again. If this problem persists, please contact us.")}})},this.updateAfterRefresh=function(){if($("#files .file").each(function(){var e=$(this).children("table");if("src"===e.data("kind")){var t=e.data("fileId"),i=t==n.srcId();$("#file_src_"+t).toggleClass("current_src",i)}}),$(".current_src").parents("ul:not(#files-container-ul)")._openFolder(),T){var e=$('.file_folder[data-path="'+T+'"]');e.parents("ul:not(#files-container-ul)")._openFolder(),e.siblings("ul")._openFolder(),T=null}WL.isTouchScreen?$(".file_controls").removeClass("controls-hidden"):$(".file_controls").addClass("controls-hidden"),L(),$("#files").trigger("refreshed")},$.fn._openFolder=function(){$(this).collapse("show");var e=$(this).siblings(".file_table").find(".arrow");e.addClass("arrow-open"),e.addClass("wl-icon-arrow-wide-down"),e.removeClass("wl-icon-arrow-wide-right")};var T=null,L=function(){u||($("#files li table").mousedown(function(){$(this).addClass("active")}),$("#files-container-ul").mouseup(function(){$("#files li table").removeClass("active")}),$("#files li table").draggable({axis:"y",helper:"clone",addClasses:!1,start:function(e){return $(e.currentTarget).parent().hasClass("current_src")?!1:void 0},stop:function(){$("#files li table").removeClass("active")}}),$(".file_folder").droppable({hoverClass:"folder-droppable-hover",drop:function(t,n){e.makeSafeOnError(function(){var i=n.draggable.hasClass("file_folder"),r=n.draggable.data("path"),o=$(t.target).data("path");if(T=o,void 0!==r){""!==o&&(o+="/");var a=r.substring(r.lastIndexOf("/")+1,r.length);if(o+=a,r&&r!=o&&(i||o))if(e.showPleaseWait(),v.deleteNewFolder(),i)p(r,o);else{var s={kind:n.draggable.data("kind"),fileId:n.draggable.data("fileId")};g(o,s)}}})}}))};this.openSrc=function(t){e.editorView.clear(),i.openFile(t),e.hashUrl.clearAtt()},this.openAtt=function(t){$("#loading").trigger("summon");var n=$("#file_att_"+t+", #file_ext_"+t).children(".file_table");1===n.length&&(e.displayAttModal(t,n.data("url"),n.data("path"),n.data("isPdf"),n.data("isEps"),n.data("isImg"),n.data("kind"),n.data("openAs")),n.addClass("current_att"),"src"==n.data("openAs")&&E(n.data("url")))};var E=function(e){$.ajax({url:e,type:"GET",success:function(e){l.value=e;var t=CodeMirror($("#text-att")[0],l);$("#modal-att").modal("show"),t.refresh(),$("#text-att").unbind("keydown").bind("keydown",function(e){(70==e.keyCode&&(e.metaKey||e.ctrlKey)||27==e.keyCode)&&e.stopPropagation()}),$("#loading").trigger("dismiss")},error:function(){$("#error-alert").trigger("summon").find("p").html("We could not load the file's content. Please try again.\nIf this error persists, please contact us.")}})};this.closeAtts=function(){e.hideAttModal()},this.srcId=function(){return i.srcId()},this.uploadFile=function(n){A=null,$.ajax({url:"/docs/"+t+"/uploads.json",type:"POST",data:n,contentType:"application/json",success:function(t){e.makeSafeOnError(function(){t&&t.reload?e.reload(!1):t&&t.uploadId?v.startUploadAutoRefresh(t.uploadId):P()})},error:function(){e.makeSafeOnError(function(){P()})}})},this.startUploadAutoRefresh=function(e){A=e,A&&R(A);var t=$("#upload_progress"),n=$("#upload_messages");t.trigger("setStatus","info"),t.addClass("flyover-persistent"),t.addClass("flyover-animate"),t.trigger("summon"),n.html("Now adding files to your project&hellip;"),n.show(),$("#upload_error").hide();var i=0;_=window.setInterval(function(){_&&(i+=1,i>x?P():A&&R(A))},C)};var M=function(e){101==e.code||(WL.reportError(e.toString()),$("#error-alert").trigger("summon").find("p").html("Sorry, something when wrong. Please try again.\nIf this error persists, please contact us.\n"+e.toString()))},P=function(){var e=$("#upload_progress");e.trigger("setStatus","danger"),e.removeClass("flyover-animate"),e.removeClass("flyover-persistent"),e.trigger("summon"),$("#upload_messages").hide(),$("#upload_error").show(),clearTimeout(_),v.$elt&&B(v.$elt)&&v.deleteNewFolder(),_=null,A=null},R=function(e){u||(b.attr("href","/docs/"+t+"/uploads/"+e+".js"),b.click())},I=$("#file-menu-container");this.openFileMenu=function(e){var t=$(e);t.focus();var n=t.parents(".folder, .file").first();n.addClass("contextmenu-attached"),0===n.length&&(n=$(".folder").first());var i=t.offset().left,r=t.offset().top+t.outerHeight();O(n,i,r)},$("#project-files-container").on("contextmenu",".folder, .file",function(e){e.preventDefault(),e.stopPropagation(),O($(e.currentTarget),e.clientX-1,e.clientY-1),$(e.currentTarget).addClass("contextmenu-attached")});var O=function(e,t,n){I.data("attachedTo",e.attr("id"));var i=e.children(".file_table");I.trigger("displayMenu",{x:t,y:n,refocusAfer:!1}),e.parents("#files").length>0||e.hasClass("new_folder")?$(".file-menu-action").show():$(".file-menu-action").hide(),"ext"==i.data("kind")?$(".file-menu-action-ext").show():$(".file-menu-action-ext").hide(),e.find(".file[data-type=ext]").length>0?$(".file-menu-action-folder-ext").show():$(".file-menu-action-folder-ext").hide();var r=i.data("path"),o="src"==i.data("kind");o=o&&!i.data("main"),o=o&&/\.tex$/.test(r),o=o&&!/\//.test(r),$(".file-menu-action-main").toggle(o),h()?$("#new-folder-menu-item").addClass("shortcut-blank"):$("#new-folder-menu-item").removeClass("shortcut-blank"),I.trigger("content-changed")};this.startUpload=function(n,i){var a=!1;v.$elt=N(n);var s=v.$elt.children(".file_folder").data("path");s&&(s+="/");var l,u=["COMPUTER","DROPBOX","GOOGLE_DRIVE"],h=["GMAIL","BOX","GITHUB","FTP","WEBDAV"];if("OTHER"==i?l=h:"COMPUTER"==i&&c?a=!0:l=i?[i]:u.concat(h),e.menuPopoverPinHeader.close(),y&&r&&!a)try{filepicker.pickAndStore({multiple:!0,mimetype:"*/*",container:"modal",services:l},{location:"S3",path:"filepicker/",container:o},function(e){var t={filepickerUrl:e.map(function(e){return e.url}),path_prefix:s};v.uploadFile(JSON.stringify(t))},function(e){M(e)})}catch(d){WL.reportError(d),D()}else if(r)if(a){var f=$("#modal-fileloader").find(".modal-body");if(0===f.children().length){var p=f.get(0);ReactDOM.render(React.createElement(WL.Fileloader,null),p)}WL.fileloaderActions.initStore({prefix_path:s,docKey:t}),$("#modal-fileloader").modal({show:!0})}else D();else $("#modal-upload").modal({show:!0});return!1},this.finishUpload=function(e){clearTimeout(_),v.$elt&&B(v.$elt)&&v.deleteNewFolder(),_=null,A=null;var t=$("#upload_progress");t.removeClass("flyover-animate"),e?t.trigger("dismiss"):t.removeClass("flyover-persistent"),$("#modal-ext-files-bib").is(":visible")&&$("#modal-ext-files-bib").modal("hide"),$("#modal-mendeley-support-message").is(":visible")&&$("#modal-mendeley-support-message").modal("hide")},$(document).on("click","#upload_progress",function(){v.finishUpload(!0)});var D=function(){$("#error-alert").trigger("summon").find("p").html("Sorry, the file uploader failed to load. Please refresh the page and try again.\n\nIf this problem persists, it may be due to an ad- or script-block extension in your browser, or a network-wide content filter blocking our scripts. You may have to add exceptions for *."+APP_DOMAIN+" and *.filepicker.io in order to upload files.\n\nPlease feel free to contact us, and we'll try to help.")},F=function(e,t){var n=e.children("table"),i=0===e.children("#files").length;e=i?e:e.children("#files");var r=e.find("ul").eq(0),o=n.find("td")[0].style.paddingLeft.replace("px","");o=parseInt(o)+42;var a=$("<input>",{type:"text","class":"form-control",maxlength:255}),s=$("<li/>",{"class":"file"}).append($("<table/>",{"class":"file_table"}).append($("<tr/>").append($("<td/>",{style:"padding-left: "+o+"px;"}).append(a))));s.prependTo(r),e.parents("ul").is("#new_folder")||r._openFolder(),a.data("path",n.data("path")),a.focus(),a.blur(t),a.keyup(function(e){13==e.keyCode?(a.blur(),a.focus()):27==e.keyCode&&(a.val(""),a.blur())})},N=function(e){return H(e)||(e=e.parents(".folder").first()),e};this.createFile=function(t){return t=N(t),B(t)?(this.createFileInNewFolder(),!1):(e.menuPopoverPinHeader.close(),F(t,W),!1)};var W=function(){if($(this).data("submitted-with")!==$(this).val()){$(this).data("submitted-with",$(this).val());var i=$(this).val(),r=$(this).data("path");i?(e.showPleaseWait(),v.deleteNewFolder(),T=r,$.ajax({url:"/docs/"+t+"/srcs.js",type:"POST",timeout:k,data:{src:{file:(r?r+"/":"")+i},socket_id:n.pusher().connection.socket_id},error:function(){$("#error-alert").trigger("summon").find("p").html("Sorry, we couldn't create this file. Please refresh the page and try again. If this problem persists, please contact us.")}})):$(this).parents("li").eq(0).remove(),$("#new_folder li.file").remove()}};this.createNewFolder=function(){e.menuPopoverPinHeader.close(),h()?$("#error-alert").trigger("summon").find("p").html("You've already created a new folder, and at present you can only create one new folder at a time. Please create or upload a new file in your new folder before creating another one. We apologise for the inconvenience."):(F($("#files-container-ul > li"),j),$("#new_folder li.file").remove(),$("#new_folder > li > ul").removeClass("collapse").addClass("in").css("height","auto"))};var j=function(){var e=$(this).val();e&&($("#new_folder .file_label").text(e),$("#new_folder .file_table").data("path",e),$("#new_folder").show()),$(this).parents("li").eq(0).remove()};this.createFileInNewFolder=function(){var e=$("#new_folder").children("li");e.children("table").data("path",h()),F(e,W)},this.renameNewFolder=function(){var e=h();this.deleteNewFolder(),this.createNewFolder(e)},this.deleteNewFolder=function(){$("#new_folder .file_label").text(""),$("#new_folder").hide()};var H=function(e){return e.hasClass("folder")},B=function(e){return H(e)&&e.hasClass("new_folder")};this.destroy=function(e){var n,i,r,o=e.children(".file_table"),a=o.data("path"),s="/docs/"+t+"/";if(B(e))return this.deleteNewFolder(),!1;H(e)?(s+="files/delete_folder",n="POST",i={path:a}):(s+=o.data("kind")+"s/"+o.data("fileId"),n="DELETE"),r=e.find(".file_label").first().html();var l="Delete the "+r+(H(e)?" folder?":" file?");return WL.Confirm({title:"Delete",message:l,confirmButtonText:"Delete",cancelButtonText:"Cancel",confirmCallback:function(){$.ajax({url:s,type:n,timeout:k,data:i,error:function(){$("#error-alert").trigger("summon").find("p").html("Sorry, the delete failed. Please refresh the page and try again. If this problem persists, please contact us.")}})},cancelCallback:null}),!1},this.rename=function(e){if(B(e))return this.renameNewFolder(),!1;var t,n,i=e.children(".file_table"),r=i.data("path");return H(e)?(t="renameFolder",n={}):(t="renameFile",n={kind:i.data("kind"),fileId:i.data("fileId")}),d(r,i,t,n),!1},this.reload=function(e){var t=e.children(".file_table");t.data("kind");return"ext"==t.data("kind")?(s.reload(t.data("fileId")),!1):void 0},this.refreshExtFiles=function(e){return s.reloadFolder(e.find(".file[data-type=ext]")),!1},this.promoteMain=function(n){var i=n.children(".file_table"),r="/docs/"+t+"/";return r+=i.data("kind")+"s/"+i.data("fileId"),r+="/promote_main.js",e.showPleaseWait(),$.ajax({url:r,type:"POST",timeout:k,error:function(){$("#error-alert").trigger("summon").find("p").html("Sorry, the operation failed. Please refresh the page and try again. If this problem persists, please contact us.")},complete:function(){WL.ui.hidePleaseWait()}}),!1},$(document).on("keyup","input.renameFolder, input.renameFile",function(e){var t=e.keyCode||e.which;13==t?$(e.target).blur():27==t&&m($(e.target))}),$(document).on("blur","input.renameFolder, input.renameFile",function(t){var n=$(t.target),i=n.hasClass("renameFolder"),r=n.data("oldPath"),o=n.val();r&&r!=o&&(i||o)?(e.showPleaseWait(),v.deleteNewFolder(),i?p(r,o):g(o,n.data()),m(n)):r&&m(n)}),$("#project-files-container").on("click",".collapsable-folder table",function(e){if(!($(e.target).parents(".file_controls").length>0||$(e.target).is(":input"))){var t=$(this).parent().children("ul"),n=$(this).find(".arrow");n.hasClass("arrow-open")?(n.removeClass("arrow-open"),n.removeClass("wl-icon-arrow-wide-down"),n.addClass("wl-icon-arrow-wide-right"),t.collapse("hide")):(n.addClass("arrow-open"),n.addClass("wl-icon-arrow-wide-down"),n.removeClass("wl-icon-arrow-wide-right"),t.collapse("show"))}}),$("#modal-files").on("click",".file_src, .file_att",function(e){$(e.target).parents(".file_controls").length>0||$(e.target).is(":input")||$("#modal-files").modal("hide")})},WL.BibtexParser=function(e,t,n,i){function r(e,t){var n;if("string"!=typeof e)return void WL.reportError("_parseBibtex received a non-string: "+e);if(e.length){WL.ignoreErrors(function(){n=_.map(_.chunk(e.split("\n"),900),function(e){return e.join("\n")})});var i,r=function(e){t(e.EntryKey)},o=new BibtexParser(r),a=function(){i=n&&n.shift(),void 0!==i&&(o.parse(i),setTimeout(a))};a()}}function o(e){var t,o;if(_.has(s,e)||(s[e]={}),!s[e].updating){e.match(/^e[0-9]+$/)?(t=$(".file_ext[data-file-id="+e.substr(1)+"]").attr("data-url"),o="GET"):(t="/docs/"+n+"/srcs/"+e.substr(1)+"/latest.json",o="POST"),analytics.track("bibtex parser","GET"===o?"external":"internal");var l=s[e]&&s[e].verId;s[e].updating=!0,$.ajax({url:t,timeout:3e4,type:o,data:{protocolVersion:i,saved_ver_id:null},success:function(t){WL.ignoreErrors(function(){var n;if(_.isString(t))n=t;else{if(!t||!_.isString(t.content))return;n=t.content}s[e]={verId:t.verId||0,timestamp:_.now()},(!l||l&&l<t.verId)&&r(n,function(e){_.contains(a.entries,e)||a.entries.push(e)}),analytics.track("bibtex parser",50*Math.ceil(a.entries.length/50))})},complete:function(){s[e].updating=!1}})}}var a=this,s={};this.entries=[],this.parseBibtex=r,t.registerHelper(t.BIB_FILES,function(e){WL.ignoreErrors(function(){e&&_.has(e,"file_id")?o(e.file_id):_.delay(function(){_.forEach(s,function(t){_.contains(e.sources,t)||delete s[t]}),_.forEach(e.sources,function(e){o(e)})},100)})})},WL.ExtFiles=function(e,t,n,i){var r=this,o=3e4,a=new WL.PendingPromise,s=$("#modal-folder-ext"),l=$("#modal-ext-files"),c=$("#modal-ext-files-bib"),u=l.find(".modal-title"),h=$("#ext-create-container"),d=$("#ext-file-name"),f=$("#ext-oauth-container"),p=$("#ext-oauth-refresh-container"),g=$(".ext-oauth-button");$(t).bind("initPusher",function(){t.docChannel().bind("upload-done",function(){a.resolve()})}),this.openCreateModal=function(t,n){if(!i)return void $("#modal-upload").modal({show:!0});if(this.clearExtModal(),$("#modal-ext-files-bib").data("attached-to",t),"bib"==n)return c.modal("show"),void $(".create-ext-bib-link").unbind("click").bind("click",function(){$(this).data("bibAgent")&&r.openCreateModal(t,$(this).data("bibAgent"))});t.hasClass("folder")||(t=t.parents(".folder").first());var o=t.children(".file_folder").data("path");o&&(o+="/");var a;switch(n){case"url":a=new UrlAgent;break;case"citeulike":a=new CiteulikeAgent;break;case"zotero":a=new OauthAgent("zotero","Zotero");break;case"wloutput":a=new WlAgent("wloutput","doc");break;case"wlfile":a=new WlAgent("wlfile","file");break;case"mendeley":a=new MendeleyAgent;break;case"plotly":a=new PlotlyAgent}if(!a)return void WL.reportError("invalid agent key for openCreateModal: "+n);a.init(),$("#agent-create").unbind("click").bind("click",function(){if(a.validate()){var n=o+d.val();return m(a,n,function(n){return t.hasClass("new_folder")&&e.files.deleteNewFolder(),$("#loading").trigger("dismiss"),n.error?void $("#error-alert").trigger("summon").find("p").html(n.error):(r.clearExtModal(),l.modal("hide"),void e.files.startUploadAutoRefresh(n.uploadId))}),!1}});var s="change paste keyup.validate";$(".ext-input").unbind(s).bind(s,function(e){"ext-file-name"==$(e.target).attr("id")?0===$(this).val().length?$(this).data("user-custom",!1):$(this).data("user-custom",!0):d.data("user-custom")||d.val(a.inferFileName());var t=d.val().length>0&&a.validate();$("#agent-create").attr("disabled",!t)})};var m=function(e,t,i){$("#loading").trigger("summon"),$.ajax({url:"/docs/"+n+"/exts.json",type:"POST",timeout:o,data:{agent:e.key,agent_data:e.getUserInput(),ext:{file:t}},error:function(e){$("#loading").trigger("dismiss"),401==e.status?$("#error-alert").trigger("summon").find("p").html("Please sign in to create this file."):$("#error-alert").trigger("summon").find("p").html("Sorry, we couldn't create this file. Please refresh the page and try again. If this problem persists, please contact us.")},success:i})};this.reload=function(t,n){return t||(t=$(n).data("extId")),$("#loading").trigger("summon"),v(t).done(function(t){return $("#loading").trigger("dismiss"),t.error?void $("#error-alert").trigger("summon").find("p").html(t.error):t.reload?void WL.ui.docAccessError(!1):void e.files.startUploadAutoRefresh(t.uploadId)}).fail(function(e){$("#loading").trigger("dismiss"),$("#error-alert").trigger("summon").find("p").html(y(e.status))}),!1},this.reloadFolder=function(e){function t(e,i){function r(n,r,o){return n.finished?n.success?!0:void a(o.status):Promise.delay(5e3).then(function(){t(e,i-1)})}function a(e){b(y(e.status))}0>=i&&b("Could not upload file.");var s=$.ajax({url:"/docs/"+n+"/uploads/"+e+".json",type:"GET",timeout:o});return Promise.resolve(s).then(r)["catch"](a)}var i=[];s.modal("show"),$("#exts-file-name").html(""),$("#refresh-progress").show();var i=_.map(e,function(e){var t=$(e).children(".file_table");return{id:t.data("fileId"),name:t.data("path")}});return $("#exts-length").html("Refreshing "+i.length+" files"),Promise.each(i,function(e){function n(e){return e.uploadId?Promise.race([a.renew(),Promise.delay(1e4)]).then(function(){return t(e.uploadId,5)}):void b(e.error)}function i(e,t){b(e?y(e.status):t)}function r(){$("#exts-file-name").append('<li><i class="wl-icon wl-icon-tick"></i><b>'+e.name+"</b></li>")}function o(t){$("#exts-file-name").append('<li class="refreshFail"><i class="wl-icon wl-icon-cross"></i><b>'+e.name+"</b></li>"),$("#error-alert").trigger("summon").find("p").html(t.messages)}var s=v(e.id);return Promise.resolve(s).then(n)["catch"](function(e){i(null,e.messages)}).then(r)["catch"](o)}).then(function(){$("#refresh-progress").hide(),$("#exts-length").html("Refreshed "+i.length+" files")}),!1};var v=function(e){return $.ajax({url:"/docs/"+n+"/exts/"+e+"/reload.json",type:"POST",timeout:o,data:{}})},y=function(e){var t;return t=422==e?"Sorry, we couldn't find this file. Please try again later.":401==e?"You need to be signed in to refresh this file.":"Sorry, we couldn't create this file. Please refresh the page and try again. If this problem persists, please contact us."},b=function(e){var t=new Error;throw t.messages=e,t};this.clearExtModal=function(){$(".ext-input").val(""),d.data("user-custom",!1),$("#agent-create").attr("disabled","true"),$(".agent-container").hide(),h.hide(),u.text("External File"),f.hide()},g.bind("click",function(){$(this).attr("disabled",!0),p.show()}),$("#ext-oauth-refresh").bind("click",function(){$(window).trigger("oauth-complete")}),$(".ext-input:not(.no-submit)").bind("keyup.submit",function(e){13==e.keyCode&&$("#agent-create").trigger("click")}),UrlAgent=function(){var e=this;this.key="url",this.fields={url:$("#agent-param-url")};var t=$("#url-agent-container");this.init=function(){u.text("Add file from URL"),l.modal("show"),h.show(),t.show()},this.validate=function(){return e.fields.url.val().length>0},this.inferFileName=function(){var t=e.fields.url.val().split("/");if(t.length>1){var n=t.reverse()[0];if(n=/[^\?]*/.exec(n),/^[\w-]+\.[A-Za-z]{2,5}$/.test(n))return n}return""},this.getUserInput=function(){var t=e.fields.url.val();return t=t.replace(/^(http.*dropbox\.com.*\?dl=)0$/,"$11"),{url:t}}},CiteulikeAgent=function(){var e=this;this.key="citeulike",this.fields={username:$("#agent-param-citeulike-username"),group:$("#agent-param-citeulike-group")};var t=$("#citeulike-agent-container");this.init=function(){u.text("Add Bibliography from CiteULike"),l.modal("show"),h.show(),t.show()},this.validate=function(){var t=e.fields.username.val(),n=e.fields.group.val(),i=t.length>0,r=n==parseInt(n);return i||r},this.inferFileName=function(){var t=e.fields.username.val(),n=e.fields.group.val();return t.length>2?t+".bib":n==parseInt(n)?"group-"+n+".bib":""},this.getUserInput=function(){return{username:e.fields.username.val(),group:e.fields.group.val()}}};var w={zotero:null,mendeley:null};OauthAgent=function(e,t){var n=this;this.key=e,this.name=t;var i=$("."+n.key+"-agent-container");this.init=function(){return w[n.key]?void n.displayAgentUI():($("#loading").trigger("summon"),void r(function(e){e&&e.uid?w[n.key]=e.uid:w[n.key]=null,n.displayAgentUI()}))},this.displayAgentUI=function(){$("#loading").trigger("dismiss"),u.text("Add Bibliography from "+n.name),$("#modal-ext-files").is(":visible")||l.modal("show"),p.hide(),g.attr("disabled",!1),w[n.key]?(h.show(),f.hide(),d.data("user-custom")||(d.val(n.inferFileName()),$("#agent-create").attr("disabled",!1))):(h.hide(),f.show(),$(window).unbind("oauth-complete").bind("oauth-complete",function(){n.init()})),i.show()};var r=function(e){$.ajax({url:"/authentications/status/"+n.key+".json",type:"GET",timeout:o,success:e,error:function(){$("#loading").trigger("dismiss"),$("#error-alert").trigger("summon").find("p").html("Sorry, we couldn't connect to "+n.name+" at the moment. Please try again later. If this problem persists, please contact us.")}})};this.validate=function(){return!!w[n.key]},this.getUserInput=function(){return{}},this.inferFileName=function(){return n.name+".bib"}},MendeleyAgent=function(){var e=$("#mendeley-group-container"),t=$("#agent-param-mendeley-group"),n=new OauthAgent("mendeley","Mendeley"),i=n.displayAgentUI;n.displayAgentUI=function(){$.ajax({url:"/partners/mendeley/groups.json",type:"GET",timeout:o,success:function(e){r(e)},complete:function(){i()}})};var r=function(n){n&&0!==n.length&&(e.removeClass("hidden"),t.select2({width:"100%",placeholder:"No group selected",allowClear:!0,data:{results:n,text:"name"}}).select2("val",null))};return n.getUserInput=function(){return{group:t.val()}},n.inferFileName=function(){var e="Mendeley",n=t.select2("data"),i=n&&n.name;return i&&i.length>0&&(i=i.replace(" ","_","g"),e+="_"+i),e+".bib"},n},WlAgent=function(t,n){this.key=t,this.targetMode=n,this.fields={doc:$("#selected-doc-id"),file:$("#selected-file-id")};var i,r=$("#wl-agent-container");this.init=function(){e.makeSafeOnError(function(){i=new WL.FilesTree(e)}),"doc"==n?u.text("Add the Output of another "+APP_NAME+" Project"):u.text("Add a File from another "+APP_NAME+" Project"),l.modal("show"),h.show(),r.show();new i.ExtProjectView({$docsContainer:$("#wloutput-list > #docs-list"),$filesContainer:$("#wloutput-list > #files-list"),targetMode:this.targetMode})},this.validate=function(){return this.fields[this.targetMode].val().length>0},this.getUserInput=function(){var e={doc:this.fields.doc.val()};return"file"==this.targetMode&&(e.type=this.fields.file.data("type"),e.file=this.fields.file.val()),e},this.inferFileName=function(){return this.fields[this.targetMode].data("name");
}},PlotlyAgent=function(){var e=this;this.key="plotly",this.fields={username:$("#agent-param-plotly-username"),plot:$("#plotly-plot-url")},this.BASE_URL="https://api.plot.ly/v2/folders/home",this.BASE_PARAMS="?page_size=30&order_by=-date_modified&user=";var t=$("#agent-plotly-search"),n=$("#plotly-agent-container"),i=$("#plotly-plots");this.init=function(){u.text("Add plot from plot.ly"),l.modal("show"),h.show(),n.show(),t.unbind("click.plotly-agent").bind("click.plotly-agent",function(){e.getPlots()}),this.fields.username.unbind("keyup.plotly-agent").bind("keyup.plotly-agent",function(t){13==t.keyCode&&e.getPlots()})},this.getPlots=function(){$("#loading").trigger("summon"),$.ajax({url:this.BASE_URL+this.BASE_PARAMS+e.fields.username.val(),type:"GET",timeout:o,complete:function(){$("#loading").trigger("dismiss")},success:function(t){var n;n=t.children.results,n?e.displayPlots(n):e.displayError()},error:function(){e.displayError()}})},this.displayError=function(){$("#error-alert").trigger("summon").find("p").html("Sorry, we couldn't connect to Plot.ly at the moment. Please try again later. If this problem persists, please contact us.")},this.displayPlots=function(t){var n,r,o;i.empty(),_.each(t,function(t){r=t.image_urls["default"],o=t.title||t.filename||t.filetype,n=$("<div>").addClass("plotly-image-container").append($("<img>").attr("src",r).data("plotName",o).click(function(t){e.selectPlot(t)})),n.appendTo(i)})},this.selectPlot=function(e){var t=$(e.delegateTarget);$("#plotly-agent-container img.selected").removeClass("selected"),t.addClass("selected"),this.fields.plot.data("plotName",t.data("plotName")),this.fields.plot.val(t.attr("src")),this.fields.plot.trigger("change")},this.validate=function(){return this.fields.plot.length>0},this.getUserInput=function(){return{plot_url:this.fields.plot.val()}},this.inferFileName=function(){var e=this.fields.plot.data("plotName");return e&&(e+=".png"),e}}},WL.Exports=function(e,t,n){var i=this,r=3e4,o=1e4,a=1e3*$(".download-zip").data("max-timeout"),s=Math.ceil(a/o);this.zipRequester=new WL.AsyncRequester(n,{start:function(e){$.ajax({url:"/docs/"+t+"/zip.js",timeout:r,type:"POST",data:{zip_format:e}}),$("#loading-zip").trigger("summon")},stop:function(e){e&&e.zipUrl?WL.downloadFile(e.zipUrl):$("#loading-zip-error").trigger("summon"),$("#loading-zip").trigger("dismiss")},pusherEvent:"zip-ready",retryTimeoutInterval:o,maxTries:s}),$(document).on("click",".download-zip",function(){return i.zipRequester.start("zip"),analytics.track("saved zip"),!1}),$(document).on("click","a.download-zip-with-outputs",function(){return i.zipRequester.start("zip_with_outputs"),analytics.track("saved zip","zip_with_outputs"),!1}),$(document).on("click","a.download-zip-with-intermediates",function(){return i.zipRequester.start("zip_with_intermediates"),analytics.track("saved zip","zip_with_intermediates"),!1}),$(document).on("click","a.download-pdf",function(){return $("#export-pdf").click(),$("#loading-pdf").trigger("summon"),analytics.track("saved pdf"),!1})},WL.Publish=function(){this.$modal=new WL.AsyncModal("#modal-publish"),this.$modal.onShow(function(){analytics.track("publish menu"),this.toggleGuide(!1)}.bind(this)),$(document).on("click","a.publish-guide-link",function(e){var t=$(e.currentTarget).data("publishGuideId");return this.toggleGuide(!0,t),!1}.bind(this))},WL.Publish.prototype.toggleGuide=function(e,t){$("#publish-table").toggle(!e),$("#publish-modal-title").toggle(!e),$("#publish-guide-modal-title").toggle(e),$(".publish-guide").hide(),t&&$("#"+t).show()},WL.Publish.prototype.showContent=function(e){this.$modal.showContent(e,function(){this.$modal.$div.trigger("activate-affix-modal")}.bind(this))},WL.Share=function(){this.$modal=new WL.AsyncModal("#modal-share"),this.$modal.$div.on("click","a.protect,a.unprotect",function(e){var t=$(e.currentTarget);return $.post(t.attr("href")).then(function(){this.$modal.reloadModal(),updateMenuShareIcon(t)}.bind(this)),!1}.bind(this))},WL.Share.prototype.showContent=function(e){this.$modal.showContent(e,$.noop)},WL.Confirm=function(e){$confirmModal=$("#modal-confirm"),$confirmModal.find(".modal-title").html(e.title),$confirmModal.find(".modal-body > p").html(e.message),$confirmButton=$("#modal-confirm .modal-body .modal-confirm"),$cancelButton=$("#modal-confirm .modal-body .modal-close"),$confirmButton.html(e.confirmButtonText),$cancelButton.html(e.cancelButtonText),$confirmButton.one("click.confirmation",function(){return e.confirmCallback&&e.confirmCallback(),e.cancelCallback=null,$confirmModal.modal("hide"),!1}),$confirmModal.one("hidden.bs.modal",function(){return e.cancelCallback&&e.cancelCallback(),e.confirmCallback=null,$confirmButton.off("click.confirmation"),$confirmModal.modal("hide"),!1}),$confirmModal.modal("show")},WL.History=function(e,t,n,i){var r=$("#saved_vers_refresh"),o=null,a=3e4;$(document).on("ajax:before","a.saved_ver_destroy",function(e){WL.ignoreErrors(function(){analytics.track("destroyed saved version");var t=e.target.id.replace("saved_ver_destroy","#saved_ver_label");$(t).css("text-decoration","line-through")})}),$(document).on("focus","#saved_ver_comment",function(){var e=this;window.setTimeout(function(){$(e).select()},0)}),$(document).on("click","#saved_vers_submit",function(){analytics.track("saved version")}),$(i).bind("initPusher",function(){i.docChannel().bind("saved-ver-change",function(){e.makeSafeOnError(function(){r.click()})})});var s=function(n,i){var r="/docs/"+t+"/saved_vers/"+parseInt(n)+"/restore";$.ajax({url:r,type:"POST",headers:{"X-CSRF-Token":$('meta[name="csrf-token"]').attr("content")},data:{force:!!i},dataType:"json",timeout:a,success:function(t){e.makeSafeOnError(function(){e.updateDefaultSrc(t.mainSrc),e.openSrc(t.mainSrc),l(!0)})},error:function(t){e.makeSafeOnError(function(){409==t.status?confirm("There have been changes to this project. If you restore an old version without first saving the current version in the history menu, these changes will be lost.")?s(n,!0):l(!1):(WL.reportAjaxError(t,r),$("#error-alert").trigger("summon").find("p").html("Sorry, the restore failed. Please check your connection and try again. If this problem persists, please contact us."))})}})};this.restore=function(e){return o=1/0,analytics.track("restored saved version"),$("#loading").trigger("summon"),$(".modal").modal("hide"),s(e,!1),!1};var l=function(t){o=null,t?(n.setCursor(0,0),e.preview.manualRender(),$("#restored").trigger("summon"),setTimeout(function(){$("#restored").trigger("dismiss")},4e3)):$("#loading").trigger("dismiss")};$("#modal-history").one("show.bs.modal",function(){r.hide().click()})},WL.SoftTruncator=function(e,t,n){var i=0,r=0;this.check=function(o){var a=!1,s=e-i;if(o.length>s){var l=o.slice(s).search(/\s|$/);l>=0&&t>=l&&(s+=l),o=o.slice(0,s),a=!0}var c=o.split("\n"),u=n-r;return c.length>u&&(o=c.slice(0,u).join("\n")+"\n",o=o.replace(/\n\s+$/,"\n"),a=!0),i+=o.length,r+=c.length-1,{text:o,truncated:a}}},WL.FileHistory=function(e,t,n,i,r,o){function a(i){var r=e.connection.srcId(),o="/docs/"+t+"/srcs/"+r+"/restore.json";return function(){$.ajax({type:"POST",dataType:"json",url:o,data:{verId:i.verId,socketId:e.connection.pusher().connection.socket_id},timeout:y,success:function(e){e.restored?(analytics.track("file version restored"),n.poll(),d()):f()},error:function(e){WL.reportAjaxError(e,o),f()}})}}function s(e){for(var t,i=WL.FileHistory.mergeDiffs(WL.FileHistory.parseDiffs(e.diffs),_,A),r=e.initialContent,s=0;s<i.length;++s){t=r;for(var l=0;l<i[s].ops.length;++l)r=i[s].ops[l].applyTo(r);if(t!=r){var c=$("<div>").addClass("file-history-diff"),u=$("<div>").addClass("file-history-diff-header");i[s].userNames=i[s].userNames.sort();var h=i[s].userNames.pop(),d=i[s].userNames.join(", ");""!==d&&(d+=" and "),h?d+=h:u.append($("<span>").addClass("file-history-diff-anonymous").text("anonymous editor")),u.prepend($("<span>").addClass("file-history-diff-author").text(d)),u.append("&nbsp;"),u.append($("<abbr>").addClass("timeago").text(i[s].createdAtDate).attr("title",i[s].createdAt)),u.append(":"),!o&&i[s].verId<n.verId()&&u.append($("<a>").attr("href","#").addClass("file-history-restore").text("restore file").data("diff_id",s).click(function(){var e=i[$(this).data("diff_id")];return a(e)(),!1}));var f=$("<pre>"),p=new WL.SoftTruncator(b,C,x),m=new WL.SoftTruncator(w,C,k);WL.FileHistory.buildInlineDiff(f,p,m,t,r),c.append(u),c.append(f),g.prepend(c)}}g.find("abbr.timeago").timeago()}function l(e,t){if(g.empty(),v.empty(),m.hide(),t.diffs&&t.diffs.length)s(t),t.initialVerId>0&&v.append($("<a>").attr("href","#").html("more history for this file&hellip;").click(function(){return analytics.track("show file history","more"),u(t.initialVerId),!1}));else{var o;o=e<n.verId()?"Sorry, there's no older history available for this file.":"Sorry, there's no history available for this file here.";var a;a=i?r?"If you need an older version of this file that you have not saved, you may be able to find it using the full project history.":"If you need an older version of this file that you have not saved, you may be able to find it using the full project history, available on Overleaf Pro.":'If you need an older version of this file that you have not saved, you can <a href="/contact">contact us</a> with the link to this project, and we can recover it for you.',g.append($("<span>").html(o+" This history shows all changes in the last 24h. Older saved versions may be available in the versions menu. "+a))}c(t)}function c(e){if(i){var t;t=r?'<a data-toggle="modal" data-target="#modal-history-service" data-history-service-view="Recent Activity" href="#">Show full project history <small>(beta)</small></a>':e.diffs&&e.diffs.length?'Looking for more? Full project history is available on our <a href="/plans">Pro plan and above</a>.':'<a href="/plans">Upgrade to Overleaf Pro</a>',p.find(".file-history-service-link").empty().append(t)}}function u(n){g.empty(),v.hide(),m.show();var i=e.connection.srcId(),r="/docs/"+t+"/srcs/"+i+"/file_history.json";$.ajax({type:"GET",dataType:"json",url:r,data:{latestVerId:n},timeout:y,success:function(e){try{l(n,e),v.show()}catch(t){f(),WL.reportError(t)}},error:function(e){WL.reportAjaxError(e,r),f()}})}function h(){$("#modal-file-history").modal("hide")}function d(){$("#restored").trigger("summon"),setTimeout(function(){$("#restored").trigger("dismiss")},4e3),h()}function f(){$("#error-alert").trigger("summon").find("p").html("Sorry, we couldn't access this file's history. Please refresh the page and try again. If this problem persists, please contact us."),h()}var p=$("#modal-file-history"),g=$("#file-history"),m=$("#file-history-placeholder"),v=$("#file-history-navigation"),y=2e4,b=100,w=150,C=20,x=3,k=4,_=12e4,A=10;p.bind({"show.bs.modal":function(){analytics.track("show file history"),u(n.verId())}}),$("#file-history-service-link").on("click",function(e){e.preventDefault(),p.modal("hide"),$("#modal-history-service").modal("show")})},WL.FileHistory.buildInlineDiff=function(e,t,n,i,r){function o(){e.append($("<span>").addClass("ellipsis").html("&hellip;"))}function a(t,n){e.append($("<"+t+">").text(n))}var s,l=new diff_match_patch,c=l.diff_main(i,r);if(l.diff_cleanupSemantic(c),0===c.length)return void e.append($("<em>").text("(empty file)"));c[0][0]==DIFF_EQUAL&&(s=t.check(WL.reverseString(c[0][1])),s.truncated&&o(),a("span",WL.reverseString(s.text)),c.shift());for(var u=0;u<c.length;u++){switch(s=n.check(c[u][1]),c[u][0]){case DIFF_INSERT:a("ins",s.text);break;case DIFF_DELETE:a("del",s.text);break;case DIFF_EQUAL:a("span",s.text)}if(s.truncated){o();break}}},WL.FileHistory.parseDiffs=function(e){for(var t=0;t<e.length;++t)e[t].createdAtDate=new Date(e[t].createdAt),e[t].ops=WL.diffStringToOps(e[t].diff),e[t].userNames=[e[t].userName];return e},WL.FileHistory.mergeDiffs=function(e,t,n){for(var i,r,o,a,s,l={pos:e[0].ops[e[0].ops.length-1].pos,size:e[0].ops[e[0].ops.length-1].size},c=1;c<e.length;c++)if(i=e[c],r=i.ops,s=Math.abs(i.createdAtDate-e[c-1].createdAtDate),s>t)l.pos=r[r.length-1].pos,l.size=r[r.length-1].size;else{a=[];for(var u=0;u<r.length;u++)o=i.ops[u],s=Math.abs(o.pos-l.pos-l.size),l&&n>s?(a.push(o),l.pos=o.pos,l.size=o.size):(l.pos=r[r.length-1].pos,l.size=r[r.length-1].size);if(a.length==r.length){for(var h=0;h<a.length;h++)e[c-1].ops.push(a[h]);e[c-1].userNames.indexOf(i.userName)<0&&e[c-1].userNames.push(i.userName),e[c-1].verId=i.verId,e.splice(c,1),c--}}return e},WL.Invites=function(e,t){var n=function(){$("#invites_refresh").hide().click()};this.refresh=n,$(document).on("focus",".share_url",function(){var e=this;window.setTimeout(function(){$(e).select()},0)}),$(t).bind("initPusher",function(){t.docChannel().bind("invite-change",function(){e.makeSafeOnError(function(){n()})})}),$(document).on("ajax:before","a.invite_destroy",function(e){WL.ignoreErrors(function(){var t=e.target.id.replace("invite_destroy","#invite_label");$(t).css("text-decoration","line-through")})}),$(document).on("ajax:beforeSend","a.invite_destroy",function(e,n,i){n.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),i.data="invite_socket_id="+t.pusher().connection.socket_id}),$(document).on("click",'#new_invite input[type="submit"]',function(){$("#invite_socket_id").val(t.pusher().connection.socket_id)})},WL.Submissions=function(e,t,n){var i=function(){$("#assignment_submit_refresh").hide().click()};this.refresh=i,$(t).bind("initPusher",function(){t.docChannel().bind("submission-change",function(){e.makeSafeOnError(function(){i()})})}),$("#assignment_submit_form").submit(function(){return n.outOfDate()?(n.autoRender?$("#error-alert").trigger("summon").find("p").html("The current version is still compiling.\nPlease wait until it finishes and then submit again."):($("#preview_manual_render").click(),$("#error-alert").trigger("summon").find("p").html("The current version hasn't been compiled yet.\nPlease wait until it finishes and then submit again.")),!1):!0})},WL.ReadUI=function(e){function t(e){$("#preview").append($("<p>").css("text-align","center").text("Sorry, the preview pages failed to load ("+e+"). Please refresh the page to try again."))}var n=CodeMirror.fromTextArea($("#doc_content")[0],{theme:"wl-default",matchBrackets:!0,lineNumbers:!0,readOnly:!0,lineWrapping:!0});this.editor=function(){return n};new WL.TwoUp(n,$("#wl_editor"),$("#wl_divider"),$("#wl_preview"),$("#wl_doc"),200,150,!0,!0);new WL.viewportFix,$(".pannel-bar, #wl_pin_divider, #wl_divider").show(),$(window).resize(function(){var e=0;$(".pannel-bar:visible").each(function(){e+=$(this).outerHeight()}),$("#wl_editor .CodeMirror").height($("#wl_editor").height()-e),n.refresh(),$("#wl_doc").trigger("twoUpResize")}),$(window).trigger("resize"),e&&$.ajax({dataType:"json",url:e,timeout:2e4,success:function(e){if(e){if(e.pageUrls){var n=new WL.Pages($("#preview"));n.update(e)}}else t("manifest not found")},error:function(e,n){t(n)}})},WL.Spell=function(e,t,n,i){function r(e){return 0!==o.spell(e)}n&&(n=JSON.parse(n));var o;WL.ignoreErrors(function(){o=new WL.Hunspell(t)}),o&&o.load().then(function(){e.addOverlay(s)});var a=function(){return o&&o.ready},s={token:function(e){if(a()){if(e.match(WL.Spell.SKIP_RX))return;if(e.match(WL.Spell.WORD_RX)){var t=e.current().replace(/\u2019/,"'");if(t=t.replace(/^'?([^']*)'*$/,"$1"),t=t.replace(/^\u201c?([^\u201d]*)\u201d*$/,"$1"),t=t.replace(/^\xab?([^\xbb]*)\xbb*$/,"$1"),n&&n.indexOf(t)>=0)return;if(r(t))return;return"spell-error"}}return e.next(),null}},l=$(".spell-suggestion-loading"),c=$(".spell-suggestion-empty"),u=$(".spell-suggestion-add"),h=$(".spell-suggestion-separator"),d=$("#contextmenu-container");this.contextMenuOpened=function(){function t(e){return/\s/.test(e)}function n(n){var i=e.getCursor("from");0!==n&&(i=e.findPosH(i,n,"column"));var r=e.findWordAt(i),o=e.getRange(r.anchor,r.head);return t(o)?null:{word:o,position:r}}function i(){return n(0)||n(-1)||n(1)}if($(".spell-suggestion").hide(),!a())return!1;if(e.somethingSelected()&&t(e.getSelection(" ")))return!1;var o=i();return!o||r(o.word)?!1:(e.setSelection(o.position.anchor,o.position.head),d.data("spell-word",o.word),f(o.word),!0)};var f=function(e){$(".spell-suggestion-word").remove(),h.show(),l.show(),u.show();var t=o.suggest(e);if(l.hide(),0===t.length)c.show();else{for(var n=t.length-1;n>=0;n--)$("<li/>",{"class":"spell-suggestion spell-suggestion-word"}).append($("<a/>",{"class":"editor-shortcut shortcut-spell",href:"#"}).append(t[n])).prependTo(d.children("ul")).bind("click",p).show();d.trigger("content-changed")}},p=function(t){t.preventDefault();var n=$(this).text();e.options.readOnly||e.replaceSelection(n,"end")};u.bind("click",function(){g(d.data("spell-word")),e.setCursor(e.getCursor())});var g=function(t){n&&n.push(t),e.removeOverlay(s),e.addOverlay(s),$.ajax({url:"/docs/"+i+"/custom_dict.js",type:"POST",data:{word:t}})}},WL.Spell.SKIP_CMDS=["documentclass","usepackage","input","include","begin","end","geometry","ref","eqref","label","bibliography","bibliographystyle","url","lstinputlisting"],_.each(WL.Constants.bibCommands,function(e){WL.Spell.SKIP_CMDS.push(e)}),WL.Spell.SKIP_RX=function(){return new RegExp("^(?:\\\\(?:"+WL.Spell.SKIP_CMDS.map(function(e){return e+"\\S*"}).join("|")+"|[^\\\\\\s{}]*)|\\$.+?\\$|[A-Z-0-9]{2,}\\b|https?://\\S+|.+?@.+?\\S+)")}(),WL.Spell.WORD_RX=/^[^!"#$%&()*+,-./:;<=>?@\\[\]^_`{|}~\d\s]{2,}/,WL.Pin=function(){var e=$("#wl_pin_divider"),t=$("#wl_pinned"),n=($("#wl_doc"),$("#open-files")),i=$("#modal-files"),r=i.find(".modal-body"),o=!1,a=function(){var e=0;return function(t,n){clearTimeout(e),e=setTimeout(t,n)}}();n.click(function(e){e.preventDefault(),$(window).width()<991&&!o?(t.children().appendTo(r),o=!0):$(window).width()>=991&&o&&(r.children().appendTo(t),i.modal("hide"),o=!1),o&&!t.is(":visible")?(i.is(":visible")?i.modal("hide"):i.modal("show"),a(function(){$("#wl_main_container").trigger("twoUpResize")},300),$.cookie("wl_project_open","true",{expires:14,path:"/"})):s()}),$("#wl_close_pin").click(function(e){e.preventDefault(),s()});var s=function(){t.is(":visible")?(t.hide(),e.css("width",0).hide(),n.removeClass("pin-menu-open"),$.cookie("wl_project_open","false",{expires:14,path:"/"})):(t.css("display","block"),e.css("display","block"),e.css("width","12px"),e.css("left","20%"),o||n.addClass("pin-menu-open"),$.cookie("wl_project_open","true",{expires:14,path:"/"})),$("#wl_main_container").trigger("twoUpResize")};"true"===$.cookie("wl_project_open")&&n.trigger("click");var l=i.find(".close");l.click(function(){$.cookie("wl_project_open","false",{expires:14,path:"/"})})},WL.MenuPopover=function(e,t,n,i){var r=n.find(".menu-resizable"),o=r.find("li:not(.menu-more, .js-no-more)"),a=r.find("li.menu-more"),s=a.children("a");s.popover({placement:i,html:!0,content:function(){return c()}}).click(function(){$(this).toggleClass("menu-more-active")});var l=function(){s.popover("hide"),s.removeClass("menu-more-active");var e=a.outerWidth(!0),t=r.width(),n=0,i=!0;o.each(function(){return n+=$(this).outerWidth(!0),n>=t?(t-=e,!1):void 0}),n=0,o.each(function(){$(this).hasClass("editor-button-hidden")||(n+=$(this).outerWidth(!0),n>=t?(i=!1,$(this).hasClass("dropdown")?$(this).addClass("menu-item-hidden-no-more"):$(this).addClass("menu-item-hidden")):($(this).removeClass("menu-item-hidden"),$(this).removeClass("menu-item-hidden-no-more")))}),i?a.hide():a.show()};t.bind("twoUpResize",function(e){e.target===this&&l()}),l();var c=function(){var e="";return r.children(".menu-item-hidden:not(.editor-button-hidden)").each(function(){e+="<li>"+$(this).html()+"</li>"}),e};this.close=function(){s.removeClass("menu-more-active"),s.popover("hide")}},WL.LatexMode=function(){function e(e,t){e.stack.push(t)}function t(e){e.stack.pop()}function n(e,n){return t(n),n.stack[n.stack.length-1](e,n)}function i(n,i){e(n,function(e,n){return t(n),i(e,n)})}function r(e,t,n,r,o){function a(e,t){if(e.match(n[s])){var l=r[s];return++s,s<n.length?i(t,a):o(e,t),l}}var s=0;return a(e,t)}function o(e,t,n){return r(e,t,[/^\\begin\s*/,"{",/[^{}]+/,"}"],["tag","bracket","keyword","bracket"],n)}function a(e,t,n){return r(e,t,[/^\\end\s*/,"{",/[^{}]+/,"}"],["tag","bracket","keyword","bracket"],n)}function s(e,t){return CodeMirror.Pos(t.line,e.start)}function l(e,t){return CodeMirror.Pos(t.line,e.start+e.current().length)}function c(e,t,n,i){var r=new Q(n,i,l(e,t));return t.openMarks.push(r),r}function u(e,t){t.openMarks.pop()}function h(e,t,n){var i=t.openMarks.pop(),r=i.openParent||t.openMarks[t.openMarks.length-1],o=new Q(i.kind,i.from,i.contentFrom,n,l(e,t),r);return t.marks.push(o),o}function d(e){return e.marks[e.marks.length-1]}function f(i,r,o,a,l,d,f,p,g,v){return i.match(l)?(c(i,r,o,a),e(r,function(e,i){if(m(e))return u(e,i),n(e,i);for(var r=0;r<g.length;++r)if(e.match(g[r],!1))return u(e,i),n(e,i);return e.match(f)?(h(e,i,s(e,i)),t(i),p):v(e,i)}),d):void 0}function p(e,t,n,i,r){return f(e,t,n,i,"[","bracket","]","bracket",[],r)}function g(e,t,n,i,r){return f(e,t,n,i,"{","bracket","}","bracket",[],r)}function m(e){return e.sol()&&(e.eol()||e.match(/^[\s\u00a0]+$/))}function v(n,i,r,o,a,s,l){return n.match(r)?(e(i,function(e,n){return m(e)?void t(n):e.match(a)?(t(n),s):l(e,n)}),o):void 0}function y(e,t,n){return v(e,t,"[","bracket","]","bracket",n)}function b(n,i,r){return n.eat("{")?(e(i,function(e,n){return e.eat("}")?(t(n),"bracket"):r(e,n)}),"bracket"):void 0}function w(e,t){function n(n){return c(e,t,n,f),e.skipToEnd(),h(e,t,l(e,t))}function i(t,i){var r=e.match(t);if(r){var o=n(i);return o.email=r[1],o.stamp=r[2],!0}return!1}function r(){return e.match(" > ")?(n("comment-quote"),!0):!1}function o(){return e.match(" ^.")?(n("comment-end"),!0):!1}function a(){return!p||"comment-start"!==p.kind&&"comment-quote"!==p.kind&&"comment-reply"!==p.kind&&"comment"!==p.kind?!1:(e.eat(" "),n("comment"),!0)}var u,f,p;if(u=e.sol(),f=s(e,t),e.match(/^\s*%/)){p=d(t);var g=u&&p&&/^comment(?:-start|-reply|-quote|-end)?$/.test(p.kind)&&p.from.line==t.line-1;return i(ee,"comment-start")||g&&r()||g&&o()||g&&i(te,"comment-reply")||g&&i(ne,"comment-close")||g&&a()||e.skipToEnd(),"comment"}}function C(e,t){function n(e){return e.match(/^\\(?:[a-zA-Z]+|.|\n)/)?"tag":e.match(/^[\^_&~]/)?"tag":e.match(/^(?:\d+\.\d*|\d*\.\d+|\d+)/)?"number":void e.next()}return L(e,t)||N(e,t)||W(e,t)||n(e,t)}function x(e,t){if(e.match(/^\\title[\[{]/,!1)){e.match(/^\\title/);var n=s(e,t);return i(t,function(e,t){return g(e,t,"title",n,K)}),i(t,function(e,t){return y(e,t,K)}),"tag"}}function k(e){for(var t in e)e[t].lookaheadPattern=new RegExp("^\\\\"+t+"\\s*[\\[{]"),e[t].matchPattern=new RegExp("^\\\\"+t+"\\s*");return e}function A(e,t,n){var r=oe[n];if(e.match(r.lookaheadPattern,!1)){e.match(r.matchPattern);var o=s(e,t);return i(t,function(e,t){return g(e,t,n,o,K)}),"tag"}}function S(e,t){var n,i=null;return _.each(WL.Constants.bibCommands,function(r){return n=A(e,t,r),n?(i=n,!1):void 0}),i}function T(e,t){var n="item";if(e.sol()&&e.match(/^\\item(?: |$)/)){var i=t.openMarks[t.openMarks.length-1];t.openMarks.length>0&&"enumerate"===i.kind&&(n="enumerate-item"),c(e,t,n,s(e,t));var r=h(e,t,l(e,t));if(r.checkedProperties.kind=n,"enumerate-item"===n||"item"===n){r.checkedProperties.number=1,r.checkedProperties.openMarksCount=t.openMarks.length-1;for(var o=t.marks.length-2;o>=0;o--){var a=t.marks[o];if(a.from.line<i.from.line)break;if(a.kind===n){if(a.openParent!==i)continue;r.checkedProperties.number=a.checkedProperties.number+1;break}}}return"tag"}}function L(n,i){var r=n.match(/^\\verb\*?([^a-zA-Z])/);if(r){var o=r[1];return e(i,function(e,n){return e.match(o)?(t(n),"tag"):e.skipTo(o)?"string":(e.skipToEnd(),"string")}),"tag"}}function E(e){return e.match(/^[^\\]+/)||e.next(),"string"}function M(e){return e.match(/^[^\\]+/)||e.next(),"comment"}function P(e,t){return D(e,t,he)||W(e,t)||Y(e,t)}function R(e,t){return A(e,t,"caption")||I(e,t)||K(e,t)}function I(e,t){var n=oe.includegraphics;if(e.match(n.lookaheadPattern,!1)){e.match(n.matchPattern);var r=s(e,t);return i(t,function(e,t){return g(e,t,"includegraphics",r,K)}),i(t,function(e,t){return p(e,t,"includegraphics-optional",r,K)}),"tag"}}function $(e){for(var t in e)if(e.hasOwnProperty(t)){var n=e[t].matchOnSingleLine?"$":"";e[t].beginPattern=new RegExp("^\\\\begin\\s*{"+t+"}"+n),e[t].endPattern=new RegExp("^\\\\end\\s*{"+t+"}")}return e}function O(e,t,n,i){for(var r in n)if(n.hasOwnProperty(r)){var o=n[r];if(e.match(o.beginPattern,!1))return i(e,t,o)}}function D(i,r,l){return O(i,r,l,function(i,r,l){function d(e,i){return!l.allowBlankLines&&m(e)?(g&&u(e,i),n(e,i)):e.match(l.endPattern,!1)?(g&&(p=s(e,i)),t(i),a(e,i,function(e,t){if(g){var n=h(e,t,p);n.checkedProperties.openMarksCount=t.openMarks.length,n.checkedProperties.fromLine=n.from.line,n.checkedProperties.toLine=n.to.line}})):l.tokenizer(e,i)}var f,p,g=l.hasOwnProperty("kind");return g&&(f=s(i,r)),o(i,r,function(t,n){if(g){var i=c(t,n,l.kind,f);i.checkedProperties.openMarksCount=n.openMarks.length-1}e(n,d)})})}function F(e,t,n,i){if(e.match(n)){var r=s(e,t);return c(e,t,i,r),h(e,t,r),"tag"}}function N(e,t){return e.match(/^\\begin\s*{[^}]+}/,!1)?o(e,t,function(){}):e.match(/^\\end\s*{[^}]+}/,!1)?a(e,t,function(){}):void 0}function W(e){return e.match(/^\\(?:[a-zA-Z]+|.|\n)/)?"tag":void 0}function j(e,t){return A(e,t,"chapter")||A(e,t,"chapter\\*")||A(e,t,"section")||A(e,t,"section\\*")||A(e,t,"subsection")||A(e,t,"subsection\\*")||A(e,t,"subsubsection")||A(e,t,"subsubsection\\*")}function H(e,t){return T(e,t)||K(e,t)}function B(e,t){return f(e,t,"display-math",s(e,t),"$$","keyword","$$","keyword",[],C)}function U(e,t){return f(e,t,"inline-math",s(e,t),"$","keyword","$","keyword",["$$"],C)}function z(e,t){return f(e,t,"display-math",s(e,t),"\\[","keyword","\\]","keyword",[],C)}function G(e,t){return f(e,t,"inline-math",s(e,t),"\\(","keyword","\\)","keyword",[],C)}function q(t,n){return t.match(/^\\end\s*{document}/,!1)?a(t,n,function(t,n){e(n,function(e){return e.skipToEnd(),"comment"})}):void 0}function Y(e){return e.match(/^[{}\[\]]/)?"bracket":e.match(/^[&~]+/)?"tag":void(e.match(/^[^{}\[\]\\$&%~]+/)||e.next())}function K(e,t){return A(e,t,"textbf")||A(e,t,"textit")||z(e,t)||G(e,t)||A(e,t,"ref")||S(e,t)||A(e,t,"label")||A(e,t,"input")||A(e,t,"include")||D(e,t,ue)||D(e,t,ce)||D(e,t,se)||L(e,t)||D(e,t,ae)||D(e,t,he)||N(e,t)||W(e,t)||b(e,t,K)||B(e,t)||U(e,t)||Y(e)}function V(e,t){return x(e,t)||A(e,t,"author")||F(e,t,/^\\maketitle$/,"maketitle")||j(e,t)||D(e,t,le)||q(e,t)||K(e,t)}function X(e){e.line+=1}function J(e,t){e.sol()&&X(t);var n=w(e,t);if(!n){var i=t.stack[t.stack.length-1];if(!i)throw"empty stack";n=i(e,t)}return e.sol()&&!e.eol()&&(t.line-=1),n}var Q=WL.LatexMode.Mark,Z=/<([^>]+@[^>]+[.][^>]+)> (\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.\d+)?Z)/,ee=new RegExp(/^ \* /.source+Z.source+":$"),te=new RegExp(/^ \^ /.source+Z.source+":$"),ne=new RegExp(/^ \^ /.source+Z.source+/\.$/.source),ie={author:{},"chapter\\*":{},chapter:{},section:{},"section\\*":{},subsection:{},"subsection\\*":{},subsubsection:{},"subsubsection\\*":{},textbf:{},textit:{},caption:{},label:{},includegraphics:{},ref:{},input:{},include:{}};_.each(WL.Constants.bibCommands,function(e){ie[e]={}});var re,oe=k(ie),ae=$({verbatim:{tokenizer:E},Verbatim:{tokenizer:E},lstlisting:{tokenizer:E},comment:{tokenizer:M}});for(re in ae)ae.hasOwnProperty(re)&&(ae[re].allowBlankLines=!0);var se={math:{kind:"inline-math"},displaymath:{kind:"display-math"}};["equation","eqnarray","align","gather","multline","alignat","xalignat"].forEach(function(e){se[e]={kind:"outer-display-math"},se[e+"\\*"]={kind:"outer-display-math"}}),$(se);for(re in se)se.hasOwnProperty(re)&&(se[re].tokenizer=C,se[re].allowBlankLines=!1);var le=$({"abstract":{tokenizer:K,kind:"abstract",allowBlankLines:!0}}),ce=$({itemize:{tokenizer:H,kind:"itemize",allowBlankLines:!0,matchOnSingleLine:!0},enumerate:{tokenizer:H,kind:"enumerate",allowBlankLines:!0,matchOnSingleLine:!0}}),ue=$({figure:{tokenizer:R,kind:"figure",allowBlankLines:!0}}),he=$({tikzpicture:{tokenizer:P,allowBlankLines:!0}});this.startState=function(){return{stack:[V],line:-1,openMarks:[],marks:[]}},this.blankLine=function(e){J(new CodeMirror.StringStream(""),e)},this.token=J,this.lineComment="%"},WL.LatexMode.Mark=function(e,t,n,i,r,o){this.kind=e,this.from=t,this.to=r,this.contentFrom=n,this.contentTo=i,this.openParent=o,this.checkedProperties={}},WL.LatexMode.Mark.copy=function(e){return new WL.LatexMode.Mark(e.kind,e.from,e.contentFrom,e.contentTo,e.to,e.openParent)},CodeMirror.defineMode("latex",function(){return new WL.LatexMode}),CodeMirror.defineMIME("application/x-tex","latex"),CodeMirror.defineMIME("application/x-latex","latex"),WL.RichText=function(e,t,n,i){function r(e,t){return e.line===t.line&&e.ch===t.ch}function o(e,t){return r(e.from,t.from)&&r(e.to,t.to)}function a(t,n){$(t).on("mousedown",function(){var t=n.find();t&&e.setCursor(t.from),n.clear(),e.refresh(),setTimeout(function(){e.focus()},0)})}function s(){return n?!0:(alert("Please sign in to leave comments. If you don't yet have an account, you can sign up for free!"),!1)}function l(t){return _.filter(e.getTokenAt(t.to,!0).state.marks,function(e){return e.from.line>=t.from.line&&e.to.line<=t.to.line&&!(e.from.line===t.from.line&&e.from.ch===t.from.ch&&e.kind===t.kind)})}function c(t){e.operation(function(){e.replaceRange("",t.contentTo,t.to),e.replaceRange("",t.from,t.contentFrom)})}function u(t){var n={line:e.doc.lineCount(),ch:0},i=e.getTokenAt(n,!0).state;return _.find(i.marks,function(e){return e.kind===t.kind&&_.isEqual(e.contentFrom,t.contentFrom)&&_.isEqual(e.from,t.from)})}function h(e){var t=function(){e.forEach(function(e){e.clear()})};return e.forEach(function(n,i){n.on("clear",t),n.on("hide",t),n.wlNextMark=e[i+1],n.wlChild=i>0}),e}function d(t,n,i){function r(){c.clear()}var o=$("<div>").addClass("preamble");if(o.append($("<h1>").addClass("title").text(WL.detex(t.getContent(e)))),n){var s=WL.splitAuthors(n.getContent(e)),l=$("<ul>").addClass("authors");s.forEach(function(e){l.append($("<li>").text(WL.detex(e)))}),o.append(l)}var c=e.addLineWidget(0,o[0],{above:!0}),u=te(e,t,n,i);u.on("clear",r),u.on("hide",r),a(o,u)}function f(t){if(!(t.contentTo.line-t.contentFrom.line<2||16!==t.contentFrom.ch||0!==t.contentTo.ch)){var n=$("<div>").text("Abstract").addClass("wl-abstract-open"),i=ee(e,t,"pre",!0,{inclusiveLeft:!0,inclusiveRight:!0,replacedWith:n[0]}),r=ee(e,t,"inner",!0,{inclusiveLeft:!0,inclusiveRight:!0,className:"wl-abstract"}),o=$("<div>").text(" ").addClass("wl-abstract-close"),a=ee(e,t,"post",!0,{inclusiveLeft:!0,inclusiveRight:!0,replacedWith:o[0]});h([i,r,a])}}function p(e,t,i){var r=(new Date).toISOString(),o=i?"":"\n%";return e+" <"+n+"> "+r+t+o}function g(e){return!!e}function m(e,t){var n=CodeMirror.splitLines(e)||[],i=n.filter(g).map(function(e){return"% "+t+e}).join("\n");return i.length?i+"\n%":""}function v(e){var t=F(D());return y(t,e)}function y(e,t){for(var n=[],i=0;i<e.length;++i){var r=e[i];r.email===t.email&&r.stamp===t.stamp&&n.push(r)}return n.length>=1?(n.length>1&&n.sort(function(e,n){var i=Math.abs(e.from.line-t.from.line),r=Math.abs(n.from.line-t.from.line);return i-r}),n[0]):null}function b(t,n){var i=n&&n.find(),r=p("% ^",".",!0);!i&&(i=v(t),i&&i.close)||(i?(e.getLine(i.to.line)===Z?(e.replaceRange(r,{line:i.to.line,ch:0},{line:i.to.line}),e.setCursor({line:i.to.line+1})):e.replaceRange("\n"+r,{line:i.to.line}),N()):alert("Sorry, the comment was deleted or edited while you were responding, and we couldn't find it to add your response.  Please try again."))}function w(t,n,i,r){var o=n&&n.find(),a=t;if(!o||t.from.line!=o.from.line&&t.to.line!=o.to.line){if(r?(r=v(r),a=y(r.replies,t)):a=v(t),!a)return void alert("Sorry, the comment was deleted or edited while you were editing, and we couldn't find it to add your changes. Please try again.");a.close&&alert("Sorry, the comment was closed while you were editing. If  you like, you can open a new comment.")}var s=("\n"+i+"\n").split("\n").map(function(e){return"% "+e}).join("\n");e.replaceRange(s,_.first(a.body).from,_.last(a.body).to),N()}function C(t,n,i){var r=n&&n.find();return!r&&(r=v(t),r&&r.close)?void alert("Sorry, the comment was closed while you were responding. If  you like, you can open a new comment."):void(r?e.getLine(r.to.line)===Z?e.replaceRange("\n"+i,{line:r.to.line-1}):e.replaceRange("\n"+i+"\n"+Z,{line:r.to.line}):alert("Sorry, the comment was deleted or edited while you were responding, and we couldn't find it to add your response.  Please try again."))}function x(r){var o,a=$("<span>").addClass("wl-comment");o=ee(e,r,"outer",!0,{inclusiveRight:!0,replacedWith:a[0]});var s={sourceMark:r,editorMark:o,avatarData:t,userIsSignedIn:!!n,isReadOnlyView:i,rt:Y};ReactDOM.render(React.createElement(RichComment,s),a[0]);
}function k(t,n){var i;if("inline-math"===t.kind)i=S(t.getContent(e),n);else if("display-math"==t.kind)i=A(t.getContent(e),n);else{if("outer-display-math"!=t.kind)throw"bad math mark "+t.kind;i=A(t.getOuter(e),n)}var r=ee(e,t,"outer",!0,{clearOnEnter:!0,replacedWith:i});a(i,r)}function A(e,t){var n=$('<script type="math/tex; mode=display">').text(e);t.push(n);var i=$("<div>").append(n).css({"text-align":"center","font-family":"Times","padding-bottom":"10pt","padding-top":"10pt"});return i[0]}function S(e,t){var n=$('<script type="math/tex">').text(e);t.push(n);var i=$("<span>").append(n).css({"font-family":"Times"});return i[0]}function T(t){var n=ee(e,t,"pre",!0,{inclusiveLeft:!0,inclusiveRight:!0,collapsed:!0}),i=ee(e,t,"post",!0,{inclusiveLeft:!0,inclusiveRight:!0,collapsed:!0});return[n,i]}function L(t){var n;n=/^chapter/.test(t.kind)?"chapter":/^subsub/.test(t.kind)?"subsubsection":/^sub/.test(t.kind)?"subsection":"section";var i=function(){var n=e.getLine(t.from.line);return t.from.line===t.to.line&&t.to.ch!==n.length||t.from.line!==t.to.line}(),r=$("<span>").text(i?"{":"").addClass("wl-"+n+"-open"),o=ee(e,t,"pre",!0,{inclusiveLeft:!i,inclusiveRight:!1,replacedWith:r[0]}),a=ee(e,t,"inner",!1,{inclusiveLeft:!0,inclusiveRight:!0,className:"wl-"+n}),s=$("<span>").text(i?"}":"").addClass("wl-"+n+"-close"),l=ee(e,t,"post",!0,{inclusiveLeft:!1,inclusiveRight:!i,replacedWith:s[0]});h([o,a,l])}function E(t){if(!(t.from.ch>0||t.to.ch<e.getLine(t.to.line).length-1)){var n=ee(e,t,"inner",!1,{inclusiveLeft:!0,inclusiveRight:!0,clearWhenEmpty:!1,className:"wl-"+t.kind});h([n].concat(T(t)))}}function M(t){var n=$("<span>").text("{").addClass("wl-"+t.kind+"-open"),i=ee(e,t,"pre",!0,{replacedWith:n[0]}),r=ee(e,t,"inner",!1,{inclusiveLeft:!0,inclusiveRight:!0,clearWhenEmpty:!1,className:"wl-"+t.kind}),o=$("<span>").text("}").addClass("wl-"+t.kind+"-close"),a=ee(e,t,"post",!0,{replacedWith:o[0]});h([i,r,a])}function P(t){var n="enumerate-item"===t.kind?t.checkedProperties.number:null,i=n&&n+"."||"\u25cf",r=$("<div>").text(i).addClass("wl-"+t.kind+"-open");r.css("margin-left","-1.5em"),ee(e,t,"outer",!0,{replacedWith:r[0],inclusiveLeft:!0,inclusiveRight:!1})}function R(t){var n=t.kind;n.match(/cite/)&&(n="cite");var i=$("<span>").attr("class","wl-icon wl-icon-accent wl-icon-"+n),r=$("<span>").addClass("wl-label-open").prepend(i);r.append($("<span>").text("{").addClass("wl-label-bracket"));var o=ee(e,t,"pre",!0,{replacedWith:r[0]}),a=$("<span>").text("}").addClass("wl-label-bracket"),s=ee(e,t,"post",!0,{replacedWith:a[0]});h([o,s])}function I(t){var n=$("<div>").addClass("wl-figure-wrap"),i=l(t);_.forEach(i,function(t){var i=t.rangeForRegion("inner");if("caption"===t.kind){var r=WL.detex(e.getRange(i.from,i.to));n.append($("<div>").text(r).addClass("wl-figure-caption"))}else if("includegraphics"===t.kind){var o=e.getRange(i.from,i.to),a=$('table[data-path^="'+o+'"]'),s="null"!==a.attr("data-is-img"),l="null"!==a.attr("data-is-pdf"),c="null"!==a.attr("data-is-eps"),u=a.attr("data-url"),h=$("<img>");if(u&&s)h.attr("src",u).attr("class","img-responsive wl-figure"),n.append(h);else{var d=$("<span>");u?(c?(h.attr("src","/assets/icons/editor/placeholder/eps.png").attr("class","img-responsive wl-figure").css("width","50px"),n.append(h)):l&&(h.attr("src","/assets/icons/editor/placeholder/pdf.png").attr("class","img-responsive wl-figure").css("width","50px"),n.append(h)),d.text("["+o+"]"),d.css("font-size","small").addClass("wl-figure-name")):(d.text("[Not Found: "+o+"]"),d.css("font-size","small").css("color","red").addClass("wl-figure-not-found")),n.append(d)}}});var r=ee(e,t,"outer",!1,{clearOnEnter:!0,inclusiveLeft:!0,inclusiveRight:!0,replacedWith:n[0]});a(n[0],r)}function O(t){var n=e.getRange(t.contentFrom,t.contentTo);n.match(/\.tex$/)||(n+=".tex");var i=$("#project-files-container table.file_table").filter(function(){return $(this).data("path")===n}).first(),r=$("<span>").attr("class","wl-icon wl-icon-accent wl-icon-link");i.length?r.css("border-bottom","1px dashed #1C8B22"):r.css("border-bottom","1px dashed #bb1111");var o=$('<a href="#">').on("click",function(){i.click()});o.addClass("wl-input-link");var a=$("<span>").prepend(r.wrap(o).parent());a.append($("<span>").text("{").addClass("wl-label-bracket"));var s=ee(e,t,"pre",!1,{replacedWith:a[0]}),l=ee(e,t,"inner",!0,{className:"wl-input"}),c=$("<span>").text("}").addClass("wl-label-bracket"),u=ee(e,t,"post",!1,{replacedWith:c[0]});h([s,l,u])}function D(){var t=e.getViewport(),n=t.to+X;return J>n&&(n=J),n}function F(t){var n=e.getStateAfter(t,!0).marks||[];return G(n),n}function N(t){if(!K){K=!0;var n,i=!1,r=[],o=D(),a=F(o),s=e.getAllMarks(),l=[];s.forEach(function(e){"function"==typeof e.wlClearMatch&&l.push(e)}),l.forEach(function(e){e.wlClearMatch()}),l.forEach(function(t){t.wlMatch(e,a)}),l.forEach(function(e){if(!e.wlIsMatched()){var t=e.find();t&&t.to.line<o&&e.clear()}});var c=null,u=null,h=null;for(n=0;n<a.length;++n){var p=a[n];p&&("inline-math"!==p.kind&&"display-math"!==p.kind&&"outer-display-math"!==p.kind||!p.hasContent(e)||p.containsCursor(e,"outer")?"chapter"!==p.kind&&"chapter\\*"!==p.kind&&"section"!==p.kind&&"section\\*"!==p.kind&&"subsection"!==p.kind&&"subsection\\*"!==p.kind&&"subsubsection"!==p.kind&&"subsubsection\\*"!==p.kind||!p.hasContent(e)?"textbf"===p.kind||"textit"===p.kind?M(p):"title"===p.kind?c=p:"author"===p.kind?u=p:"maketitle"===p.kind?h=p:"abstract"===p.kind?f(p):"comment-start"===p.kind?x(p):"itemize"===p.kind||"enumerate"===p.kind?E(p):"item"===p.kind||"enumerate-item"===p.kind?P(p):"figure"===p.kind&&p.hasContent(e)&&!p.containsCursor(e,"outer")?I(p):_.include(ne,p.kind)?R(p):"input"!==p.kind&&"include"!==p.kind||O(p):L(p):(k(p,r),i=!0))}if(c&&h){var g=e.indexFromPos(e.getCursor("head")),m=e.indexFromPos(h.to);(t||g>m)&&(t&&m>=g&&e.setCursor(e.posFromIndex(m+1)),d(c,u,h))}if(i){for(MathJax.Hub.Queue(function(){MathJax.InputJax.TeX.resetEquationNumbers&&MathJax.InputJax.TeX.resetEquationNumbers()}),n=0;n<r.length;++n)MathJax.Hub.Queue(["Typeset",MathJax.Hub,r[n][0]]);MathJax.Hub.Queue(function(){e.refresh()})}K=!1}}function W(t,n,i){function r(t){var n=t.from(),i=t.to();if(n.line===i.line&&0===n.ch){var r=e.getLine(n.line),o=e.getRange(n,i);return r===o.slice(0,r.length)}return!1}if(i&&!e.somethingSelected()){var o=e.getCursor(),a=e.getTokenAt(o,!0).state,s=_.last(a.openMarks);(!s||s&&!re[s.kind])&&e.setSelection({line:o.line,ch:0},{line:o.line})}e.operation(function(){for(var o,a=e.listSelections(),s=0;s<a.length;++s)H(t,n,a[s])?(i&&!r(a[s])&&(t="\n"+t,n+="\n"),e.replaceRange(t,a[s].from(),null,"+list"),a=e.listSelections(),e.replaceRange(n,a[s].to(),null,"+list"),o=a[s],a=e.listSelections(),a[s]=o,e.setSelections(a)):a=e.listSelections()}),e.refresh(),e.focus()}function j(t,n,i,r){var o=_.clone(r.to()),a=_.clone(r.from()),s=e.doc.getRange(a,o);if(!t||!n.match(t.kind))return!0;var l=u(t);if(l&&n.match(l.kind)){var h=e.doc.getRange(l.contentFrom,a),d=e.doc.getRange(o,l.contentTo),f=d.match(/^\s*/),p=h.match(/\s*$/),g=l.contentFrom.line===a.line&&l.contentFrom.ch===a.ch,m=l.contentTo.line===o.line&&l.contentTo.ch===o.ch;g&&m?c(l):g?(d.match(/^\s/)&&(o.ch+=f[0].split(/\s/).length-1,s+=" "),e.operation(function(){e.replaceRange("",a,o),e.replaceRange(s,l.from)})):m?(h.match(/\s$/)&&(a.ch-=p[0].split(/\s/).length-1,s=" "+s),e.operation(function(){e.replaceRange(s,l.to),e.replaceRange("",a,o)})):(d.match(/^\s*\n/)?(o.ch=-1,o.line+=1):f&&(o.ch+=f[0].split(/\s/).length-1),p&&(a.ch-=p[0].split(/\s/).length-1),e.operation(function(){e.replaceRange(i,a),e.replaceRange(n,{line:o.line,ch:o.ch+1})})),e.focus()}}function H(t,n,i){var r=i.from(),o=i.to(),a=e.getTokenAt(o,!0).state,s=_.last(a.openMarks),l=_.clone(a.openMarks),u=_.filter(a.marks,function(e){return t.match(e.kind)&&re[e.kind]&&e.from.line>=r.line&&e.from.ch>=r.ch&&e.to.line<=o.line&&e.to.ch<=o.ch}),h=_.find(l,function(e){var n=re[e.kind];return n&&n.exclude&&_.find(n.exclude,function(e){return t.match(e)})});l.pop();var d=_.find(l,function(e){var n=re[e.kind];return n&&!n.exclude&&t.match(e.kind)});return _.forEach(u.reverse(),function(e){c(e)}),d||h?void 0:s&&re[s.kind]&&re[s.kind].inner?re[s.kind].inner(s,t,n,i):!0}function B(){var t=e.getSelection();t=t.split("\n").map(function(e){return"\\item "+e}),e.replaceSelection(t.join("\n"),null,"+list")}function U(){N(!1)}function z(){N(!1)}function G(t){for(var n=0,i=null,r=null;n<t.length;){var o=t[n];"comment-start"===o.kind?(i=WL.LatexMode.Mark.copy(o),i.email=o.email,i.stamp=o.stamp,i.replies=[],i.userInput={email:null,kind:"comment-input",stamp:null,body:null},r=i.body=[],t.splice(n,1,i),++n):i&&/^comment/.test(o.kind)?(i.to=o.to,t.splice(n,1),"comment-reply"===o.kind?(i.replies.push(o),r=o.body=[]):"comment-close"===o.kind?(i.close=o,i=null,r=null):"comment-end"===o.kind?(i.end=o,i=null,r=null):"comment"===o.kind||"comment-quote"===o.kind?(o.text=o.getContent(e),r.push(o)):WL.flunk("bad comment mark kind: "+o.kind)):++n}}function q(){V&&N(!1)}var Y=this,K=!1,V=!1,X=100,J=350,Q={itemize:!0,enumerate:!0},Z="% ^.",ee=function(){function e(){this.wlMatched=!1}function t(){return this.wlMatched}function n(e,t,n){return"undefined"==typeof t.wlValue||e.getRange(n.from,n.to)===t.wlValue}function i(e,t){for(var n in t.wlProperties)if(t.wlProperties.hasOwnProperty(n)&&e.checkedProperties[n]!==t.wlProperties[n])return!1;return!0}function r(e,t){function r(t,a){var s=t.rangeForRegion(a.wlRegion),l=a.find();return l&&o(s,l)&&n(e,a,l)&&i(t,a)?a.wlNextMark?r(t,a.wlNextMark):!0:!1}function a(e){e.wlMatched=!0,e.wlNextMark&&a(e.wlNextMark)}if(!this.wlChild)for(var s=0;s<t.length;++s){var l=t[s];if(l&&r(l,this))return a(this),void delete t[s]}}return function(n,i,o,a,s){var l=i.rangeForRegion(o),c=n.markText(l.from,l.to,s);return Q[i.kind]?_.forEach(_.range(l.from.line,l.to.line+1),function(e){e===l.from.line||e===l.to.line?(n.doc.removeLineClass(e,"text"),n.doc.addLineClass(e,"text","wl-indent-env-"+(i.checkedProperties.openMarksCount>4?4:i.checkedProperties.openMarksCount))):n.doc.addLineClass(e,"text","wl-indent-"+(i.checkedProperties.openMarksCount>4?4:i.checkedProperties.openMarksCount))}):i.openParent&&Q[i.openParent.kind]&&(n.doc.removeLineClass(l.from.line,"text"),n.doc.addLineClass(l.from.line,"text","wl-indent-"+i.openParent.checkedProperties.openMarksCount)),c.wlClearMatch=e,c.wlMatch=r,c.wlIsMatched=t,c.wlProperties=i.checkedProperties,c.wlRegion=o,a&&(c.wlValue=n.getRange(l.from,l.to)),c}}(),te=function(){function e(){this.wlMatched=!1}function t(){return this.wlMatched}function n(e,t){for(var n=-1,o=-1,a=-1,s=0;s<t.length;++s){var l=t[s];if(l)if("title"===l.kind&&l.getContent(e)===this.wlTitle)n=s;else if("author"===l.kind&&l.getContent(e)===this.wlAuthor)o=s;else if("maketitle"===l.kind){var c=this.find();r(i,c.from)&&r(l.to,c.to)&&(a=s)}}n>=0&&a>=0&&(!this.wlAuthor||o>=0)&&(delete t[n],delete t[a],o>=0&&delete t[o],this.wlMatched=!0)}var i={line:0,ch:0};return function(r,o,a,s){var l=r.markText(i,s.to,{clearOnEnter:!0,collapsed:!0,inclusiveRight:!0});return l.wlTitle=o.getContent(r),a?l.wlAuthor=a.getContent(r):l.wlAuthor=null,l.wlClearMatch=e,l.wlMatch=n,l.wlIsMatched=t,l}}();this.makeRichCommentHeader=p,this.makeRichCommentLines=m,this.relocateRichComment=v,this.closeRichComment=b,this.editRichComment=w,this.appendToRichComment=C;var ne=["label","ref"];_.each(WL.Constants.bibCommands,function(e){ne.push(e)}),this.insertSection=function(){analytics.track("toolbar","insert section"),W("\\section{","}",!0)},this.insertSubsection=function(){analytics.track("toolbar","insert subsection"),W("\\subsection{","}",!0)},this.insertBold=function(){analytics.track("toolbar","insert bold"),W("\\textbf{","}",!1)},this.insertItalic=function(){analytics.track("toolbar","insert italic"),W("\\textit{","}",!1)},this.insertInlineMath=function(){W("\\(","\\)",!1)},this.insertDisplayMath=function(){W("\\[","\\]",!0)},this.insertSnippet=function(e,t){W(e,t,!1)};var ie=["chapter","section","subsection","subsubsection","itemize","enumerate"],re={textbf:{inner:j},textit:{inner:j},chapter:{exclude:ie},"chapter\\*":{exclude:ie},section:{exclude:ie},"section\\*":{exclude:ie},subsection:{exclude:ie},"subsection\\*":{exclude:ie},subsubsection:{exclude:ie},"subsubsection\\*":{exclude:ie}};this.insertNumberedList=function(){analytics.track("toolbar","insert numbered list");var t=e.getCursor(),n=e.getTokenAt(t,!0),i=e.getLine(t.line);0===t.ch||!i&&!n.type?W("\\begin{enumerate}\n","\n\\end{enumerate}\n",!1):t.ch>0&&t.ch<i.length?W("\n\\begin{enumerate}\n","\n\\end{enumerate}\n",!1):W("\n\\begin{enumerate}\n","\n\\end{enumerate}",!1),B()},this.insertBulletPointList=function(){analytics.track("toolbar","insert bullet point list");var t=e.getCursor(),n=e.getTokenAt(t,!0),i=e.getLine(t.line);0===t.ch||!i&&!n.type?W("\\begin{itemize}\n","\n\\end{itemize}\n",!1):t.ch>0&&t.ch<i.length?W("\n\\begin{itemize}\n","\n\\end{itemize}\n",!1):W("\n\\begin{itemize}\n","\n\\end{itemize}",!1),B()},this.insertRichComment=function(t){if(!s())return analytics.track("rich comment","not signed in"),!1;var n=m(e.getSelection()||"","> "),i=p("% *",":"),r=m(t||"",""),o="% ^.",a=e.getCursor(),l=e.getLine(a.line),c=[i,n,r,o].filter(g).join("\n");return""===l?e.replaceRange(c,{line:a.line}):l.match(/^% \*/)?e.replaceRange(c+"\n",{line:a.line,ch:0}):e.replaceRange("\n"+c,{line:a.line}),e.setCursor(a),q(),analytics.track("rich comment","inserted"),_.delay(function(){$(".wl-comment-input").focus()},100),e.refresh(),!0},this.combineRichCommentMarks=G,this.deleteRichComment=function(t){return e.replaceRange("",t.from,t.to),q(),e.focus(),e.setCursor(t.from),""!==e.getLine(t.from.line-1)&&(e.execCommand("deleteLine"),e.setCursor({line:t.from.line-1}),e.execCommand("goLineEnd")),e.refresh(),analytics.track("rich comment","cancelled"),!1},this.enable=function(){V||($(e.getWrapperElement()).addClass("rich-text"),e.on("cursorActivity",U),e.on("viewportChange",z),N(!0),V=!0,e.refresh(),e.scrollIntoView(null,100),WL.ignoreErrors(function(){e.focus()}))},this.disable=function(){if(V){$(e.getWrapperElement()).removeClass("rich-text"),e.off("cursorActivity",U),e.off("viewportChange",z);for(var t=e.getAllMarks(),n=0;n<t.length;++n)t[n].clear();_.forEach(_.range(0,e.doc.lineCount()),function(t){e.doc.removeLineClass(t,"text")}),V=!1,e.refresh(),WL.ignoreErrors(function(){e.focus()})}},this.update=q,this.cmRefresh=function(){e.refresh()},this.isEnabled=function(){return V}},function(){function e(e,t,n,i){var r=e.indexFromPos(t),o=e.indexFromPos(n),a=e.indexFromPos(i);return r>=o&&a>=r}WL.LatexMode.Mark.prototype.getOuter=function(e){return e.getRange(this.from,this.to)},WL.LatexMode.Mark.prototype.getContent=function(e){return e.getRange(this.contentFrom,this.contentTo)},WL.LatexMode.Mark.prototype.hasContent=function(e){return $.trim(this.getContent(e)).length},WL.LatexMode.Mark.prototype.containsCursor=function(t,n){var i=t.getCursor("head");return"inner"===n?e(t,i,this.contentFrom,this.contentTo):"outer"===n?e(t,i,this.from,this.to):void WL.flunk("bad region "+n)},WL.LatexMode.Mark.prototype.rangeForRegion=function(e){return"pre"===e?{from:this.from,to:this.contentFrom}:"inner"===e?{from:this.contentFrom,to:this.contentTo}:"post"===e?{from:this.contentTo,to:this.to}:"outer"===e?this:void WL.flunk("bad region "+e)}}(),WL.RichTextAdapter=function(e,t,n,i,r,o,a,s,l,c){function u(){return"undefined"!=typeof MathJax}function h(){return"default"===a&&u()}function d(){return/\.tex$/.test(e.editorView.fileName())}function f(){h()?d()?b.getWantRichText()?(p(),m("on")):(g(),m("off")):(g(),m("hidden")):(g(),m("unsupported")),v(),$("#wl_editor_content").trigger("twoUpResize")}function p(){e.makeSafeOnError(function(){try{r.enable(),o.enable(),e.editorView.setOption("theme","wl-rich-text"),e.editorView.setOption("matchBrackets",!1)}catch(t){throw b.setWantRichText(!1),t}})}function g(){r.disable(),o.disable(),e.editorView.setOption("theme",l),e.editorView.setOption("matchBrackets",!0)}function m(e){"hidden"===e?w.hide():(w.show(),C.attr("title","Rich Text is in beta. Feedback appreciated!").tooltip("fixTitle"),"off"===e?x.removeProp("checked"):"unsupported"===e?"default"!==a?C.attr("title","Sorry, rich text is not yet compatible with our vim and emacs modes. We're working on it!").tooltip("fixTitle"):u()?C.attr("title","Sorry, rich text is not supported in your setup.").tooltip("fixTitle"):C.attr("title","Sorry, we could not load MathJax for equations in rich text mode; it may be temporarily unavailable or blocked on your computer or network. Please see https://www.overleaf.com/help/112.").tooltip("fixTitle"):"on"===e?x.prop("checked",!0):WL.flunk("bad toggle state "+e))}function v(){h()&&"hidden"!==y()?k.removeClass("editor-button-hidden"):k.addClass("editor-button-hidden")}function y(){return w.is(":visible")?x.is(":checked")?"on":h()?"off":"unsupported":"hidden"}var b=this,w=$("#rich-text-toggle-container"),C=$("#rich-text-toggle"),x=$("#rich-text-toggle-checkbox"),k=$(".editor-button-rich-text");!function(){var e={expires:14,path:"/"+t},n="true"===$.cookie("wl_rich_text")||c&&"false"!==$.cookie("wl_rich_text");b.getWantRichText=function(){return n},b.setWantRichText=function(t){$.cookie("wl_rich_text",t,e),n=!!t,analytics.track("set want rich text",t)}}(),C.tooltip({placement:"bottom"}),C.bind("click",function(e){if("INPUT"===e.target.tagName.toUpperCase())return void e.preventDefault();var t=y();"hidden"===t||("on"===t?b.setWantRichText(!1):"off"===t&&b.setWantRichText(!0),f())}),this.insertRichComment=function(){h()&&r.insertRichComment()&&!r.isEnabled()&&(b.setWantRichText(!0),f())},$(e.editorView).bind("connected",f),$(i).bind("polled",function(e,t){t.diffs&&(r.update(),o.update())}),f()},"undefined"==typeof window.console&&(window.console={}),"undefined"==typeof window.console.emulated&&("function"==typeof window.console.log?window.console.hasLog=!0:("undefined"==typeof window.console.log&&(window.console.log=function(){}),window.console.hasLog=!1),"function"==typeof window.console.debug?window.console.hasDebug=!0:("undefined"==typeof window.console.debug&&(window.console.debug=window.console.hasLog?function(){for(var e=["console.debug:"],t=0;t<arguments.length;t++)e.push(arguments[t]);window.console.log.apply(window.console,e)}:function(){}),window.console.hasDebug=!1),"function"==typeof window.console.warn?window.console.hasWarn=!0:("undefined"==typeof window.console.warn&&(window.console.warn=window.console.hasLog?function(){for(var e=["console.warn:"],t=0;t<arguments.length;t++)e.push(arguments[t]);window.console.log.apply(window.console,e)}:function(){}),window.console.hasWarn=!1),"function"==typeof window.console.error?window.console.hasError=!0:("undefined"==typeof window.console.error&&(window.console.error=function(){var e="An error has occured.";if(window.console.hasLog){for(var e=["console.error:"],t=0;t<arguments.length;t++)e.push(arguments[t]);window.console.log.apply(window.console,e),e="An error has occured. More information is available in your browser's javascript console."}for(t=0;t<arguments.length&&"string"==typeof arguments[t];++t)e+="\n"+arguments[t];if("undefined"!=typeof Error)throw Error(e);throw e}),window.console.hasError=!1),"function"==typeof window.console.trace?window.console.hasTrace=!0:("undefined"==typeof window.console.trace&&(window.console.trace=function(){window.console.error("console.trace does not exist")}),window.console.hasTrace=!1),window.console.emulated=!0),function(e){e.History?window.console.warn("$.History has already been defined..."):(e.History={options:{debug:!1},state:"",$window:null,$iframe:null,handlers:{generic:[],specific:{}},extractHash:function(e){return e.replace(/^[^#]*#/,"").replace(/^#+|#+$/,"")},getState:function(){return e.History.state},setState:function(t){var n=e.History,t=n.extractHash(t);return n.state=t,n.state},getHash:function(){return e.History.extractHash(window.location.hash||location.hash)},setHash:function(t){return t=e.History.extractHash(t),"undefined"!=typeof window.location.hash?window.location.hash!==t&&(window.location.hash=t):location.hash!==t&&(location.hash=t),t},go:function(t){var n=e.History,t=n.extractHash(t),i=n.getHash(),r=n.getState();return t!==i?n.setHash(t):(t!==r&&n.setState(t),n.trigger()),!0},hashchange:function(){var t=e.History,n=t.getHash();return t.go(n),!0},bind:function(t,n){var i=e.History;return n?("undefined"==typeof i.handlers.specific[t]&&(i.handlers.specific[t]=[]),i.handlers.specific[t].push(n)):i.handlers.generic.push(t),!0},trigger:function(t){var n=e.History;"undefined"==typeof t&&(t=n.getState());var i,r,o,a;if("undefined"!=typeof n.handlers.specific[t])for(a=n.handlers.specific[t],i=0,r=a.length;r>i;++i)(o=a[i])(t);for(a=n.handlers.generic,i=0,r=a.length;r>i;++i)(o=a[i])(t);return!0},construct:function(){var t=e.History;return e(document).ready(function(){t.domReady()}),!0},configure:function(t){var n=e.History;return n.options=e.extend(n.options,t),!0},domReadied:!1,domReady:function(){var t=e.History;return t.domRedied?void 0:(t.domRedied=!0,t.$window=e(window),t.$window.bind("hashchange",this.hashchange),setTimeout(t.hashchangeLoader,200),!0)},nativeSupport:function(t){var t=t||e.browser,n=t.version,i=parseInt(n,10),r=n.split(/[^0-9]/g),n=parseInt(r[0],10),o=parseInt(r[1],10),r=parseInt(r[2],10),a=!1;return t.msie&&i>=8?a=!0:t.webkit&&i>=528?a=!0:t.mozilla?n>1?a=!0:1===n&&(o>9?a=!0:9===o&&r>=2&&(a=!0)):t.opera&&(n>10?a=!0:10===n&&o>=60&&(a=!0)),a},hashchangeLoader:function(){var t=e.History;if(t.nativeSupport())t.getHash()&&t.$window.trigger("hashchange");else{var n;if(e.browser.msie){t.$iframe=e('<iframe id="jquery-history-iframe" style="display: none;"></$iframe>').prependTo(document.body)[0],t.$iframe.contentWindow.document.open(),t.$iframe.contentWindow.document.close();var i=!1;n=function(){var e=t.getHash(),n=t.getState(),r=t.extractHash(t.$iframe.contentWindow.document.location.hash);n!==e?(i||(t.$iframe.contentWindow.document.open(),t.$iframe.contentWindow.document.close(),t.$iframe.contentWindow.document.location.hash=e),i=!1,t.$window.trigger("hashchange")):n!==r&&(i=!0,t.setHash(r))}}else n=function(){var e=t.getHash();t.getState()!==e&&t.$window.trigger("hashchange")};setInterval(n,200)}return!0}},e.History.construct())}(jQuery),WL.HashUrl=function(e,t){var n=this,i={src:null,att:null},r=function(){return $.History.getHash()};this.getHashData=function(){return i.src||(i={src:t,att:null}),i};var o=function(){var e=r().match(/^\/(\d+)(\/(\d+))?\/?$/);return e?(void 0===e[3]&&(e[3]=null),{src:e[1],att:e[3]}):{src:t,att:null}},a=function(){var e="",t=n.getHashData();t.src&&(e+="/"+t.src,t.att&&(e+="/"+t.att),e+="/"),$.History.setHash(e)},s=function(e){var t=n.getHashData();return t[e]};this.getSrc=function(){return s("src")},this.getAtt=function(){return s("att")};var l=function(e,t){i[e]=t,a()};this.setSrc=function(e){l("src",e)},this.setAtt=function(e){l("att",e)},this.clearSrc=function(){n.setSrc(t)},this.clearAtt=function(){n.setAtt(null)},this.clear=function(){this.clearSrc(),this.clearAtt()};var c=function(t){e.openSrc(t)},u=function(t){t?e.openAtt(t):e.hideAttModal()};this.updateDefaultSrc=function(e){t=e},$.History.bind(function(){var e=o(),t=n.getHashData(),r=e.src!=t.src,a=e.att!=t.att;(r||a)&&(i=e,r&&c(i.src),a&&u(i.att))}),i=o(),i.att&&$("#files").bind("refreshed.HashUrl",function(){u(i.att),$("#modal-files").modal("hide"),$(this).unbind("refreshed.HashUrl")})},function(e,t,n){"use strict";var i={version:"2.1",tipLocation:"bottom",nubPosition:"auto",scroll:!0,scrollSpeed:300,timer:0,autoStart:!1,startTimerOnClick:!0,startOffset:0,nextButton:!0,tipAnimation:"fade",pauseAfter:[],tipAnimationFadeSpeed:300,cookieMonster:!1,cookieName:"joyride",cookieDomain:!1,cookiePath:!1,localStorage:!1,localStorageKey:"joyride",tipContainer:"body",modal:!1,expose:!1,postExposeCallback:e.noop,preRideCallback:e.noop,postRideCallback:e.noop,preStepCallback:e.noop,postStepCallback:e.noop,template:{link:'<a href="#close" class="joyride-close-tip">X</a>',timer:'<div class="joyride-timer-indicator-wrap"><span class="joyride-timer-indicator"></span></div>',tip:'<div class="joyride-tip-guide"><span class="joyride-nub"></span></div>',wrapper:'<div class="joyride-content-wrapper" role="dialog"></div>',button:'<a href="#" class="joyride-next-tip"></a>',modal:'<div class="joyride-modal-bg"></div>',expose:'<div class="joyride-expose-wrapper"></div>',exposeCover:'<div class="joyride-expose-cover"></div>'}},r=r||!1,o={},a={init:function(n){return this.each(function(){e.isEmptyObject(o)?(o=e.extend(!0,i,n),o.document=t.document,o.$document=e(o.document),o.$window=e(t),o.$content_el=e(this),o.$body=e(o.tipContainer),o.body_offset=e(o.tipContainer).position(),o.$tip_content=e("> li",o.$content_el),o.paused=!1,o.attempts=0,o.tipLocationPatterns={top:["bottom"],bottom:[],left:["right","top","bottom"],right:["left","top","bottom"]},a.jquery_check(),e.isFunction(e.cookie)||(o.cookieMonster=!1),o.cookieMonster&&e.cookie(o.cookieName)||o.localStorage&&a.support_localstorage()&&localStorage.getItem(o.localStorageKey)||(o.$tip_content.each(function(t){a.create({$li:e(this),index:t})}),o.autoStart&&(!o.startTimerOnClick&&o.timer>0?(a.show("init"),a.startTimer()):a.show("init"))),o.$document.on("click.joyride",".joyride-next-tip, .joyride-modal-bg",function(e){e.preventDefault(),o.$li.next().length<1?a.end():o.timer>0?(clearTimeout(o.automate),a.hide(),a.show(),a.startTimer()):(a.hide(),a.show())}),o.$document.on("click.joyride",".joyride-close-tip",function(e){e.preventDefault(),a.end()}),o.$window.bind("resize.joyride",function(){if(o.$li){if(o.exposed&&o.exposed.length>0){var t=e(o.exposed);t.each(function(){var t=e(this);a.un_expose(t),a.expose(t)})}a.is_phone()?a.pos_phone():a.pos_default()}})):a.restart()})},resume:function(){a.set_li(),a.show()},nextTip:function(){o.$li.next().length<1?a.end():o.timer>0?(clearTimeout(o.automate),a.hide(),a.show(),a.startTimer()):(a.hide(),a.show())},tip_template:function(t){var n,i,r;return t.tip_class=t.tip_class||"",n=e(o.template.tip).addClass(t.tip_class),i=e.trim(e(t.li).html())+a.button_text(t.button_text)+o.template.link+a.timer_instance(t.index),r=e(o.template.wrapper),t.li.attr("data-aria-labelledby")&&r.attr("aria-labelledby",t.li.attr("data-aria-labelledby")),t.li.attr("data-aria-describedby")&&r.attr("aria-describedby",t.li.attr("data-aria-describedby")),n.append(r),n.first().attr("data-index",t.index),e(".joyride-content-wrapper",n).append(i),n[0]},timer_instance:function(t){var n;return n=0===t&&o.startTimerOnClick&&o.timer>0||0===o.timer?"":a.outerHTML(e(o.template.timer)[0])},button_text:function(t){return o.nextButton?(t=e.trim(t)||"Next",t=a.outerHTML(e(o.template.button).append(t)[0])):t="",t},create:function(t){var n=t.$li.attr("data-button")||t.$li.attr("data-text"),i=t.$li.attr("class"),r=e(a.tip_template({tip_class:i,index:t.index,button_text:n,li:t.$li}));e(o.tipContainer).append(r)},show:function(t){var i,r,s={},l=[],c=0,u=null;if(o.$li===n||-1===e.inArray(o.$li.index(),o.pauseAfter))if(o.paused?o.paused=!1:a.set_li(t),o.attempts=0,o.$li.length&&o.$target.length>0){for(t&&(o.preRideCallback(o.$li.index(),o.$next_tip),o.modal&&a.show_modal()),o.preStepCallback(o.$li.index(),o.$next_tip),l=(o.$li.data("options")||":").split(";"),c=l.length,i=c-1;i>=0;i--)r=l[i].split(":"),2===r.length&&(s[e.trim(r[0])]=e.trim(r[1]));o.tipSettings=e.extend({},o,s),o.tipSettings.tipLocationPattern=o.tipLocationPatterns[o.tipSettings.tipLocation],o.modal&&o.expose&&a.expose(),!/body/i.test(o.$target.selector)&&o.scroll&&a.scroll_to(),a.is_phone()?a.pos_phone(!0):a.pos_default(!0),u=e(".joyride-timer-indicator",o.$next_tip),/pop/i.test(o.tipAnimation)?(u.outerWidth(0),o.timer>0?(o.$next_tip.show(),u.animate({width:e(".joyride-timer-indicator-wrap",o.$next_tip).outerWidth()},o.timer)):o.$next_tip.show()):/fade/i.test(o.tipAnimation)&&(u.outerWidth(0),o.timer>0?(o.$next_tip.fadeIn(o.tipAnimationFadeSpeed),o.$next_tip.show(),u.animate({width:e(".joyride-timer-indicator-wrap",o.$next_tip).outerWidth()},o.timer)):o.$next_tip.fadeIn(o.tipAnimationFadeSpeed)),o.$current_tip=o.$next_tip,e(".joyride-next-tip",o.$current_tip).focus(),a.tabbable(o.$current_tip)}else o.$li&&o.$target.length<1?a.show():a.end();else o.paused=!0},is_phone:function(){return r?r.mq("only screen and (max-width: 767px)"):o.$window.width()<767},support_localstorage:function(){return r?r.localstorage:!!t.localStorage},hide:function(){o.modal&&o.expose&&a.un_expose(),o.modal||e(".joyride-modal-bg").hide(),o.$current_tip.hide(),o.postStepCallback(o.$li.index(),o.$current_tip)},set_li:function(e){e?(o.$li=o.$tip_content.eq(o.startOffset),a.set_next_tip(),o.$current_tip=o.$next_tip):(o.$li=o.$li.next(),a.set_next_tip()),a.set_target()},set_next_tip:function(){o.$next_tip=e(".joyride-tip-guide[data-index="+o.$li.index()+"]")},set_target:function(){var t=o.$li.attr("data-class"),n=o.$li.attr("data-id"),i=function(){return n?e(o.document.getElementById(n)):t?e("."+t).filter(":visible").first():e("body")};o.$target=i()},scroll_to:function(){var t,n;t=o.$window.height()/2,n=Math.ceil(o.$target.offset().top-t+o.$next_tip.outerHeight()),e("html, body").stop().animate({scrollTop:n},o.scrollSpeed)},paused:function(){return-1===e.inArray(o.$li.index()+1,o.pauseAfter)},destroy:function(){e.isEmptyObject(o)||o.$document.off(".joyride"),e(t).off(".joyride"),e(".joyride-close-tip, .joyride-next-tip, .joyride-modal-bg").off(".joyride"),e(".joyride-tip-guide, .joyride-modal-bg").remove(),clearTimeout(o.automate),o={}},restart:function(){o.autoStart?(a.hide(),o.$li=n,a.show("init")):(!o.startTimerOnClick&&o.timer>0?(a.show("init"),a.startTimer()):a.show("init"),o.autoStart=!0)},pos_default:function(t){var n=(Math.ceil(o.$window.height()/2),o.$next_tip.offset(),e(".joyride-nub",o.$next_tip)),i=Math.ceil(n.outerWidth()/2),r=Math.ceil(n.outerHeight()/2),s=t||!1;if(s&&(o.$next_tip.css("visibility","hidden"),o.$next_tip.show()),/body/i.test(o.$target.selector))o.$li.length&&a.pos_modal(n);else{var l=o.tipSettings.tipAdjustmentY?parseInt(o.tipSettings.tipAdjustmentY):0,c=o.tipSettings.tipAdjustmentX?parseInt(o.tipSettings.tipAdjustmentX):0;a.bottom()?(o.$next_tip.css({top:o.$target.offset().top+r+o.$target.outerHeight()+l,left:o.$target.offset().left+c}),/right/i.test(o.tipSettings.nubPosition)&&o.$next_tip.css("left",o.$target.offset().left-o.$next_tip.outerWidth()+o.$target.outerWidth()),a.nub_position(n,o.tipSettings.nubPosition,"top")):a.top()?(o.$next_tip.css({top:o.$target.offset().top-o.$next_tip.outerHeight()-r+l,left:o.$target.offset().left+c}),a.nub_position(n,o.tipSettings.nubPosition,"bottom")):a.right()?(o.$next_tip.css({top:o.$target.offset().top+l,left:o.$target.outerWidth()+o.$target.offset().left+i+c}),a.nub_position(n,o.tipSettings.nubPosition,"left")):a.left()&&(o.$next_tip.css({top:o.$target.offset().top+l,left:o.$target.offset().left-o.$next_tip.outerWidth()-i+c}),a.nub_position(n,o.tipSettings.nubPosition,"right")),!a.visible(a.corners(o.$next_tip))&&o.attempts<o.tipSettings.tipLocationPattern.length&&(n.removeClass("bottom").removeClass("top").removeClass("right").removeClass("left"),o.tipSettings.tipLocation=o.tipSettings.tipLocationPattern[o.attempts],o.attempts++,a.pos_default(!0))}s&&(o.$next_tip.hide(),o.$next_tip.css("visibility","visible"))},pos_phone:function(t){var n=o.$next_tip.outerHeight(),i=(o.$next_tip.offset(),o.$target.outerHeight()),r=e(".joyride-nub",o.$next_tip),s=Math.ceil(r.outerHeight()/2),l=t||!1;r.removeClass("bottom").removeClass("top").removeClass("right").removeClass("left"),l&&(o.$next_tip.css("visibility","hidden"),o.$next_tip.show()),/body/i.test(o.$target.selector)?o.$li.length&&a.pos_modal(r):a.top()?(o.$next_tip.offset({top:o.$target.offset().top-n-s}),r.addClass("bottom")):(o.$next_tip.offset({top:o.$target.offset().top+i+s}),r.addClass("top")),l&&(o.$next_tip.hide(),o.$next_tip.css("visibility","visible"))},pos_modal:function(e){a.center(),e.hide(),a.show_modal()},show_modal:function(){e(".joyride-modal-bg").length<1&&e("body").append(o.template.modal).show(),/pop/i.test(o.tipAnimation)?e(".joyride-modal-bg").show():e(".joyride-modal-bg").fadeIn(o.tipAnimationFadeSpeed)},expose:function(){var n,i,r,s,l="expose-"+Math.floor(1e4*Math.random());if(arguments.length>0&&arguments[0]instanceof e)r=arguments[0];else{if(!o.$target||/body/i.test(o.$target.selector))return!1;r=o.$target}return r.length<1?(t.console&&console.error("element not valid",r),!1):(n=e(o.template.expose),o.$body.append(n),n.css({top:r.offset().top,left:r.offset().left,width:r.outerWidth(!0),height:r.outerHeight(!0)}),i=e(o.template.exposeCover),s={zIndex:r.css("z-index"),position:r.css("position")},r.css("z-index",1*n.css("z-index")+1),"static"==s.position&&r.css("position","relative"),
r.data("expose-css",s),i.css({top:r.offset().top,left:r.offset().left,width:r.outerWidth(!0),height:r.outerHeight(!0)}),o.$body.append(i),n.addClass(l),i.addClass(l),o.tipSettings.exposeClass&&(n.addClass(o.tipSettings.exposeClass),i.addClass(o.tipSettings.exposeClass)),r.data("expose",l),o.postExposeCallback(o.$li.index(),o.$next_tip,r),void a.add_exposed(r))},un_expose:function(){var n,i,r,s,l=!1;if(arguments.length>0&&arguments[0]instanceof e)i=arguments[0];else{if(!o.$target||/body/i.test(o.$target.selector))return!1;i=o.$target}return i.length<1?(t.console&&console.error("element not valid",i),!1):(n=i.data("expose"),r=e("."+n),arguments.length>1&&(l=arguments[1]),l===!0?e(".joyride-expose-wrapper,.joyride-expose-cover").remove():r.remove(),s=i.data("expose-css"),"auto"==s.zIndex?i.css("z-index",""):i.css("z-index",s.zIndex),s.position!=i.css("position")&&("static"==s.position?i.css("position",""):i.css("position",s.position)),i.removeData("expose"),i.removeData("expose-z-index"),void a.remove_exposed(i))},add_exposed:function(t){o.exposed=o.exposed||[],t instanceof e?o.exposed.push(t[0]):"string"==typeof t&&o.exposed.push(t)},remove_exposed:function(t){var n;t instanceof e?n=t[0]:"string"==typeof t&&(n=t),o.exposed=o.exposed||[];for(var i=0;i<o.exposed.length;i++)if(o.exposed[i]==n)return void o.exposed.splice(i,1)},center:function(){var e=o.$window;return o.$next_tip.css({top:(e.height()-o.$next_tip.outerHeight())/2+e.scrollTop(),left:(e.width()-o.$next_tip.outerWidth())/2+e.scrollLeft()}),!0},bottom:function(){return/bottom/i.test(o.tipSettings.tipLocation)},top:function(){return/top/i.test(o.tipSettings.tipLocation)},right:function(){return/right/i.test(o.tipSettings.tipLocation)},left:function(){return/left/i.test(o.tipSettings.tipLocation)},corners:function(e){var t=o.$window,n=t.height()/2,i=Math.ceil(o.$target.offset().top-n+o.$next_tip.outerHeight()),r=t.width()+t.scrollLeft(),a=t.height()+i,s=t.height()+t.scrollTop(),l=t.scrollTop();return l>i&&(l=0>i?0:i),a>s&&(s=a),[e.offset().top<l,r<e.offset().left+e.outerWidth(),s<e.offset().top+e.outerHeight(),t.scrollLeft()>e.offset().left]},visible:function(e){for(var t=e.length;t--;)if(e[t])return!1;return!0},nub_position:function(e,t,n){"auto"===t?e.addClass(n):e.addClass(t)},startTimer:function(){o.$li.length?o.automate=setTimeout(function(){a.hide(),a.show(),a.startTimer()},o.timer):clearTimeout(o.automate)},end:function(){o.cookieMonster&&e.cookie(o.cookieName,"ridden",{expires:365,domain:o.cookieDomain,path:o.cookiePath}),o.localStorage&&localStorage.setItem(o.localStorageKey,!0),o.timer>0&&clearTimeout(o.automate),o.modal&&o.expose&&a.un_expose(),o.$current_tip&&o.$current_tip.hide(),o.$li&&(o.postStepCallback(o.$li.index(),o.$current_tip),o.postRideCallback(o.$li.index(),o.$current_tip)),e(".joyride-modal-bg").hide()},jquery_check:function(){return e.isFunction(e.fn.on)?!0:(e.fn.on=function(e,t,n){return this.delegate(t,e,n)},e.fn.off=function(e,t,n){return this.undelegate(t,e,n)},!1)},outerHTML:function(e){return e.outerHTML||(new XMLSerializer).serializeToString(e)},version:function(){return o.version},tabbable:function(t){e(t).on("keydown",function(n){if(!n.isDefaultPrevented()&&n.keyCode&&27===n.keyCode)return n.preventDefault(),void a.end();if(9===n.keyCode){var i=e(t).find(":tabbable"),r=i.filter(":first"),o=i.filter(":last");n.target!==o[0]||n.shiftKey?n.target===r[0]&&n.shiftKey&&(o.focus(1),n.preventDefault()):(r.focus(1),n.preventDefault())}})}};e.fn.joyride=function(t){return a[t]?a[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist on jQuery.joyride"):a.init.apply(this,arguments)}}(jQuery,this),WL.Joyride=function(e,t){function n(e){e.css("margin-top","10px")}var i=!0,r="?";(t||$.cookie("hide_help_ride"))&&(i=!1),$.cookie("hide_help_ride",!0,{expires:365,path:"/"}),this.ride=function(e){$(window).width()<=991||(i||e)&&($("#wl_pinned").is(":visible")&&$("#open-files").click(),o(),i=!1)};var o=function(){r=$("#joyride-tour").children("li").length,$("#joyride-tour").joyride({tipLocation:"top",nubPosition:"top-right",template:{link:'<a href="#" class="joyride-close-tip wl-icon-modal-close"></a>',tip:'<div class="joyride-tip-guide popover"><span class="joyride-nub"></span></div>',button:'<a href="#" class="joyride-next-tip link-as-button"></a>'},preStepCallback:a,postStepCallback:s}),$("#joyride-tour").joyride("restart"),$(".joyride-modal-bg").bind("click",function(e){e.preventDefault(),e.stopPropagation(),$("#joyride-tour").joyride("destroy")})},a=function(e,t){$(".modal").modal("hide"),t.children(".joyride-content-wrapper").prepend($("<div>",{"class":"joyride-tip-header"}).append($("<span>",{"class":"joyride-tip-number"}).text(e+1+" of "+r))),1==e?($("#share_menu").addClass("hover"),n(t)):2==e?($("#saved_vers_menu").addClass("hover"),n(t)):3==e?($("#open-files").addClass("hover"),$("#wl_pinned").is(":visible")||$("#open-files").click(),n(t)):4==e?n(t):5==e?(t.css("margin-top","3px"),t.css("margin-left","-22px")):e==r-1&&$("#app_menu").addClass("hover"),analytics.track("tour step",e+"/"+r)},s=function(e){$("#share_menu").removeClass("hover"),$("#saved_vers_menu").removeClass("hover"),$("#open-files").removeClass("hover"),$("#app_menu").removeClass("hover"),3==e&&$("#wl_pinned").is(":visible")&&$("#open-files").click()}},WL.Settings=function(e,t,n,i){!function(){function e(){o.is(":checked")?a.slideUp("fast"):a.slideDown("fast")}var n=null,r=$(".return-to-path"),o=$("#doc_use_automatic_title"),a=$("#doc_custom_title");$("#modal-settings").bind({"show.bs.modal":function(){r.val(window.location.pathname+window.location.hash),0!==$("#theme-sample-cm").length&&(n||($("#user_code_mirror_theme").val(t),n=WL.UserSettings.makeThemeDemoCodeMirror(t)))},"shown.bs.modal":function(){n&&n.refresh(),WL.UserSettings.updateEditorFontSize(i)}}),o.change(e),e()}(),$("#user_font_size").on("change",function(){$(".font-size-demo").css("font-size",""+$("#user_font_size").val()+"em"),$("#theme-sample").children(".CodeMirror").css("font-size",""+$("#user_font_size").val()+"em")})},WL.Keymap=function(e,t,n,i,r,o,a,s){function l(e,n){if("EOL"===n){var i=t.getLine(e.line);n={line:e.line,ch:i.length}}return _.filter(t.getTokenAt(n).state.marks,function(t){return t.from.line>=e.line&&t.from.ch>=e.ch&&t.to.line<=n.line&&t.to.ch<=n.ch})}function c(e){var n={line:t.doc.lineCount(),ch:0},i=t.getTokenAt(n,!0).state;return _.find(i.marks,function(t){return t.kind===e.kind&&_.isEqual(t.contentFrom,e.contentFrom)&&_.isEqual(t.from,e.from)})}function u(e){var n,i=t.getOption("extraKeys");for(n in i)if(i.hasOwnProperty(n)&&i[n]==e)return n;var r=CodeMirror.keyMap[t.getOption("keyMap")];for(n in r)if(r.hasOwnProperty(n)&&r[n]==e)return n;WL.flunk("could not find key shortcut for command "+e)}function h(e,t){return WL.mac&&(e=e.replace(/Cmd-/g,"\u2318"),e=e.replace(/Shift-/g,"\u21e7"),e=e.replace(/Alt-/g,"\u2325")),t?e:$("<span>").addClass("shortcut").text(e)}function d(e,t){e.children("a").attr("data-original-title",h(t,!0)).addClass("has-tooltip")}function f(){return"vim"===n&&!(t.state.vim&&t.state.vim.insertMode)}function p(e,n){var i=t.getTokenAt(n,!0).state;return _.find(i.marks,function(t){return("item"===t.kind||"enumerate-item"===t.kind)&&t.from.line>e.from.line&&t.to.line<=n.line})}function g(e){var t=e.doc.getCursor(),n=CodeMirror.Pos(t.line,t.ch-1),i=e.doc.getRange(n,t),r=CodeMirror.Pos(t.line,t.ch+1),o=e.doc.getRange(t,r);return" "!==i&&""!==i||" "!==o&&""!==o||v(e),CodeMirror.Pass}function m(e){v(e)}function v(e){return i&&!f()&&setTimeout(function(){e.state.completionActive||CodeMirror.showHint(e,CodeMirror.latexHint,{completeOnSingleClick:!0,completeOnSelection:!0,completeSingle:!1,extraKeys:J,closeCharacters:/[\s()\[\]{};>,]/,_bibtex:s})},100),CodeMirror.Pass}function y(e,t,n,i){if(f())return CodeMirror.Pass;var r=b(e,t,n,i);return v(e),r}function b(e,t,n,i){if(f()||"0"==r)return CodeMirror.Pass;if(e.somethingSelected())return CodeMirror.Pass;var o=e.doc.getCursor(),a=CodeMirror.Pos(o.line,o.ch-1),s=CodeMirror.Pos(o.line,o.ch+1),l=e.doc.getRange(o,s);e.doc.getRange(a,o);i==t?t==n&&l==n||(l.match(/^[\`\'\[\]\{\}\ ]?$/)?e.doc.replaceRange(t+n,o):e.doc.replaceRange(t,o)):l!=n&&e.doc.replaceRange(n,o),e.doc.setCursor(s)}function w(e){return a.isEnabled()&&(S(e)||C(e)||L(e))?null:CodeMirror.Pass}function C(e){var n=e.doc.getCursor(),i=e.getTokenAt(n,!0),r=_.last(i.state.openMarks),o=e.getLine(n.line),a=l({line:n.line+1,ch:0},"EOL"),s=l({line:n.line,ch:0},"EOL"),c=_.find(_.union(a,s),function(e){return Y[e.kind]});if(r&&Y[r.kind]){var u=o.match(new RegExp("\\\\"+r.kind+"\\s*{}"));if(u)return e.replaceRange("",{line:n.line,ch:r.from.ch},{line:n.line,ch:r.from.ch+u[2].length}),!0;if(c&&n.ch===c.contentTo.ch)return!0}else if(n.ch===o.length&&a&&c)return""===o&&t.replaceRange("",n,{line:n.line+1,ch:0}),!0}function x(e){if(a.isEnabled()){var t=e.listSelections()[0],n=_.isEqual(t.from(),t.to());if(n&&(A(e)||T(e)||k(e)))return null}return E(e),CodeMirror.Pass}function k(e){var n=e.doc.getCursor(),i=e.getTokenAt(n,!0),r=_.last(i.state.openMarks),o=_.last(i.state.marks),a=e.getLine(n.line);if(r&&Y[r.kind]){var s=a.match(new RegExp("\\\\"+r.kind+"\\s*{}"));if(s)return e.replaceRange("",{line:n.line,ch:r.from.ch},{line:n.line,ch:r.from.ch+s[0].length}),!0;if(r.contentFrom.line===n.line&&r.contentFrom.ch===n.ch)return 0===r.from.ch?t.getLine(n.line-1)?(e.setCursor({line:r.from.line-1}),e.execCommand("goLineEnd")):(e.setCursor({line:r.from.line-1}),e.execCommand("goLineEnd"),e.replaceRange("",e.getCursor(),r.from)):e.replaceRange("",{line:n.line,ch:r.from.ch-1},{line:n.line,ch:r.from.ch}),!0}else if(o&&Y[o.kind]&&(o.to.ch===n.ch&&n.line===o.to.line||n.line===o.to.line+1&&0===n.ch))return""===a&&e.execCommand("deleteLine"),e.setCursor(o.contentTo),!0}function A(e){function t(t){return""===e.getRange(t.contentFrom,t.contentTo).replace(/\s*/g,"").replace(/\\item$/,"")}var n=e.doc.getCursor(),i=e.getTokenAt(n,!0),r=_.last(i.state.openMarks),o=_.last(i.state.marks),a=e.getLine(n.line);if(!r||"itemize"!==r.kind&&"enumerate"!==r.kind){if(o&&("itemize"===o.kind||"enumerate"===o.kind)&&n.line===o.to.line+1&&0===n.ch)return e.operation(function(){""===a&&e.execCommand("deleteLine"),e.setCursor(o.contentTo)}),!0}else{if(n.line===r.contentFrom.line+1&&6===n.ch){var s=_.find(e.getStateAfter(e.doc.lineCount(),!0).marks,function(e){return("itemize"===e.kind||"enumerate"===e.kind)&&e.from.line===r.from.line&&e.from.ch===r.from.ch});return t(s)?e.replaceRange("",s.from,s.to):e.operation(function(){var i=e.getLine(n.line-2),r=e.getRange(n,{line:n.line,ch:a.length});if(i&&i.match(/\\end{.*}/))e.replaceRange(r+"\n",{line:n.line-1,ch:0}),e.replaceRange("",{line:n.line+1,ch:0},{line:n.line+1,ch:a.length}),e.replaceRange("",{line:n.line+1,ch:0},{line:n.line+2,ch:0}),t(s)&&e.replaceRange("",s.from,s.to),_.delay(function(){e.setCursor({line:n.line-1,ch:0})},20);else if(i){var o=i.length;e.replaceRange(r,{line:n.line-2,ch:o}),e.replaceRange("",{line:n.line,ch:0},{line:n.line,ch:a.length}),t(s)&&e.replaceRange("",s.from,s.to),e.execCommand("deleteLine"),e.setCursor({line:n.line-2,ch:o})}else e.replaceRange(r+"\n",{line:n.line-1,ch:0}),t(s)&&e.replaceRange("",s.from,s.to),e.replaceRange("",{line:n.line+1,ch:0},{line:n.line+2,ch:0}),_.delay(function(){e.setCursor({line:n.line-1,ch:0})},20),e.refresh()}),!0}var l=_.find(i.state.marks,function(e){return("itemize"===e.kind||"enumerate"===e.kind)&&e.to.line===n.line-1});if(l&&n.line===l.to.line+1){if(t(l))return e.replaceRange("",l.from,l.to),!0;if(6===n.ch)return e.operation(function(){var i=e.getLine(n.line-2).length,r=e.getRange(n,{line:n.line,ch:a.length});e.replaceRange(r,{line:n.line-2,ch:i}),e.replaceRange("",{line:n.line,ch:0},{line:n.line,ch:a.length}),t(l)&&e.replaceRange("",l.from,l.to),e.replaceRange("",{line:n.line,ch:0},{line:n.line+1,ch:0}),e.setCursor({line:n.line-2,ch:i})}),!0}}}function S(e){var t=e.doc.getCursor(),n=e.getTokenAt(t,!0),i=_.last(n.state.openMarks),r=e.getLine(t.line),o=e.getLine(t.line+1);if(!i||"enumerate"!==i.kind&&"itemize"!==i.kind){if(o.match(/\\begin{(enumerate|itemize)}/)&&t.ch===r.length)return!0}else if(t.ch===r.length&&(o.match(/\\begin{.*}/)||o.match(/\\end{.*}/)))return!0}function T(e){var t=e.doc.getCursor(),n=e.getTokenAt(t,!0),i=_.last(n.state.openMarks),r=_.last(n.state.marks),o=e.getLine(t.line);if(i&&"abstract"===i.kind){if(0===t.ch&&t.line===i.contentFrom.line+1||_.isEqual(t,i.contentFrom)){var a=_.find(e.getStateAfter(e.doc.lineCount(),!0).marks,function(e){return"abstract"===e.kind&&e.from.line===i.from.line&&e.from.ch===i.from.ch});return""===e.getRange(a.contentFrom,a.contentTo).replace(/\s*/,"")?(e.replaceRange("",a.from,a.to),!0):(e.setCursor({line:t.line-2,ch:e.getLine(t.line-2).length}),!0)}}else if(r&&"abstract"===r.kind&&t.line===r.to.line+1&&0===t.ch)return e.operation(function(){""===o&&e.execCommand("deleteLine"),e.setCursor(r.contentTo)}),!0}function L(e){var t=e.doc.getCursor(),n=e.getTokenAt(t,!0),i=_.last(n.state.openMarks),r=function(){var n=e.getLine(t.line+1),i=e.getTokenAt({line:t.line+1,ch:n.length},!0);return _.find(i.state.openMarks,function(e){return"abstract"===e.kind&&e.from.line===t.line+1})}(),o=e.getLine(t.line);if(i&&"abstract"===i.kind){if(0===t.ch&&t.line===i.contentFrom.line+1||_.isEqual(t,i.contentFrom)){var a=_.find(e.getStateAfter(e.doc.lineCount(),!0).marks,function(e){return"abstract"===e.kind&&e.from.line===i.from.line&&e.from.ch===i.from.ch});if(""===e.getRange(a.contentFrom,a.contentTo).replace(/\s*/,""))return e.replaceRange("",a.from,a.to),!0}}else if(r&&t.ch===o.length)return e.operation(function(){""===o&&e.execCommand("deleteLine"),e.setCursor(r.contentFrom)}),!0}function E(e){if(f()||"0"==r)return CodeMirror.Pass;var t=e.doc.getCursor(),n=CodeMirror.Pos(t.line,t.ch-1),i=CodeMirror.Pos(t.line,t.ch+1),o=e.doc.getRange(t,i),a=e.doc.getRange(n,t),s=["{","[","(","`"],l=["}","]",")","'"];return o=l.indexOf(o),a=s.indexOf(a),a>=0&&a==o&&e.doc.replaceRange("",t,i),CodeMirror.Pass}function M(e){return e.somethingSelected()&&e.doc.setSelection(e.getCursor()),CodeMirror.Pass}var P=this,R=WL.mac?"Cmd":"Ctrl",I=220,O=8,D=32,F=188,N=70,W=71,j=new RegExp("^[a-zA-Z0-9]+$"),H={};_.each(WL.Constants.bibCommands,function(e){H[e]=!0}),t.on("keyup",function(e,n){if(n.which===I)v(e);else if(n.which===O||n.which===F||n.which===D||j.test(String.fromCharCode(n.which))){var i=t.getTokenAt(t.getCursor());if(i.string.match(/^\\/)||"keyword"===i.type&&e.getLine(i.state.line).substr(0,i.start).match(/^\\begin{/))v(e);else{var r=_.last(i.state.openMarks);r&&H[r.kind]&&v(e)}}});var B=function(e){$("#notice").trigger("summon").find("p").html("This action isn't yet available from the menu, but you can press <strong>"+h(e,!0)+"</strong> instead.")},U=function(e){return function(){CodeMirror.commands[e](t),"undo"!=e&&"redo"!=e||P.updateUndoRedoActions()}},z="default"==n?R:"Ctrl";$(".shortcut_edit_find > a").click(U("findPersistent")),$(".shortcut_edit_find_next > a").click(U("findPersistentNext")),$(".shortcut_edit_find_prev > a").click(U("findPersistentPrev")),$(".shortcut_edit_replace > a").click(U("replace")),$(".shortcut_edit_replace_all > a").click(U("replaceAll")),$(".shortcut_edit_undo > a").click(U("undo")),$(".shortcut_edit_redo > a").click(U("redo")),$(".shortcut_edit_synctex_view > a").click(U("synctexView")),$(".shortcut_edit_cut > a").click(function(){B(R+"-X")}),$(".shortcut_edit_copy > a").click(function(){B(R+"-C")}),$(".shortcut_edit_paste > a").click(function(){B(R+"-V")}),$(".shortcut_edit_comment > a").click(U("toggleComment")),this.updateUndoRedoActions=function(){$(".shortcut_edit_undo > a, .shortcut_edit_redo > a").removeClass("shortcut-blank");var e=t.historySize();0===e.undo&&$(".shortcut_edit_undo > a").addClass("shortcut-blank"),0===e.redo&&$(".shortcut_edit_redo > a").addClass("shortcut-blank")},t.on("change",function(){P.updateUndoRedoActions()});var G={"Ctrl-.":"goToFirstMarkerOrManualRender","'\\'":g,"Ctrl-,":"synctexView","'{'":function(e){return y(e,"{","}","{")},"'['":function(e){return y(e,"[","]","[")},"'}'":function(e){return b(e,"{","}","}")},"']'":function(e){return b(e,"[","]","]")},"Cmd-`":function(e){return X(e,!0)},"'`'":function(e){return X(e,!1)},"'''":function(e){return b(e,"`","'","'")},Backspace:function(e){return x(e)},Delete:function(e){return w(e)},Up:function(e){return q(e)},Enter:function(e){return K(e)},Home:"goLineLeft",End:"goLineRight"};(WL.mac||"default"==n)&&(G[R+"-B"]=function(){return a.insertBold()},G[R+"-I"]=function(){return a.insertItalic()},G[R+"-F"]="findPersistent",G[R+"-G"]="findPersistentNext",G["Shift-"+R+"-G"]="findPersistentPrev"),G[z+"-/"]=U("toggleComment");var q=function(e){if(a.isEnabled()){var t=e.getCursor(),n=e.getTokenAt(t,!0).state,i=_.last(n.marks);if(i&&("item"===i.kind||"enumerate-item"===i.kind)&&t.ch===i.to.ch)return e.execCommand("goLineLeft"),null}return CodeMirror.Pass},Y={chapter:!0,"chapter\\*":!0,section:!0,"section\\*":!0,subsection:!0,"subsection\\*":!0,subsubsection:!0,"subsubsection\\*":!0},K=function(e){if(a.isEnabled()){var t=e.getCursor(),n=e.getTokenAt(t,!0),i=n.state,r=_.last(i.openMarks),o=_.last(i.marks);if(r){var s=e.getStateAfter(t.line,!0),l=_.last(s.marks),u=_.last(s.openMarks);if(("itemize"===r.kind||"enumerate"===r.kind)&&o&&t.line>=o.to.line){if(t.line===r.from.line&&t.ch<r.contentFrom.ch)return CodeMirror.Pass;if(0===t.ch&&0===e.getLine(t.line).indexOf("\\item"))return CodeMirror.Pass;if(l&&l.kind===r.kind&&t.line===l.to.line&&_.isEqual(r.from,l.from)&&t.ch<l.to.ch)return CodeMirror.Pass;if(t.line===r.from.line||t.line===u.from.line){if(t.ch<r.contentFrom.ch)return CodeMirror.Pass;var h=e.getStateAfter(t.line+1,!0),d=_.find(h.marks,function(e){return e.from.line>=t.line&&("enumerate-item"===e.kind||"item"===e.kind||e.kind===r.kind)});if(!d)return CodeMirror.Pass;e.replaceRange("\n\\item ",{line:t.line,ch:t.ch}),e.doc.setCursor({line:t.line+1,ch:r.contentFrom.ch})}else{var f=_.find(i.openMarks,function(e){return e!==r&&("enumerate"===e.kind||"itemize"===e.kind)}),g=c(r),m=e.getLine(t.line);g&&!p(o,g.to)&&""===e.getRange({line:t.line,ch:0},{line:t.line,ch:m.length}).replace(/\s*/g,"").replace("\\item","")?f?e.operation(function(){_.delay(function(){e.setCursor({line:g.to.line,ch:0})},20),e.execCommand("deleteLine"),e.replaceRange("\\item \n",{line:g.to.line,ch:0}),e.refresh()}):e.operation(function(){_.delay(function(){e.setCursor({line:g.to.line,ch:0})},20),e.execCommand("deleteLine"),e.replaceRange("\n",{line:g.to.line,ch:0}),e.refresh()}):(e.replaceRange("\n\\item ",{line:t.line,ch:t.ch}),"item"!==l.kind&&"enumerate-item"!==l.kind||e.doc.setCursor({line:t.line+1,ch:l.contentFrom.ch}))}return null}if(Y[r.kind])return r.contentFrom.line===t.line&&r.contentFrom.ch===t.ch?(e.replaceRange("\n",r.from),null):(e.operation(function(){_.delay(function(){e.setCursor({line:t.line+1,ch:0})},20),e.replaceRange("\n",{line:t.line+1,ch:0}),e.refresh()}),null)}}return CodeMirror.Pass},V=!1,X=function(e,t){return t?(WL.safari&&(V=!0),CodeMirror.Pass):V?(V=!1,CodeMirror.Pass):b(e,"`","'","`")};d($("#wl_editor_menu .shortcut_edit_synctex_view"),"Ctrl-, (comma)"),d($("#wl_editor_menu .shortcut_edit_comment"),z+"-/"),"default"==n&&(d($("#wl_editor_menu .shortcut_edit_find"),u("find")),d($("#wl_editor_menu .shortcut_edit_find_next"),u("findNext")),d($("#wl_editor_menu .shortcut_edit_find_prev"),u("findPrev")),d($("#wl_editor_menu .shortcut_edit_replace"),u("replace")),d($("#wl_editor_menu .shortcut_edit_replace_all"),u("replaceAll")),d($("#wl_editor_menu .shortcut_edit_undo"),u("undo")),d($("#wl_editor_menu .shortcut_edit_redo"),u("redo")),d($("#wl_editor_menu .shortcut_edit_cut"),R+"-X"),d($("#wl_editor_menu .shortcut_edit_copy"),R+"-C"),d($("#wl_editor_menu .shortcut_edit_paste"),R+"-V"));var J=null;"vim"==n?(CodeMirror.Vim.defineEx("cnext","cn",function(){e.preview.goToFirstMarker()}),d($("#preview_first_marker"),":cn"),CodeMirror.Vim.defineEx("write","w",function(){e.preview.manualRenderEnabled()&&e.preview.manualRender()}),d($("#preview_status_dirty"),":w"),CodeMirror.Vim.map("z=",":spellSuggestions"),CodeMirror.Vim.defineEx("spellSuggestions","spellSuggestions",function(){ne()}),$(".shortcut_edit_spell_suggest > a").click(function(){ne()}),d($("#wl_editor_menu .shortcut_edit_spell_suggest"),"z="),G["Ctrl-Space"]=m,G["Ctrl-N"]=m,J={"Ctrl-N":"Down","Ctrl-P":"Up",Esc:function(){CodeMirror.Vim.handleKey(t,"<Esc>")}}):(CodeMirror.commands.goToFirstMarkerOrManualRender=function(){e.preview.manualRenderEnabled()?e.preview.manualRender():e.preview.goToFirstMarker()},d($("#preview_status_dirty"),"Ctrl-."),d($("#preview_first_marker"),"Ctrl-."),G.Esc=M,G["Ctrl-Space"]=v),t.setOption("extraKeys",G);var Q=$("#contextmenu-container"),Z=$(t.display.input.textarea,t.display.input.contenteditable);Z.bind("contextmenu",function(e){ee(e)}),$(t.display.wrapper).find(".CodeMirror-lines").bind("contextmenu",function(e){var n=t.coordsChar({left:e.pageX,top:e.pageY}),i=!1;$.each(t.listSelections(),function(e,t){from=t.from(),to=t.to();var r=from.line<n.line||from.line==n.line&&from.ch<=n.ch,o=to.line>n.line||to.line==n.line&&to.ch>=n.ch;return r&&o?(i=!0,!1):void 0}),i||t.setCursor(n),ee(e)});var ee=function(e){"vim"!=n&&(e.preventDefault(),WL.mac&&WL.firefox&&0===e.button||te(e.clientX,e.clientY))},te=function(e,t){var i=!1;void 0!==o&&(i=o.contextMenuOpened()),(i||"vim"!=n)&&Q.trigger("displayMenu",{x:e-1,y:t-1,refocusAfer:!0})},ne=function(){var e=t.cursorCoords(!1,"page");te(e.left,e.top+t.defaultTextHeight())};CodeMirror.commands.save=function(){},$(document).bind("keydown",function(e){function n(e,n){return CodeMirror.commands[e](t),n.preventDefault(),!1}if(e.metaKey||e.ctrlKey){if(e.keyCode==N)return n("findPersistent",e);if(e.keyCode==W&&e.shiftKey)return n("findPersistentPrev",e);if(e.keyCode==W)return n("findPersistentNext",e)}}),$("#wl_editor_content").bind("keydown",function(e){e.keyCode!=N&&e.keyCode!=W||!e.metaKey&&!e.ctrlKey||e.stopPropagation()})},WL.EditorView=function(e,t,n){var i=this,r=null,o=null,a=!0,s=null,l=!1,c=$("#wl_editor"),u=$("#wl_editor_content .CodeMirror-merge-gap"),h=$("#wl_editor_content .CodeMirror-merge-pane:first"),d=$("#wl_editor_content .CodeMirror-merge-pane:last"),f=$(".editor-left-pane-placeholder"),p=$(".editor-right-pane-placeholder"),g=($("#wl_pinned"),$("#saved-versions-select")),m=$("body"),v=$("#wl_editor_menu .menu-resizable"),y=$("#restore-file");this.toNormalMode=function(){t.setShowDifferences(!1),u.addClass("gap-hidden"),e.twoUps.twoUpEditor.collapseTwoUp("right"),l&&e.twoUps.twoUpInner.restoreTwoUp(),c.removeClass("editor-merge"),m.removeClass("merge-mode"),$(".merging-ongoing").removeClass("merging-ongoing"),$(window).trigger("resize"),e.connection.stopMergeMode(),e.files.stopMergeMode(),t.right.orig.setValue(""),a=!1,r=null,b()},this.toMergeMode=function(){u.removeClass("gap-hidden"),e.twoUps.twoUpEditor.restoreTwoUp(),l=e.twoUps.twoUpInner.leftPanelVisible(),e.twoUps.twoUpInner.collapseTwoUp("right"),c.addClass("editor-merge"),m.addClass("merge-mode"),g.empty(),$("#saved_vers_table tr").each(function(){g.append($("<option/>",{value:$(this).data("savedVersionId"),text:$(this).find(".saved_ver_name").text()}))}),g.val(r),$(window).trigger("resize"),a=!0,s.main.isNull=!1},g.bind("change",function(){i.startMergeMode($(this).val())}),this.startMergeMode=function(t){analytics.track("compare saved version"),$("#loading").trigger("summon"),r=t,e.connection.startMergeMode(t),e.files.startMergeMode(t),$(".modal").modal("hide"),$(".merging-ongoing").removeClass("merging-ongoing"),$("#saved_ver_"+r).addClass("merging-ongoing"),$("#files-merge-menu .default-option").click();var n=s.main.isNull;this.clear(),s.main.upToDate=!0,s.main.isNull=n},this.restore=function(){this.setEditValue(t.right.orig.getValue(),t.right.orig.getOption("mode"))},this.clear=function(){s={main:{upToDate:!1,isNull:!0},merge:{upToDate:!1,isNull:!0}},v.removeClass("menu-no-value"),y.hide(),t.setShowDifferences(!1),o=null},this.clear(),this.setMergeValue=function(e,n,i){a||this.toMergeMode(),s.merge.upToDate=!0,null!==e&&(s.merge.isNull=!1),x(t.right.orig,e,n,i,!0,"right")},this.setEditValue=function(e,n,i){s.main.upToDate=!0;var r=!1;null===e?(v.addClass("menu-no-value"),r=!0):s.main.isNull=!1,x(t.edit,e,n,i,r,"left")};var b=function(){C()&&(w(),$(i).trigger("connected"))},w=function(){t.setShowDifferences(!1),s.main.isNull||s.merge.isNull||!a||t.setShowDifferences(!0)},C=function(){return s.main.upToDate&&(s.merge.upToDate||!a)};$(e.connection).bind("connected",function(){C()&&$(i).trigger("connected")}),$(i).bind("connected",function(){$("#loading").trigger("dismiss"),s.main.isNull||s.merge.isNull?y.hide():y.show()});var x=function(e,t,i,r,a,s){a=a||n,"left"==s?h.children(".merge-pane-placeholder").remove():"right"==s&&d.children(".merge-pane-placeholder").remove(),null===t&&(k(s),t=""),e.setValue(t),e.setOption("mode",i),e.setOption("readOnly",a),a&&CodeMirror.commands.goNextDiff(e),r&&(o=r),b()},k=function(e){"left"==e?(h.prepend(f),f.show()):"right"==e&&(d.prepend(p),p.show())};this.setOption=function(e,n){t.edit.setOption(e,n),t.right.orig.setOption(e,n)},this.fileName=function(){return o},$("#wl_editor_content").bind("twoUpResize",function(e){e.target===this&&(w(),$(".editor-bar-left").width(h.width()),$(".editor-bar-right").width(d.width()))});var _=$("#files-merge-menu .dropdown-title");$("#files-merge-menu .dropdown-menu a").bind("click",function(){switch($("#files-merge-menu .option-selected").removeClass("option-selected"),$(this).addClass("option-selected"),_.text($(this).text()),$(".file-merge").addClass("file-merge-hidden"),$(this).data("toggle")){case"diff":$(".file-merge-diff").removeClass("file-merge-hidden");break;case"added":$(".file-merge-added").removeClass("file-merge-hidden");break;case"deleted":$(".file-merge-deleted").removeClass("file-merge-hidden");break;default:$(".file-merge").removeClass("file-merge-hidden")}$(".folder-merge-hidden").removeClass("folder-merge-hidden");var e=0;$(".collapsable-folder").each(function(){level=$(this).data("level"),level>e&&(e=level)});for(var t=e;t>0;t--)$(".collapsable-folder.level-"+t).each(function(){child=$(this).children(".folder-content");var e=child.children("li:not(.file-merge-hidden)").length;e-=child.children("li.folder-merge-hidden").length,0===e&&$(this).addClass("folder-merge-hidden")})})},WL.ContextMenu=function(e,t){var n=$(".act-as-contextmenu"),i=null;n.bind("displayMenu",function(e,t){r($(this),t.x,t.y,t.refocusAfer)}).bind("content-changed",function(){_positionContextMenu($(this))}).bind("mousedown",function(e){e.stopPropagation()}).bind("click",function(e){o(!$(e.target).hasClass("shortcut-unavailable"))}),$("body").bind("mousedown",function(e){o(!$(e.target).hasClass("shortcut-unavailable"))}).bind("keydown",function(e){if(27==e.keyCode)o(!1);else if([40,38,74,75].indexOf(e.keyCode)>-1){var t=$(".act-as-contextmenu a:visible").not(".shortcut-section");if(!(t.length>0))return;e.stopPropagation();var n=t.length-1,i=t.index(t.filter(":focus"));[40,74].indexOf(e.keyCode)>-1?(i=n>i?i+1:0,t.eq(i).focus()):[38,75].indexOf(e.keyCode)>-1&&(i=0>=i?n:i-1,t.eq(i).focus())}}),$(window).blur(function(){o(!1)});var r=function(e,t,n,r){o(!1),e.css("visibility","hidden").show(),e.data("pos-x",t),e.data("pos-y",n),e.data("refocusAfer",r),_positionContextMenu(e),e.css({visibility:"visible"}),e.children("ul").focus(),i=e},o=function(e){i&&(t&&i.data("refocusAfer")&&(t.focus(),t.somethingSelected()&&e&&t.setCursor(t.getCursor())),n.hide(),i=null,$(".contextmenu-attached").removeClass("contextmenu-attached"))};_positionContextMenu=function(e){var t=e.children("ul").outerHeight(),n=e.children("ul").outerWidth(),i=e.data("pos-x"),r=e.data("pos-y");r+t-$(window).scrollTop()>$(window).height()&&(r=$(window).height()-t+$(window).scrollTop()),i+n>$(window).width()&&(i=$(window).width()-n),e.css({top:r+"px",left:i+"px"})},this.attachedTo=function(){if(!i)return null;var e=i.data("attachedTo"),t=$("#"+e);return t}},WL.FilesTree=function(){_.templateSettings={escape:/\{\{\=(.+?)\}\}/g,evaluate:/\{\{(.+?)\}\}/g};var e,t=Backbone.Model.extend({initialize:function(e,t){this.level=t.level,this.view=new s({model:this}),this.set("name",this.get("file").split("/").reverse()[0])},select:function(){this.trigger("select",this),$("#selected-file-id").val(this.get("file")).data("name",this.get("name")).data("type",this.get("type")).trigger("keyup")}}),n=Backbone.Model.extend({initialize:function(e,t){this.docId=t.docId,this.level=this.get("level"),this.view=new l({model:this})},url:function(){return"/docs/"+this.docId+"/files.json"},parse:function(e){return{path:e.path[e.path.length-1],level:e.path.length,files:new r(e.files,{level:e.path.length}),folders:new o(e.subfolders,{parse:!0})}}}),i=Backbone.Collection.extend({render:function(e){this.each(function(t){t.view.render(e)})}}),r=i.extend({model:t}),o=i.extend({model:n,parse:function(e){var t=[];for(var n in e)t.push(e[n]);return t}}),a=Backbone.View.extend({tagName:"li",render:function(e){var t=this.model.toJSON();t.iconClass="wl-icon-file","ext"===t.type?t.iconClass+="-ext":"att"===t.type&&(t.iconClass="-binary"),"undefined"!=typeof t.main&&t.main&&(t.iconClass+="-main"),this.$el.html(this.template(t)),e.append(this.$el),this.setPadding()},setPadding:function(){var e=21*this.paddingLevel();this.$el.find("td:first").css("padding-left",e+"px")},paddingLevel:function(){return this.model.level}}),s=a.extend({className:"file",template:_.template($("#_template-file-item").html()),events:{click:"select"},select:function(){e.selectedFile=this.model,this.model.select(),$(".current_src").removeClass("current_src"),this.$el.addClass("current_src"),e.trigger("selected")},paddingLevel:function(){return this.model.level+1}}),l=a.extend({className:"folder collapsable-folder",template:_.template($("#_template-folder-item").html()),events:{"click > table":"toggleCollapse"},initialize:function(){this.model.set("collapsed",!0)},render:function(e){a.prototype.render.apply(this,[e]),this.renderCollapse(),e=this.$el.children(".folder-content"),this.model.get("folders").render(e),this.model.get("files").render(e)},renderCollapse:function(){var e=this.$el.children("ul"),t=this.$el.find(".arrow:first");this.model.get("collapsed")&&this.model.get("level")>0?(e.collapse("hide"),t.removeClass("arrow-open"),t.removeClass("wl-icon-arrow-wide-down"),t.addClass("wl-icon-arrow-wide-right")):(e.collapse("show"),t.addClass("arrow-open"),t.addClass("wl-icon-arrow-wide-down"),t.removeClass("wl-icon-arrow-wide-right"))},toggleCollapse:function(){this.model.set("collapsed",!this.model.get("collapsed")),this.renderCollapse()}}),c=Backbone.Model.extend({select:function(){this.trigger("select",this),$("#selected-doc-id").val(this.get("id")).data("name",this.get("title")+".pdf").trigger("keyup"),"file"==this.collection.targetMode&&this.selecteFileMode()},selecteFileMode:function(){this.trigger("reset");var e=this;this.collection.$docsContainer.hide(),this.collection.$filesContainer.show(),this.topFolder=new n(null,{docId:this.get("id")}),this.topFolder.fetch().done(function(){var t=new l({model:e.topFolder});t.render(e.collection.$filesContainer),e.trigger("render")})}}),u=Backbone.Collection.extend({model:c,url:"/docs/all.json",selectedDoc:null,selectedFile:null,initialize:function(e){this.options=e,this.targetMode=e.targetMode,this.$docsContainer=e.$docsContainer,this.$filesContainer=e.$filesContainer},addOne:function(e){var t=new h({model:e});this.options.$docsContainer.append(t.render().el)},addAll:function(){var e=this;this.each(function(t){e.addOne(t)})}}),h=Backbone.View.extend({tagName:"li",className:"doc",template:_.template($("#_template-doc-item").html()),events:{click:"select"},initialize:function(){this.listenTo(this.model,"select selected",this.render)},render:function(){var e=this.model.toJSON();return this.$el.html(this.template(e)),this},select:function(){e.selectedDoc=this.model,this.model.select(),$(".current_src").removeClass("current_src"),this.$el.addClass("current_src")}});this.ExtProjectView=Backbone.View.extend({el:$("#wl-agent-container"),selectedDocTemplate:_.template($("#_template-selected-doc").html()),events:{"click .reset-selection":"resetSelection"},initialize:function(t){this.options=t,this.options.el&&(this.el=this.options.el),e=new u(this.options),this.$progressBar=this.$(".progress"),this.reset(),this.listenTo(e,"add",e.addOne),this.listenTo(e,"select selected",this.render),this.listenTo(e,"reset",this.reset),this.listenTo(e,"render",this.render),this.$label=$("#agent-label-wl");var n=this;e.fetch().done(function(){n.render()})},render:function(){var t=null;t=e.selectedDoc?this.selectedDocTemplate({
doc:e.selectedDoc,file:e.selectedFile,fileMode:"file"==this.options.targetMode}):"Select a Project",this.$label.html(t),this.$progressBar.hide(),e.$docsContainer.show()},reset:function(){e.$filesContainer.empty().hide(),e.$docsContainer.empty().hide(),this.$progressBar.show()},resetSelection:function(){e.selectedDoc=null,e.selectedFile=null,this.reset(),this.render(),e.addAll()}})},WL.AvatarData=function(e){function t(e){return $.trim(e).toLowerCase()}function n(e,n){var i=t(e);s.hasOwnProperty(i)||(s[i]=[]),s[i].push(n)}function i(){var e=[];for(var t in s)s.hasOwnProperty(t)&&e.push(t);return e}function r(e){if(s.hasOwnProperty(e)){for(var t=a[e],n=s[e],i=0;i<n.length;++i)n[i](t);delete s[e]}}function o(){l=null;var n=i(),o="/docs/"+e+"/avatars.json";n&&$.ajax({url:o,timeout:c,data:{emails:n},success:function(e){for(var n=0;n<e.length;++n){var i=t(e[n].email);a[i]=e[n],r(i)}},error:function(e){WL.reportAjaxError(e,o)}})}var a={},s={},l=null,c=3e4;this.PENDING_DELAY=500,this.get=function(e,i){if(e){var r=t(e);return a.hasOwnProperty(r)?i(a[r]):(n(e,i),l||(l=setTimeout(o,this.PENDING_DELAY))),!0}return!1}},WL.WatchTower=function(e){function t(e){return/[.]/.exec(e)?/[^.]+$/.exec(e):void 0}var n=this,i={},r={},o=null,a={},s=!1;this.BIB_FILES="bib",this.MAIN_FILE="__main__",this.getIdentifier=function(e){if(_.isNumber(e)){var t=$(".file_ext[data-file-id="+e+"]").attr("data-url"),n=t&&"null"!==t;return(n?"e":"i")+e}return _.isString(e)?e.match(/^[ei][0-9]+$/)?e.substr(1):e:_.isPlainObject(e)&&_.has(e,"external")&&_.has(e,"file_id")?(e.external?"e":"i")+e.file_id:void 0},this.registerHelper=function(e,t){_.isFunction(t)||(t=function(){return t}),e=n.getIdentifier(e),_.has(a,e)?a[e].push(t):a[e]=[t]},this.notifyHelpers=function(t){var i=Array.prototype.slice.call(arguments,1);_.delay(function(){t=n.getIdentifier(t),_.forEach(a[t],function(t){_.delay(function(){e.makeSafeOnError(function(){t.apply(void 0,i)})})})})},this.init=function(){s||(s=!0,l())},$("#files").on("refreshed",function(){l()}).on("new-version",function(e,t){c(t)});var l=function(){if(s){var e={},a={},l={};$(".file_src, .file_ext").each(function(){var i=$(this),r=i.data(),s=t(r.path),c=$(".file_ext[data-file-id="+r.fileId+"]").attr("data-url"),u=c&&"null"!==c,h=n.getIdentifier({external:u,file_id:r.fileId});a[h]=r,_.has(l,s)?l[s].push(h):l[s]=[h],i.find(".file_label_main").length&&(o=h,a[n.MAIN_FILE]=r,n.notifyHelpers(n.MAIN_FILE,r)),e[s]=!0}),i=a,r=l,_.forEach(e,function(e,t){n.notifyHelpers(t,{sources:r[t]})})}},c=function(e){if(e&&e.hasOwnProperty("file_id")){var r=$(".file_ext[data-file-id="+e.file_id+"]").attr("data-url"),o=r&&"null"!==r,a=n.getIdentifier({external:o,file_id:e.file_id});a===n.main?n.notifyHelpers(n.MAIN_FILE,i[n.MAIN_FILE]):i[a]&&n.notifyHelpers(t(i[a].path),{file_id:e.file_id}),n.notifyHelpers({file_id:e.file_id,external:o},{file_id:e.file_id})}}},WL.EditorMenu=function(e,t){var n=$("#snippets-menu"),i=n.find(".dropdown-menu"),r=function(){if(0!==t.length){var e;_.each(t,function(t){e=$("<a/>",{"class":"editor-shortcut",href:"#",text:t.title}),t.tooltip.length>0&&(e.attr("data-original-title",t.tooltip),e.addClass("has-tooltip")),e.click(function(e){WL.ui.richText.insertSnippet(t.prefix,t.suffix),e.preventDefault()}),i.append($("<li/>").append(e))}),n.show()}};r()},WL.errorHandler=function(){var e={};return e.makeSafe=function(e){WL.ui&&(WL.ui.connection&&WL.ui.connection.stop(),WL.ui.editor()&&WL.ui.editor().setOption("readOnly",!0)),$("#"+e).trigger("summon"),$("#loading").trigger("dismiss")},e.makeSafeOnError=function(t){try{return t()}catch(n){throw e.makeSafeOnErrorHandler(n),n}},e.makeSafeOnErrorHandler=function(t){WL.reportError(t),e.makeSafe("exception")},e}(),WL.HistoryService=function(e,t,n,i){function r(){return new Promise(function(e,t){$.ajax({method:"POST",url:"/api/v0/docs/"+n+"/history/auth"}).done(function(t){e(t.token)}).fail(function(e){t(e.responseJSON)})})}function o(){return new Promise(function(e,t){$.ajax({method:"POST",url:"/api/v0/docs/"+n+"/history/sync"}).done(function(t){e(t.status)}).fail(function(e){t(e.responseJSON)})})}function a(){return new Promise(function(t,n){var i=e.connection.docChannel();i.bind("history-sync",function r(e){i.unbind("history-sync",r),"success"==e.status?t():n(new Error("History service sync failed"))})})}function s(e){var t=h.SwaggerClient,n=new t.ApiKeyAuthorization("Authorization","Bearer "+e,"header"),r={url:i.url,authorizations:{jwt:n}};return t.createAsync(r).then(function(e){return{apiClient:e,blobStore:new h.RemoteBlobStore(e)}})}function l(){d.modal("hide"),$("#modal-history").modal("show")}function c(e){if(!h)throw new Error("History Service not enabled");if(!i.url)throw new Error("No History Service api url");var n=$(e.relatedTarget).data("history-service-view"),c=!1;Promise.join(r(),o()).then(function(e){var t=e[0];return c="pending"==e[1],t}).tap(function(){return c?a():void 0}).then(s).then(function(e){var r=h.configureStore(e),o=React.createElement(h.HistoryService,{projectId:t,projectCreatedAt:moment.unix(i.docCreatedAt),onShowLabelsView:l,view:n}),a=React.createElement(h.Provider,{store:r},o);p.hide(),ReactDOM.render(a,f[0])})["catch"](function(e){console.error(e),p.hide(),f.empty().html("<p>There was an error. Please refresh and try again.</p>")})}function u(){if(!h)throw new Error("History Service not enabled");if(!i.url)throw new Error("No History Service api url");ReactDOM.unmountComponentAtNode(f[0]),p.show()}var h=window.OLHistoryService,d=$("#modal-history-service"),f=$("#history-service-mount"),p=$("#history-service-loading");d.bind({"show.bs.modal":c,"hidden.bs.modal":u})},$(function(){var e="wl_hide_maintenance_notice",t=$("#maintenance-notice");t.length>0&&!$.cookie(e)&&(t.trigger("summon"),t.on("dismissed",function(){return $.cookie(e,"true",{expires:1,path:"/"}),!1}))}),WL.Select={initialize:function(){WL.Select.setupAll($(".input-hints-select2"))},setupAll:function(e){e.each(function(){WL.Select.setup($(this))})},setup:function(e){var t=function(){var e=$(this).data("select2");setTimeout(function(){e.opened()||e.open()},0)};e.select2({initSelection:function(e,t){t({id:e.val(),text:e.val()})},data:function(){var t=[];return e.data("hints")&&$.each(e.data("hints"),function(e,n){t.push({id:n,text:n})}),{results:t}},width:"100%",openOnEnter:!1,minimumInputLength:1,selectOnBlur:!0,dropdownCssClass:"input-hints-select2-dropdown",createSearchChoicePosition:"top",createSearchChoice:function(e){return{id:e,text:e,customSearchChoice:!0}}}).bind("select2-open",function(){var t=$.trim(e.val());$("#select2-drop").find(".select2-input").val(t+" ").keydown().keyup().keydown().keyup().val(t).keydown().keyup(),$(this).select2("val","")}).on("select2-blur",function(){$(this).one("select2-focus",t),$(this).trigger("change")}).one("select2-focus",t)}},WL.UI=function(e,t,n,i,r,o,a,s,l,c,u,h,d,f,p,g,m,v,y,b,w,C,x,k,_,A){var S=this;this.makeSafe=function(e){WL.errorHandler.makeSafe(e)},this.makeSafeOnError=function(e){WL.errorHandler.makeSafeOnError(e)},this.makeSafeOnErrorHandler=function(e){WL.errorHandler.makeSafeOnErrorHandler(e)};try{var T=setTimeout(function(){$("#notice-loading-wait").hide(),$("#notice-loading-timeout").show(),analytics.track("loading-timeout")},3e4);u||(u="default");var L={theme:"wl-default",matchBrackets:!0,lineNumbers:!0,lineWrapping:d,readOnly:!0,keyMap:u,value:"",orig:"",highlightDifferences:!1},E=CodeMirror.MergeView($("#wl_editor_content")[0],L),M=E.edit;this.editor=function(){return M},M.state.matchBrackets.maxHighlightLineLength=1e4,M.on("beforeChange",function(e,t){t.update&&"paste"===t.origin&&t.update(null,null,t.text.map(function(e){return e=e.replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,""),e=e.replace(/[\uE000-\uF8FF\uFFFC]/g,""),e=e.replace(/[\x00-\x08\x0b-\x1f\xa0]/g,"")}))}),this.defaultSrc=i,this.hashUrl=new WL.HashUrl(this,i),i=this.hashUrl.getSrc(),b=JSON.parse(b),C=JSON.parse(C);var P=-1!==["student","pro","pro_plus"].indexOf(A);this.connection=new WL.Connection(this,e,n,i,r,o),this.twoUps=new WL.twoUps(M,WL.isTouchScreen);var R=new WL.Client(this,M,this.connection,_);this.watchTower=new WL.WatchTower(this);var I=new WL.Listener(this,M,this.connection,R,c);this.editorView=new WL.EditorView(S,E,_),this.preview=new WL.Preview(this,n,M,this.connection,R,g,_),this.synctex=new WL.Synctex(this,this.connection,R),this.texcount=new WL.TeXcount(this,this.connection,n),this.extFiles=new WL.ExtFiles(this,this.connection,n,w),this.files=new WL.Files(this,n,this.connection,R,a,s,l,this.extFiles,L,x,_),this.bibtex=new WL.BibtexParser(this,this.watchTower,n,e),this.history=new WL.History(this,n,M,this.connection,R,I),this.fileHistory=new WL.FileHistory(this,n,R,k.enabled,P,_),this.historyService=new WL.HistoryService(this,t,n,k),this.exports=new WL.Exports(this,n,this.connection),this.publish=new WL.Publish,this.share=new WL.Share,this.invites=new WL.Invites(this,this.connection),this.submissions=new WL.Submissions(this,this.connection,this.preview),this.pin=new WL.Pin(this),this.menuPopover=new WL.MenuPopover(this,$("#wl_editor_content"),$("#wl_editor_menu"),"bottom"),this.menuPopoverPinHeader=new WL.MenuPopover(this,$("#wl_main_container"),$("#wl_pinned .pannel-head, #modal-files .pannel-head"),"bottom"),this.joyride=new WL.Joyride(this,h),$(".start-joyride").bind("click",function(){S.joyride.ride(!0)}),this.avatarData=new WL.AvatarData(n),this.richText=new WL.RichText(M,this.avatarData,w,_),this.richTextMerge=new WL.RichText(E.right.orig,this.avatarData,w),this.richTextAdapter=new WL.RichTextAdapter(S,n,this.connection,R,this.richText,this.richTextMerge,u,M,m,y),f&&(this.spell=new WL.Spell(M,f,p,n)),this.editorView.toNormalMode();var O=b.editor_font_size,D=parseFloat(O)+.25;$('<style type="text/css">div.CodeMirror.rich-text { font-size:'+D+"em }</style>").prependTo("head"),$('<style type="text/css">div.CodeMirror { font-size:'+O+"em }</style>").prependTo("head");WL.Settings(this,m,d,O);this.contextMenu=new WL.ContextMenu(this,M),this.editorMenu=new WL.EditorMenu(this,C),$(this.connection).bind("connected",function(){$("#fade").trigger("dismiss"),$("#disconnected").trigger("dismiss"),T&&(clearTimeout(T),T=null,$("#loading").find("p").html("Please wait")),S.joyride.ride(!1),S.watchTower.init()}),$(this.connection).bind("disconnected",function(){this.connection.isStopped()||$("#loading").is(":visible")||$("#disconnected").trigger("summon")}.bind(this)),this.sleep=function(){analytics.track("sleep"),S.connection.stop(),$("#disconnected").trigger("dismiss"),M.setOption("readOnly",!0),$("#fade").trigger("summon"),$("#doc_sleep").trigger("summon")},this.showPleaseWait=function(){$("#doc_wait").trigger("summon")},this.hidePleaseWait=function(){$("#doc_wait").trigger("dismiss")};var F,N=function(){F=window.setTimeout(S.sleep,648e5)},W=function(){window.clearTimeout(F),N()};M.on("cursorActivity",W),this.displayAttModal=function(e,t,n,i,r,o,a,s){var l=$("#modal-att"),c=$("#link-att"),u=$("#img-att"),h=$("#att-ext-actions"),d=$("#att-ext-reload"),f=$("#text-att");u.attr("src",""),f.hide(),h.hide(),l.removeClass("has-ext-action"),d.unbind("click"),l.find(".modal-title").text(n),c.attr("href",t),c.show(),i?u.attr("src","/assets/icons/editor/placeholder/pdf.png"):r?u.attr("src","/assets/icons/editor/placeholder/eps.png"):o?u.attr("src",t):"ext"==a&&"src"==s||u.attr("src","/assets/icons/editor/placeholder/binary.png"),"ext"==a&&(l.addClass("has-ext-action"),h.show(),d.bind("click",function(){S.extFiles.reload(e)}),"src"==s&&(c.hide(),u.attr("src",""),f.show())),$("#modal-att").unbind("show.bs.modal"),$("#modal-att").unbind("hide.bs.modal"),$("#modal-att").bind({"show.bs.modal":function(){$("#wl_pinned, #wl_pin_divider").css("z-index","1050"),S.hashUrl.setAtt(e)},"hide.bs.modal":function(){$("#wl_pinned, #wl_pin_divider").css("z-index","10"),S.hashUrl.clearAtt(),j(),$("#text-att").empty()}})},this.openSrc=function(e){this.files.openSrc(e)},this.openAtt=function(e){this.files.openAtt(e)},this.updateDefaultSrc=function(e){S.defaultSrc=e,S.hashUrl.updateDefaultSrc(e)},this.hideAttModal=function(){j(),$("#modal-att").modal("hide")};var j=function(){$(".current_att").removeClass("current_att")};this.keymap=new WL.Keymap(this,M,u,v,b.auto_close_brackets,this.spell,this.richText,this.bibtex);var H=function(e){return function(){CodeMirror.commands[e](M),$("#edit_menu").removeClass("hover"),"findNext"!=e&&"findPrev"!=e||M.focus()}};$("#edit_find_link").click(H("find")),$("#edit_find_next_link").click(H("findNext")),$("#edit_find_prev_link").click(H("findPrev")),$("#edit_replace_link").click(H("replace")),$("#edit_replace_all_link").click(H("replaceAll")),this.replaceDocKeyInLinks=function(){var e=null;$("a[href*='DOC_KEY_RGXP']").each(function(){e=$(this).attr("href").replace("DOC_KEY_RGXP",n),e&&$(this).attr("href",e)})},S.replaceDocKeyInLinks(),$("#editor_notice").delay(5e3).fadeOut(1e3),this.forcingReload=!1,this.reload=function(e){e&&this.hashUrl.clear(),this.forcingReload=!0,WL.errorHandler.makeSafe("needs-to-reload"),setInterval(function(){var e=$("#reload-countdown"),t=parseInt(e.text(),10);t>1?e.text(--t):window.location.reload(!0)},1e3)},this.docAccessError=function(e){if(_){var t="Forbidden action in read-only mode.";$("#loading").trigger("dismiss"),$("#error-alert").trigger("summon").find("p").html(t)}else this.reload(e)},this.connection.start()}catch(B){throw WL.reportError(B),"no pusher"==B?($("#error-alert").trigger("summon").find("p").html("Sorry, one of the scripts we need does not seem to have loaded correctly. Please refresh the page to try again.\n\nIf this problem persists, it may be due to an ad- or script-block extension in your browser, or a network-wide content filter blocking our scripts. You may have to add an exception for *."+APP_DOMAIN+" in order to continue. Please feel free to contact us, and we'll try to help."),S.makeSafe("failed_to_load")):S.makeSafe("exception"),B}},$(document).ready(function(){$(".fb-like-delayed").closest(".control_menu").hover(function(){var e=$(this).find(".fb-like-delayed");e.length&&"undefined"!=typeof FB&&(e.removeClass("fb-like-delayed").addClass("fb-like"),FB.XFBML.parse(this))}),$("#wl-navbar").on("click",".main-nav.in a",function(){var e=$(this).parents("ul.main-nav");e.collapse("hide")}),$("#fade").bind({summon:function(){$(this).children().fadeIn()},dismiss:function(){$(this).children().fadeOut()}});var e=$(".modal");$(".navbar-nav li.modal-menu").bind("click",function(t){$(this).hasClass("wl-menu-modal-open")?(t.stopPropagation(),e.modal("hide")):$(this).addClass("wl-menu-modal-openning"),t.preventDefault()}),e.bind({"show.bs.modal":function(){e.modal("hide"),$(".wl-menu-modal-openning").removeClass("wl-menu-modal-openning").addClass("wl-menu-modal-open")},"hide.bs.modal":function(){$(".modal-backdrop").fadeOut(),$(".wl-menu-modal-open").removeClass("wl-menu-modal-open")}});var t=$("#modal-att");$("#img-att").bind("load",function(){t.modal("show"),$("#modal-att").trigger("twoUpResize"),$("#loading").trigger("dismiss")}).bind("error",function(){0!==$("#img-att").attr("src").length&&($("#loading").trigger("dismiss"),$("#error-alert").trigger("summon").find("p").html("We could not load this image. Please make sure the extension is correct."))}),t.bind("click",function(e){($(e.target).hasClass("modal-body")||$(e.target).hasClass("modal-body-content"))&&t.modal("hide")}),$("body").popover({placement:"bottom",selector:"[data-toggle='popover']",html:!0,content:function(){return $(this).next().html()}}),$("abbr.timeago").timeago()});